const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomePage-Mu7fz5zU.js","assets/geminiService-Dr8cZ5LP.js","assets/ArtifactPanel-BukV9qUG.js","assets/index-3gRswD5s.js","assets/activity-HGUxiTS0.js","assets/maximize-2-Chk4sja3.js","assets/layers-BAcIpE-B.js","assets/parsing-CtvF_D5E.js","assets/FlowPage-8C1TGFlr.js","assets/branchFusionService-fSHKxQrq.js","assets/LibraryPage-lDc5YBfY.js","assets/clock-CSHSVtva.js","assets/SettingsPage-BgMHpa5p.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();var oh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function F_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var iy={exports:{}},wc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nb;function lk(){if(Nb)return wc;Nb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,o){var l=null;if(o!==void 0&&(l=""+o),r.key!==void 0&&(l=""+r.key),"key"in r){o={};for(var c in r)c!=="key"&&(o[c]=r[c])}else o=r;return r=o.ref,{$$typeof:n,type:i,key:l,ref:r!==void 0?r:null,props:o}}return wc.Fragment=e,wc.jsx=t,wc.jsxs=t,wc}var kb;function uk(){return kb||(kb=1,iy.exports=lk()),iy.exports}var S=uk(),ry={exports:{}},ut={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mb;function ck(){if(Mb)return ut;Mb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),E=Symbol.iterator;function b(F){return F===null||typeof F!="object"?null:(F=E&&F[E]||F["@@iterator"],typeof F=="function"?F:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,A={};function N(F,W,ye){this.props=F,this.context=W,this.refs=A,this.updater=ye||I}N.prototype.isReactComponent={},N.prototype.setState=function(F,W){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,W,"setState")},N.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function U(){}U.prototype=N.prototype;function L(F,W,ye){this.props=F,this.context=W,this.refs=A,this.updater=ye||I}var $=L.prototype=new U;$.constructor=L,x($,N.prototype),$.isPureReactComponent=!0;var K=Array.isArray;function j(){}var k={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function D(F,W,ye){var _e=ye.ref;return{$$typeof:n,type:F,key:W,ref:_e!==void 0?_e:null,props:ye}}function z(F,W){return D(F.type,W,F.props)}function G(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function M(F){var W={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(ye){return W[ye]})}var B=/\/+/g;function O(F,W){return typeof F=="object"&&F!==null&&F.key!=null?M(""+F.key):W.toString(36)}function oe(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(j,j):(F.status="pending",F.then(function(W){F.status==="pending"&&(F.status="fulfilled",F.value=W)},function(W){F.status==="pending"&&(F.status="rejected",F.reason=W)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function X(F,W,ye,_e,Ee){var ze=typeof F;(ze==="undefined"||ze==="boolean")&&(F=null);var Qe=!1;if(F===null)Qe=!0;else switch(ze){case"bigint":case"string":case"number":Qe=!0;break;case"object":switch(F.$$typeof){case n:case e:Qe=!0;break;case m:return Qe=F._init,X(Qe(F._payload),W,ye,_e,Ee)}}if(Qe)return Ee=Ee(F),Qe=_e===""?"."+O(F,0):_e,K(Ee)?(ye="",Qe!=null&&(ye=Qe.replace(B,"$&/")+"/"),X(Ee,W,ye,"",function(Ge){return Ge})):Ee!=null&&(G(Ee)&&(Ee=z(Ee,ye+(Ee.key==null||F&&F.key===Ee.key?"":(""+Ee.key).replace(B,"$&/")+"/")+Qe)),W.push(Ee)),1;Qe=0;var Je=_e===""?".":_e+":";if(K(F))for(var Ne=0;Ne<F.length;Ne++)_e=F[Ne],ze=Je+O(_e,Ne),Qe+=X(_e,W,ye,ze,Ee);else if(Ne=b(F),typeof Ne=="function")for(F=Ne.call(F),Ne=0;!(_e=F.next()).done;)_e=_e.value,ze=Je+O(_e,Ne++),Qe+=X(_e,W,ye,ze,Ee);else if(ze==="object"){if(typeof F.then=="function")return X(oe(F),W,ye,_e,Ee);throw W=String(F),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return Qe}function Q(F,W,ye){if(F==null)return F;var _e=[],Ee=0;return X(F,_e,"","",function(ze){return W.call(ye,ze,Ee++)}),_e}function se(F){if(F._status===-1){var W=F._result;W=W(),W.then(function(ye){(F._status===0||F._status===-1)&&(F._status=1,F._result=ye)},function(ye){(F._status===0||F._status===-1)&&(F._status=2,F._result=ye)}),F._status===-1&&(F._status=0,F._result=W)}if(F._status===1)return F._result.default;throw F._result}var ne=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},ue={map:Q,forEach:function(F,W,ye){Q(F,function(){W.apply(this,arguments)},ye)},count:function(F){var W=0;return Q(F,function(){W++}),W},toArray:function(F){return Q(F,function(W){return W})||[]},only:function(F){if(!G(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return ut.Activity=v,ut.Children=ue,ut.Component=N,ut.Fragment=t,ut.Profiler=r,ut.PureComponent=L,ut.StrictMode=i,ut.Suspense=d,ut.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,ut.__COMPILER_RUNTIME={__proto__:null,c:function(F){return k.H.useMemoCache(F)}},ut.cache=function(F){return function(){return F.apply(null,arguments)}},ut.cacheSignal=function(){return null},ut.cloneElement=function(F,W,ye){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var _e=x({},F.props),Ee=F.key;if(W!=null)for(ze in W.key!==void 0&&(Ee=""+W.key),W)!V.call(W,ze)||ze==="key"||ze==="__self"||ze==="__source"||ze==="ref"&&W.ref===void 0||(_e[ze]=W[ze]);var ze=arguments.length-2;if(ze===1)_e.children=ye;else if(1<ze){for(var Qe=Array(ze),Je=0;Je<ze;Je++)Qe[Je]=arguments[Je+2];_e.children=Qe}return D(F.type,Ee,_e)},ut.createContext=function(F){return F={$$typeof:l,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:o,_context:F},F},ut.createElement=function(F,W,ye){var _e,Ee={},ze=null;if(W!=null)for(_e in W.key!==void 0&&(ze=""+W.key),W)V.call(W,_e)&&_e!=="key"&&_e!=="__self"&&_e!=="__source"&&(Ee[_e]=W[_e]);var Qe=arguments.length-2;if(Qe===1)Ee.children=ye;else if(1<Qe){for(var Je=Array(Qe),Ne=0;Ne<Qe;Ne++)Je[Ne]=arguments[Ne+2];Ee.children=Je}if(F&&F.defaultProps)for(_e in Qe=F.defaultProps,Qe)Ee[_e]===void 0&&(Ee[_e]=Qe[_e]);return D(F,ze,Ee)},ut.createRef=function(){return{current:null}},ut.forwardRef=function(F){return{$$typeof:c,render:F}},ut.isValidElement=G,ut.lazy=function(F){return{$$typeof:m,_payload:{_status:-1,_result:F},_init:se}},ut.memo=function(F,W){return{$$typeof:f,type:F,compare:W===void 0?null:W}},ut.startTransition=function(F){var W=k.T,ye={};k.T=ye;try{var _e=F(),Ee=k.S;Ee!==null&&Ee(ye,_e),typeof _e=="object"&&_e!==null&&typeof _e.then=="function"&&_e.then(j,ne)}catch(ze){ne(ze)}finally{W!==null&&ye.types!==null&&(W.types=ye.types),k.T=W}},ut.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},ut.use=function(F){return k.H.use(F)},ut.useActionState=function(F,W,ye){return k.H.useActionState(F,W,ye)},ut.useCallback=function(F,W){return k.H.useCallback(F,W)},ut.useContext=function(F){return k.H.useContext(F)},ut.useDebugValue=function(){},ut.useDeferredValue=function(F,W){return k.H.useDeferredValue(F,W)},ut.useEffect=function(F,W){return k.H.useEffect(F,W)},ut.useEffectEvent=function(F){return k.H.useEffectEvent(F)},ut.useId=function(){return k.H.useId()},ut.useImperativeHandle=function(F,W,ye){return k.H.useImperativeHandle(F,W,ye)},ut.useInsertionEffect=function(F,W){return k.H.useInsertionEffect(F,W)},ut.useLayoutEffect=function(F,W){return k.H.useLayoutEffect(F,W)},ut.useMemo=function(F,W){return k.H.useMemo(F,W)},ut.useOptimistic=function(F,W){return k.H.useOptimistic(F,W)},ut.useReducer=function(F,W,ye){return k.H.useReducer(F,W,ye)},ut.useRef=function(F){return k.H.useRef(F)},ut.useState=function(F){return k.H.useState(F)},ut.useSyncExternalStore=function(F,W,ye){return k.H.useSyncExternalStore(F,W,ye)},ut.useTransition=function(){return k.H.useTransition()},ut.version="19.2.4",ut}var Db;function z_(){return Db||(Db=1,ry.exports=ck()),ry.exports}var Oe=z_();const dk=F_(Oe);var sy={exports:{}},xc={},oy={exports:{}},ay={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pb;function fk(){return Pb||(Pb=1,(function(n){function e(X,Q){var se=X.length;X.push(Q);e:for(;0<se;){var ne=se-1>>>1,ue=X[ne];if(0<r(ue,Q))X[ne]=Q,X[se]=ue,se=ne;else break e}}function t(X){return X.length===0?null:X[0]}function i(X){if(X.length===0)return null;var Q=X[0],se=X.pop();if(se!==Q){X[0]=se;e:for(var ne=0,ue=X.length,F=ue>>>1;ne<F;){var W=2*(ne+1)-1,ye=X[W],_e=W+1,Ee=X[_e];if(0>r(ye,se))_e<ue&&0>r(Ee,ye)?(X[ne]=Ee,X[_e]=se,ne=_e):(X[ne]=ye,X[W]=se,ne=W);else if(_e<ue&&0>r(Ee,se))X[ne]=Ee,X[_e]=se,ne=_e;else break e}}return Q}function r(X,Q){var se=X.sortIndex-Q.sortIndex;return se!==0?se:X.id-Q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var d=[],f=[],m=1,v=null,E=3,b=!1,I=!1,x=!1,A=!1,N=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function $(X){for(var Q=t(f);Q!==null;){if(Q.callback===null)i(f);else if(Q.startTime<=X)i(f),Q.sortIndex=Q.expirationTime,e(d,Q);else break;Q=t(f)}}function K(X){if(x=!1,$(X),!I)if(t(d)!==null)I=!0,j||(j=!0,M());else{var Q=t(f);Q!==null&&oe(K,Q.startTime-X)}}var j=!1,k=-1,V=5,D=-1;function z(){return A?!0:!(n.unstable_now()-D<V)}function G(){if(A=!1,j){var X=n.unstable_now();D=X;var Q=!0;try{e:{I=!1,x&&(x=!1,U(k),k=-1),b=!0;var se=E;try{t:{for($(X),v=t(d);v!==null&&!(v.expirationTime>X&&z());){var ne=v.callback;if(typeof ne=="function"){v.callback=null,E=v.priorityLevel;var ue=ne(v.expirationTime<=X);if(X=n.unstable_now(),typeof ue=="function"){v.callback=ue,$(X),Q=!0;break t}v===t(d)&&i(d),$(X)}else i(d);v=t(d)}if(v!==null)Q=!0;else{var F=t(f);F!==null&&oe(K,F.startTime-X),Q=!1}}break e}finally{v=null,E=se,b=!1}Q=void 0}}finally{Q?M():j=!1}}}var M;if(typeof L=="function")M=function(){L(G)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,O=B.port2;B.port1.onmessage=G,M=function(){O.postMessage(null)}}else M=function(){N(G,0)};function oe(X,Q){k=N(function(){X(n.unstable_now())},Q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_next=function(X){switch(E){case 1:case 2:case 3:var Q=3;break;default:Q=E}var se=E;E=Q;try{return X()}finally{E=se}},n.unstable_requestPaint=function(){A=!0},n.unstable_runWithPriority=function(X,Q){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var se=E;E=X;try{return Q()}finally{E=se}},n.unstable_scheduleCallback=function(X,Q,se){var ne=n.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?ne+se:ne):se=ne,X){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=se+ue,X={id:m++,callback:Q,priorityLevel:X,startTime:se,expirationTime:ue,sortIndex:-1},se>ne?(X.sortIndex=se,e(f,X),t(d)===null&&X===t(f)&&(x?(U(k),k=-1):x=!0,oe(K,se-ne))):(X.sortIndex=ue,e(d,X),I||b||(I=!0,j||(j=!0,M()))),X},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(X){var Q=E;return function(){var se=E;E=Q;try{return X.apply(this,arguments)}finally{E=se}}}})(ay)),ay}var Ob;function hk(){return Ob||(Ob=1,oy.exports=fk()),oy.exports}var ly={exports:{}},zn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vb;function pk(){if(Vb)return zn;Vb=1;var n=z_();function e(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(d,f,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:v==null?null:""+v,children:d,containerInfo:f,implementation:m}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return zn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,zn.createPortal=function(d,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return o(d,f,null,m)},zn.flushSync=function(d){var f=l.T,m=i.p;try{if(l.T=null,i.p=2,d)return d()}finally{l.T=f,i.p=m,i.d.f()}},zn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},zn.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},zn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var m=f.as,v=c(m,f.crossOrigin),E=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:E,fetchPriority:b}):m==="script"&&i.d.X(d,{crossOrigin:v,integrity:E,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},zn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=c(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},zn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,v=c(m,f.crossOrigin);i.d.L(d,m,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},zn.preloadModule=function(d,f){if(typeof d=="string")if(f){var m=c(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},zn.requestFormReset=function(d){i.d.r(d)},zn.unstable_batchedUpdates=function(d,f){return d(f)},zn.useFormState=function(d,f,m){return l.H.useFormState(d,f,m)},zn.useFormStatus=function(){return l.H.useHostTransitionStatus()},zn.version="19.2.4",zn}var Ub;function mk(){if(Ub)return ly.exports;Ub=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ly.exports=pk(),ly.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lb;function gk(){if(Lb)return xc;Lb=1;var n=hk(),e=z_(),t=mk();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var a=s,u=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(u=a.return),s=a.return;while(s)}return a.tag===3?u:null}function l(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function c(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function d(s){if(o(s)!==s)throw Error(i(188))}function f(s){var a=s.alternate;if(!a){if(a=o(s),a===null)throw Error(i(188));return a!==s?null:s}for(var u=s,h=a;;){var _=u.return;if(_===null)break;var T=_.alternate;if(T===null){if(h=_.return,h!==null){u=h;continue}break}if(_.child===T.child){for(T=_.child;T;){if(T===u)return d(_),s;if(T===h)return d(_),a;T=T.sibling}throw Error(i(188))}if(u.return!==h.return)u=_,h=T;else{for(var R=!1,q=_.child;q;){if(q===u){R=!0,u=_,h=T;break}if(q===h){R=!0,h=_,u=T;break}q=q.sibling}if(!R){for(q=T.child;q;){if(q===u){R=!0,u=T,h=_;break}if(q===h){R=!0,h=T,u=_;break}q=q.sibling}if(!R)throw Error(i(189))}}if(u.alternate!==h)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?s:a}function m(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=m(s),a!==null)return a;s=s.sibling}return null}var v=Object.assign,E=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),I=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),L=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),G=Symbol.iterator;function M(s){return s===null||typeof s!="object"?null:(s=G&&s[G]||s["@@iterator"],typeof s=="function"?s:null)}var B=Symbol.for("react.client.reference");function O(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===B?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case x:return"Fragment";case N:return"Profiler";case A:return"StrictMode";case K:return"Suspense";case j:return"SuspenseList";case D:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case I:return"Portal";case L:return s.displayName||"Context";case U:return(s._context.displayName||"Context")+".Consumer";case $:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case k:return a=s.displayName||null,a!==null?a:O(s.type)||"Memo";case V:a=s._payload,s=s._init;try{return O(s(a))}catch{}}return null}var oe=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se={pending:!1,data:null,method:null,action:null},ne=[],ue=-1;function F(s){return{current:s}}function W(s){0>ue||(s.current=ne[ue],ne[ue]=null,ue--)}function ye(s,a){ue++,ne[ue]=s.current,s.current=a}var _e=F(null),Ee=F(null),ze=F(null),Qe=F(null);function Je(s,a){switch(ye(ze,a),ye(Ee,s),ye(_e,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?ZT(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=ZT(a),s=eb(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}W(_e),ye(_e,s)}function Ne(){W(_e),W(Ee),W(ze)}function Ge(s){s.memoizedState!==null&&ye(Qe,s);var a=_e.current,u=eb(a,s.type);a!==u&&(ye(Ee,s),ye(_e,u))}function Ye(s){Ee.current===s&&(W(_e),W(Ee)),Qe.current===s&&(W(Qe),Ec._currentValue=se)}var gt,it;function C(s){if(gt===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);gt=a&&a[1]||"",it=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+gt+s+it}var ie=!1;function re(s,a){if(!s||ie)return"";ie=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(a){var Ce=function(){throw Error()};if(Object.defineProperty(Ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ce,[])}catch(Te){var ge=Te}Reflect.construct(s,[],Ce)}else{try{Ce.call()}catch(Te){ge=Te}s.call(Ce.prototype)}}else{try{throw Error()}catch(Te){ge=Te}(Ce=s())&&typeof Ce.catch=="function"&&Ce.catch(function(){})}}catch(Te){if(Te&&ge&&typeof Te.stack=="string")return[Te.stack,ge.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=h.DetermineComponentFrameRoot(),R=T[0],q=T[1];if(R&&q){var Z=R.split(`
`),me=q.split(`
`);for(_=h=0;h<Z.length&&!Z[h].includes("DetermineComponentFrameRoot");)h++;for(;_<me.length&&!me[_].includes("DetermineComponentFrameRoot");)_++;if(h===Z.length||_===me.length)for(h=Z.length-1,_=me.length-1;1<=h&&0<=_&&Z[h]!==me[_];)_--;for(;1<=h&&0<=_;h--,_--)if(Z[h]!==me[_]){if(h!==1||_!==1)do if(h--,_--,0>_||Z[h]!==me[_]){var we=`
`+Z[h].replace(" at new "," at ");return s.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",s.displayName)),we}while(1<=h&&0<=_);break}}}finally{ie=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?C(u):""}function Y(s,a){switch(s.tag){case 26:case 27:case 5:return C(s.type);case 16:return C("Lazy");case 13:return s.child!==a&&a!==null?C("Suspense Fallback"):C("Suspense");case 19:return C("SuspenseList");case 0:case 15:return re(s.type,!1);case 11:return re(s.type.render,!1);case 1:return re(s.type,!0);case 31:return C("Activity");default:return""}}function J(s){try{var a="",u=null;do a+=Y(s,u),u=s,s=s.return;while(s);return a}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var ee=Object.prototype.hasOwnProperty,be=n.unstable_scheduleCallback,Ie=n.unstable_cancelCallback,de=n.unstable_shouldYield,Me=n.unstable_requestPaint,De=n.unstable_now,ke=n.unstable_getCurrentPriorityLevel,He=n.unstable_ImmediatePriority,ct=n.unstable_UserBlockingPriority,nt=n.unstable_NormalPriority,Ht=n.unstable_LowPriority,Rt=n.unstable_IdlePriority,It=n.log,le=n.unstable_setDisableYieldValue,he=null,Ae=null;function Ve(s){if(typeof It=="function"&&le(s),Ae&&typeof Ae.setStrictMode=="function")try{Ae.setStrictMode(he,s)}catch{}}var Re=Math.clz32?Math.clz32:wt,Be=Math.log,$e=Math.LN2;function wt(s){return s>>>=0,s===0?32:31-(Be(s)/$e|0)|0}var $t=256,rn=262144,Nt=4194304;function dt(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function pt(s,a,u){var h=s.pendingLanes;if(h===0)return 0;var _=0,T=s.suspendedLanes,R=s.pingedLanes;s=s.warmLanes;var q=h&134217727;return q!==0?(h=q&~T,h!==0?_=dt(h):(R&=q,R!==0?_=dt(R):u||(u=q&~s,u!==0&&(_=dt(u))))):(q=h&~T,q!==0?_=dt(q):R!==0?_=dt(R):u||(u=h&~s,u!==0&&(_=dt(u)))),_===0?0:a!==0&&a!==_&&(a&T)===0&&(T=_&-_,u=a&-a,T>=u||T===32&&(u&4194048)!==0)?a:_}function In(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function ys(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zi(){var s=Nt;return Nt<<=1,(Nt&62914560)===0&&(Nt=4194304),s}function Ut(s){for(var a=[],u=0;31>u;u++)a.push(s);return a}function ar(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Va(s,a,u,h,_,T){var R=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var q=s.entanglements,Z=s.expirationTimes,me=s.hiddenUpdates;for(u=R&~u;0<u;){var we=31-Re(u),Ce=1<<we;q[we]=0,Z[we]=-1;var ge=me[we];if(ge!==null)for(me[we]=null,we=0;we<ge.length;we++){var Te=ge[we];Te!==null&&(Te.lane&=-536870913)}u&=~Ce}h!==0&&Ro(s,h,0),T!==0&&_===0&&s.tag!==0&&(s.suspendedLanes|=T&~(R&~a))}function Ro(s,a,u){s.pendingLanes|=a,s.suspendedLanes&=~a;var h=31-Re(a);s.entangledLanes|=a,s.entanglements[h]=s.entanglements[h]|1073741824|u&261930}function xu(s,a){var u=s.entangledLanes|=a;for(s=s.entanglements;u;){var h=31-Re(u),_=1<<h;_&a|s[h]&a&&(s[h]|=a),u&=~_}}function Au(s,a){var u=a&-a;return u=(u&42)!==0?1:No(u),(u&(s.suspendedLanes|a))!==0?0:u}function No(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Or(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ud(){var s=Q.p;return s!==0?s:(s=window.event,s===void 0?32:Sb(s.type))}function Gi(s,a){var u=Q.p;try{return Q.p=s,a()}finally{Q.p=u}}var qi=Math.random().toString(36).slice(2),mn="__reactFiber$"+qi,Cn="__reactProps$"+qi,lr="__reactContainer$"+qi,Ua="__reactEvents$"+qi,um="__reactListeners$"+qi,Ld="__reactHandles$"+qi,Bd="__reactResources$"+qi,ur="__reactMarker$"+qi;function La(s){delete s[mn],delete s[Cn],delete s[Ua],delete s[um],delete s[Ld]}function cr(s){var a=s[mn];if(a)return a;for(var u=s.parentNode;u;){if(a=u[lr]||u[mn]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(s=ab(s);s!==null;){if(u=s[mn])return u;s=ab(s)}return a}s=u,u=s.parentNode}return null}function Si(s){if(s=s[mn]||s[lr]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function ui(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function dr(s){var a=s[Bd];return a||(a=s[Bd]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function gn(s){s[ur]=!0}var Iu=new Set,Cu={};function fr(s,a){hr(s,a),hr(s+"Capture",a)}function hr(s,a){for(Cu[s]=a,s=0;s<a.length;s++)Iu.add(a[s])}var Ru=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nu={},ku={};function Fd(s){return ee.call(ku,s)?!0:ee.call(Nu,s)?!1:Ru.test(s)?ku[s]=!0:(Nu[s]=!0,!1)}function Ba(s,a,u){if(Fd(a))if(u===null)s.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var h=a.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+u)}}function ci(s,a,u){if(u===null)s.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+u)}}function yn(s,a,u,h){if(h===null)s.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(a,u,""+h)}}function Rn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function _s(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Mu(s,a,u){var h=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var _=h.get,T=h.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return _.call(this)},set:function(R){u=""+R,T.call(this,R)}}),Object.defineProperty(s,a,{enumerable:h.enumerable}),{getValue:function(){return u},setValue:function(R){u=""+R},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function Lt(s){if(!s._valueTracker){var a=_s(s)?"checked":"value";s._valueTracker=Mu(s,a,""+s[a])}}function ko(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var u=a.getValue(),h="";return s&&(h=_s(s)?s.checked?"true":"false":s.value),s=h,s!==u?(a.setValue(s),!0):!1}function pr(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Mo=/[\n"\\]/g;function Zn(s){return s.replace(Mo,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Fa(s,a,u,h,_,T,R,q){s.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?s.type=R:s.removeAttribute("type"),a!=null?R==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Rn(a)):s.value!==""+Rn(a)&&(s.value=""+Rn(a)):R!=="submit"&&R!=="reset"||s.removeAttribute("value"),a!=null?Du(s,R,Rn(a)):u!=null?Du(s,R,Rn(u)):h!=null&&s.removeAttribute("value"),_==null&&T!=null&&(s.defaultChecked=!!T),_!=null&&(s.checked=_&&typeof _!="function"&&typeof _!="symbol"),q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?s.name=""+Rn(q):s.removeAttribute("name")}function zd(s,a,u,h,_,T,R,q){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(s.type=T),a!=null||u!=null){if(!(T!=="submit"&&T!=="reset"||a!=null)){Lt(s);return}u=u!=null?""+Rn(u):"",a=a!=null?""+Rn(a):u,q||a===s.value||(s.value=a),s.defaultValue=a}h=h??_,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=q?s.checked:!!h,s.defaultChecked=!!h,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(s.name=R),Lt(s)}function Du(s,a,u){a==="number"&&pr(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function vs(s,a,u,h){if(s=s.options,a){a={};for(var _=0;_<u.length;_++)a["$"+u[_]]=!0;for(u=0;u<s.length;u++)_=a.hasOwnProperty("$"+s[u].value),s[u].selected!==_&&(s[u].selected=_),_&&h&&(s[u].defaultSelected=!0)}else{for(u=""+Rn(u),a=null,_=0;_<s.length;_++){if(s[_].value===u){s[_].selected=!0,h&&(s[_].defaultSelected=!0);return}a!==null||s[_].disabled||(a=s[_])}a!==null&&(a.selected=!0)}}function Gd(s,a,u){if(a!=null&&(a=""+Rn(a),a!==s.value&&(s.value=a),u==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=u!=null?""+Rn(u):""}function Es(s,a,u,h){if(a==null){if(h!=null){if(u!=null)throw Error(i(92));if(oe(h)){if(1<h.length)throw Error(i(93));h=h[0]}u=h}u==null&&(u=""),a=u}u=Rn(a),s.defaultValue=u,h=s.textContent,h===u&&h!==""&&h!==null&&(s.value=h),Lt(s)}function ei(s,a){if(a){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=a;return}}s.textContent=a}var qd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Pu(s,a,u){var h=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?h?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":h?s.setProperty(a,u):typeof u!="number"||u===0||qd.has(a)?a==="float"?s.cssFloat=u:s[a]=(""+u).trim():s[a]=u+"px"}function Ou(s,a,u){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,u!=null){for(var h in u)!u.hasOwnProperty(h)||a!=null&&a.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var _ in a)h=a[_],a.hasOwnProperty(_)&&u[_]!==h&&Pu(s,_,h)}else for(var T in a)a.hasOwnProperty(T)&&Pu(s,T,a[T])}function za(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ts=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ga(s){return Ts.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Hi(){}var Vu=null;function wi(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var bs=null,mr=null;function Do(s){var a=Si(s);if(a&&(s=a.stateNode)){var u=s[Cn]||null;e:switch(s=a.stateNode,a.type){case"input":if(Fa(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Zn(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var h=u[a];if(h!==s&&h.form===s.form){var _=h[Cn]||null;if(!_)throw Error(i(90));Fa(h,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(a=0;a<u.length;a++)h=u[a],h.form===s.form&&ko(h)}break e;case"textarea":Gd(s,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&vs(s,!!u.multiple,a,!1)}}}var qa=!1;function Ss(s,a,u){if(qa)return s(a,u);qa=!0;try{var h=s(a);return h}finally{if(qa=!1,(bs!==null||mr!==null)&&(Lf(),bs&&(a=bs,s=mr,mr=bs=null,Do(a),s)))for(a=0;a<s.length;a++)Do(s[a])}}function $i(s,a){var u=s.stateNode;if(u===null)return null;var h=u[Cn]||null;if(h===null)return null;u=h[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(i(231,a,typeof u));return u}var xi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Po=!1;if(xi)try{var jt={};Object.defineProperty(jt,"passive",{get:function(){Po=!0}}),window.addEventListener("test",jt,jt),window.removeEventListener("test",jt,jt)}catch{Po=!1}var gr=null,Uu=null,Oo=null;function Lu(){if(Oo)return Oo;var s,a=Uu,u=a.length,h,_="value"in gr?gr.value:gr.textContent,T=_.length;for(s=0;s<u&&a[s]===_[s];s++);var R=u-s;for(h=1;h<=R&&a[u-h]===_[T-h];h++);return Oo=_.slice(s,1<h?1-h:void 0)}function Vo(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Vr(){return!0}function ji(){return!1}function On(s){function a(u,h,_,T,R){this._reactName=u,this._targetInst=_,this.type=h,this.nativeEvent=T,this.target=R,this.currentTarget=null;for(var q in s)s.hasOwnProperty(q)&&(u=s[q],this[q]=u?u(T):T[q]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Vr:ji,this.isPropagationStopped=ji,this}return v(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Vr)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Vr)},persist:function(){},isPersistent:Vr}),a}var Ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yr=On(Ur),ws=v({},Ur,{view:0,detail:0}),Bu=On(ws),xs,Ha,_r,$a=v({},ws,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:As,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==_r&&(_r&&s.type==="mousemove"?(xs=s.screenX-_r.screenX,Ha=s.screenY-_r.screenY):Ha=xs=0,_r=s),xs)},movementY:function(s){return"movementY"in s?s.movementY:Ha}}),Fu=On($a),Uo=v({},$a,{dataTransfer:0}),$d=On(Uo),jd=v({},ws,{relatedTarget:0}),Lo=On(jd),zu=v({},Ur,{animationName:0,elapsedTime:0,pseudoElement:0}),Kd=On(zu),ja=v({},Ur,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Jd=On(ja),Yd=v({},Ur,{data:0}),vr=On(Yd),Wd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zd(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Xd[s])?!!a[s]:!1}function As(){return Zd}var Jn=v({},ws,{key:function(s){if(s.key){var a=Wd[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Vo(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Qd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:As,charCode:function(s){return s.type==="keypress"?Vo(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Vo(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ef=On(Jn),tf=v({},$a,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lr=On(tf),y=v({},ws,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:As}),w=On(y),P=v({},Ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),H=On(P),fe=v({},$a,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ve=On(fe),Le=v({},Ur,{newState:0,oldState:0}),ft=On(Le),un=[9,13,27,32],Pt=xi&&"CompositionEvent"in window,en=null;xi&&"documentMode"in document&&(en=document.documentMode);var Ai=xi&&"TextEvent"in window&&!en,Er=xi&&(!Pt||en&&8<en&&11>=en),Ki=" ",Ji=!1;function Bo(s,a){switch(s){case"keyup":return un.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ka(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ja=!1;function MN(s,a){switch(s){case"compositionend":return Ka(a);case"keypress":return a.which!==32?null:(Ji=!0,Ki);case"textInput":return s=a.data,s===Ki&&Ji?null:s;default:return null}}function DN(s,a){if(Ja)return s==="compositionend"||!Pt&&Bo(s,a)?(s=Lu(),Oo=Uu=gr=null,Ja=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Er&&a.locale!=="ko"?null:a.data;default:return null}}var PN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function c0(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!PN[s.type]:a==="textarea"}function d0(s,a,u,h){bs?mr?mr.push(h):mr=[h]:bs=h,a=$f(a,"onChange"),0<a.length&&(u=new yr("onChange","change",null,u,h),s.push({event:u,listeners:a}))}var Gu=null,qu=null;function ON(s){KT(s,0)}function nf(s){var a=ui(s);if(ko(a))return s}function f0(s,a){if(s==="change")return a}var h0=!1;if(xi){var cm;if(xi){var dm="oninput"in document;if(!dm){var p0=document.createElement("div");p0.setAttribute("oninput","return;"),dm=typeof p0.oninput=="function"}cm=dm}else cm=!1;h0=cm&&(!document.documentMode||9<document.documentMode)}function m0(){Gu&&(Gu.detachEvent("onpropertychange",g0),qu=Gu=null)}function g0(s){if(s.propertyName==="value"&&nf(qu)){var a=[];d0(a,qu,s,wi(s)),Ss(ON,a)}}function VN(s,a,u){s==="focusin"?(m0(),Gu=a,qu=u,Gu.attachEvent("onpropertychange",g0)):s==="focusout"&&m0()}function UN(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return nf(qu)}function LN(s,a){if(s==="click")return nf(a)}function BN(s,a){if(s==="input"||s==="change")return nf(a)}function FN(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var di=typeof Object.is=="function"?Object.is:FN;function Hu(s,a){if(di(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var u=Object.keys(s),h=Object.keys(a);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var _=u[h];if(!ee.call(a,_)||!di(s[_],a[_]))return!1}return!0}function y0(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function _0(s,a){var u=y0(s);s=0;for(var h;u;){if(u.nodeType===3){if(h=s+u.textContent.length,s<=a&&h>=a)return{node:u,offset:a-s};s=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=y0(u)}}function v0(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?v0(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function E0(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=pr(s.document);a instanceof s.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)s=a.contentWindow;else break;a=pr(s.document)}return a}function fm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var zN=xi&&"documentMode"in document&&11>=document.documentMode,Ya=null,hm=null,$u=null,pm=!1;function T0(s,a,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;pm||Ya==null||Ya!==pr(h)||(h=Ya,"selectionStart"in h&&fm(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),$u&&Hu($u,h)||($u=h,h=$f(hm,"onSelect"),0<h.length&&(a=new yr("onSelect","select",null,a,u),s.push({event:a,listeners:h}),a.target=Ya)))}function Fo(s,a){var u={};return u[s.toLowerCase()]=a.toLowerCase(),u["Webkit"+s]="webkit"+a,u["Moz"+s]="moz"+a,u}var Wa={animationend:Fo("Animation","AnimationEnd"),animationiteration:Fo("Animation","AnimationIteration"),animationstart:Fo("Animation","AnimationStart"),transitionrun:Fo("Transition","TransitionRun"),transitionstart:Fo("Transition","TransitionStart"),transitioncancel:Fo("Transition","TransitionCancel"),transitionend:Fo("Transition","TransitionEnd")},mm={},b0={};xi&&(b0=document.createElement("div").style,"AnimationEvent"in window||(delete Wa.animationend.animation,delete Wa.animationiteration.animation,delete Wa.animationstart.animation),"TransitionEvent"in window||delete Wa.transitionend.transition);function zo(s){if(mm[s])return mm[s];if(!Wa[s])return s;var a=Wa[s],u;for(u in a)if(a.hasOwnProperty(u)&&u in b0)return mm[s]=a[u];return s}var S0=zo("animationend"),w0=zo("animationiteration"),x0=zo("animationstart"),GN=zo("transitionrun"),qN=zo("transitionstart"),HN=zo("transitioncancel"),A0=zo("transitionend"),I0=new Map,gm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");gm.push("scrollEnd");function Yi(s,a){I0.set(s,a),fr(a,[s])}var rf=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ii=[],Qa=0,ym=0;function sf(){for(var s=Qa,a=ym=Qa=0;a<s;){var u=Ii[a];Ii[a++]=null;var h=Ii[a];Ii[a++]=null;var _=Ii[a];Ii[a++]=null;var T=Ii[a];if(Ii[a++]=null,h!==null&&_!==null){var R=h.pending;R===null?_.next=_:(_.next=R.next,R.next=_),h.pending=_}T!==0&&C0(u,_,T)}}function of(s,a,u,h){Ii[Qa++]=s,Ii[Qa++]=a,Ii[Qa++]=u,Ii[Qa++]=h,ym|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function _m(s,a,u,h){return of(s,a,u,h),af(s)}function Go(s,a){return of(s,null,null,a),af(s)}function C0(s,a,u){s.lanes|=u;var h=s.alternate;h!==null&&(h.lanes|=u);for(var _=!1,T=s.return;T!==null;)T.childLanes|=u,h=T.alternate,h!==null&&(h.childLanes|=u),T.tag===22&&(s=T.stateNode,s===null||s._visibility&1||(_=!0)),s=T,T=T.return;return s.tag===3?(T=s.stateNode,_&&a!==null&&(_=31-Re(u),s=T.hiddenUpdates,h=s[_],h===null?s[_]=[a]:h.push(a),a.lane=u|536870912),T):null}function af(s){if(50<hc)throw hc=0,Ig=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var Xa={};function $N(s,a,u,h){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(s,a,u,h){return new $N(s,a,u,h)}function vm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Br(s,a){var u=s.alternate;return u===null?(u=fi(s.tag,a,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=a,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,a=s.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function R0(s,a){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,a=u.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function lf(s,a,u,h,_,T){var R=0;if(h=s,typeof s=="function")vm(s)&&(R=1);else if(typeof s=="string")R=W2(s,u,_e.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case D:return s=fi(31,u,a,_),s.elementType=D,s.lanes=T,s;case x:return qo(u.children,_,T,a);case A:R=8,_|=24;break;case N:return s=fi(12,u,a,_|2),s.elementType=N,s.lanes=T,s;case K:return s=fi(13,u,a,_),s.elementType=K,s.lanes=T,s;case j:return s=fi(19,u,a,_),s.elementType=j,s.lanes=T,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case L:R=10;break e;case U:R=9;break e;case $:R=11;break e;case k:R=14;break e;case V:R=16,h=null;break e}R=29,u=Error(i(130,s===null?"null":typeof s,"")),h=null}return a=fi(R,u,a,_),a.elementType=s,a.type=h,a.lanes=T,a}function qo(s,a,u,h){return s=fi(7,s,h,a),s.lanes=u,s}function Em(s,a,u){return s=fi(6,s,null,a),s.lanes=u,s}function N0(s){var a=fi(18,null,null,0);return a.stateNode=s,a}function Tm(s,a,u){return a=fi(4,s.children!==null?s.children:[],s.key,a),a.lanes=u,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var k0=new WeakMap;function Ci(s,a){if(typeof s=="object"&&s!==null){var u=k0.get(s);return u!==void 0?u:(a={value:s,source:a,stack:J(a)},k0.set(s,a),a)}return{value:s,source:a,stack:J(a)}}var Za=[],el=0,uf=null,ju=0,Ri=[],Ni=0,Is=null,Tr=1,br="";function Fr(s,a){Za[el++]=ju,Za[el++]=uf,uf=s,ju=a}function M0(s,a,u){Ri[Ni++]=Tr,Ri[Ni++]=br,Ri[Ni++]=Is,Is=s;var h=Tr;s=br;var _=32-Re(h)-1;h&=~(1<<_),u+=1;var T=32-Re(a)+_;if(30<T){var R=_-_%5;T=(h&(1<<R)-1).toString(32),h>>=R,_-=R,Tr=1<<32-Re(a)+_|u<<_|h,br=T+s}else Tr=1<<T|u<<_|h,br=s}function bm(s){s.return!==null&&(Fr(s,1),M0(s,1,0))}function Sm(s){for(;s===uf;)uf=Za[--el],Za[el]=null,ju=Za[--el],Za[el]=null;for(;s===Is;)Is=Ri[--Ni],Ri[Ni]=null,br=Ri[--Ni],Ri[Ni]=null,Tr=Ri[--Ni],Ri[Ni]=null}function D0(s,a){Ri[Ni++]=Tr,Ri[Ni++]=br,Ri[Ni++]=Is,Tr=a.id,br=a.overflow,Is=s}var Vn=null,Xt=null,xt=!1,Cs=null,ki=!1,wm=Error(i(519));function Rs(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ku(Ci(a,s)),wm}function P0(s){var a=s.stateNode,u=s.type,h=s.memoizedProps;switch(a[mn]=s,a[Cn]=h,u){case"dialog":vt("cancel",a),vt("close",a);break;case"iframe":case"object":case"embed":vt("load",a);break;case"video":case"audio":for(u=0;u<mc.length;u++)vt(mc[u],a);break;case"source":vt("error",a);break;case"img":case"image":case"link":vt("error",a),vt("load",a);break;case"details":vt("toggle",a);break;case"input":vt("invalid",a),zd(a,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":vt("invalid",a);break;case"textarea":vt("invalid",a),Es(a,h.value,h.defaultValue,h.children)}u=h.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||h.suppressHydrationWarning===!0||QT(a.textContent,u)?(h.popover!=null&&(vt("beforetoggle",a),vt("toggle",a)),h.onScroll!=null&&vt("scroll",a),h.onScrollEnd!=null&&vt("scrollend",a),h.onClick!=null&&(a.onclick=Hi),a=!0):a=!1,a||Rs(s,!0)}function O0(s){for(Vn=s.return;Vn;)switch(Vn.tag){case 5:case 31:case 13:ki=!1;return;case 27:case 3:ki=!0;return;default:Vn=Vn.return}}function tl(s){if(s!==Vn)return!1;if(!xt)return O0(s),xt=!0,!1;var a=s.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||Gg(s.type,s.memoizedProps)),u=!u),u&&Xt&&Rs(s),O0(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Xt=ob(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Xt=ob(s)}else a===27?(a=Xt,qs(s.type)?(s=Kg,Kg=null,Xt=s):Xt=a):Xt=Vn?Di(s.stateNode.nextSibling):null;return!0}function Ho(){Xt=Vn=null,xt=!1}function xm(){var s=Cs;return s!==null&&(ri===null?ri=s:ri.push.apply(ri,s),Cs=null),s}function Ku(s){Cs===null?Cs=[s]:Cs.push(s)}var Am=F(null),$o=null,zr=null;function Ns(s,a,u){ye(Am,a._currentValue),a._currentValue=u}function Gr(s){s._currentValue=Am.current,W(Am)}function Im(s,a,u){for(;s!==null;){var h=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,h!==null&&(h.childLanes|=a)):h!==null&&(h.childLanes&a)!==a&&(h.childLanes|=a),s===u)break;s=s.return}}function Cm(s,a,u,h){var _=s.child;for(_!==null&&(_.return=s);_!==null;){var T=_.dependencies;if(T!==null){var R=_.child;T=T.firstContext;e:for(;T!==null;){var q=T;T=_;for(var Z=0;Z<a.length;Z++)if(q.context===a[Z]){T.lanes|=u,q=T.alternate,q!==null&&(q.lanes|=u),Im(T.return,u,s),h||(R=null);break e}T=q.next}}else if(_.tag===18){if(R=_.return,R===null)throw Error(i(341));R.lanes|=u,T=R.alternate,T!==null&&(T.lanes|=u),Im(R,u,s),R=null}else R=_.child;if(R!==null)R.return=_;else for(R=_;R!==null;){if(R===s){R=null;break}if(_=R.sibling,_!==null){_.return=R.return,R=_;break}R=R.return}_=R}}function nl(s,a,u,h){s=null;for(var _=a,T=!1;_!==null;){if(!T){if((_.flags&524288)!==0)T=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var R=_.alternate;if(R===null)throw Error(i(387));if(R=R.memoizedProps,R!==null){var q=_.type;di(_.pendingProps.value,R.value)||(s!==null?s.push(q):s=[q])}}else if(_===Qe.current){if(R=_.alternate,R===null)throw Error(i(387));R.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(s!==null?s.push(Ec):s=[Ec])}_=_.return}s!==null&&Cm(a,s,u,h),a.flags|=262144}function cf(s){for(s=s.firstContext;s!==null;){if(!di(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function jo(s){$o=s,zr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Un(s){return V0($o,s)}function df(s,a){return $o===null&&jo(s),V0(s,a)}function V0(s,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},zr===null){if(s===null)throw Error(i(308));zr=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else zr=zr.next=a;return u}var jN=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(u,h){s.push(h)}};this.abort=function(){a.aborted=!0,s.forEach(function(u){return u()})}},KN=n.unstable_scheduleCallback,JN=n.unstable_NormalPriority,_n={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Rm(){return{controller:new jN,data:new Map,refCount:0}}function Ju(s){s.refCount--,s.refCount===0&&KN(JN,function(){s.controller.abort()})}var Yu=null,Nm=0,il=0,rl=null;function YN(s,a){if(Yu===null){var u=Yu=[];Nm=0,il=Dg(),rl={status:"pending",value:void 0,then:function(h){u.push(h)}}}return Nm++,a.then(U0,U0),a}function U0(){if(--Nm===0&&Yu!==null){rl!==null&&(rl.status="fulfilled");var s=Yu;Yu=null,il=0,rl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function WN(s,a){var u=[],h={status:"pending",value:null,reason:null,then:function(_){u.push(_)}};return s.then(function(){h.status="fulfilled",h.value=a;for(var _=0;_<u.length;_++)(0,u[_])(a)},function(_){for(h.status="rejected",h.reason=_,_=0;_<u.length;_++)(0,u[_])(void 0)}),h}var L0=X.S;X.S=function(s,a){TT=De(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&YN(s,a),L0!==null&&L0(s,a)};var Ko=F(null);function km(){var s=Ko.current;return s!==null?s:Wt.pooledCache}function ff(s,a){a===null?ye(Ko,Ko.current):ye(Ko,a.pool)}function B0(){var s=km();return s===null?null:{parent:_n._currentValue,pool:s}}var sl=Error(i(460)),Mm=Error(i(474)),hf=Error(i(542)),pf={then:function(){}};function F0(s){return s=s.status,s==="fulfilled"||s==="rejected"}function z0(s,a,u){switch(u=s[u],u===void 0?s.push(a):u!==a&&(a.then(Hi,Hi),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,q0(s),s;default:if(typeof a.status=="string")a.then(Hi,Hi);else{if(s=Wt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(h){if(a.status==="pending"){var _=a;_.status="fulfilled",_.value=h}},function(h){if(a.status==="pending"){var _=a;_.status="rejected",_.reason=h}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,q0(s),s}throw Yo=a,sl}}function Jo(s){try{var a=s._init;return a(s._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Yo=u,sl):u}}var Yo=null;function G0(){if(Yo===null)throw Error(i(459));var s=Yo;return Yo=null,s}function q0(s){if(s===sl||s===hf)throw Error(i(483))}var ol=null,Wu=0;function mf(s){var a=Wu;return Wu+=1,ol===null&&(ol=[]),z0(ol,s,a)}function Qu(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function gf(s,a){throw a.$$typeof===E?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function H0(s){function a(ae,te){if(s){var pe=ae.deletions;pe===null?(ae.deletions=[te],ae.flags|=16):pe.push(te)}}function u(ae,te){if(!s)return null;for(;te!==null;)a(ae,te),te=te.sibling;return null}function h(ae){for(var te=new Map;ae!==null;)ae.key!==null?te.set(ae.key,ae):te.set(ae.index,ae),ae=ae.sibling;return te}function _(ae,te){return ae=Br(ae,te),ae.index=0,ae.sibling=null,ae}function T(ae,te,pe){return ae.index=pe,s?(pe=ae.alternate,pe!==null?(pe=pe.index,pe<te?(ae.flags|=67108866,te):pe):(ae.flags|=67108866,te)):(ae.flags|=1048576,te)}function R(ae){return s&&ae.alternate===null&&(ae.flags|=67108866),ae}function q(ae,te,pe,xe){return te===null||te.tag!==6?(te=Em(pe,ae.mode,xe),te.return=ae,te):(te=_(te,pe),te.return=ae,te)}function Z(ae,te,pe,xe){var et=pe.type;return et===x?we(ae,te,pe.props.children,xe,pe.key):te!==null&&(te.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===V&&Jo(et)===te.type)?(te=_(te,pe.props),Qu(te,pe),te.return=ae,te):(te=lf(pe.type,pe.key,pe.props,null,ae.mode,xe),Qu(te,pe),te.return=ae,te)}function me(ae,te,pe,xe){return te===null||te.tag!==4||te.stateNode.containerInfo!==pe.containerInfo||te.stateNode.implementation!==pe.implementation?(te=Tm(pe,ae.mode,xe),te.return=ae,te):(te=_(te,pe.children||[]),te.return=ae,te)}function we(ae,te,pe,xe,et){return te===null||te.tag!==7?(te=qo(pe,ae.mode,xe,et),te.return=ae,te):(te=_(te,pe),te.return=ae,te)}function Ce(ae,te,pe){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return te=Em(""+te,ae.mode,pe),te.return=ae,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case b:return pe=lf(te.type,te.key,te.props,null,ae.mode,pe),Qu(pe,te),pe.return=ae,pe;case I:return te=Tm(te,ae.mode,pe),te.return=ae,te;case V:return te=Jo(te),Ce(ae,te,pe)}if(oe(te)||M(te))return te=qo(te,ae.mode,pe,null),te.return=ae,te;if(typeof te.then=="function")return Ce(ae,mf(te),pe);if(te.$$typeof===L)return Ce(ae,df(ae,te),pe);gf(ae,te)}return null}function ge(ae,te,pe,xe){var et=te!==null?te.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return et!==null?null:q(ae,te,""+pe,xe);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case b:return pe.key===et?Z(ae,te,pe,xe):null;case I:return pe.key===et?me(ae,te,pe,xe):null;case V:return pe=Jo(pe),ge(ae,te,pe,xe)}if(oe(pe)||M(pe))return et!==null?null:we(ae,te,pe,xe,null);if(typeof pe.then=="function")return ge(ae,te,mf(pe),xe);if(pe.$$typeof===L)return ge(ae,te,df(ae,pe),xe);gf(ae,pe)}return null}function Te(ae,te,pe,xe,et){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return ae=ae.get(pe)||null,q(te,ae,""+xe,et);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case b:return ae=ae.get(xe.key===null?pe:xe.key)||null,Z(te,ae,xe,et);case I:return ae=ae.get(xe.key===null?pe:xe.key)||null,me(te,ae,xe,et);case V:return xe=Jo(xe),Te(ae,te,pe,xe,et)}if(oe(xe)||M(xe))return ae=ae.get(pe)||null,we(te,ae,xe,et,null);if(typeof xe.then=="function")return Te(ae,te,pe,mf(xe),et);if(xe.$$typeof===L)return Te(ae,te,pe,df(te,xe),et);gf(te,xe)}return null}function Ke(ae,te,pe,xe){for(var et=null,kt=null,Xe=te,mt=te=0,Tt=null;Xe!==null&&mt<pe.length;mt++){Xe.index>mt?(Tt=Xe,Xe=null):Tt=Xe.sibling;var Mt=ge(ae,Xe,pe[mt],xe);if(Mt===null){Xe===null&&(Xe=Tt);break}s&&Xe&&Mt.alternate===null&&a(ae,Xe),te=T(Mt,te,mt),kt===null?et=Mt:kt.sibling=Mt,kt=Mt,Xe=Tt}if(mt===pe.length)return u(ae,Xe),xt&&Fr(ae,mt),et;if(Xe===null){for(;mt<pe.length;mt++)Xe=Ce(ae,pe[mt],xe),Xe!==null&&(te=T(Xe,te,mt),kt===null?et=Xe:kt.sibling=Xe,kt=Xe);return xt&&Fr(ae,mt),et}for(Xe=h(Xe);mt<pe.length;mt++)Tt=Te(Xe,ae,mt,pe[mt],xe),Tt!==null&&(s&&Tt.alternate!==null&&Xe.delete(Tt.key===null?mt:Tt.key),te=T(Tt,te,mt),kt===null?et=Tt:kt.sibling=Tt,kt=Tt);return s&&Xe.forEach(function(Js){return a(ae,Js)}),xt&&Fr(ae,mt),et}function rt(ae,te,pe,xe){if(pe==null)throw Error(i(151));for(var et=null,kt=null,Xe=te,mt=te=0,Tt=null,Mt=pe.next();Xe!==null&&!Mt.done;mt++,Mt=pe.next()){Xe.index>mt?(Tt=Xe,Xe=null):Tt=Xe.sibling;var Js=ge(ae,Xe,Mt.value,xe);if(Js===null){Xe===null&&(Xe=Tt);break}s&&Xe&&Js.alternate===null&&a(ae,Xe),te=T(Js,te,mt),kt===null?et=Js:kt.sibling=Js,kt=Js,Xe=Tt}if(Mt.done)return u(ae,Xe),xt&&Fr(ae,mt),et;if(Xe===null){for(;!Mt.done;mt++,Mt=pe.next())Mt=Ce(ae,Mt.value,xe),Mt!==null&&(te=T(Mt,te,mt),kt===null?et=Mt:kt.sibling=Mt,kt=Mt);return xt&&Fr(ae,mt),et}for(Xe=h(Xe);!Mt.done;mt++,Mt=pe.next())Mt=Te(Xe,ae,mt,Mt.value,xe),Mt!==null&&(s&&Mt.alternate!==null&&Xe.delete(Mt.key===null?mt:Mt.key),te=T(Mt,te,mt),kt===null?et=Mt:kt.sibling=Mt,kt=Mt);return s&&Xe.forEach(function(ak){return a(ae,ak)}),xt&&Fr(ae,mt),et}function Yt(ae,te,pe,xe){if(typeof pe=="object"&&pe!==null&&pe.type===x&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case b:e:{for(var et=pe.key;te!==null;){if(te.key===et){if(et=pe.type,et===x){if(te.tag===7){u(ae,te.sibling),xe=_(te,pe.props.children),xe.return=ae,ae=xe;break e}}else if(te.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===V&&Jo(et)===te.type){u(ae,te.sibling),xe=_(te,pe.props),Qu(xe,pe),xe.return=ae,ae=xe;break e}u(ae,te);break}else a(ae,te);te=te.sibling}pe.type===x?(xe=qo(pe.props.children,ae.mode,xe,pe.key),xe.return=ae,ae=xe):(xe=lf(pe.type,pe.key,pe.props,null,ae.mode,xe),Qu(xe,pe),xe.return=ae,ae=xe)}return R(ae);case I:e:{for(et=pe.key;te!==null;){if(te.key===et)if(te.tag===4&&te.stateNode.containerInfo===pe.containerInfo&&te.stateNode.implementation===pe.implementation){u(ae,te.sibling),xe=_(te,pe.children||[]),xe.return=ae,ae=xe;break e}else{u(ae,te);break}else a(ae,te);te=te.sibling}xe=Tm(pe,ae.mode,xe),xe.return=ae,ae=xe}return R(ae);case V:return pe=Jo(pe),Yt(ae,te,pe,xe)}if(oe(pe))return Ke(ae,te,pe,xe);if(M(pe)){if(et=M(pe),typeof et!="function")throw Error(i(150));return pe=et.call(pe),rt(ae,te,pe,xe)}if(typeof pe.then=="function")return Yt(ae,te,mf(pe),xe);if(pe.$$typeof===L)return Yt(ae,te,df(ae,pe),xe);gf(ae,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint"?(pe=""+pe,te!==null&&te.tag===6?(u(ae,te.sibling),xe=_(te,pe),xe.return=ae,ae=xe):(u(ae,te),xe=Em(pe,ae.mode,xe),xe.return=ae,ae=xe),R(ae)):u(ae,te)}return function(ae,te,pe,xe){try{Wu=0;var et=Yt(ae,te,pe,xe);return ol=null,et}catch(Xe){if(Xe===sl||Xe===hf)throw Xe;var kt=fi(29,Xe,null,ae.mode);return kt.lanes=xe,kt.return=ae,kt}finally{}}}var Wo=H0(!0),$0=H0(!1),ks=!1;function Dm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ms(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ds(s,a,u){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(Ot&2)!==0){var _=h.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),h.pending=a,a=af(s),C0(s,null,u),a}return of(s,h,a,u),af(s)}function Xu(s,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var h=a.lanes;h&=s.pendingLanes,u|=h,a.lanes=u,xu(s,u)}}function Om(s,a){var u=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var _=null,T=null;if(u=u.firstBaseUpdate,u!==null){do{var R={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};T===null?_=T=R:T=T.next=R,u=u.next}while(u!==null);T===null?_=T=a:T=T.next=a}else _=T=a;u={baseState:h.baseState,firstBaseUpdate:_,lastBaseUpdate:T,shared:h.shared,callbacks:h.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=a:s.next=a,u.lastBaseUpdate=a}var Vm=!1;function Zu(){if(Vm){var s=rl;if(s!==null)throw s}}function ec(s,a,u,h){Vm=!1;var _=s.updateQueue;ks=!1;var T=_.firstBaseUpdate,R=_.lastBaseUpdate,q=_.shared.pending;if(q!==null){_.shared.pending=null;var Z=q,me=Z.next;Z.next=null,R===null?T=me:R.next=me,R=Z;var we=s.alternate;we!==null&&(we=we.updateQueue,q=we.lastBaseUpdate,q!==R&&(q===null?we.firstBaseUpdate=me:q.next=me,we.lastBaseUpdate=Z))}if(T!==null){var Ce=_.baseState;R=0,we=me=Z=null,q=T;do{var ge=q.lane&-536870913,Te=ge!==q.lane;if(Te?(Et&ge)===ge:(h&ge)===ge){ge!==0&&ge===il&&(Vm=!0),we!==null&&(we=we.next={lane:0,tag:q.tag,payload:q.payload,callback:null,next:null});e:{var Ke=s,rt=q;ge=a;var Yt=u;switch(rt.tag){case 1:if(Ke=rt.payload,typeof Ke=="function"){Ce=Ke.call(Yt,Ce,ge);break e}Ce=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=rt.payload,ge=typeof Ke=="function"?Ke.call(Yt,Ce,ge):Ke,ge==null)break e;Ce=v({},Ce,ge);break e;case 2:ks=!0}}ge=q.callback,ge!==null&&(s.flags|=64,Te&&(s.flags|=8192),Te=_.callbacks,Te===null?_.callbacks=[ge]:Te.push(ge))}else Te={lane:ge,tag:q.tag,payload:q.payload,callback:q.callback,next:null},we===null?(me=we=Te,Z=Ce):we=we.next=Te,R|=ge;if(q=q.next,q===null){if(q=_.shared.pending,q===null)break;Te=q,q=Te.next,Te.next=null,_.lastBaseUpdate=Te,_.shared.pending=null}}while(!0);we===null&&(Z=Ce),_.baseState=Z,_.firstBaseUpdate=me,_.lastBaseUpdate=we,T===null&&(_.shared.lanes=0),Ls|=R,s.lanes=R,s.memoizedState=Ce}}function j0(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function K0(s,a){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)j0(u[s],a)}var al=F(null),yf=F(0);function J0(s,a){s=Qr,ye(yf,s),ye(al,a),Qr=s|a.baseLanes}function Um(){ye(yf,Qr),ye(al,al.current)}function Lm(){Qr=yf.current,W(al),W(yf)}var hi=F(null),Mi=null;function Ps(s){var a=s.alternate;ye(cn,cn.current&1),ye(hi,s),Mi===null&&(a===null||al.current!==null||a.memoizedState!==null)&&(Mi=s)}function Bm(s){ye(cn,cn.current),ye(hi,s),Mi===null&&(Mi=s)}function Y0(s){s.tag===22?(ye(cn,cn.current),ye(hi,s),Mi===null&&(Mi=s)):Os()}function Os(){ye(cn,cn.current),ye(hi,hi.current)}function pi(s){W(hi),Mi===s&&(Mi=null),W(cn)}var cn=F(0);function _f(s){for(var a=s;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||$g(u)||jg(u)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var qr=0,ht=null,Kt=null,vn=null,vf=!1,ll=!1,Qo=!1,Ef=0,tc=0,ul=null,QN=0;function on(){throw Error(i(321))}function Fm(s,a){if(a===null)return!1;for(var u=0;u<a.length&&u<s.length;u++)if(!di(s[u],a[u]))return!1;return!0}function zm(s,a,u,h,_,T){return qr=T,ht=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,X.H=s===null||s.memoizedState===null?ME:ng,Qo=!1,T=u(h,_),Qo=!1,ll&&(T=Q0(a,u,h,_)),W0(s),T}function W0(s){X.H=rc;var a=Kt!==null&&Kt.next!==null;if(qr=0,vn=Kt=ht=null,vf=!1,tc=0,ul=null,a)throw Error(i(300));s===null||En||(s=s.dependencies,s!==null&&cf(s)&&(En=!0))}function Q0(s,a,u,h){ht=s;var _=0;do{if(ll&&(ul=null),tc=0,ll=!1,25<=_)throw Error(i(301));if(_+=1,vn=Kt=null,s.updateQueue!=null){var T=s.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}X.H=DE,T=a(u,h)}while(ll);return T}function XN(){var s=X.H,a=s.useState()[0];return a=typeof a.then=="function"?nc(a):a,s=s.useState()[0],(Kt!==null?Kt.memoizedState:null)!==s&&(ht.flags|=1024),a}function Gm(){var s=Ef!==0;return Ef=0,s}function qm(s,a,u){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~u}function Hm(s){if(vf){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}vf=!1}qr=0,vn=Kt=ht=null,ll=!1,tc=Ef=0,ul=null}function Yn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vn===null?ht.memoizedState=vn=s:vn=vn.next=s,vn}function dn(){if(Kt===null){var s=ht.alternate;s=s!==null?s.memoizedState:null}else s=Kt.next;var a=vn===null?ht.memoizedState:vn.next;if(a!==null)vn=a,Kt=s;else{if(s===null)throw ht.alternate===null?Error(i(467)):Error(i(310));Kt=s,s={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},vn===null?ht.memoizedState=vn=s:vn=vn.next=s}return vn}function Tf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function nc(s){var a=tc;return tc+=1,ul===null&&(ul=[]),s=z0(ul,s,a),a=ht,(vn===null?a.memoizedState:vn.next)===null&&(a=a.alternate,X.H=a===null||a.memoizedState===null?ME:ng),s}function bf(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return nc(s);if(s.$$typeof===L)return Un(s)}throw Error(i(438,String(s)))}function $m(s){var a=null,u=ht.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var h=ht.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(a={data:h.data.map(function(_){return _.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=Tf(),ht.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(s),h=0;h<s;h++)u[h]=z;return a.index++,u}function Hr(s,a){return typeof a=="function"?a(s):a}function Sf(s){var a=dn();return jm(a,Kt,s)}function jm(s,a,u){var h=s.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=u;var _=s.baseQueue,T=h.pending;if(T!==null){if(_!==null){var R=_.next;_.next=T.next,T.next=R}a.baseQueue=_=T,h.pending=null}if(T=s.baseState,_===null)s.memoizedState=T;else{a=_.next;var q=R=null,Z=null,me=a,we=!1;do{var Ce=me.lane&-536870913;if(Ce!==me.lane?(Et&Ce)===Ce:(qr&Ce)===Ce){var ge=me.revertLane;if(ge===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),Ce===il&&(we=!0);else if((qr&ge)===ge){me=me.next,ge===il&&(we=!0);continue}else Ce={lane:0,revertLane:me.revertLane,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},Z===null?(q=Z=Ce,R=T):Z=Z.next=Ce,ht.lanes|=ge,Ls|=ge;Ce=me.action,Qo&&u(T,Ce),T=me.hasEagerState?me.eagerState:u(T,Ce)}else ge={lane:Ce,revertLane:me.revertLane,gesture:me.gesture,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},Z===null?(q=Z=ge,R=T):Z=Z.next=ge,ht.lanes|=Ce,Ls|=Ce;me=me.next}while(me!==null&&me!==a);if(Z===null?R=T:Z.next=q,!di(T,s.memoizedState)&&(En=!0,we&&(u=rl,u!==null)))throw u;s.memoizedState=T,s.baseState=R,s.baseQueue=Z,h.lastRenderedState=T}return _===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function Km(s){var a=dn(),u=a.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=s;var h=u.dispatch,_=u.pending,T=a.memoizedState;if(_!==null){u.pending=null;var R=_=_.next;do T=s(T,R.action),R=R.next;while(R!==_);di(T,a.memoizedState)||(En=!0),a.memoizedState=T,a.baseQueue===null&&(a.baseState=T),u.lastRenderedState=T}return[T,h]}function X0(s,a,u){var h=ht,_=dn(),T=xt;if(T){if(u===void 0)throw Error(i(407));u=u()}else u=a();var R=!di((Kt||_).memoizedState,u);if(R&&(_.memoizedState=u,En=!0),_=_.queue,Wm(tE.bind(null,h,_,s),[s]),_.getSnapshot!==a||R||vn!==null&&vn.memoizedState.tag&1){if(h.flags|=2048,cl(9,{destroy:void 0},eE.bind(null,h,_,u,a),null),Wt===null)throw Error(i(349));T||(qr&127)!==0||Z0(h,a,u)}return u}function Z0(s,a,u){s.flags|=16384,s={getSnapshot:a,value:u},a=ht.updateQueue,a===null?(a=Tf(),ht.updateQueue=a,a.stores=[s]):(u=a.stores,u===null?a.stores=[s]:u.push(s))}function eE(s,a,u,h){a.value=u,a.getSnapshot=h,nE(a)&&iE(s)}function tE(s,a,u){return u(function(){nE(a)&&iE(s)})}function nE(s){var a=s.getSnapshot;s=s.value;try{var u=a();return!di(s,u)}catch{return!0}}function iE(s){var a=Go(s,2);a!==null&&si(a,s,2)}function Jm(s){var a=Yn();if(typeof s=="function"){var u=s;if(s=u(),Qo){Ve(!0);try{u()}finally{Ve(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:s},a}function rE(s,a,u,h){return s.baseState=u,jm(s,Kt,typeof h=="function"?h:Hr)}function ZN(s,a,u,h,_){if(Af(s))throw Error(i(485));if(s=a.action,s!==null){var T={payload:_,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){T.listeners.push(R)}};X.T!==null?u(!0):T.isTransition=!1,h(T),u=a.pending,u===null?(T.next=a.pending=T,sE(a,T)):(T.next=u.next,a.pending=u.next=T)}}function sE(s,a){var u=a.action,h=a.payload,_=s.state;if(a.isTransition){var T=X.T,R={};X.T=R;try{var q=u(_,h),Z=X.S;Z!==null&&Z(R,q),oE(s,a,q)}catch(me){Ym(s,a,me)}finally{T!==null&&R.types!==null&&(T.types=R.types),X.T=T}}else try{T=u(_,h),oE(s,a,T)}catch(me){Ym(s,a,me)}}function oE(s,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(h){aE(s,a,h)},function(h){return Ym(s,a,h)}):aE(s,a,u)}function aE(s,a,u){a.status="fulfilled",a.value=u,lE(a),s.state=u,a=s.pending,a!==null&&(u=a.next,u===a?s.pending=null:(u=u.next,a.next=u,sE(s,u)))}function Ym(s,a,u){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do a.status="rejected",a.reason=u,lE(a),a=a.next;while(a!==h)}s.action=null}function lE(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function uE(s,a){return a}function cE(s,a){if(xt){var u=Wt.formState;if(u!==null){e:{var h=ht;if(xt){if(Xt){t:{for(var _=Xt,T=ki;_.nodeType!==8;){if(!T){_=null;break t}if(_=Di(_.nextSibling),_===null){_=null;break t}}T=_.data,_=T==="F!"||T==="F"?_:null}if(_){Xt=Di(_.nextSibling),h=_.data==="F!";break e}}Rs(h)}h=!1}h&&(a=u[0])}}return u=Yn(),u.memoizedState=u.baseState=a,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:uE,lastRenderedState:a},u.queue=h,u=RE.bind(null,ht,h),h.dispatch=u,h=Jm(!1),T=tg.bind(null,ht,!1,h.queue),h=Yn(),_={state:a,dispatch:null,action:s,pending:null},h.queue=_,u=ZN.bind(null,ht,_,T,u),_.dispatch=u,h.memoizedState=s,[a,u,!1]}function dE(s){var a=dn();return fE(a,Kt,s)}function fE(s,a,u){if(a=jm(s,a,uE)[0],s=Sf(Hr)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var h=nc(a)}catch(R){throw R===sl?hf:R}else h=a;a=dn();var _=a.queue,T=_.dispatch;return u!==a.memoizedState&&(ht.flags|=2048,cl(9,{destroy:void 0},e2.bind(null,_,u),null)),[h,T,s]}function e2(s,a){s.action=a}function hE(s){var a=dn(),u=Kt;if(u!==null)return fE(a,u,s);dn(),a=a.memoizedState,u=dn();var h=u.queue.dispatch;return u.memoizedState=s,[a,h,!1]}function cl(s,a,u,h){return s={tag:s,create:u,deps:h,inst:a,next:null},a=ht.updateQueue,a===null&&(a=Tf(),ht.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=s.next=s:(h=u.next,u.next=s,s.next=h,a.lastEffect=s),s}function pE(){return dn().memoizedState}function wf(s,a,u,h){var _=Yn();ht.flags|=s,_.memoizedState=cl(1|a,{destroy:void 0},u,h===void 0?null:h)}function xf(s,a,u,h){var _=dn();h=h===void 0?null:h;var T=_.memoizedState.inst;Kt!==null&&h!==null&&Fm(h,Kt.memoizedState.deps)?_.memoizedState=cl(a,T,u,h):(ht.flags|=s,_.memoizedState=cl(1|a,T,u,h))}function mE(s,a){wf(8390656,8,s,a)}function Wm(s,a){xf(2048,8,s,a)}function t2(s){ht.flags|=4;var a=ht.updateQueue;if(a===null)a=Tf(),ht.updateQueue=a,a.events=[s];else{var u=a.events;u===null?a.events=[s]:u.push(s)}}function gE(s){var a=dn().memoizedState;return t2({ref:a,nextImpl:s}),function(){if((Ot&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function yE(s,a){return xf(4,2,s,a)}function _E(s,a){return xf(4,4,s,a)}function vE(s,a){if(typeof a=="function"){s=s();var u=a(s);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function EE(s,a,u){u=u!=null?u.concat([s]):null,xf(4,4,vE.bind(null,a,s),u)}function Qm(){}function TE(s,a){var u=dn();a=a===void 0?null:a;var h=u.memoizedState;return a!==null&&Fm(a,h[1])?h[0]:(u.memoizedState=[s,a],s)}function bE(s,a){var u=dn();a=a===void 0?null:a;var h=u.memoizedState;if(a!==null&&Fm(a,h[1]))return h[0];if(h=s(),Qo){Ve(!0);try{s()}finally{Ve(!1)}}return u.memoizedState=[h,a],h}function Xm(s,a,u){return u===void 0||(qr&1073741824)!==0&&(Et&261930)===0?s.memoizedState=a:(s.memoizedState=u,s=ST(),ht.lanes|=s,Ls|=s,u)}function SE(s,a,u,h){return di(u,a)?u:al.current!==null?(s=Xm(s,u,h),di(s,a)||(En=!0),s):(qr&42)===0||(qr&1073741824)!==0&&(Et&261930)===0?(En=!0,s.memoizedState=u):(s=ST(),ht.lanes|=s,Ls|=s,a)}function wE(s,a,u,h,_){var T=Q.p;Q.p=T!==0&&8>T?T:8;var R=X.T,q={};X.T=q,tg(s,!1,a,u);try{var Z=_(),me=X.S;if(me!==null&&me(q,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var we=WN(Z,h);ic(s,a,we,yi(s))}else ic(s,a,h,yi(s))}catch(Ce){ic(s,a,{then:function(){},status:"rejected",reason:Ce},yi())}finally{Q.p=T,R!==null&&q.types!==null&&(R.types=q.types),X.T=R}}function n2(){}function Zm(s,a,u,h){if(s.tag!==5)throw Error(i(476));var _=xE(s).queue;wE(s,_,a,se,u===null?n2:function(){return AE(s),u(h)})}function xE(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:se,baseState:se,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:se},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:u},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function AE(s){var a=xE(s);a.next===null&&(a=s.alternate.memoizedState),ic(s,a.next.queue,{},yi())}function eg(){return Un(Ec)}function IE(){return dn().memoizedState}function CE(){return dn().memoizedState}function i2(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var u=yi();s=Ms(u);var h=Ds(a,s,u);h!==null&&(si(h,a,u),Xu(h,a,u)),a={cache:Rm()},s.payload=a;return}a=a.return}}function r2(s,a,u){var h=yi();u={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Af(s)?NE(a,u):(u=_m(s,a,u,h),u!==null&&(si(u,s,h),kE(u,a,h)))}function RE(s,a,u){var h=yi();ic(s,a,u,h)}function ic(s,a,u,h){var _={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Af(s))NE(a,_);else{var T=s.alternate;if(s.lanes===0&&(T===null||T.lanes===0)&&(T=a.lastRenderedReducer,T!==null))try{var R=a.lastRenderedState,q=T(R,u);if(_.hasEagerState=!0,_.eagerState=q,di(q,R))return of(s,a,_,0),Wt===null&&sf(),!1}catch{}finally{}if(u=_m(s,a,_,h),u!==null)return si(u,s,h),kE(u,a,h),!0}return!1}function tg(s,a,u,h){if(h={lane:2,revertLane:Dg(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Af(s)){if(a)throw Error(i(479))}else a=_m(s,u,h,2),a!==null&&si(a,s,2)}function Af(s){var a=s.alternate;return s===ht||a!==null&&a===ht}function NE(s,a){ll=vf=!0;var u=s.pending;u===null?a.next=a:(a.next=u.next,u.next=a),s.pending=a}function kE(s,a,u){if((u&4194048)!==0){var h=a.lanes;h&=s.pendingLanes,u|=h,a.lanes=u,xu(s,u)}}var rc={readContext:Un,use:bf,useCallback:on,useContext:on,useEffect:on,useImperativeHandle:on,useLayoutEffect:on,useInsertionEffect:on,useMemo:on,useReducer:on,useRef:on,useState:on,useDebugValue:on,useDeferredValue:on,useTransition:on,useSyncExternalStore:on,useId:on,useHostTransitionStatus:on,useFormState:on,useActionState:on,useOptimistic:on,useMemoCache:on,useCacheRefresh:on};rc.useEffectEvent=on;var ME={readContext:Un,use:bf,useCallback:function(s,a){return Yn().memoizedState=[s,a===void 0?null:a],s},useContext:Un,useEffect:mE,useImperativeHandle:function(s,a,u){u=u!=null?u.concat([s]):null,wf(4194308,4,vE.bind(null,a,s),u)},useLayoutEffect:function(s,a){return wf(4194308,4,s,a)},useInsertionEffect:function(s,a){wf(4,2,s,a)},useMemo:function(s,a){var u=Yn();a=a===void 0?null:a;var h=s();if(Qo){Ve(!0);try{s()}finally{Ve(!1)}}return u.memoizedState=[h,a],h},useReducer:function(s,a,u){var h=Yn();if(u!==void 0){var _=u(a);if(Qo){Ve(!0);try{u(a)}finally{Ve(!1)}}}else _=a;return h.memoizedState=h.baseState=_,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:_},h.queue=s,s=s.dispatch=r2.bind(null,ht,s),[h.memoizedState,s]},useRef:function(s){var a=Yn();return s={current:s},a.memoizedState=s},useState:function(s){s=Jm(s);var a=s.queue,u=RE.bind(null,ht,a);return a.dispatch=u,[s.memoizedState,u]},useDebugValue:Qm,useDeferredValue:function(s,a){var u=Yn();return Xm(u,s,a)},useTransition:function(){var s=Jm(!1);return s=wE.bind(null,ht,s.queue,!0,!1),Yn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,u){var h=ht,_=Yn();if(xt){if(u===void 0)throw Error(i(407));u=u()}else{if(u=a(),Wt===null)throw Error(i(349));(Et&127)!==0||Z0(h,a,u)}_.memoizedState=u;var T={value:u,getSnapshot:a};return _.queue=T,mE(tE.bind(null,h,T,s),[s]),h.flags|=2048,cl(9,{destroy:void 0},eE.bind(null,h,T,u,a),null),u},useId:function(){var s=Yn(),a=Wt.identifierPrefix;if(xt){var u=br,h=Tr;u=(h&~(1<<32-Re(h)-1)).toString(32)+u,a="_"+a+"R_"+u,u=Ef++,0<u&&(a+="H"+u.toString(32)),a+="_"}else u=QN++,a="_"+a+"r_"+u.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:eg,useFormState:cE,useActionState:cE,useOptimistic:function(s){var a=Yn();a.memoizedState=a.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=tg.bind(null,ht,!0,u),u.dispatch=a,[s,a]},useMemoCache:$m,useCacheRefresh:function(){return Yn().memoizedState=i2.bind(null,ht)},useEffectEvent:function(s){var a=Yn(),u={impl:s};return a.memoizedState=u,function(){if((Ot&2)!==0)throw Error(i(440));return u.impl.apply(void 0,arguments)}}},ng={readContext:Un,use:bf,useCallback:TE,useContext:Un,useEffect:Wm,useImperativeHandle:EE,useInsertionEffect:yE,useLayoutEffect:_E,useMemo:bE,useReducer:Sf,useRef:pE,useState:function(){return Sf(Hr)},useDebugValue:Qm,useDeferredValue:function(s,a){var u=dn();return SE(u,Kt.memoizedState,s,a)},useTransition:function(){var s=Sf(Hr)[0],a=dn().memoizedState;return[typeof s=="boolean"?s:nc(s),a]},useSyncExternalStore:X0,useId:IE,useHostTransitionStatus:eg,useFormState:dE,useActionState:dE,useOptimistic:function(s,a){var u=dn();return rE(u,Kt,s,a)},useMemoCache:$m,useCacheRefresh:CE};ng.useEffectEvent=gE;var DE={readContext:Un,use:bf,useCallback:TE,useContext:Un,useEffect:Wm,useImperativeHandle:EE,useInsertionEffect:yE,useLayoutEffect:_E,useMemo:bE,useReducer:Km,useRef:pE,useState:function(){return Km(Hr)},useDebugValue:Qm,useDeferredValue:function(s,a){var u=dn();return Kt===null?Xm(u,s,a):SE(u,Kt.memoizedState,s,a)},useTransition:function(){var s=Km(Hr)[0],a=dn().memoizedState;return[typeof s=="boolean"?s:nc(s),a]},useSyncExternalStore:X0,useId:IE,useHostTransitionStatus:eg,useFormState:hE,useActionState:hE,useOptimistic:function(s,a){var u=dn();return Kt!==null?rE(u,Kt,s,a):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:$m,useCacheRefresh:CE};DE.useEffectEvent=gE;function ig(s,a,u,h){a=s.memoizedState,u=u(h,a),u=u==null?a:v({},a,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var rg={enqueueSetState:function(s,a,u){s=s._reactInternals;var h=yi(),_=Ms(h);_.payload=a,u!=null&&(_.callback=u),a=Ds(s,_,h),a!==null&&(si(a,s,h),Xu(a,s,h))},enqueueReplaceState:function(s,a,u){s=s._reactInternals;var h=yi(),_=Ms(h);_.tag=1,_.payload=a,u!=null&&(_.callback=u),a=Ds(s,_,h),a!==null&&(si(a,s,h),Xu(a,s,h))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var u=yi(),h=Ms(u);h.tag=2,a!=null&&(h.callback=a),a=Ds(s,h,u),a!==null&&(si(a,s,u),Xu(a,s,u))}};function PE(s,a,u,h,_,T,R){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,T,R):a.prototype&&a.prototype.isPureReactComponent?!Hu(u,h)||!Hu(_,T):!0}function OE(s,a,u,h){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,h),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,h),a.state!==s&&rg.enqueueReplaceState(a,a.state,null)}function Xo(s,a){var u=a;if("ref"in a){u={};for(var h in a)h!=="ref"&&(u[h]=a[h])}if(s=s.defaultProps){u===a&&(u=v({},u));for(var _ in s)u[_]===void 0&&(u[_]=s[_])}return u}function VE(s){rf(s)}function UE(s){console.error(s)}function LE(s){rf(s)}function If(s,a){try{var u=s.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(h){setTimeout(function(){throw h})}}function BE(s,a,u){try{var h=s.onCaughtError;h(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function sg(s,a,u){return u=Ms(u),u.tag=3,u.payload={element:null},u.callback=function(){If(s,a)},u}function FE(s){return s=Ms(s),s.tag=3,s}function zE(s,a,u,h){var _=u.type.getDerivedStateFromError;if(typeof _=="function"){var T=h.value;s.payload=function(){return _(T)},s.callback=function(){BE(a,u,h)}}var R=u.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(s.callback=function(){BE(a,u,h),typeof _!="function"&&(Bs===null?Bs=new Set([this]):Bs.add(this));var q=h.stack;this.componentDidCatch(h.value,{componentStack:q!==null?q:""})})}function s2(s,a,u,h,_){if(u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(a=u.alternate,a!==null&&nl(a,u,_,!0),u=hi.current,u!==null){switch(u.tag){case 31:case 13:return Mi===null?Bf():u.alternate===null&&an===0&&(an=3),u.flags&=-257,u.flags|=65536,u.lanes=_,h===pf?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([h]):a.add(h),Ng(s,h,_)),!1;case 22:return u.flags|=65536,h===pf?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([h])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([h]):u.add(h)),Ng(s,h,_)),!1}throw Error(i(435,u.tag))}return Ng(s,h,_),Bf(),!1}if(xt)return a=hi.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=_,h!==wm&&(s=Error(i(422),{cause:h}),Ku(Ci(s,u)))):(h!==wm&&(a=Error(i(423),{cause:h}),Ku(Ci(a,u))),s=s.current.alternate,s.flags|=65536,_&=-_,s.lanes|=_,h=Ci(h,u),_=sg(s.stateNode,h,_),Om(s,_),an!==4&&(an=2)),!1;var T=Error(i(520),{cause:h});if(T=Ci(T,u),fc===null?fc=[T]:fc.push(T),an!==4&&(an=2),a===null)return!0;h=Ci(h,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,s=_&-_,u.lanes|=s,s=sg(u.stateNode,h,s),Om(u,s),!1;case 1:if(a=u.type,T=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Bs===null||!Bs.has(T))))return u.flags|=65536,_&=-_,u.lanes|=_,_=FE(_),zE(_,s,u,h),Om(u,_),!1}u=u.return}while(u!==null);return!1}var og=Error(i(461)),En=!1;function Ln(s,a,u,h){a.child=s===null?$0(a,null,u,h):Wo(a,s.child,u,h)}function GE(s,a,u,h,_){u=u.render;var T=a.ref;if("ref"in h){var R={};for(var q in h)q!=="ref"&&(R[q]=h[q])}else R=h;return jo(a),h=zm(s,a,u,R,T,_),q=Gm(),s!==null&&!En?(qm(s,a,_),$r(s,a,_)):(xt&&q&&bm(a),a.flags|=1,Ln(s,a,h,_),a.child)}function qE(s,a,u,h,_){if(s===null){var T=u.type;return typeof T=="function"&&!vm(T)&&T.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=T,HE(s,a,T,h,_)):(s=lf(u.type,null,h,a,a.mode,_),s.ref=a.ref,s.return=a,a.child=s)}if(T=s.child,!pg(s,_)){var R=T.memoizedProps;if(u=u.compare,u=u!==null?u:Hu,u(R,h)&&s.ref===a.ref)return $r(s,a,_)}return a.flags|=1,s=Br(T,h),s.ref=a.ref,s.return=a,a.child=s}function HE(s,a,u,h,_){if(s!==null){var T=s.memoizedProps;if(Hu(T,h)&&s.ref===a.ref)if(En=!1,a.pendingProps=h=T,pg(s,_))(s.flags&131072)!==0&&(En=!0);else return a.lanes=s.lanes,$r(s,a,_)}return ag(s,a,u,h,_)}function $E(s,a,u,h){var _=h.children,T=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((a.flags&128)!==0){if(T=T!==null?T.baseLanes|u:u,s!==null){for(h=a.child=s.child,_=0;h!==null;)_=_|h.lanes|h.childLanes,h=h.sibling;h=_&~T}else h=0,a.child=null;return jE(s,a,T,u,h)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&ff(a,T!==null?T.cachePool:null),T!==null?J0(a,T):Um(),Y0(a);else return h=a.lanes=536870912,jE(s,a,T!==null?T.baseLanes|u:u,u,h)}else T!==null?(ff(a,T.cachePool),J0(a,T),Os(),a.memoizedState=null):(s!==null&&ff(a,null),Um(),Os());return Ln(s,a,_,u),a.child}function sc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function jE(s,a,u,h,_){var T=km();return T=T===null?null:{parent:_n._currentValue,pool:T},a.memoizedState={baseLanes:u,cachePool:T},s!==null&&ff(a,null),Um(),Y0(a),s!==null&&nl(s,a,h,!0),a.childLanes=_,null}function Cf(s,a){return a=Nf({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function KE(s,a,u){return Wo(a,s.child,null,u),s=Cf(a,a.pendingProps),s.flags|=2,pi(a),a.memoizedState=null,s}function o2(s,a,u){var h=a.pendingProps,_=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(xt){if(h.mode==="hidden")return s=Cf(a,h),a.lanes=536870912,sc(null,s);if(Bm(a),(s=Xt)?(s=sb(s,ki),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Is!==null?{id:Tr,overflow:br}:null,retryLane:536870912,hydrationErrors:null},u=N0(s),u.return=a,a.child=u,Vn=a,Xt=null)):s=null,s===null)throw Rs(a);return a.lanes=536870912,null}return Cf(a,h)}var T=s.memoizedState;if(T!==null){var R=T.dehydrated;if(Bm(a),_)if(a.flags&256)a.flags&=-257,a=KE(s,a,u);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(En||nl(s,a,u,!1),_=(u&s.childLanes)!==0,En||_){if(h=Wt,h!==null&&(R=Au(h,u),R!==0&&R!==T.retryLane))throw T.retryLane=R,Go(s,R),si(h,s,R),og;Bf(),a=KE(s,a,u)}else s=T.treeContext,Xt=Di(R.nextSibling),Vn=a,xt=!0,Cs=null,ki=!1,s!==null&&D0(a,s),a=Cf(a,h),a.flags|=4096;return a}return s=Br(s.child,{mode:h.mode,children:h.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Rf(s,a){var u=a.ref;if(u===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(s===null||s.ref!==u)&&(a.flags|=4194816)}}function ag(s,a,u,h,_){return jo(a),u=zm(s,a,u,h,void 0,_),h=Gm(),s!==null&&!En?(qm(s,a,_),$r(s,a,_)):(xt&&h&&bm(a),a.flags|=1,Ln(s,a,u,_),a.child)}function JE(s,a,u,h,_,T){return jo(a),a.updateQueue=null,u=Q0(a,h,u,_),W0(s),h=Gm(),s!==null&&!En?(qm(s,a,T),$r(s,a,T)):(xt&&h&&bm(a),a.flags|=1,Ln(s,a,u,T),a.child)}function YE(s,a,u,h,_){if(jo(a),a.stateNode===null){var T=Xa,R=u.contextType;typeof R=="object"&&R!==null&&(T=Un(R)),T=new u(h,T),a.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=rg,a.stateNode=T,T._reactInternals=a,T=a.stateNode,T.props=h,T.state=a.memoizedState,T.refs={},Dm(a),R=u.contextType,T.context=typeof R=="object"&&R!==null?Un(R):Xa,T.state=a.memoizedState,R=u.getDerivedStateFromProps,typeof R=="function"&&(ig(a,u,R,h),T.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(R=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),R!==T.state&&rg.enqueueReplaceState(T,T.state,null),ec(a,h,T,_),Zu(),T.state=a.memoizedState),typeof T.componentDidMount=="function"&&(a.flags|=4194308),h=!0}else if(s===null){T=a.stateNode;var q=a.memoizedProps,Z=Xo(u,q);T.props=Z;var me=T.context,we=u.contextType;R=Xa,typeof we=="object"&&we!==null&&(R=Un(we));var Ce=u.getDerivedStateFromProps;we=typeof Ce=="function"||typeof T.getSnapshotBeforeUpdate=="function",q=a.pendingProps!==q,we||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(q||me!==R)&&OE(a,T,h,R),ks=!1;var ge=a.memoizedState;T.state=ge,ec(a,h,T,_),Zu(),me=a.memoizedState,q||ge!==me||ks?(typeof Ce=="function"&&(ig(a,u,Ce,h),me=a.memoizedState),(Z=ks||PE(a,u,Z,h,ge,me,R))?(we||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(a.flags|=4194308)):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=h,a.memoizedState=me),T.props=h,T.state=me,T.context=R,h=Z):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),h=!1)}else{T=a.stateNode,Pm(s,a),R=a.memoizedProps,we=Xo(u,R),T.props=we,Ce=a.pendingProps,ge=T.context,me=u.contextType,Z=Xa,typeof me=="object"&&me!==null&&(Z=Un(me)),q=u.getDerivedStateFromProps,(me=typeof q=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(R!==Ce||ge!==Z)&&OE(a,T,h,Z),ks=!1,ge=a.memoizedState,T.state=ge,ec(a,h,T,_),Zu();var Te=a.memoizedState;R!==Ce||ge!==Te||ks||s!==null&&s.dependencies!==null&&cf(s.dependencies)?(typeof q=="function"&&(ig(a,u,q,h),Te=a.memoizedState),(we=ks||PE(a,u,we,h,ge,Te,Z)||s!==null&&s.dependencies!==null&&cf(s.dependencies))?(me||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(h,Te,Z),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(h,Te,Z)),typeof T.componentDidUpdate=="function"&&(a.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof T.componentDidUpdate!="function"||R===s.memoizedProps&&ge===s.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&ge===s.memoizedState||(a.flags|=1024),a.memoizedProps=h,a.memoizedState=Te),T.props=h,T.state=Te,T.context=Z,h=we):(typeof T.componentDidUpdate!="function"||R===s.memoizedProps&&ge===s.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&ge===s.memoizedState||(a.flags|=1024),h=!1)}return T=h,Rf(s,a),h=(a.flags&128)!==0,T||h?(T=a.stateNode,u=h&&typeof u.getDerivedStateFromError!="function"?null:T.render(),a.flags|=1,s!==null&&h?(a.child=Wo(a,s.child,null,_),a.child=Wo(a,null,u,_)):Ln(s,a,u,_),a.memoizedState=T.state,s=a.child):s=$r(s,a,_),s}function WE(s,a,u,h){return Ho(),a.flags|=256,Ln(s,a,u,h),a.child}var lg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ug(s){return{baseLanes:s,cachePool:B0()}}function cg(s,a,u){return s=s!==null?s.childLanes&~u:0,a&&(s|=gi),s}function QE(s,a,u){var h=a.pendingProps,_=!1,T=(a.flags&128)!==0,R;if((R=T)||(R=s!==null&&s.memoizedState===null?!1:(cn.current&2)!==0),R&&(_=!0,a.flags&=-129),R=(a.flags&32)!==0,a.flags&=-33,s===null){if(xt){if(_?Ps(a):Os(),(s=Xt)?(s=sb(s,ki),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Is!==null?{id:Tr,overflow:br}:null,retryLane:536870912,hydrationErrors:null},u=N0(s),u.return=a,a.child=u,Vn=a,Xt=null)):s=null,s===null)throw Rs(a);return jg(s)?a.lanes=32:a.lanes=536870912,null}var q=h.children;return h=h.fallback,_?(Os(),_=a.mode,q=Nf({mode:"hidden",children:q},_),h=qo(h,_,u,null),q.return=a,h.return=a,q.sibling=h,a.child=q,h=a.child,h.memoizedState=ug(u),h.childLanes=cg(s,R,u),a.memoizedState=lg,sc(null,h)):(Ps(a),dg(a,q))}var Z=s.memoizedState;if(Z!==null&&(q=Z.dehydrated,q!==null)){if(T)a.flags&256?(Ps(a),a.flags&=-257,a=fg(s,a,u)):a.memoizedState!==null?(Os(),a.child=s.child,a.flags|=128,a=null):(Os(),q=h.fallback,_=a.mode,h=Nf({mode:"visible",children:h.children},_),q=qo(q,_,u,null),q.flags|=2,h.return=a,q.return=a,h.sibling=q,a.child=h,Wo(a,s.child,null,u),h=a.child,h.memoizedState=ug(u),h.childLanes=cg(s,R,u),a.memoizedState=lg,a=sc(null,h));else if(Ps(a),jg(q)){if(R=q.nextSibling&&q.nextSibling.dataset,R)var me=R.dgst;R=me,h=Error(i(419)),h.stack="",h.digest=R,Ku({value:h,source:null,stack:null}),a=fg(s,a,u)}else if(En||nl(s,a,u,!1),R=(u&s.childLanes)!==0,En||R){if(R=Wt,R!==null&&(h=Au(R,u),h!==0&&h!==Z.retryLane))throw Z.retryLane=h,Go(s,h),si(R,s,h),og;$g(q)||Bf(),a=fg(s,a,u)}else $g(q)?(a.flags|=192,a.child=s.child,a=null):(s=Z.treeContext,Xt=Di(q.nextSibling),Vn=a,xt=!0,Cs=null,ki=!1,s!==null&&D0(a,s),a=dg(a,h.children),a.flags|=4096);return a}return _?(Os(),q=h.fallback,_=a.mode,Z=s.child,me=Z.sibling,h=Br(Z,{mode:"hidden",children:h.children}),h.subtreeFlags=Z.subtreeFlags&65011712,me!==null?q=Br(me,q):(q=qo(q,_,u,null),q.flags|=2),q.return=a,h.return=a,h.sibling=q,a.child=h,sc(null,h),h=a.child,q=s.child.memoizedState,q===null?q=ug(u):(_=q.cachePool,_!==null?(Z=_n._currentValue,_=_.parent!==Z?{parent:Z,pool:Z}:_):_=B0(),q={baseLanes:q.baseLanes|u,cachePool:_}),h.memoizedState=q,h.childLanes=cg(s,R,u),a.memoizedState=lg,sc(s.child,h)):(Ps(a),u=s.child,s=u.sibling,u=Br(u,{mode:"visible",children:h.children}),u.return=a,u.sibling=null,s!==null&&(R=a.deletions,R===null?(a.deletions=[s],a.flags|=16):R.push(s)),a.child=u,a.memoizedState=null,u)}function dg(s,a){return a=Nf({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Nf(s,a){return s=fi(22,s,null,a),s.lanes=0,s}function fg(s,a,u){return Wo(a,s.child,null,u),s=dg(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function XE(s,a,u){s.lanes|=a;var h=s.alternate;h!==null&&(h.lanes|=a),Im(s.return,a,u)}function hg(s,a,u,h,_,T){var R=s.memoizedState;R===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:_,treeForkCount:T}:(R.isBackwards=a,R.rendering=null,R.renderingStartTime=0,R.last=h,R.tail=u,R.tailMode=_,R.treeForkCount=T)}function ZE(s,a,u){var h=a.pendingProps,_=h.revealOrder,T=h.tail;h=h.children;var R=cn.current,q=(R&2)!==0;if(q?(R=R&1|2,a.flags|=128):R&=1,ye(cn,R),Ln(s,a,h,u),h=xt?ju:0,!q&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&XE(s,u,a);else if(s.tag===19)XE(s,u,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(_){case"forwards":for(u=a.child,_=null;u!==null;)s=u.alternate,s!==null&&_f(s)===null&&(_=u),u=u.sibling;u=_,u===null?(_=a.child,a.child=null):(_=u.sibling,u.sibling=null),hg(a,!1,_,u,T,h);break;case"backwards":case"unstable_legacy-backwards":for(u=null,_=a.child,a.child=null;_!==null;){if(s=_.alternate,s!==null&&_f(s)===null){a.child=_;break}s=_.sibling,_.sibling=u,u=_,_=s}hg(a,!0,u,null,T,h);break;case"together":hg(a,!1,null,null,void 0,h);break;default:a.memoizedState=null}return a.child}function $r(s,a,u){if(s!==null&&(a.dependencies=s.dependencies),Ls|=a.lanes,(u&a.childLanes)===0)if(s!==null){if(nl(s,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,u=Br(s,s.pendingProps),a.child=u,u.return=a;s.sibling!==null;)s=s.sibling,u=u.sibling=Br(s,s.pendingProps),u.return=a;u.sibling=null}return a.child}function pg(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&cf(s)))}function a2(s,a,u){switch(a.tag){case 3:Je(a,a.stateNode.containerInfo),Ns(a,_n,s.memoizedState.cache),Ho();break;case 27:case 5:Ge(a);break;case 4:Je(a,a.stateNode.containerInfo);break;case 10:Ns(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Bm(a),null;break;case 13:var h=a.memoizedState;if(h!==null)return h.dehydrated!==null?(Ps(a),a.flags|=128,null):(u&a.child.childLanes)!==0?QE(s,a,u):(Ps(a),s=$r(s,a,u),s!==null?s.sibling:null);Ps(a);break;case 19:var _=(s.flags&128)!==0;if(h=(u&a.childLanes)!==0,h||(nl(s,a,u,!1),h=(u&a.childLanes)!==0),_){if(h)return ZE(s,a,u);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),ye(cn,cn.current),h)break;return null;case 22:return a.lanes=0,$E(s,a,u,a.pendingProps);case 24:Ns(a,_n,s.memoizedState.cache)}return $r(s,a,u)}function eT(s,a,u){if(s!==null)if(s.memoizedProps!==a.pendingProps)En=!0;else{if(!pg(s,u)&&(a.flags&128)===0)return En=!1,a2(s,a,u);En=(s.flags&131072)!==0}else En=!1,xt&&(a.flags&1048576)!==0&&M0(a,ju,a.index);switch(a.lanes=0,a.tag){case 16:e:{var h=a.pendingProps;if(s=Jo(a.elementType),a.type=s,typeof s=="function")vm(s)?(h=Xo(s,h),a.tag=1,a=YE(null,a,s,h,u)):(a.tag=0,a=ag(null,a,s,h,u));else{if(s!=null){var _=s.$$typeof;if(_===$){a.tag=11,a=GE(null,a,s,h,u);break e}else if(_===k){a.tag=14,a=qE(null,a,s,h,u);break e}}throw a=O(s)||s,Error(i(306,a,""))}}return a;case 0:return ag(s,a,a.type,a.pendingProps,u);case 1:return h=a.type,_=Xo(h,a.pendingProps),YE(s,a,h,_,u);case 3:e:{if(Je(a,a.stateNode.containerInfo),s===null)throw Error(i(387));h=a.pendingProps;var T=a.memoizedState;_=T.element,Pm(s,a),ec(a,h,null,u);var R=a.memoizedState;if(h=R.cache,Ns(a,_n,h),h!==T.cache&&Cm(a,[_n],u,!0),Zu(),h=R.element,T.isDehydrated)if(T={element:h,isDehydrated:!1,cache:R.cache},a.updateQueue.baseState=T,a.memoizedState=T,a.flags&256){a=WE(s,a,h,u);break e}else if(h!==_){_=Ci(Error(i(424)),a),Ku(_),a=WE(s,a,h,u);break e}else{switch(s=a.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Xt=Di(s.firstChild),Vn=a,xt=!0,Cs=null,ki=!0,u=$0(a,null,h,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Ho(),h===_){a=$r(s,a,u);break e}Ln(s,a,h,u)}a=a.child}return a;case 26:return Rf(s,a),s===null?(u=db(a.type,null,a.pendingProps,null))?a.memoizedState=u:xt||(u=a.type,s=a.pendingProps,h=jf(ze.current).createElement(u),h[mn]=a,h[Cn]=s,Bn(h,u,s),gn(h),a.stateNode=h):a.memoizedState=db(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Ge(a),s===null&&xt&&(h=a.stateNode=lb(a.type,a.pendingProps,ze.current),Vn=a,ki=!0,_=Xt,qs(a.type)?(Kg=_,Xt=Di(h.firstChild)):Xt=_),Ln(s,a,a.pendingProps.children,u),Rf(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&xt&&((_=h=Xt)&&(h=U2(h,a.type,a.pendingProps,ki),h!==null?(a.stateNode=h,Vn=a,Xt=Di(h.firstChild),ki=!1,_=!0):_=!1),_||Rs(a)),Ge(a),_=a.type,T=a.pendingProps,R=s!==null?s.memoizedProps:null,h=T.children,Gg(_,T)?h=null:R!==null&&Gg(_,R)&&(a.flags|=32),a.memoizedState!==null&&(_=zm(s,a,XN,null,null,u),Ec._currentValue=_),Rf(s,a),Ln(s,a,h,u),a.child;case 6:return s===null&&xt&&((s=u=Xt)&&(u=L2(u,a.pendingProps,ki),u!==null?(a.stateNode=u,Vn=a,Xt=null,s=!0):s=!1),s||Rs(a)),null;case 13:return QE(s,a,u);case 4:return Je(a,a.stateNode.containerInfo),h=a.pendingProps,s===null?a.child=Wo(a,null,h,u):Ln(s,a,h,u),a.child;case 11:return GE(s,a,a.type,a.pendingProps,u);case 7:return Ln(s,a,a.pendingProps,u),a.child;case 8:return Ln(s,a,a.pendingProps.children,u),a.child;case 12:return Ln(s,a,a.pendingProps.children,u),a.child;case 10:return h=a.pendingProps,Ns(a,a.type,h.value),Ln(s,a,h.children,u),a.child;case 9:return _=a.type._context,h=a.pendingProps.children,jo(a),_=Un(_),h=h(_),a.flags|=1,Ln(s,a,h,u),a.child;case 14:return qE(s,a,a.type,a.pendingProps,u);case 15:return HE(s,a,a.type,a.pendingProps,u);case 19:return ZE(s,a,u);case 31:return o2(s,a,u);case 22:return $E(s,a,u,a.pendingProps);case 24:return jo(a),h=Un(_n),s===null?(_=km(),_===null&&(_=Wt,T=Rm(),_.pooledCache=T,T.refCount++,T!==null&&(_.pooledCacheLanes|=u),_=T),a.memoizedState={parent:h,cache:_},Dm(a),Ns(a,_n,_)):((s.lanes&u)!==0&&(Pm(s,a),ec(a,null,null,u),Zu()),_=s.memoizedState,T=a.memoizedState,_.parent!==h?(_={parent:h,cache:h},a.memoizedState=_,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=_),Ns(a,_n,h)):(h=T.cache,Ns(a,_n,h),h!==_.cache&&Cm(a,[_n],u,!0))),Ln(s,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function jr(s){s.flags|=4}function mg(s,a,u,h,_){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(_&335544128)===_)if(s.stateNode.complete)s.flags|=8192;else if(IT())s.flags|=8192;else throw Yo=pf,Mm}else s.flags&=-16777217}function tT(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!gb(a))if(IT())s.flags|=8192;else throw Yo=pf,Mm}function kf(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?zi():536870912,s.lanes|=a,pl|=a)}function oc(s,a){if(!xt)switch(s.tailMode){case"hidden":a=s.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function Zt(s){var a=s.alternate!==null&&s.alternate.child===s.child,u=0,h=0;if(a)for(var _=s.child;_!==null;)u|=_.lanes|_.childLanes,h|=_.subtreeFlags&65011712,h|=_.flags&65011712,_.return=s,_=_.sibling;else for(_=s.child;_!==null;)u|=_.lanes|_.childLanes,h|=_.subtreeFlags,h|=_.flags,_.return=s,_=_.sibling;return s.subtreeFlags|=h,s.childLanes=u,a}function l2(s,a,u){var h=a.pendingProps;switch(Sm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(a),null;case 1:return Zt(a),null;case 3:return u=a.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),a.memoizedState.cache!==h&&(a.flags|=2048),Gr(_n),Ne(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(tl(a)?jr(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,xm())),Zt(a),null;case 26:var _=a.type,T=a.memoizedState;return s===null?(jr(a),T!==null?(Zt(a),tT(a,T)):(Zt(a),mg(a,_,null,h,u))):T?T!==s.memoizedState?(jr(a),Zt(a),tT(a,T)):(Zt(a),a.flags&=-16777217):(s=s.memoizedProps,s!==h&&jr(a),Zt(a),mg(a,_,s,h,u)),null;case 27:if(Ye(a),u=ze.current,_=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==h&&jr(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return Zt(a),null}s=_e.current,tl(a)?P0(a):(s=lb(_,h,u),a.stateNode=s,jr(a))}return Zt(a),null;case 5:if(Ye(a),_=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==h&&jr(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return Zt(a),null}if(T=_e.current,tl(a))P0(a);else{var R=jf(ze.current);switch(T){case 1:T=R.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:T=R.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":T=R.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":T=R.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":T=R.createElement("div"),T.innerHTML="<script><\/script>",T=T.removeChild(T.firstChild);break;case"select":T=typeof h.is=="string"?R.createElement("select",{is:h.is}):R.createElement("select"),h.multiple?T.multiple=!0:h.size&&(T.size=h.size);break;default:T=typeof h.is=="string"?R.createElement(_,{is:h.is}):R.createElement(_)}}T[mn]=a,T[Cn]=h;e:for(R=a.child;R!==null;){if(R.tag===5||R.tag===6)T.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===a)break e;for(;R.sibling===null;){if(R.return===null||R.return===a)break e;R=R.return}R.sibling.return=R.return,R=R.sibling}a.stateNode=T;e:switch(Bn(T,_,h),_){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&jr(a)}}return Zt(a),mg(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,u),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==h&&jr(a);else{if(typeof h!="string"&&a.stateNode===null)throw Error(i(166));if(s=ze.current,tl(a)){if(s=a.stateNode,u=a.memoizedProps,h=null,_=Vn,_!==null)switch(_.tag){case 27:case 5:h=_.memoizedProps}s[mn]=a,s=!!(s.nodeValue===u||h!==null&&h.suppressHydrationWarning===!0||QT(s.nodeValue,u)),s||Rs(a,!0)}else s=jf(s).createTextNode(h),s[mn]=a,a.stateNode=s}return Zt(a),null;case 31:if(u=a.memoizedState,s===null||s.memoizedState!==null){if(h=tl(a),u!==null){if(s===null){if(!h)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[mn]=a}else Ho(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Zt(a),s=!1}else u=xm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=u),s=!0;if(!s)return a.flags&256?(pi(a),a):(pi(a),null);if((a.flags&128)!==0)throw Error(i(558))}return Zt(a),null;case 13:if(h=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(_=tl(a),h!==null&&h.dehydrated!==null){if(s===null){if(!_)throw Error(i(318));if(_=a.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(i(317));_[mn]=a}else Ho(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Zt(a),_=!1}else _=xm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=_),_=!0;if(!_)return a.flags&256?(pi(a),a):(pi(a),null)}return pi(a),(a.flags&128)!==0?(a.lanes=u,a):(u=h!==null,s=s!==null&&s.memoizedState!==null,u&&(h=a.child,_=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(_=h.alternate.memoizedState.cachePool.pool),T=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(T=h.memoizedState.cachePool.pool),T!==_&&(h.flags|=2048)),u!==s&&u&&(a.child.flags|=8192),kf(a,a.updateQueue),Zt(a),null);case 4:return Ne(),s===null&&Ug(a.stateNode.containerInfo),Zt(a),null;case 10:return Gr(a.type),Zt(a),null;case 19:if(W(cn),h=a.memoizedState,h===null)return Zt(a),null;if(_=(a.flags&128)!==0,T=h.rendering,T===null)if(_)oc(h,!1);else{if(an!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(T=_f(s),T!==null){for(a.flags|=128,oc(h,!1),s=T.updateQueue,a.updateQueue=s,kf(a,s),a.subtreeFlags=0,s=u,u=a.child;u!==null;)R0(u,s),u=u.sibling;return ye(cn,cn.current&1|2),xt&&Fr(a,h.treeForkCount),a.child}s=s.sibling}h.tail!==null&&De()>Vf&&(a.flags|=128,_=!0,oc(h,!1),a.lanes=4194304)}else{if(!_)if(s=_f(T),s!==null){if(a.flags|=128,_=!0,s=s.updateQueue,a.updateQueue=s,kf(a,s),oc(h,!0),h.tail===null&&h.tailMode==="hidden"&&!T.alternate&&!xt)return Zt(a),null}else 2*De()-h.renderingStartTime>Vf&&u!==536870912&&(a.flags|=128,_=!0,oc(h,!1),a.lanes=4194304);h.isBackwards?(T.sibling=a.child,a.child=T):(s=h.last,s!==null?s.sibling=T:a.child=T,h.last=T)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=De(),s.sibling=null,u=cn.current,ye(cn,_?u&1|2:u&1),xt&&Fr(a,h.treeForkCount),s):(Zt(a),null);case 22:case 23:return pi(a),Lm(),h=a.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(a.flags|=8192):h&&(a.flags|=8192),h?(u&536870912)!==0&&(a.flags&128)===0&&(Zt(a),a.subtreeFlags&6&&(a.flags|=8192)):Zt(a),u=a.updateQueue,u!==null&&kf(a,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),h=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),h!==u&&(a.flags|=2048),s!==null&&W(Ko),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),Gr(_n),Zt(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function u2(s,a){switch(Sm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Gr(_n),Ne(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Ye(a),null;case 31:if(a.memoizedState!==null){if(pi(a),a.alternate===null)throw Error(i(340));Ho()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(pi(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Ho()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return W(cn),null;case 4:return Ne(),null;case 10:return Gr(a.type),null;case 22:case 23:return pi(a),Lm(),s!==null&&W(Ko),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Gr(_n),null;case 25:return null;default:return null}}function nT(s,a){switch(Sm(a),a.tag){case 3:Gr(_n),Ne();break;case 26:case 27:case 5:Ye(a);break;case 4:Ne();break;case 31:a.memoizedState!==null&&pi(a);break;case 13:pi(a);break;case 19:W(cn);break;case 10:Gr(a.type);break;case 22:case 23:pi(a),Lm(),s!==null&&W(Ko);break;case 24:Gr(_n)}}function ac(s,a){try{var u=a.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var _=h.next;u=_;do{if((u.tag&s)===s){h=void 0;var T=u.create,R=u.inst;h=T(),R.destroy=h}u=u.next}while(u!==_)}}catch(q){Ft(a,a.return,q)}}function Vs(s,a,u){try{var h=a.updateQueue,_=h!==null?h.lastEffect:null;if(_!==null){var T=_.next;h=T;do{if((h.tag&s)===s){var R=h.inst,q=R.destroy;if(q!==void 0){R.destroy=void 0,_=a;var Z=u,me=q;try{me()}catch(we){Ft(_,Z,we)}}}h=h.next}while(h!==T)}}catch(we){Ft(a,a.return,we)}}function iT(s){var a=s.updateQueue;if(a!==null){var u=s.stateNode;try{K0(a,u)}catch(h){Ft(s,s.return,h)}}}function rT(s,a,u){u.props=Xo(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(h){Ft(s,a,h)}}function lc(s,a){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof u=="function"?s.refCleanup=u(h):u.current=h}}catch(_){Ft(s,a,_)}}function Sr(s,a){var u=s.ref,h=s.refCleanup;if(u!==null)if(typeof h=="function")try{h()}catch(_){Ft(s,a,_)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(_){Ft(s,a,_)}else u.current=null}function sT(s){var a=s.type,u=s.memoizedProps,h=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&h.focus();break e;case"img":u.src?h.src=u.src:u.srcSet&&(h.srcset=u.srcSet)}}catch(_){Ft(s,s.return,_)}}function gg(s,a,u){try{var h=s.stateNode;k2(h,s.type,u,a),h[Cn]=a}catch(_){Ft(s,s.return,_)}}function oT(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&qs(s.type)||s.tag===4}function yg(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||oT(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&qs(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function _g(s,a,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(s),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=Hi));else if(h!==4&&(h===27&&qs(s.type)&&(u=s.stateNode,a=null),s=s.child,s!==null))for(_g(s,a,u),s=s.sibling;s!==null;)_g(s,a,u),s=s.sibling}function Mf(s,a,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,a?u.insertBefore(s,a):u.appendChild(s);else if(h!==4&&(h===27&&qs(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(Mf(s,a,u),s=s.sibling;s!==null;)Mf(s,a,u),s=s.sibling}function aT(s){var a=s.stateNode,u=s.memoizedProps;try{for(var h=s.type,_=a.attributes;_.length;)a.removeAttributeNode(_[0]);Bn(a,h,u),a[mn]=s,a[Cn]=u}catch(T){Ft(s,s.return,T)}}var Kr=!1,Tn=!1,vg=!1,lT=typeof WeakSet=="function"?WeakSet:Set,Nn=null;function c2(s,a){if(s=s.containerInfo,Fg=Zf,s=E0(s),fm(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var _=h.anchorOffset,T=h.focusNode;h=h.focusOffset;try{u.nodeType,T.nodeType}catch{u=null;break e}var R=0,q=-1,Z=-1,me=0,we=0,Ce=s,ge=null;t:for(;;){for(var Te;Ce!==u||_!==0&&Ce.nodeType!==3||(q=R+_),Ce!==T||h!==0&&Ce.nodeType!==3||(Z=R+h),Ce.nodeType===3&&(R+=Ce.nodeValue.length),(Te=Ce.firstChild)!==null;)ge=Ce,Ce=Te;for(;;){if(Ce===s)break t;if(ge===u&&++me===_&&(q=R),ge===T&&++we===h&&(Z=R),(Te=Ce.nextSibling)!==null)break;Ce=ge,ge=Ce.parentNode}Ce=Te}u=q===-1||Z===-1?null:{start:q,end:Z}}else u=null}u=u||{start:0,end:0}}else u=null;for(zg={focusedElem:s,selectionRange:u},Zf=!1,Nn=a;Nn!==null;)if(a=Nn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Nn=s;else for(;Nn!==null;){switch(a=Nn,T=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(u=0;u<s.length;u++)_=s[u],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&T!==null){s=void 0,u=a,_=T.memoizedProps,T=T.memoizedState,h=u.stateNode;try{var Ke=Xo(u.type,_);s=h.getSnapshotBeforeUpdate(Ke,T),h.__reactInternalSnapshotBeforeUpdate=s}catch(rt){Ft(u,u.return,rt)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,u=s.nodeType,u===9)Hg(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Hg(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,Nn=s;break}Nn=a.return}}function uT(s,a,u){var h=u.flags;switch(u.tag){case 0:case 11:case 15:Yr(s,u),h&4&&ac(5,u);break;case 1:if(Yr(s,u),h&4)if(s=u.stateNode,a===null)try{s.componentDidMount()}catch(R){Ft(u,u.return,R)}else{var _=Xo(u.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(_,a,s.__reactInternalSnapshotBeforeUpdate)}catch(R){Ft(u,u.return,R)}}h&64&&iT(u),h&512&&lc(u,u.return);break;case 3:if(Yr(s,u),h&64&&(s=u.updateQueue,s!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{K0(s,a)}catch(R){Ft(u,u.return,R)}}break;case 27:a===null&&h&4&&aT(u);case 26:case 5:Yr(s,u),a===null&&h&4&&sT(u),h&512&&lc(u,u.return);break;case 12:Yr(s,u);break;case 31:Yr(s,u),h&4&&fT(s,u);break;case 13:Yr(s,u),h&4&&hT(s,u),h&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=v2.bind(null,u),B2(s,u))));break;case 22:if(h=u.memoizedState!==null||Kr,!h){a=a!==null&&a.memoizedState!==null||Tn,_=Kr;var T=Tn;Kr=h,(Tn=a)&&!T?Wr(s,u,(u.subtreeFlags&8772)!==0):Yr(s,u),Kr=_,Tn=T}break;case 30:break;default:Yr(s,u)}}function cT(s){var a=s.alternate;a!==null&&(s.alternate=null,cT(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&La(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var tn=null,ti=!1;function Jr(s,a,u){for(u=u.child;u!==null;)dT(s,a,u),u=u.sibling}function dT(s,a,u){if(Ae&&typeof Ae.onCommitFiberUnmount=="function")try{Ae.onCommitFiberUnmount(he,u)}catch{}switch(u.tag){case 26:Tn||Sr(u,a),Jr(s,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Tn||Sr(u,a);var h=tn,_=ti;qs(u.type)&&(tn=u.stateNode,ti=!1),Jr(s,a,u),yc(u.stateNode),tn=h,ti=_;break;case 5:Tn||Sr(u,a);case 6:if(h=tn,_=ti,tn=null,Jr(s,a,u),tn=h,ti=_,tn!==null)if(ti)try{(tn.nodeType===9?tn.body:tn.nodeName==="HTML"?tn.ownerDocument.body:tn).removeChild(u.stateNode)}catch(T){Ft(u,a,T)}else try{tn.removeChild(u.stateNode)}catch(T){Ft(u,a,T)}break;case 18:tn!==null&&(ti?(s=tn,ib(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),bl(s)):ib(tn,u.stateNode));break;case 4:h=tn,_=ti,tn=u.stateNode.containerInfo,ti=!0,Jr(s,a,u),tn=h,ti=_;break;case 0:case 11:case 14:case 15:Vs(2,u,a),Tn||Vs(4,u,a),Jr(s,a,u);break;case 1:Tn||(Sr(u,a),h=u.stateNode,typeof h.componentWillUnmount=="function"&&rT(u,a,h)),Jr(s,a,u);break;case 21:Jr(s,a,u);break;case 22:Tn=(h=Tn)||u.memoizedState!==null,Jr(s,a,u),Tn=h;break;default:Jr(s,a,u)}}function fT(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{bl(s)}catch(u){Ft(a,a.return,u)}}}function hT(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{bl(s)}catch(u){Ft(a,a.return,u)}}function d2(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new lT),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new lT),a;default:throw Error(i(435,s.tag))}}function Df(s,a){var u=d2(s);a.forEach(function(h){if(!u.has(h)){u.add(h);var _=E2.bind(null,s,h);h.then(_,_)}})}function ni(s,a){var u=a.deletions;if(u!==null)for(var h=0;h<u.length;h++){var _=u[h],T=s,R=a,q=R;e:for(;q!==null;){switch(q.tag){case 27:if(qs(q.type)){tn=q.stateNode,ti=!1;break e}break;case 5:tn=q.stateNode,ti=!1;break e;case 3:case 4:tn=q.stateNode.containerInfo,ti=!0;break e}q=q.return}if(tn===null)throw Error(i(160));dT(T,R,_),tn=null,ti=!1,T=_.alternate,T!==null&&(T.return=null),_.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)pT(a,s),a=a.sibling}var Wi=null;function pT(s,a){var u=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ni(a,s),ii(s),h&4&&(Vs(3,s,s.return),ac(3,s),Vs(5,s,s.return));break;case 1:ni(a,s),ii(s),h&512&&(Tn||u===null||Sr(u,u.return)),h&64&&Kr&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?h:u.concat(h))));break;case 26:var _=Wi;if(ni(a,s),ii(s),h&512&&(Tn||u===null||Sr(u,u.return)),h&4){var T=u!==null?u.memoizedState:null;if(h=s.memoizedState,u===null)if(h===null)if(s.stateNode===null){e:{h=s.type,u=s.memoizedProps,_=_.ownerDocument||_;t:switch(h){case"title":T=_.getElementsByTagName("title")[0],(!T||T[ur]||T[mn]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=_.createElement(h),_.head.insertBefore(T,_.querySelector("head > title"))),Bn(T,h,u),T[mn]=s,gn(T),h=T;break e;case"link":var R=pb("link","href",_).get(h+(u.href||""));if(R){for(var q=0;q<R.length;q++)if(T=R[q],T.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&T.getAttribute("rel")===(u.rel==null?null:u.rel)&&T.getAttribute("title")===(u.title==null?null:u.title)&&T.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){R.splice(q,1);break t}}T=_.createElement(h),Bn(T,h,u),_.head.appendChild(T);break;case"meta":if(R=pb("meta","content",_).get(h+(u.content||""))){for(q=0;q<R.length;q++)if(T=R[q],T.getAttribute("content")===(u.content==null?null:""+u.content)&&T.getAttribute("name")===(u.name==null?null:u.name)&&T.getAttribute("property")===(u.property==null?null:u.property)&&T.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&T.getAttribute("charset")===(u.charSet==null?null:u.charSet)){R.splice(q,1);break t}}T=_.createElement(h),Bn(T,h,u),_.head.appendChild(T);break;default:throw Error(i(468,h))}T[mn]=s,gn(T),h=T}s.stateNode=h}else mb(_,s.type,s.stateNode);else s.stateNode=hb(_,h,s.memoizedProps);else T!==h?(T===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):T.count--,h===null?mb(_,s.type,s.stateNode):hb(_,h,s.memoizedProps)):h===null&&s.stateNode!==null&&gg(s,s.memoizedProps,u.memoizedProps)}break;case 27:ni(a,s),ii(s),h&512&&(Tn||u===null||Sr(u,u.return)),u!==null&&h&4&&gg(s,s.memoizedProps,u.memoizedProps);break;case 5:if(ni(a,s),ii(s),h&512&&(Tn||u===null||Sr(u,u.return)),s.flags&32){_=s.stateNode;try{ei(_,"")}catch(Ke){Ft(s,s.return,Ke)}}h&4&&s.stateNode!=null&&(_=s.memoizedProps,gg(s,_,u!==null?u.memoizedProps:_)),h&1024&&(vg=!0);break;case 6:if(ni(a,s),ii(s),h&4){if(s.stateNode===null)throw Error(i(162));h=s.memoizedProps,u=s.stateNode;try{u.nodeValue=h}catch(Ke){Ft(s,s.return,Ke)}}break;case 3:if(Yf=null,_=Wi,Wi=Kf(a.containerInfo),ni(a,s),Wi=_,ii(s),h&4&&u!==null&&u.memoizedState.isDehydrated)try{bl(a.containerInfo)}catch(Ke){Ft(s,s.return,Ke)}vg&&(vg=!1,mT(s));break;case 4:h=Wi,Wi=Kf(s.stateNode.containerInfo),ni(a,s),ii(s),Wi=h;break;case 12:ni(a,s),ii(s);break;case 31:ni(a,s),ii(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Df(s,h)));break;case 13:ni(a,s),ii(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Of=De()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Df(s,h)));break;case 22:_=s.memoizedState!==null;var Z=u!==null&&u.memoizedState!==null,me=Kr,we=Tn;if(Kr=me||_,Tn=we||Z,ni(a,s),Tn=we,Kr=me,ii(s),h&8192)e:for(a=s.stateNode,a._visibility=_?a._visibility&-2:a._visibility|1,_&&(u===null||Z||Kr||Tn||Zo(s)),u=null,a=s;;){if(a.tag===5||a.tag===26){if(u===null){Z=u=a;try{if(T=Z.stateNode,_)R=T.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{q=Z.stateNode;var Ce=Z.memoizedProps.style,ge=Ce!=null&&Ce.hasOwnProperty("display")?Ce.display:null;q.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(Ke){Ft(Z,Z.return,Ke)}}}else if(a.tag===6){if(u===null){Z=a;try{Z.stateNode.nodeValue=_?"":Z.memoizedProps}catch(Ke){Ft(Z,Z.return,Ke)}}}else if(a.tag===18){if(u===null){Z=a;try{var Te=Z.stateNode;_?rb(Te,!0):rb(Z.stateNode,!1)}catch(Ke){Ft(Z,Z.return,Ke)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}h&4&&(h=s.updateQueue,h!==null&&(u=h.retryQueue,u!==null&&(h.retryQueue=null,Df(s,u))));break;case 19:ni(a,s),ii(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Df(s,h)));break;case 30:break;case 21:break;default:ni(a,s),ii(s)}}function ii(s){var a=s.flags;if(a&2){try{for(var u,h=s.return;h!==null;){if(oT(h)){u=h;break}h=h.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var _=u.stateNode,T=yg(s);Mf(s,T,_);break;case 5:var R=u.stateNode;u.flags&32&&(ei(R,""),u.flags&=-33);var q=yg(s);Mf(s,q,R);break;case 3:case 4:var Z=u.stateNode.containerInfo,me=yg(s);_g(s,me,Z);break;default:throw Error(i(161))}}catch(we){Ft(s,s.return,we)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function mT(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;mT(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function Yr(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)uT(s,a.alternate,a),a=a.sibling}function Zo(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Vs(4,a,a.return),Zo(a);break;case 1:Sr(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&rT(a,a.return,u),Zo(a);break;case 27:yc(a.stateNode);case 26:case 5:Sr(a,a.return),Zo(a);break;case 22:a.memoizedState===null&&Zo(a);break;case 30:Zo(a);break;default:Zo(a)}s=s.sibling}}function Wr(s,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var h=a.alternate,_=s,T=a,R=T.flags;switch(T.tag){case 0:case 11:case 15:Wr(_,T,u),ac(4,T);break;case 1:if(Wr(_,T,u),h=T,_=h.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(me){Ft(h,h.return,me)}if(h=T,_=h.updateQueue,_!==null){var q=h.stateNode;try{var Z=_.shared.hiddenCallbacks;if(Z!==null)for(_.shared.hiddenCallbacks=null,_=0;_<Z.length;_++)j0(Z[_],q)}catch(me){Ft(h,h.return,me)}}u&&R&64&&iT(T),lc(T,T.return);break;case 27:aT(T);case 26:case 5:Wr(_,T,u),u&&h===null&&R&4&&sT(T),lc(T,T.return);break;case 12:Wr(_,T,u);break;case 31:Wr(_,T,u),u&&R&4&&fT(_,T);break;case 13:Wr(_,T,u),u&&R&4&&hT(_,T);break;case 22:T.memoizedState===null&&Wr(_,T,u),lc(T,T.return);break;case 30:break;default:Wr(_,T,u)}a=a.sibling}}function Eg(s,a){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Ju(u))}function Tg(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ju(s))}function Qi(s,a,u,h){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)gT(s,a,u,h),a=a.sibling}function gT(s,a,u,h){var _=a.flags;switch(a.tag){case 0:case 11:case 15:Qi(s,a,u,h),_&2048&&ac(9,a);break;case 1:Qi(s,a,u,h);break;case 3:Qi(s,a,u,h),_&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ju(s)));break;case 12:if(_&2048){Qi(s,a,u,h),s=a.stateNode;try{var T=a.memoizedProps,R=T.id,q=T.onPostCommit;typeof q=="function"&&q(R,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Z){Ft(a,a.return,Z)}}else Qi(s,a,u,h);break;case 31:Qi(s,a,u,h);break;case 13:Qi(s,a,u,h);break;case 23:break;case 22:T=a.stateNode,R=a.alternate,a.memoizedState!==null?T._visibility&2?Qi(s,a,u,h):uc(s,a):T._visibility&2?Qi(s,a,u,h):(T._visibility|=2,dl(s,a,u,h,(a.subtreeFlags&10256)!==0||!1)),_&2048&&Eg(R,a);break;case 24:Qi(s,a,u,h),_&2048&&Tg(a.alternate,a);break;default:Qi(s,a,u,h)}}function dl(s,a,u,h,_){for(_=_&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var T=s,R=a,q=u,Z=h,me=R.flags;switch(R.tag){case 0:case 11:case 15:dl(T,R,q,Z,_),ac(8,R);break;case 23:break;case 22:var we=R.stateNode;R.memoizedState!==null?we._visibility&2?dl(T,R,q,Z,_):uc(T,R):(we._visibility|=2,dl(T,R,q,Z,_)),_&&me&2048&&Eg(R.alternate,R);break;case 24:dl(T,R,q,Z,_),_&&me&2048&&Tg(R.alternate,R);break;default:dl(T,R,q,Z,_)}a=a.sibling}}function uc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=s,h=a,_=h.flags;switch(h.tag){case 22:uc(u,h),_&2048&&Eg(h.alternate,h);break;case 24:uc(u,h),_&2048&&Tg(h.alternate,h);break;default:uc(u,h)}a=a.sibling}}var cc=8192;function fl(s,a,u){if(s.subtreeFlags&cc)for(s=s.child;s!==null;)yT(s,a,u),s=s.sibling}function yT(s,a,u){switch(s.tag){case 26:fl(s,a,u),s.flags&cc&&s.memoizedState!==null&&Q2(u,Wi,s.memoizedState,s.memoizedProps);break;case 5:fl(s,a,u);break;case 3:case 4:var h=Wi;Wi=Kf(s.stateNode.containerInfo),fl(s,a,u),Wi=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=cc,cc=16777216,fl(s,a,u),cc=h):fl(s,a,u));break;default:fl(s,a,u)}}function _T(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function dc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var h=a[u];Nn=h,ET(h,s)}_T(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)vT(s),s=s.sibling}function vT(s){switch(s.tag){case 0:case 11:case 15:dc(s),s.flags&2048&&Vs(9,s,s.return);break;case 3:dc(s);break;case 12:dc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Pf(s)):dc(s);break;default:dc(s)}}function Pf(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var h=a[u];Nn=h,ET(h,s)}_T(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Vs(8,a,a.return),Pf(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,Pf(a));break;default:Pf(a)}s=s.sibling}}function ET(s,a){for(;Nn!==null;){var u=Nn;switch(u.tag){case 0:case 11:case 15:Vs(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var h=u.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Ju(u.memoizedState.cache)}if(h=u.child,h!==null)h.return=u,Nn=h;else e:for(u=s;Nn!==null;){h=Nn;var _=h.sibling,T=h.return;if(cT(h),h===u){Nn=null;break e}if(_!==null){_.return=T,Nn=_;break e}Nn=T}}}var f2={getCacheForType:function(s){var a=Un(_n),u=a.data.get(s);return u===void 0&&(u=s(),a.data.set(s,u)),u},cacheSignal:function(){return Un(_n).controller.signal}},h2=typeof WeakMap=="function"?WeakMap:Map,Ot=0,Wt=null,_t=null,Et=0,Bt=0,mi=null,Us=!1,hl=!1,bg=!1,Qr=0,an=0,Ls=0,ea=0,Sg=0,gi=0,pl=0,fc=null,ri=null,wg=!1,Of=0,TT=0,Vf=1/0,Uf=null,Bs=null,wn=0,Fs=null,ml=null,Xr=0,xg=0,Ag=null,bT=null,hc=0,Ig=null;function yi(){return(Ot&2)!==0&&Et!==0?Et&-Et:X.T!==null?Dg():Ud()}function ST(){if(gi===0)if((Et&536870912)===0||xt){var s=rn;rn<<=1,(rn&3932160)===0&&(rn=262144),gi=s}else gi=536870912;return s=hi.current,s!==null&&(s.flags|=32),gi}function si(s,a,u){(s===Wt&&(Bt===2||Bt===9)||s.cancelPendingCommit!==null)&&(gl(s,0),zs(s,Et,gi,!1)),ar(s,u),((Ot&2)===0||s!==Wt)&&(s===Wt&&((Ot&2)===0&&(ea|=u),an===4&&zs(s,Et,gi,!1)),wr(s))}function wT(s,a,u){if((Ot&6)!==0)throw Error(i(327));var h=!u&&(a&127)===0&&(a&s.expiredLanes)===0||In(s,a),_=h?g2(s,a):Rg(s,a,!0),T=h;do{if(_===0){hl&&!h&&zs(s,a,0,!1);break}else{if(u=s.current.alternate,T&&!p2(u)){_=Rg(s,a,!1),T=!1;continue}if(_===2){if(T=a,s.errorRecoveryDisabledLanes&T)var R=0;else R=s.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){a=R;e:{var q=s;_=fc;var Z=q.current.memoizedState.isDehydrated;if(Z&&(gl(q,R).flags|=256),R=Rg(q,R,!1),R!==2){if(bg&&!Z){q.errorRecoveryDisabledLanes|=T,ea|=T,_=4;break e}T=ri,ri=_,T!==null&&(ri===null?ri=T:ri.push.apply(ri,T))}_=R}if(T=!1,_!==2)continue}}if(_===1){gl(s,0),zs(s,a,0,!0);break}e:{switch(h=s,T=_,T){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:zs(h,a,gi,!Us);break e;case 2:ri=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(_=Of+300-De(),10<_)){if(zs(h,a,gi,!Us),pt(h,0,!0)!==0)break e;Xr=a,h.timeoutHandle=tb(xT.bind(null,h,u,ri,Uf,wg,a,gi,ea,pl,Us,T,"Throttled",-0,0),_);break e}xT(h,u,ri,Uf,wg,a,gi,ea,pl,Us,T,null,-0,0)}}break}while(!0);wr(s)}function xT(s,a,u,h,_,T,R,q,Z,me,we,Ce,ge,Te){if(s.timeoutHandle=-1,Ce=a.subtreeFlags,Ce&8192||(Ce&16785408)===16785408){Ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Hi},yT(a,T,Ce);var Ke=(T&62914560)===T?Of-De():(T&4194048)===T?TT-De():0;if(Ke=X2(Ce,Ke),Ke!==null){Xr=T,s.cancelPendingCommit=Ke(DT.bind(null,s,a,T,u,h,_,R,q,Z,we,Ce,null,ge,Te)),zs(s,T,R,!me);return}}DT(s,a,T,u,h,_,R,q,Z)}function p2(s){for(var a=s;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var h=0;h<u.length;h++){var _=u[h],T=_.getSnapshot;_=_.value;try{if(!di(T(),_))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function zs(s,a,u,h){a&=~Sg,a&=~ea,s.suspendedLanes|=a,s.pingedLanes&=~a,h&&(s.warmLanes|=a),h=s.expirationTimes;for(var _=a;0<_;){var T=31-Re(_),R=1<<T;h[T]=-1,_&=~R}u!==0&&Ro(s,u,a)}function Lf(){return(Ot&6)===0?(pc(0),!1):!0}function Cg(){if(_t!==null){if(Bt===0)var s=_t.return;else s=_t,zr=$o=null,Hm(s),ol=null,Wu=0,s=_t;for(;s!==null;)nT(s.alternate,s),s=s.return;_t=null}}function gl(s,a){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,P2(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),Xr=0,Cg(),Wt=s,_t=u=Br(s.current,null),Et=a,Bt=0,mi=null,Us=!1,hl=In(s,a),bg=!1,pl=gi=Sg=ea=Ls=an=0,ri=fc=null,wg=!1,(a&8)!==0&&(a|=a&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=a;0<h;){var _=31-Re(h),T=1<<_;a|=s[_],h&=~T}return Qr=a,sf(),u}function AT(s,a){ht=null,X.H=rc,a===sl||a===hf?(a=G0(),Bt=3):a===Mm?(a=G0(),Bt=4):Bt=a===og?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,mi=a,_t===null&&(an=1,If(s,Ci(a,s.current)))}function IT(){var s=hi.current;return s===null?!0:(Et&4194048)===Et?Mi===null:(Et&62914560)===Et||(Et&536870912)!==0?s===Mi:!1}function CT(){var s=X.H;return X.H=rc,s===null?rc:s}function RT(){var s=X.A;return X.A=f2,s}function Bf(){an=4,Us||(Et&4194048)!==Et&&hi.current!==null||(hl=!0),(Ls&134217727)===0&&(ea&134217727)===0||Wt===null||zs(Wt,Et,gi,!1)}function Rg(s,a,u){var h=Ot;Ot|=2;var _=CT(),T=RT();(Wt!==s||Et!==a)&&(Uf=null,gl(s,a)),a=!1;var R=an;e:do try{if(Bt!==0&&_t!==null){var q=_t,Z=mi;switch(Bt){case 8:Cg(),R=6;break e;case 3:case 2:case 9:case 6:hi.current===null&&(a=!0);var me=Bt;if(Bt=0,mi=null,yl(s,q,Z,me),u&&hl){R=0;break e}break;default:me=Bt,Bt=0,mi=null,yl(s,q,Z,me)}}m2(),R=an;break}catch(we){AT(s,we)}while(!0);return a&&s.shellSuspendCounter++,zr=$o=null,Ot=h,X.H=_,X.A=T,_t===null&&(Wt=null,Et=0,sf()),R}function m2(){for(;_t!==null;)NT(_t)}function g2(s,a){var u=Ot;Ot|=2;var h=CT(),_=RT();Wt!==s||Et!==a?(Uf=null,Vf=De()+500,gl(s,a)):hl=In(s,a);e:do try{if(Bt!==0&&_t!==null){a=_t;var T=mi;t:switch(Bt){case 1:Bt=0,mi=null,yl(s,a,T,1);break;case 2:case 9:if(F0(T)){Bt=0,mi=null,kT(a);break}a=function(){Bt!==2&&Bt!==9||Wt!==s||(Bt=7),wr(s)},T.then(a,a);break e;case 3:Bt=7;break e;case 4:Bt=5;break e;case 7:F0(T)?(Bt=0,mi=null,kT(a)):(Bt=0,mi=null,yl(s,a,T,7));break;case 5:var R=null;switch(_t.tag){case 26:R=_t.memoizedState;case 5:case 27:var q=_t;if(R?gb(R):q.stateNode.complete){Bt=0,mi=null;var Z=q.sibling;if(Z!==null)_t=Z;else{var me=q.return;me!==null?(_t=me,Ff(me)):_t=null}break t}}Bt=0,mi=null,yl(s,a,T,5);break;case 6:Bt=0,mi=null,yl(s,a,T,6);break;case 8:Cg(),an=6;break e;default:throw Error(i(462))}}y2();break}catch(we){AT(s,we)}while(!0);return zr=$o=null,X.H=h,X.A=_,Ot=u,_t!==null?0:(Wt=null,Et=0,sf(),an)}function y2(){for(;_t!==null&&!de();)NT(_t)}function NT(s){var a=eT(s.alternate,s,Qr);s.memoizedProps=s.pendingProps,a===null?Ff(s):_t=a}function kT(s){var a=s,u=a.alternate;switch(a.tag){case 15:case 0:a=JE(u,a,a.pendingProps,a.type,void 0,Et);break;case 11:a=JE(u,a,a.pendingProps,a.type.render,a.ref,Et);break;case 5:Hm(a);default:nT(u,a),a=_t=R0(a,Qr),a=eT(u,a,Qr)}s.memoizedProps=s.pendingProps,a===null?Ff(s):_t=a}function yl(s,a,u,h){zr=$o=null,Hm(a),ol=null,Wu=0;var _=a.return;try{if(s2(s,_,a,u,Et)){an=1,If(s,Ci(u,s.current)),_t=null;return}}catch(T){if(_!==null)throw _t=_,T;an=1,If(s,Ci(u,s.current)),_t=null;return}a.flags&32768?(xt||h===1?s=!0:hl||(Et&536870912)!==0?s=!1:(Us=s=!0,(h===2||h===9||h===3||h===6)&&(h=hi.current,h!==null&&h.tag===13&&(h.flags|=16384))),MT(a,s)):Ff(a)}function Ff(s){var a=s;do{if((a.flags&32768)!==0){MT(a,Us);return}s=a.return;var u=l2(a.alternate,a,Qr);if(u!==null){_t=u;return}if(a=a.sibling,a!==null){_t=a;return}_t=a=s}while(a!==null);an===0&&(an=5)}function MT(s,a){do{var u=u2(s.alternate,s);if(u!==null){u.flags&=32767,_t=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(s=s.sibling,s!==null)){_t=s;return}_t=s=u}while(s!==null);an=6,_t=null}function DT(s,a,u,h,_,T,R,q,Z){s.cancelPendingCommit=null;do zf();while(wn!==0);if((Ot&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(T=a.lanes|a.childLanes,T|=ym,Va(s,u,T,R,q,Z),s===Wt&&(_t=Wt=null,Et=0),ml=a,Fs=s,Xr=u,xg=T,Ag=_,bT=h,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,T2(nt,function(){return LT(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||h){h=X.T,X.T=null,_=Q.p,Q.p=2,R=Ot,Ot|=4;try{c2(s,a,u)}finally{Ot=R,Q.p=_,X.T=h}}wn=1,PT(),OT(),VT()}}function PT(){if(wn===1){wn=0;var s=Fs,a=ml,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=X.T,X.T=null;var h=Q.p;Q.p=2;var _=Ot;Ot|=4;try{pT(a,s);var T=zg,R=E0(s.containerInfo),q=T.focusedElem,Z=T.selectionRange;if(R!==q&&q&&q.ownerDocument&&v0(q.ownerDocument.documentElement,q)){if(Z!==null&&fm(q)){var me=Z.start,we=Z.end;if(we===void 0&&(we=me),"selectionStart"in q)q.selectionStart=me,q.selectionEnd=Math.min(we,q.value.length);else{var Ce=q.ownerDocument||document,ge=Ce&&Ce.defaultView||window;if(ge.getSelection){var Te=ge.getSelection(),Ke=q.textContent.length,rt=Math.min(Z.start,Ke),Yt=Z.end===void 0?rt:Math.min(Z.end,Ke);!Te.extend&&rt>Yt&&(R=Yt,Yt=rt,rt=R);var ae=_0(q,rt),te=_0(q,Yt);if(ae&&te&&(Te.rangeCount!==1||Te.anchorNode!==ae.node||Te.anchorOffset!==ae.offset||Te.focusNode!==te.node||Te.focusOffset!==te.offset)){var pe=Ce.createRange();pe.setStart(ae.node,ae.offset),Te.removeAllRanges(),rt>Yt?(Te.addRange(pe),Te.extend(te.node,te.offset)):(pe.setEnd(te.node,te.offset),Te.addRange(pe))}}}}for(Ce=[],Te=q;Te=Te.parentNode;)Te.nodeType===1&&Ce.push({element:Te,left:Te.scrollLeft,top:Te.scrollTop});for(typeof q.focus=="function"&&q.focus(),q=0;q<Ce.length;q++){var xe=Ce[q];xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}}Zf=!!Fg,zg=Fg=null}finally{Ot=_,Q.p=h,X.T=u}}s.current=a,wn=2}}function OT(){if(wn===2){wn=0;var s=Fs,a=ml,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=X.T,X.T=null;var h=Q.p;Q.p=2;var _=Ot;Ot|=4;try{uT(s,a.alternate,a)}finally{Ot=_,Q.p=h,X.T=u}}wn=3}}function VT(){if(wn===4||wn===3){wn=0,Me();var s=Fs,a=ml,u=Xr,h=bT;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?wn=5:(wn=0,ml=Fs=null,UT(s,s.pendingLanes));var _=s.pendingLanes;if(_===0&&(Bs=null),Or(u),a=a.stateNode,Ae&&typeof Ae.onCommitFiberRoot=="function")try{Ae.onCommitFiberRoot(he,a,void 0,(a.current.flags&128)===128)}catch{}if(h!==null){a=X.T,_=Q.p,Q.p=2,X.T=null;try{for(var T=s.onRecoverableError,R=0;R<h.length;R++){var q=h[R];T(q.value,{componentStack:q.stack})}}finally{X.T=a,Q.p=_}}(Xr&3)!==0&&zf(),wr(s),_=s.pendingLanes,(u&261930)!==0&&(_&42)!==0?s===Ig?hc++:(hc=0,Ig=s):hc=0,pc(0)}}function UT(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,Ju(a)))}function zf(){return PT(),OT(),VT(),LT()}function LT(){if(wn!==5)return!1;var s=Fs,a=xg;xg=0;var u=Or(Xr),h=X.T,_=Q.p;try{Q.p=32>u?32:u,X.T=null,u=Ag,Ag=null;var T=Fs,R=Xr;if(wn=0,ml=Fs=null,Xr=0,(Ot&6)!==0)throw Error(i(331));var q=Ot;if(Ot|=4,vT(T.current),gT(T,T.current,R,u),Ot=q,pc(0,!1),Ae&&typeof Ae.onPostCommitFiberRoot=="function")try{Ae.onPostCommitFiberRoot(he,T)}catch{}return!0}finally{Q.p=_,X.T=h,UT(s,a)}}function BT(s,a,u){a=Ci(u,a),a=sg(s.stateNode,a,2),s=Ds(s,a,2),s!==null&&(ar(s,2),wr(s))}function Ft(s,a,u){if(s.tag===3)BT(s,s,u);else for(;a!==null;){if(a.tag===3){BT(a,s,u);break}else if(a.tag===1){var h=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Bs===null||!Bs.has(h))){s=Ci(u,s),u=FE(2),h=Ds(a,u,2),h!==null&&(zE(u,h,a,s),ar(h,2),wr(h));break}}a=a.return}}function Ng(s,a,u){var h=s.pingCache;if(h===null){h=s.pingCache=new h2;var _=new Set;h.set(a,_)}else _=h.get(a),_===void 0&&(_=new Set,h.set(a,_));_.has(u)||(bg=!0,_.add(u),s=_2.bind(null,s,a,u),a.then(s,s))}function _2(s,a,u){var h=s.pingCache;h!==null&&h.delete(a),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Wt===s&&(Et&u)===u&&(an===4||an===3&&(Et&62914560)===Et&&300>De()-Of?(Ot&2)===0&&gl(s,0):Sg|=u,pl===Et&&(pl=0)),wr(s)}function FT(s,a){a===0&&(a=zi()),s=Go(s,a),s!==null&&(ar(s,a),wr(s))}function v2(s){var a=s.memoizedState,u=0;a!==null&&(u=a.retryLane),FT(s,u)}function E2(s,a){var u=0;switch(s.tag){case 31:case 13:var h=s.stateNode,_=s.memoizedState;_!==null&&(u=_.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(a),FT(s,u)}function T2(s,a){return be(s,a)}var Gf=null,_l=null,kg=!1,qf=!1,Mg=!1,Gs=0;function wr(s){s!==_l&&s.next===null&&(_l===null?Gf=_l=s:_l=_l.next=s),qf=!0,kg||(kg=!0,S2())}function pc(s,a){if(!Mg&&qf){Mg=!0;do for(var u=!1,h=Gf;h!==null;){if(s!==0){var _=h.pendingLanes;if(_===0)var T=0;else{var R=h.suspendedLanes,q=h.pingedLanes;T=(1<<31-Re(42|s)+1)-1,T&=_&~(R&~q),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(u=!0,HT(h,T))}else T=Et,T=pt(h,h===Wt?T:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(T&3)===0||In(h,T)||(u=!0,HT(h,T));h=h.next}while(u);Mg=!1}}function b2(){zT()}function zT(){qf=kg=!1;var s=0;Gs!==0&&D2()&&(s=Gs);for(var a=De(),u=null,h=Gf;h!==null;){var _=h.next,T=GT(h,a);T===0?(h.next=null,u===null?Gf=_:u.next=_,_===null&&(_l=u)):(u=h,(s!==0||(T&3)!==0)&&(qf=!0)),h=_}wn!==0&&wn!==5||pc(s),Gs!==0&&(Gs=0)}function GT(s,a){for(var u=s.suspendedLanes,h=s.pingedLanes,_=s.expirationTimes,T=s.pendingLanes&-62914561;0<T;){var R=31-Re(T),q=1<<R,Z=_[R];Z===-1?((q&u)===0||(q&h)!==0)&&(_[R]=ys(q,a)):Z<=a&&(s.expiredLanes|=q),T&=~q}if(a=Wt,u=Et,u=pt(s,s===a?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,u===0||s===a&&(Bt===2||Bt===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&Ie(h),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||In(s,u)){if(a=u&-u,a===s.callbackPriority)return a;switch(h!==null&&Ie(h),Or(u)){case 2:case 8:u=ct;break;case 32:u=nt;break;case 268435456:u=Rt;break;default:u=nt}return h=qT.bind(null,s),u=be(u,h),s.callbackPriority=a,s.callbackNode=u,a}return h!==null&&h!==null&&Ie(h),s.callbackPriority=2,s.callbackNode=null,2}function qT(s,a){if(wn!==0&&wn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(zf()&&s.callbackNode!==u)return null;var h=Et;return h=pt(s,s===Wt?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(wT(s,h,a),GT(s,De()),s.callbackNode!=null&&s.callbackNode===u?qT.bind(null,s):null)}function HT(s,a){if(zf())return null;wT(s,a,!0)}function S2(){O2(function(){(Ot&6)!==0?be(He,b2):zT()})}function Dg(){if(Gs===0){var s=il;s===0&&(s=$t,$t<<=1,($t&261888)===0&&($t=256)),Gs=s}return Gs}function $T(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ga(""+s)}function jT(s,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,s.id&&u.setAttribute("form",s.id),a.parentNode.insertBefore(u,a),s=new FormData(s),u.parentNode.removeChild(u),s}function w2(s,a,u,h,_){if(a==="submit"&&u&&u.stateNode===_){var T=$T((_[Cn]||null).action),R=h.submitter;R&&(a=(a=R[Cn]||null)?$T(a.formAction):R.getAttribute("formAction"),a!==null&&(T=a,R=null));var q=new yr("action","action",null,h,_);s.push({event:q,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Gs!==0){var Z=R?jT(_,R):new FormData(_);Zm(u,{pending:!0,data:Z,method:_.method,action:T},null,Z)}}else typeof T=="function"&&(q.preventDefault(),Z=R?jT(_,R):new FormData(_),Zm(u,{pending:!0,data:Z,method:_.method,action:T},T,Z))},currentTarget:_}]})}}for(var Pg=0;Pg<gm.length;Pg++){var Og=gm[Pg],x2=Og.toLowerCase(),A2=Og[0].toUpperCase()+Og.slice(1);Yi(x2,"on"+A2)}Yi(S0,"onAnimationEnd"),Yi(w0,"onAnimationIteration"),Yi(x0,"onAnimationStart"),Yi("dblclick","onDoubleClick"),Yi("focusin","onFocus"),Yi("focusout","onBlur"),Yi(GN,"onTransitionRun"),Yi(qN,"onTransitionStart"),Yi(HN,"onTransitionCancel"),Yi(A0,"onTransitionEnd"),hr("onMouseEnter",["mouseout","mouseover"]),hr("onMouseLeave",["mouseout","mouseover"]),hr("onPointerEnter",["pointerout","pointerover"]),hr("onPointerLeave",["pointerout","pointerover"]),fr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fr("onBeforeInput",["compositionend","keypress","textInput","paste"]),fr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(mc));function KT(s,a){a=(a&4)!==0;for(var u=0;u<s.length;u++){var h=s[u],_=h.event;h=h.listeners;e:{var T=void 0;if(a)for(var R=h.length-1;0<=R;R--){var q=h[R],Z=q.instance,me=q.currentTarget;if(q=q.listener,Z!==T&&_.isPropagationStopped())break e;T=q,_.currentTarget=me;try{T(_)}catch(we){rf(we)}_.currentTarget=null,T=Z}else for(R=0;R<h.length;R++){if(q=h[R],Z=q.instance,me=q.currentTarget,q=q.listener,Z!==T&&_.isPropagationStopped())break e;T=q,_.currentTarget=me;try{T(_)}catch(we){rf(we)}_.currentTarget=null,T=Z}}}}function vt(s,a){var u=a[Ua];u===void 0&&(u=a[Ua]=new Set);var h=s+"__bubble";u.has(h)||(JT(a,s,2,!1),u.add(h))}function Vg(s,a,u){var h=0;a&&(h|=4),JT(u,s,h,a)}var Hf="_reactListening"+Math.random().toString(36).slice(2);function Ug(s){if(!s[Hf]){s[Hf]=!0,Iu.forEach(function(u){u!=="selectionchange"&&(I2.has(u)||Vg(u,!1,s),Vg(u,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Hf]||(a[Hf]=!0,Vg("selectionchange",!1,a))}}function JT(s,a,u,h){switch(Sb(a)){case 2:var _=tk;break;case 8:_=nk;break;default:_=Xg}u=_.bind(null,a,u,s),_=void 0,!Po||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),h?_!==void 0?s.addEventListener(a,u,{capture:!0,passive:_}):s.addEventListener(a,u,!0):_!==void 0?s.addEventListener(a,u,{passive:_}):s.addEventListener(a,u,!1)}function Lg(s,a,u,h,_){var T=h;if((a&1)===0&&(a&2)===0&&h!==null)e:for(;;){if(h===null)return;var R=h.tag;if(R===3||R===4){var q=h.stateNode.containerInfo;if(q===_)break;if(R===4)for(R=h.return;R!==null;){var Z=R.tag;if((Z===3||Z===4)&&R.stateNode.containerInfo===_)return;R=R.return}for(;q!==null;){if(R=cr(q),R===null)return;if(Z=R.tag,Z===5||Z===6||Z===26||Z===27){h=T=R;continue e}q=q.parentNode}}h=h.return}Ss(function(){var me=T,we=wi(u),Ce=[];e:{var ge=I0.get(s);if(ge!==void 0){var Te=yr,Ke=s;switch(s){case"keypress":if(Vo(u)===0)break e;case"keydown":case"keyup":Te=ef;break;case"focusin":Ke="focus",Te=Lo;break;case"focusout":Ke="blur",Te=Lo;break;case"beforeblur":case"afterblur":Te=Lo;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=Fu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=$d;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=w;break;case S0:case w0:case x0:Te=Kd;break;case A0:Te=H;break;case"scroll":case"scrollend":Te=Bu;break;case"wheel":Te=ve;break;case"copy":case"cut":case"paste":Te=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=Lr;break;case"toggle":case"beforetoggle":Te=ft}var rt=(a&4)!==0,Yt=!rt&&(s==="scroll"||s==="scrollend"),ae=rt?ge!==null?ge+"Capture":null:ge;rt=[];for(var te=me,pe;te!==null;){var xe=te;if(pe=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||pe===null||ae===null||(xe=$i(te,ae),xe!=null&&rt.push(gc(te,xe,pe))),Yt)break;te=te.return}0<rt.length&&(ge=new Te(ge,Ke,null,u,we),Ce.push({event:ge,listeners:rt}))}}if((a&7)===0){e:{if(ge=s==="mouseover"||s==="pointerover",Te=s==="mouseout"||s==="pointerout",ge&&u!==Vu&&(Ke=u.relatedTarget||u.fromElement)&&(cr(Ke)||Ke[lr]))break e;if((Te||ge)&&(ge=we.window===we?we:(ge=we.ownerDocument)?ge.defaultView||ge.parentWindow:window,Te?(Ke=u.relatedTarget||u.toElement,Te=me,Ke=Ke?cr(Ke):null,Ke!==null&&(Yt=o(Ke),rt=Ke.tag,Ke!==Yt||rt!==5&&rt!==27&&rt!==6)&&(Ke=null)):(Te=null,Ke=me),Te!==Ke)){if(rt=Fu,xe="onMouseLeave",ae="onMouseEnter",te="mouse",(s==="pointerout"||s==="pointerover")&&(rt=Lr,xe="onPointerLeave",ae="onPointerEnter",te="pointer"),Yt=Te==null?ge:ui(Te),pe=Ke==null?ge:ui(Ke),ge=new rt(xe,te+"leave",Te,u,we),ge.target=Yt,ge.relatedTarget=pe,xe=null,cr(we)===me&&(rt=new rt(ae,te+"enter",Ke,u,we),rt.target=pe,rt.relatedTarget=Yt,xe=rt),Yt=xe,Te&&Ke)t:{for(rt=C2,ae=Te,te=Ke,pe=0,xe=ae;xe;xe=rt(xe))pe++;xe=0;for(var et=te;et;et=rt(et))xe++;for(;0<pe-xe;)ae=rt(ae),pe--;for(;0<xe-pe;)te=rt(te),xe--;for(;pe--;){if(ae===te||te!==null&&ae===te.alternate){rt=ae;break t}ae=rt(ae),te=rt(te)}rt=null}else rt=null;Te!==null&&YT(Ce,ge,Te,rt,!1),Ke!==null&&Yt!==null&&YT(Ce,Yt,Ke,rt,!0)}}e:{if(ge=me?ui(me):window,Te=ge.nodeName&&ge.nodeName.toLowerCase(),Te==="select"||Te==="input"&&ge.type==="file")var kt=f0;else if(c0(ge))if(h0)kt=BN;else{kt=UN;var Xe=VN}else Te=ge.nodeName,!Te||Te.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?me&&za(me.elementType)&&(kt=f0):kt=LN;if(kt&&(kt=kt(s,me))){d0(Ce,kt,u,we);break e}Xe&&Xe(s,ge,me),s==="focusout"&&me&&ge.type==="number"&&me.memoizedProps.value!=null&&Du(ge,"number",ge.value)}switch(Xe=me?ui(me):window,s){case"focusin":(c0(Xe)||Xe.contentEditable==="true")&&(Ya=Xe,hm=me,$u=null);break;case"focusout":$u=hm=Ya=null;break;case"mousedown":pm=!0;break;case"contextmenu":case"mouseup":case"dragend":pm=!1,T0(Ce,u,we);break;case"selectionchange":if(zN)break;case"keydown":case"keyup":T0(Ce,u,we)}var mt;if(Pt)e:{switch(s){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else Ja?Bo(s,u)&&(Tt="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Tt="onCompositionStart");Tt&&(Er&&u.locale!=="ko"&&(Ja||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&Ja&&(mt=Lu()):(gr=we,Uu="value"in gr?gr.value:gr.textContent,Ja=!0)),Xe=$f(me,Tt),0<Xe.length&&(Tt=new vr(Tt,s,null,u,we),Ce.push({event:Tt,listeners:Xe}),mt?Tt.data=mt:(mt=Ka(u),mt!==null&&(Tt.data=mt)))),(mt=Ai?MN(s,u):DN(s,u))&&(Tt=$f(me,"onBeforeInput"),0<Tt.length&&(Xe=new vr("onBeforeInput","beforeinput",null,u,we),Ce.push({event:Xe,listeners:Tt}),Xe.data=mt)),w2(Ce,s,me,u,we)}KT(Ce,a)})}function gc(s,a,u){return{instance:s,listener:a,currentTarget:u}}function $f(s,a){for(var u=a+"Capture",h=[];s!==null;){var _=s,T=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||T===null||(_=$i(s,u),_!=null&&h.unshift(gc(s,_,T)),_=$i(s,a),_!=null&&h.push(gc(s,_,T))),s.tag===3)return h;s=s.return}return[]}function C2(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function YT(s,a,u,h,_){for(var T=a._reactName,R=[];u!==null&&u!==h;){var q=u,Z=q.alternate,me=q.stateNode;if(q=q.tag,Z!==null&&Z===h)break;q!==5&&q!==26&&q!==27||me===null||(Z=me,_?(me=$i(u,T),me!=null&&R.unshift(gc(u,me,Z))):_||(me=$i(u,T),me!=null&&R.push(gc(u,me,Z)))),u=u.return}R.length!==0&&s.push({event:a,listeners:R})}var R2=/\r\n?/g,N2=/\u0000|\uFFFD/g;function WT(s){return(typeof s=="string"?s:""+s).replace(R2,`
`).replace(N2,"")}function QT(s,a){return a=WT(a),WT(s)===a}function Jt(s,a,u,h,_,T){switch(u){case"children":typeof h=="string"?a==="body"||a==="textarea"&&h===""||ei(s,h):(typeof h=="number"||typeof h=="bigint")&&a!=="body"&&ei(s,""+h);break;case"className":ci(s,"class",h);break;case"tabIndex":ci(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":ci(s,u,h);break;case"style":Ou(s,h,T);break;case"data":if(a!=="object"){ci(s,"data",h);break}case"src":case"href":if(h===""&&(a!=="a"||u!=="href")){s.removeAttribute(u);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=Ga(""+h),s.setAttribute(u,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(u==="formAction"?(a!=="input"&&Jt(s,a,"name",_.name,_,null),Jt(s,a,"formEncType",_.formEncType,_,null),Jt(s,a,"formMethod",_.formMethod,_,null),Jt(s,a,"formTarget",_.formTarget,_,null)):(Jt(s,a,"encType",_.encType,_,null),Jt(s,a,"method",_.method,_,null),Jt(s,a,"target",_.target,_,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=Ga(""+h),s.setAttribute(u,h);break;case"onClick":h!=null&&(s.onclick=Hi);break;case"onScroll":h!=null&&vt("scroll",s);break;case"onScrollEnd":h!=null&&vt("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(u=h.__html,u!=null){if(_.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}u=Ga(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""+h):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":h===!0?s.setAttribute(u,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,h):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(u,h):s.removeAttribute(u);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(u):s.setAttribute(u,h);break;case"popover":vt("beforetoggle",s),vt("toggle",s),Ba(s,"popover",h);break;case"xlinkActuate":yn(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":yn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":yn(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":yn(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":yn(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":yn(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":yn(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":yn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":yn(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Ba(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Hd.get(u)||u,Ba(s,u,h))}}function Bg(s,a,u,h,_,T){switch(u){case"style":Ou(s,h,T);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(u=h.__html,u!=null){if(_.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"children":typeof h=="string"?ei(s,h):(typeof h=="number"||typeof h=="bigint")&&ei(s,""+h);break;case"onScroll":h!=null&&vt("scroll",s);break;case"onScrollEnd":h!=null&&vt("scrollend",s);break;case"onClick":h!=null&&(s.onclick=Hi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Cu.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(_=u.endsWith("Capture"),a=u.slice(2,_?u.length-7:void 0),T=s[Cn]||null,T=T!=null?T[u]:null,typeof T=="function"&&s.removeEventListener(a,T,_),typeof h=="function")){typeof T!="function"&&T!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(a,h,_);break e}u in s?s[u]=h:h===!0?s.setAttribute(u,""):Ba(s,u,h)}}}function Bn(s,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":vt("error",s),vt("load",s);var h=!1,_=!1,T;for(T in u)if(u.hasOwnProperty(T)){var R=u[T];if(R!=null)switch(T){case"src":h=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Jt(s,a,T,R,u,null)}}_&&Jt(s,a,"srcSet",u.srcSet,u,null),h&&Jt(s,a,"src",u.src,u,null);return;case"input":vt("invalid",s);var q=T=R=_=null,Z=null,me=null;for(h in u)if(u.hasOwnProperty(h)){var we=u[h];if(we!=null)switch(h){case"name":_=we;break;case"type":R=we;break;case"checked":Z=we;break;case"defaultChecked":me=we;break;case"value":T=we;break;case"defaultValue":q=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,a));break;default:Jt(s,a,h,we,u,null)}}zd(s,T,q,Z,me,R,_,!1);return;case"select":vt("invalid",s),h=R=T=null;for(_ in u)if(u.hasOwnProperty(_)&&(q=u[_],q!=null))switch(_){case"value":T=q;break;case"defaultValue":R=q;break;case"multiple":h=q;default:Jt(s,a,_,q,u,null)}a=T,u=R,s.multiple=!!h,a!=null?vs(s,!!h,a,!1):u!=null&&vs(s,!!h,u,!0);return;case"textarea":vt("invalid",s),T=_=h=null;for(R in u)if(u.hasOwnProperty(R)&&(q=u[R],q!=null))switch(R){case"value":h=q;break;case"defaultValue":_=q;break;case"children":T=q;break;case"dangerouslySetInnerHTML":if(q!=null)throw Error(i(91));break;default:Jt(s,a,R,q,u,null)}Es(s,h,_,T);return;case"option":for(Z in u)if(u.hasOwnProperty(Z)&&(h=u[Z],h!=null))switch(Z){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Jt(s,a,Z,h,u,null)}return;case"dialog":vt("beforetoggle",s),vt("toggle",s),vt("cancel",s),vt("close",s);break;case"iframe":case"object":vt("load",s);break;case"video":case"audio":for(h=0;h<mc.length;h++)vt(mc[h],s);break;case"image":vt("error",s),vt("load",s);break;case"details":vt("toggle",s);break;case"embed":case"source":case"link":vt("error",s),vt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(me in u)if(u.hasOwnProperty(me)&&(h=u[me],h!=null))switch(me){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Jt(s,a,me,h,u,null)}return;default:if(za(a)){for(we in u)u.hasOwnProperty(we)&&(h=u[we],h!==void 0&&Bg(s,a,we,h,u,void 0));return}}for(q in u)u.hasOwnProperty(q)&&(h=u[q],h!=null&&Jt(s,a,q,h,u,null))}function k2(s,a,u,h){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,T=null,R=null,q=null,Z=null,me=null,we=null;for(Te in u){var Ce=u[Te];if(u.hasOwnProperty(Te)&&Ce!=null)switch(Te){case"checked":break;case"value":break;case"defaultValue":Z=Ce;default:h.hasOwnProperty(Te)||Jt(s,a,Te,null,h,Ce)}}for(var ge in h){var Te=h[ge];if(Ce=u[ge],h.hasOwnProperty(ge)&&(Te!=null||Ce!=null))switch(ge){case"type":T=Te;break;case"name":_=Te;break;case"checked":me=Te;break;case"defaultChecked":we=Te;break;case"value":R=Te;break;case"defaultValue":q=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(i(137,a));break;default:Te!==Ce&&Jt(s,a,ge,Te,h,Ce)}}Fa(s,R,q,Z,me,we,T,_);return;case"select":Te=R=q=ge=null;for(T in u)if(Z=u[T],u.hasOwnProperty(T)&&Z!=null)switch(T){case"value":break;case"multiple":Te=Z;default:h.hasOwnProperty(T)||Jt(s,a,T,null,h,Z)}for(_ in h)if(T=h[_],Z=u[_],h.hasOwnProperty(_)&&(T!=null||Z!=null))switch(_){case"value":ge=T;break;case"defaultValue":q=T;break;case"multiple":R=T;default:T!==Z&&Jt(s,a,_,T,h,Z)}a=q,u=R,h=Te,ge!=null?vs(s,!!u,ge,!1):!!h!=!!u&&(a!=null?vs(s,!!u,a,!0):vs(s,!!u,u?[]:"",!1));return;case"textarea":Te=ge=null;for(q in u)if(_=u[q],u.hasOwnProperty(q)&&_!=null&&!h.hasOwnProperty(q))switch(q){case"value":break;case"children":break;default:Jt(s,a,q,null,h,_)}for(R in h)if(_=h[R],T=u[R],h.hasOwnProperty(R)&&(_!=null||T!=null))switch(R){case"value":ge=_;break;case"defaultValue":Te=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(i(91));break;default:_!==T&&Jt(s,a,R,_,h,T)}Gd(s,ge,Te);return;case"option":for(var Ke in u)if(ge=u[Ke],u.hasOwnProperty(Ke)&&ge!=null&&!h.hasOwnProperty(Ke))switch(Ke){case"selected":s.selected=!1;break;default:Jt(s,a,Ke,null,h,ge)}for(Z in h)if(ge=h[Z],Te=u[Z],h.hasOwnProperty(Z)&&ge!==Te&&(ge!=null||Te!=null))switch(Z){case"selected":s.selected=ge&&typeof ge!="function"&&typeof ge!="symbol";break;default:Jt(s,a,Z,ge,h,Te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var rt in u)ge=u[rt],u.hasOwnProperty(rt)&&ge!=null&&!h.hasOwnProperty(rt)&&Jt(s,a,rt,null,h,ge);for(me in h)if(ge=h[me],Te=u[me],h.hasOwnProperty(me)&&ge!==Te&&(ge!=null||Te!=null))switch(me){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(i(137,a));break;default:Jt(s,a,me,ge,h,Te)}return;default:if(za(a)){for(var Yt in u)ge=u[Yt],u.hasOwnProperty(Yt)&&ge!==void 0&&!h.hasOwnProperty(Yt)&&Bg(s,a,Yt,void 0,h,ge);for(we in h)ge=h[we],Te=u[we],!h.hasOwnProperty(we)||ge===Te||ge===void 0&&Te===void 0||Bg(s,a,we,ge,h,Te);return}}for(var ae in u)ge=u[ae],u.hasOwnProperty(ae)&&ge!=null&&!h.hasOwnProperty(ae)&&Jt(s,a,ae,null,h,ge);for(Ce in h)ge=h[Ce],Te=u[Ce],!h.hasOwnProperty(Ce)||ge===Te||ge==null&&Te==null||Jt(s,a,Ce,ge,h,Te)}function XT(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function M2(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,u=performance.getEntriesByType("resource"),h=0;h<u.length;h++){var _=u[h],T=_.transferSize,R=_.initiatorType,q=_.duration;if(T&&q&&XT(R)){for(R=0,q=_.responseEnd,h+=1;h<u.length;h++){var Z=u[h],me=Z.startTime;if(me>q)break;var we=Z.transferSize,Ce=Z.initiatorType;we&&XT(Ce)&&(Z=Z.responseEnd,R+=we*(Z<q?1:(q-me)/(Z-me)))}if(--h,a+=8*(T+R)/(_.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Fg=null,zg=null;function jf(s){return s.nodeType===9?s:s.ownerDocument}function ZT(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function eb(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function Gg(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var qg=null;function D2(){var s=window.event;return s&&s.type==="popstate"?s===qg?!1:(qg=s,!0):(qg=null,!1)}var tb=typeof setTimeout=="function"?setTimeout:void 0,P2=typeof clearTimeout=="function"?clearTimeout:void 0,nb=typeof Promise=="function"?Promise:void 0,O2=typeof queueMicrotask=="function"?queueMicrotask:typeof nb<"u"?function(s){return nb.resolve(null).then(s).catch(V2)}:tb;function V2(s){setTimeout(function(){throw s})}function qs(s){return s==="head"}function ib(s,a){var u=a,h=0;do{var _=u.nextSibling;if(s.removeChild(u),_&&_.nodeType===8)if(u=_.data,u==="/$"||u==="/&"){if(h===0){s.removeChild(_),bl(a);return}h--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")h++;else if(u==="html")yc(s.ownerDocument.documentElement);else if(u==="head"){u=s.ownerDocument.head,yc(u);for(var T=u.firstChild;T;){var R=T.nextSibling,q=T.nodeName;T[ur]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&T.rel.toLowerCase()==="stylesheet"||u.removeChild(T),T=R}}else u==="body"&&yc(s.ownerDocument.body);u=_}while(u);bl(a)}function rb(s,a){var u=s;s=0;do{var h=u.nextSibling;if(u.nodeType===1?a?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(a?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),h&&h.nodeType===8)if(u=h.data,u==="/$"){if(s===0)break;s--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||s++;u=h}while(u)}function Hg(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Hg(u),La(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function U2(s,a,u,h){for(;s.nodeType===1;){var _=u;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[ur])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(T=s.getAttribute("rel"),T==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(T!==_.rel||s.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||s.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||s.getAttribute("title")!==(_.title==null?null:_.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(T=s.getAttribute("src"),(T!==(_.src==null?null:_.src)||s.getAttribute("type")!==(_.type==null?null:_.type)||s.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&T&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var T=_.name==null?null:""+_.name;if(_.type==="hidden"&&s.getAttribute("name")===T)return s}else return s;if(s=Di(s.nextSibling),s===null)break}return null}function L2(s,a,u){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=Di(s.nextSibling),s===null))return null;return s}function sb(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=Di(s.nextSibling),s===null))return null;return s}function $g(s){return s.data==="$?"||s.data==="$~"}function jg(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function B2(s,a){var u=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||u.readyState!=="loading")a();else{var h=function(){a(),u.removeEventListener("DOMContentLoaded",h)};u.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function Di(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var Kg=null;function ob(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"||u==="/&"){if(a===0)return Di(s.nextSibling);a--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||a++}s=s.nextSibling}return null}function ab(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(a===0)return s;a--}else u!=="/$"&&u!=="/&"||a++}s=s.previousSibling}return null}function lb(s,a,u){switch(a=jf(u),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function yc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);La(s)}var Pi=new Map,ub=new Set;function Kf(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Zr=Q.d;Q.d={f:F2,r:z2,D:G2,C:q2,L:H2,m:$2,X:K2,S:j2,M:J2};function F2(){var s=Zr.f(),a=Lf();return s||a}function z2(s){var a=Si(s);a!==null&&a.tag===5&&a.type==="form"?AE(a):Zr.r(s)}var vl=typeof document>"u"?null:document;function cb(s,a,u){var h=vl;if(h&&typeof a=="string"&&a){var _=Zn(a);_='link[rel="'+s+'"][href="'+_+'"]',typeof u=="string"&&(_+='[crossorigin="'+u+'"]'),ub.has(_)||(ub.add(_),s={rel:s,crossOrigin:u,href:a},h.querySelector(_)===null&&(a=h.createElement("link"),Bn(a,"link",s),gn(a),h.head.appendChild(a)))}}function G2(s){Zr.D(s),cb("dns-prefetch",s,null)}function q2(s,a){Zr.C(s,a),cb("preconnect",s,a)}function H2(s,a,u){Zr.L(s,a,u);var h=vl;if(h&&s&&a){var _='link[rel="preload"][as="'+Zn(a)+'"]';a==="image"&&u&&u.imageSrcSet?(_+='[imagesrcset="'+Zn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(_+='[imagesizes="'+Zn(u.imageSizes)+'"]')):_+='[href="'+Zn(s)+'"]';var T=_;switch(a){case"style":T=El(s);break;case"script":T=Tl(s)}Pi.has(T)||(s=v({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:s,as:a},u),Pi.set(T,s),h.querySelector(_)!==null||a==="style"&&h.querySelector(_c(T))||a==="script"&&h.querySelector(vc(T))||(a=h.createElement("link"),Bn(a,"link",s),gn(a),h.head.appendChild(a)))}}function $2(s,a){Zr.m(s,a);var u=vl;if(u&&s){var h=a&&typeof a.as=="string"?a.as:"script",_='link[rel="modulepreload"][as="'+Zn(h)+'"][href="'+Zn(s)+'"]',T=_;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Tl(s)}if(!Pi.has(T)&&(s=v({rel:"modulepreload",href:s},a),Pi.set(T,s),u.querySelector(_)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(vc(T)))return}h=u.createElement("link"),Bn(h,"link",s),gn(h),u.head.appendChild(h)}}}function j2(s,a,u){Zr.S(s,a,u);var h=vl;if(h&&s){var _=dr(h).hoistableStyles,T=El(s);a=a||"default";var R=_.get(T);if(!R){var q={loading:0,preload:null};if(R=h.querySelector(_c(T)))q.loading=5;else{s=v({rel:"stylesheet",href:s,"data-precedence":a},u),(u=Pi.get(T))&&Jg(s,u);var Z=R=h.createElement("link");gn(Z),Bn(Z,"link",s),Z._p=new Promise(function(me,we){Z.onload=me,Z.onerror=we}),Z.addEventListener("load",function(){q.loading|=1}),Z.addEventListener("error",function(){q.loading|=2}),q.loading|=4,Jf(R,a,h)}R={type:"stylesheet",instance:R,count:1,state:q},_.set(T,R)}}}function K2(s,a){Zr.X(s,a);var u=vl;if(u&&s){var h=dr(u).hoistableScripts,_=Tl(s),T=h.get(_);T||(T=u.querySelector(vc(_)),T||(s=v({src:s,async:!0},a),(a=Pi.get(_))&&Yg(s,a),T=u.createElement("script"),gn(T),Bn(T,"link",s),u.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},h.set(_,T))}}function J2(s,a){Zr.M(s,a);var u=vl;if(u&&s){var h=dr(u).hoistableScripts,_=Tl(s),T=h.get(_);T||(T=u.querySelector(vc(_)),T||(s=v({src:s,async:!0,type:"module"},a),(a=Pi.get(_))&&Yg(s,a),T=u.createElement("script"),gn(T),Bn(T,"link",s),u.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},h.set(_,T))}}function db(s,a,u,h){var _=(_=ze.current)?Kf(_):null;if(!_)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=El(u.href),u=dr(_).hoistableStyles,h=u.get(a),h||(h={type:"style",instance:null,count:0,state:null},u.set(a,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=El(u.href);var T=dr(_).hoistableStyles,R=T.get(s);if(R||(_=_.ownerDocument||_,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(s,R),(T=_.querySelector(_c(s)))&&!T._p&&(R.instance=T,R.state.loading=5),Pi.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Pi.set(s,u),T||Y2(_,s,u,R.state))),a&&h===null)throw Error(i(528,""));return R}if(a&&h!==null)throw Error(i(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Tl(u),u=dr(_).hoistableScripts,h=u.get(a),h||(h={type:"script",instance:null,count:0,state:null},u.set(a,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function El(s){return'href="'+Zn(s)+'"'}function _c(s){return'link[rel="stylesheet"]['+s+"]"}function fb(s){return v({},s,{"data-precedence":s.precedence,precedence:null})}function Y2(s,a,u,h){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?h.loading=1:(a=s.createElement("link"),h.preload=a,a.addEventListener("load",function(){return h.loading|=1}),a.addEventListener("error",function(){return h.loading|=2}),Bn(a,"link",u),gn(a),s.head.appendChild(a))}function Tl(s){return'[src="'+Zn(s)+'"]'}function vc(s){return"script[async]"+s}function hb(s,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var h=s.querySelector('style[data-href~="'+Zn(u.href)+'"]');if(h)return a.instance=h,gn(h),h;var _=v({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),gn(h),Bn(h,"style",_),Jf(h,u.precedence,s),a.instance=h;case"stylesheet":_=El(u.href);var T=s.querySelector(_c(_));if(T)return a.state.loading|=4,a.instance=T,gn(T),T;h=fb(u),(_=Pi.get(_))&&Jg(h,_),T=(s.ownerDocument||s).createElement("link"),gn(T);var R=T;return R._p=new Promise(function(q,Z){R.onload=q,R.onerror=Z}),Bn(T,"link",h),a.state.loading|=4,Jf(T,u.precedence,s),a.instance=T;case"script":return T=Tl(u.src),(_=s.querySelector(vc(T)))?(a.instance=_,gn(_),_):(h=u,(_=Pi.get(T))&&(h=v({},u),Yg(h,_)),s=s.ownerDocument||s,_=s.createElement("script"),gn(_),Bn(_,"link",h),s.head.appendChild(_),a.instance=_);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(h=a.instance,a.state.loading|=4,Jf(h,u.precedence,s));return a.instance}function Jf(s,a,u){for(var h=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=h.length?h[h.length-1]:null,T=_,R=0;R<h.length;R++){var q=h[R];if(q.dataset.precedence===a)T=q;else if(T!==_)break}T?T.parentNode.insertBefore(s,T.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(s,a.firstChild))}function Jg(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function Yg(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var Yf=null;function pb(s,a,u){if(Yf===null){var h=new Map,_=Yf=new Map;_.set(u,h)}else _=Yf,h=_.get(u),h||(h=new Map,_.set(u,h));if(h.has(s))return h;for(h.set(s,null),u=u.getElementsByTagName(s),_=0;_<u.length;_++){var T=u[_];if(!(T[ur]||T[mn]||s==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var R=T.getAttribute(a)||"";R=s+R;var q=h.get(R);q?q.push(T):h.set(R,[T])}}return h}function mb(s,a,u){s=s.ownerDocument||s,s.head.insertBefore(u,a==="title"?s.querySelector("head > title"):null)}function W2(s,a,u){if(u===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function gb(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function Q2(s,a,u,h){if(u.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var _=El(h.href),T=a.querySelector(_c(_));if(T){a=T._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=Wf.bind(s),a.then(s,s)),u.state.loading|=4,u.instance=T,gn(T);return}T=a.ownerDocument||a,h=fb(h),(_=Pi.get(_))&&Jg(h,_),T=T.createElement("link"),gn(T);var R=T;R._p=new Promise(function(q,Z){R.onload=q,R.onerror=Z}),Bn(T,"link",h),u.instance=T}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(u,a),(a=u.state.preload)&&(u.state.loading&3)===0&&(s.count++,u=Wf.bind(s),a.addEventListener("load",u),a.addEventListener("error",u))}}var Wg=0;function X2(s,a){return s.stylesheets&&s.count===0&&Xf(s,s.stylesheets),0<s.count||0<s.imgCount?function(u){var h=setTimeout(function(){if(s.stylesheets&&Xf(s,s.stylesheets),s.unsuspend){var T=s.unsuspend;s.unsuspend=null,T()}},6e4+a);0<s.imgBytes&&Wg===0&&(Wg=62500*M2());var _=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Xf(s,s.stylesheets),s.unsuspend)){var T=s.unsuspend;s.unsuspend=null,T()}},(s.imgBytes>Wg?50:800)+a);return s.unsuspend=u,function(){s.unsuspend=null,clearTimeout(h),clearTimeout(_)}}:null}function Wf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Xf(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Qf=null;function Xf(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Qf=new Map,a.forEach(Z2,s),Qf=null,Wf.call(s))}function Z2(s,a){if(!(a.state.loading&4)){var u=Qf.get(s);if(u)var h=u.get(null);else{u=new Map,Qf.set(s,u);for(var _=s.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<_.length;T++){var R=_[T];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(u.set(R.dataset.precedence,R),h=R)}h&&u.set(null,h)}_=a.instance,R=_.getAttribute("data-precedence"),T=u.get(R)||h,T===h&&u.set(null,_),u.set(R,_),this.count++,h=Wf.bind(this),_.addEventListener("load",h),_.addEventListener("error",h),T?T.parentNode.insertBefore(_,T.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(_,s.firstChild)),a.state.loading|=4}}var Ec={$$typeof:L,Provider:null,Consumer:null,_currentValue:se,_currentValue2:se,_threadCount:0};function ek(s,a,u,h,_,T,R,q,Z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ut(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ut(0),this.hiddenUpdates=Ut(null),this.identifierPrefix=h,this.onUncaughtError=_,this.onCaughtError=T,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function yb(s,a,u,h,_,T,R,q,Z,me,we,Ce){return s=new ek(s,a,u,R,Z,me,we,Ce,q),a=1,T===!0&&(a|=24),T=fi(3,null,null,a),s.current=T,T.stateNode=s,a=Rm(),a.refCount++,s.pooledCache=a,a.refCount++,T.memoizedState={element:h,isDehydrated:u,cache:a},Dm(T),s}function _b(s){return s?(s=Xa,s):Xa}function vb(s,a,u,h,_,T){_=_b(_),h.context===null?h.context=_:h.pendingContext=_,h=Ms(a),h.payload={element:u},T=T===void 0?null:T,T!==null&&(h.callback=T),u=Ds(s,h,a),u!==null&&(si(u,s,a),Xu(u,s,a))}function Eb(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<a?u:a}}function Qg(s,a){Eb(s,a),(s=s.alternate)&&Eb(s,a)}function Tb(s){if(s.tag===13||s.tag===31){var a=Go(s,67108864);a!==null&&si(a,s,67108864),Qg(s,67108864)}}function bb(s){if(s.tag===13||s.tag===31){var a=yi();a=No(a);var u=Go(s,a);u!==null&&si(u,s,a),Qg(s,a)}}var Zf=!0;function tk(s,a,u,h){var _=X.T;X.T=null;var T=Q.p;try{Q.p=2,Xg(s,a,u,h)}finally{Q.p=T,X.T=_}}function nk(s,a,u,h){var _=X.T;X.T=null;var T=Q.p;try{Q.p=8,Xg(s,a,u,h)}finally{Q.p=T,X.T=_}}function Xg(s,a,u,h){if(Zf){var _=Zg(h);if(_===null)Lg(s,a,h,eh,u),wb(s,h);else if(rk(_,s,a,u,h))h.stopPropagation();else if(wb(s,h),a&4&&-1<ik.indexOf(s)){for(;_!==null;){var T=Si(_);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var R=dt(T.pendingLanes);if(R!==0){var q=T;for(q.pendingLanes|=2,q.entangledLanes|=2;R;){var Z=1<<31-Re(R);q.entanglements[1]|=Z,R&=~Z}wr(T),(Ot&6)===0&&(Vf=De()+500,pc(0))}}break;case 31:case 13:q=Go(T,2),q!==null&&si(q,T,2),Lf(),Qg(T,2)}if(T=Zg(h),T===null&&Lg(s,a,h,eh,u),T===_)break;_=T}_!==null&&h.stopPropagation()}else Lg(s,a,h,null,u)}}function Zg(s){return s=wi(s),ey(s)}var eh=null;function ey(s){if(eh=null,s=cr(s),s!==null){var a=o(s);if(a===null)s=null;else{var u=a.tag;if(u===13){if(s=l(a),s!==null)return s;s=null}else if(u===31){if(s=c(a),s!==null)return s;s=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return eh=s,null}function Sb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ke()){case He:return 2;case ct:return 8;case nt:case Ht:return 32;case Rt:return 268435456;default:return 32}default:return 32}}var ty=!1,Hs=null,$s=null,js=null,Tc=new Map,bc=new Map,Ks=[],ik="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wb(s,a){switch(s){case"focusin":case"focusout":Hs=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":js=null;break;case"pointerover":case"pointerout":Tc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":bc.delete(a.pointerId)}}function Sc(s,a,u,h,_,T){return s===null||s.nativeEvent!==T?(s={blockedOn:a,domEventName:u,eventSystemFlags:h,nativeEvent:T,targetContainers:[_]},a!==null&&(a=Si(a),a!==null&&Tb(a)),s):(s.eventSystemFlags|=h,a=s.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),s)}function rk(s,a,u,h,_){switch(a){case"focusin":return Hs=Sc(Hs,s,a,u,h,_),!0;case"dragenter":return $s=Sc($s,s,a,u,h,_),!0;case"mouseover":return js=Sc(js,s,a,u,h,_),!0;case"pointerover":var T=_.pointerId;return Tc.set(T,Sc(Tc.get(T)||null,s,a,u,h,_)),!0;case"gotpointercapture":return T=_.pointerId,bc.set(T,Sc(bc.get(T)||null,s,a,u,h,_)),!0}return!1}function xb(s){var a=cr(s.target);if(a!==null){var u=o(a);if(u!==null){if(a=u.tag,a===13){if(a=l(u),a!==null){s.blockedOn=a,Gi(s.priority,function(){bb(u)});return}}else if(a===31){if(a=c(u),a!==null){s.blockedOn=a,Gi(s.priority,function(){bb(u)});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function th(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var u=Zg(s.nativeEvent);if(u===null){u=s.nativeEvent;var h=new u.constructor(u.type,u);Vu=h,u.target.dispatchEvent(h),Vu=null}else return a=Si(u),a!==null&&Tb(a),s.blockedOn=u,!1;a.shift()}return!0}function Ab(s,a,u){th(s)&&u.delete(a)}function sk(){ty=!1,Hs!==null&&th(Hs)&&(Hs=null),$s!==null&&th($s)&&($s=null),js!==null&&th(js)&&(js=null),Tc.forEach(Ab),bc.forEach(Ab)}function nh(s,a){s.blockedOn===a&&(s.blockedOn=null,ty||(ty=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,sk)))}var ih=null;function Ib(s){ih!==s&&(ih=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ih===s&&(ih=null);for(var a=0;a<s.length;a+=3){var u=s[a],h=s[a+1],_=s[a+2];if(typeof h!="function"){if(ey(h||u)===null)continue;break}var T=Si(u);T!==null&&(s.splice(a,3),a-=3,Zm(T,{pending:!0,data:_,method:u.method,action:h},h,_))}}))}function bl(s){function a(Z){return nh(Z,s)}Hs!==null&&nh(Hs,s),$s!==null&&nh($s,s),js!==null&&nh(js,s),Tc.forEach(a),bc.forEach(a);for(var u=0;u<Ks.length;u++){var h=Ks[u];h.blockedOn===s&&(h.blockedOn=null)}for(;0<Ks.length&&(u=Ks[0],u.blockedOn===null);)xb(u),u.blockedOn===null&&Ks.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(h=0;h<u.length;h+=3){var _=u[h],T=u[h+1],R=_[Cn]||null;if(typeof T=="function")R||Ib(u);else if(R){var q=null;if(T&&T.hasAttribute("formAction")){if(_=T,R=T[Cn]||null)q=R.formAction;else if(ey(_)!==null)continue}else q=R.action;typeof q=="function"?u[h+1]=q:(u.splice(h,3),h-=3),Ib(u)}}}function Cb(){function s(T){T.canIntercept&&T.info==="react-transition"&&T.intercept({handler:function(){return new Promise(function(R){return _=R})},focusReset:"manual",scroll:"manual"})}function a(){_!==null&&(_(),_=null),h||setTimeout(u,20)}function u(){if(!h&&!navigation.transition){var T=navigation.currentEntry;T&&T.url!=null&&navigation.navigate(T.url,{state:T.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,_=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(u,100),function(){h=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),_!==null&&(_(),_=null)}}}function ny(s){this._internalRoot=s}rh.prototype.render=ny.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var u=a.current,h=yi();vb(u,h,s,a,null,null)},rh.prototype.unmount=ny.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;vb(s.current,2,null,s,null,null),Lf(),a[lr]=null}};function rh(s){this._internalRoot=s}rh.prototype.unstable_scheduleHydration=function(s){if(s){var a=Ud();s={blockedOn:null,target:s,priority:a};for(var u=0;u<Ks.length&&a!==0&&a<Ks[u].priority;u++);Ks.splice(u,0,s),u===0&&xb(s)}};var Rb=e.version;if(Rb!=="19.2.4")throw Error(i(527,Rb,"19.2.4"));Q.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=f(a),s=s!==null?m(s):null,s=s===null?null:s.stateNode,s};var ok={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sh.isDisabled&&sh.supportsFiber)try{he=sh.inject(ok),Ae=sh}catch{}}return xc.createRoot=function(s,a){if(!r(s))throw Error(i(299));var u=!1,h="",_=VE,T=UE,R=LE;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(_=a.onUncaughtError),a.onCaughtError!==void 0&&(T=a.onCaughtError),a.onRecoverableError!==void 0&&(R=a.onRecoverableError)),a=yb(s,1,!1,null,null,u,h,null,_,T,R,Cb),s[lr]=a.current,Ug(s),new ny(a)},xc.hydrateRoot=function(s,a,u){if(!r(s))throw Error(i(299));var h=!1,_="",T=VE,R=UE,q=LE,Z=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(_=u.identifierPrefix),u.onUncaughtError!==void 0&&(T=u.onUncaughtError),u.onCaughtError!==void 0&&(R=u.onCaughtError),u.onRecoverableError!==void 0&&(q=u.onRecoverableError),u.formState!==void 0&&(Z=u.formState)),a=yb(s,1,!0,a,u??null,h,_,Z,T,R,q,Cb),a.context=_b(null),u=a.current,h=yi(),h=No(h),_=Ms(h),_.callback=null,Ds(u,_,h),u=h,a.current.lanes=u,ar(a,u),wr(a),s[lr]=a.current,Ug(s),new rh(a)},xc.version="19.2.4",xc}var Bb;function yk(){if(Bb)return sy.exports;Bb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),sy.exports=gk(),sy.exports}var _k=yk();const vk=F_(_k),Ek="modulepreload",Tk=function(n){return"/"+n},Fb={},bd=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let l=function(f){return Promise.all(f.map(m=>Promise.resolve(m).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));r=l(t.map(f=>{if(f=Tk(f),f in Fb)return;Fb[f]=!0;const m=f.endsWith(".css"),v=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${v}`))return;const E=document.createElement("link");if(E.rel=m?"stylesheet":Ek,m||(E.as="script"),E.crossOrigin="",E.href=f,d&&E.setAttribute("nonce",d),document.head.appendChild(E),m)return new Promise((b,I)=>{E.addEventListener("load",b),E.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${f}`)))})}))}function o(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return r.then(l=>{for(const c of l||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),LA=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Sk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=Oe.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:o,iconNode:l,...c},d)=>Oe.createElement("svg",{ref:d,...Sk,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:LA("lucide",r),...c},[...l.map(([f,m])=>Oe.createElement(f,m)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=(n,e)=>{const t=Oe.forwardRef(({className:i,...r},o)=>Oe.createElement(wk,{ref:o,iconNode:e,className:LA(`lucide-${bk(n)}`,i),...r}));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xk=st("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=st("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=st("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ak=st("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ik=st("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ck=st("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=st("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gb=st("CircleArrowUp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uy=st("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=st("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rk=st("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nk=st("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kk=st("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mk=st("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dk=st("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pk=st("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ok=st("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vk=st("FileDiff",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M9 10h6",key:"9gxzsh"}],["path",{d:"M12 13V7",key:"h0r20n"}],["path",{d:"M9 17h6",key:"r8uit2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uk=st("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lk=st("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bk=st("GitCommitHorizontal",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qb=st("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fk=st("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zk=st("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gk=st("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qk=st("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hk=st("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $k=st("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jk=st("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uy=st("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=st("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=st("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hb=st("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=st("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=st("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=st("ScrollText",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=st("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=st("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wk=st("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=st("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jb=st("SlidersVertical",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const id=st("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xk=st("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ly=st("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=st("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=st("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=st("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=st("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=st("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=st("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=st("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),nM=({activePage:n,onPageChange:e})=>{const t=[{id:"home",label:"Home",icon:Ea},{id:"console",label:"Console",icon:Ly},{id:"workflows",label:"Workflows",icon:tM},{id:"library",label:"Library",icon:Gk}];return S.jsx("nav",{className:"fixed bottom-0 left-0 right-0 h-16 bg-white/80 dark:bg-[#1C1C1E]/80 backdrop-blur-xl border-t border-border/50 flex items-center justify-around px-2 z-50 sm:relative sm:bottom-auto sm:bg-transparent sm:border-t-0 sm:h-auto sm:px-0 sm:gap-1",children:t.map(i=>{const r=n===i.id,o=i.icon;return S.jsxs("button",{onClick:()=>e(i.id),"aria-label":`Go to ${i.label}`,"aria-current":r?"page":void 0,className:`
              flex flex-col items-center justify-center gap-1 flex-1 py-2 px-1 rounded-xl transition-all duration-200
              sm:flex-row sm:px-4 sm:py-1.5 sm:rounded-lg
              ${r?"text-accent bg-accent/5":"text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}
            `,children:[S.jsx(o,{size:20,strokeWidth:r?2.5:2,className:"sm:w-4 sm:h-4"}),S.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider sm:text-xs sm:normal-case sm:tracking-normal",children:i.label})]},i.id)})})},iM=()=>{};var Kb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},rM=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const o=n[t++];e[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){const o=n[t++],l=n[t++],c=n[t++],d=((r&7)<<18|(o&63)<<12|(l&63)<<6|c&63)-65536;e[i++]=String.fromCharCode(55296+(d>>10)),e[i++]=String.fromCharCode(56320+(d&1023))}else{const o=n[t++],l=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|l&63)}}return e.join("")},qA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const o=n[r],l=r+1<n.length,c=l?n[r+1]:0,d=r+2<n.length,f=d?n[r+2]:0,m=o>>2,v=(o&3)<<4|c>>4;let E=(c&15)<<2|f>>6,b=f&63;d||(b=64,l||(E=64)),i.push(t[m],t[v],t[E],t[b])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(GA(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):rM(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const o=t[n.charAt(r++)],c=r<n.length?t[n.charAt(r)]:0;++r;const f=r<n.length?t[n.charAt(r)]:64;++r;const v=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||c==null||f==null||v==null)throw new sM;const E=o<<2|c>>4;if(i.push(E),f!==64){const b=c<<4&240|f>>2;if(i.push(b),v!==64){const I=f<<6&192|v;i.push(I)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class sM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const oM=function(n){const e=GA(n);return qA.encodeByteArray(e,!0)},qh=function(n){return oM(n).replace(/\./g,"")},HA=function(n){try{return qA.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $A(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aM=()=>$A().__FIREBASE_DEFAULTS__,lM=()=>{if(typeof process>"u"||typeof Kb>"u")return;const n=Kb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},uM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&HA(n[1]);return e&&JSON.parse(e)},Ap=()=>{try{return iM()||aM()||lM()||uM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},jA=n=>{var e,t;return(t=(e=Ap())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},cM=n=>{const e=jA(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},KA=()=>{var n;return(n=Ap())==null?void 0:n.config},JA=n=>{var e;return(e=Ap())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Da(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function q_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fM(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[qh(JSON.stringify(t)),qh(JSON.stringify(l)),""].join(".")}const $c={};function hM(){const n={prod:[],emulator:[]};for(const e of Object.keys($c))$c[e]?n.emulator.push(e):n.prod.push(e);return n}function pM(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Jb=!1;function YA(n,e){if(typeof window>"u"||typeof document>"u"||!Da(window.location.host)||$c[n]===e||$c[n]||Jb)return;$c[n]=e;function t(E){return`__firebase__banner__${E}`}const i="__firebase__banner",o=hM().prod.length>0;function l(){const E=document.getElementById(i);E&&E.remove()}function c(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function d(E,b){E.setAttribute("width","24"),E.setAttribute("id",b),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function f(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Jb=!0,l()},E}function m(E,b){E.setAttribute("id",b),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function v(){const E=pM(i),b=t("text"),I=document.getElementById(b)||document.createElement("span"),x=t("learnmore"),A=document.getElementById(x)||document.createElement("a"),N=t("preprendIcon"),U=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const L=E.element;c(L),m(A,x);const $=f();d(U,N),L.append(U,I,A,$),document.body.appendChild(L)}o?(I.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function mM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xn())}function WA(){var e;const n=(e=Ap())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function gM(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function yM(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function _M(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function vM(){const n=xn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function QA(){return!WA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function XA(){return!WA()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ZA(){try{return typeof indexedDB=="object"}catch{return!1}}function EM(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var o;e(((o=r.error)==null?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM="FirebaseError";class ds extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=TM,Object.setPrototypeOf(this,ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sd.prototype.create)}}class Sd{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],l=o?bM(o,i):"Error",c=`${this.serviceName}: ${l} (${r}).`;return new ds(r,c,i)}}function bM(n,e){return n.replace(SM,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const SM=/\{\$([^}]+)}/g;function wM(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ho(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const o=n[r],l=e[r];if(Yb(o)&&Yb(l)){if(!ho(o,l))return!1}else if(o!==l)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function Yb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wd(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Vc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[r,o]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function Uc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function xM(n,e){const t=new AM(n,e);return t.subscribe.bind(t)}class AM{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");IM(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=cy),r.error===void 0&&(r.error=cy),r.complete===void 0&&(r.complete=cy);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function IM(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function cy(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(n){return n&&n._delegate?n._delegate:n}class Sa{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CM{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new dM;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(NM(e))try{this.getOrInitializeService({instanceIdentifier:na})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(e=na){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=na){return this.instances.has(e)}getOptions(e=na){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);i===c&&l.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:RM(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=na){return this.component?this.component.multipleInstances?e:na:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function RM(n){return n===na?void 0:n}function NM(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new CM(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(bt||(bt={}));const MM={debug:bt.DEBUG,verbose:bt.VERBOSE,info:bt.INFO,warn:bt.WARN,error:bt.ERROR,silent:bt.SILENT},DM=bt.INFO,PM={[bt.DEBUG]:"log",[bt.VERBOSE]:"log",[bt.INFO]:"info",[bt.WARN]:"warn",[bt.ERROR]:"error"},OM=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=PM[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class H_{constructor(e){this.name=e,this._logLevel=DM,this._logHandler=OM,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in bt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?MM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,bt.DEBUG,...e),this._logHandler(this,bt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,bt.VERBOSE,...e),this._logHandler(this,bt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,bt.INFO,...e),this._logHandler(this,bt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,bt.WARN,...e),this._logHandler(this,bt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,bt.ERROR,...e),this._logHandler(this,bt.ERROR,...e)}}const VM=(n,e)=>e.some(t=>n instanceof t);let Wb,Qb;function UM(){return Wb||(Wb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function LM(){return Qb||(Qb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const eI=new WeakMap,By=new WeakMap,tI=new WeakMap,dy=new WeakMap,$_=new WeakMap;function BM(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",l)},o=()=>{t(oo(n.result)),r()},l=()=>{i(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&eI.set(t,n)}).catch(()=>{}),$_.set(e,n),e}function FM(n){if(By.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",l),n.removeEventListener("abort",l)},o=()=>{t(),r()},l=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",l),n.addEventListener("abort",l)});By.set(n,e)}let Fy={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return By.get(n);if(e==="objectStoreNames")return n.objectStoreNames||tI.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return oo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function zM(n){Fy=n(Fy)}function GM(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(fy(this),e,...t);return tI.set(i,e.sort?e.sort():[e]),oo(i)}:LM().includes(n)?function(...e){return n.apply(fy(this),e),oo(eI.get(this))}:function(...e){return oo(n.apply(fy(this),e))}}function qM(n){return typeof n=="function"?GM(n):(n instanceof IDBTransaction&&FM(n),VM(n,UM())?new Proxy(n,Fy):n)}function oo(n){if(n instanceof IDBRequest)return BM(n);if(dy.has(n))return dy.get(n);const e=qM(n);return e!==n&&(dy.set(n,e),$_.set(e,n)),e}const fy=n=>$_.get(n);function HM(n,e,{blocked:t,upgrade:i,blocking:r,terminated:o}={}){const l=indexedDB.open(n,e),c=oo(l);return i&&l.addEventListener("upgradeneeded",d=>{i(oo(l.result),d.oldVersion,d.newVersion,oo(l.transaction),d)}),t&&l.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),c.then(d=>{o&&d.addEventListener("close",()=>o()),r&&d.addEventListener("versionchange",f=>r(f.oldVersion,f.newVersion,f))}).catch(()=>{}),c}const $M=["get","getKey","getAll","getAllKeys","count"],jM=["put","add","delete","clear"],hy=new Map;function Xb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(hy.get(e))return hy.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=jM.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||$M.includes(t)))return;const o=async function(l,...c){const d=this.transaction(l,r?"readwrite":"readonly");let f=d.store;return i&&(f=f.index(c.shift())),(await Promise.all([f[t](...c),r&&d.done]))[0]};return hy.set(e,o),o}zM(n=>({...n,get:(e,t,i)=>Xb(e,t)||n.get(e,t,i),has:(e,t)=>!!Xb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(JM(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function JM(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const zy="@firebase/app",Zb="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const os=new H_("@firebase/app"),YM="@firebase/app-compat",WM="@firebase/analytics-compat",QM="@firebase/analytics",XM="@firebase/app-check-compat",ZM="@firebase/app-check",eD="@firebase/auth",tD="@firebase/auth-compat",nD="@firebase/database",iD="@firebase/data-connect",rD="@firebase/database-compat",sD="@firebase/functions",oD="@firebase/functions-compat",aD="@firebase/installations",lD="@firebase/installations-compat",uD="@firebase/messaging",cD="@firebase/messaging-compat",dD="@firebase/performance",fD="@firebase/performance-compat",hD="@firebase/remote-config",pD="@firebase/remote-config-compat",mD="@firebase/storage",gD="@firebase/storage-compat",yD="@firebase/firestore",_D="@firebase/ai",vD="@firebase/firestore-compat",ED="firebase",TD="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gy="[DEFAULT]",bD={[zy]:"fire-core",[YM]:"fire-core-compat",[QM]:"fire-analytics",[WM]:"fire-analytics-compat",[ZM]:"fire-app-check",[XM]:"fire-app-check-compat",[eD]:"fire-auth",[tD]:"fire-auth-compat",[nD]:"fire-rtdb",[iD]:"fire-data-connect",[rD]:"fire-rtdb-compat",[sD]:"fire-fn",[oD]:"fire-fn-compat",[aD]:"fire-iid",[lD]:"fire-iid-compat",[uD]:"fire-fcm",[cD]:"fire-fcm-compat",[dD]:"fire-perf",[fD]:"fire-perf-compat",[hD]:"fire-rc",[pD]:"fire-rc-compat",[mD]:"fire-gcs",[gD]:"fire-gcs-compat",[yD]:"fire-fst",[vD]:"fire-fst-compat",[_D]:"fire-vertex","fire-js":"fire-js",[ED]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rd=new Map,SD=new Map,qy=new Map;function eS(n,e){try{n.container.addComponent(e)}catch(t){os.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Kl(n){const e=n.name;if(qy.has(e))return os.debug(`There were multiple attempts to register component ${e}.`),!1;qy.set(e,n);for(const t of rd.values())eS(t,n);for(const t of SD.values())eS(t,n);return!0}function Ip(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function oi(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ao=new Sd("app","Firebase",wD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Sa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ao.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pu=TD;function nI(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Gy,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw ao.create("bad-app-name",{appName:String(r)});if(t||(t=KA()),!t)throw ao.create("no-options");const o=rd.get(r);if(o){if(ho(t,o.options)&&ho(i,o.config))return o;throw ao.create("duplicate-app",{appName:r})}const l=new kM(r);for(const d of qy.values())l.addComponent(d);const c=new xD(t,i,l);return rd.set(r,c),c}function iI(n=Gy){const e=rd.get(n);if(!e&&n===Gy&&KA())return nI();if(!e)throw ao.create("no-app",{appName:n});return e}function AD(){return Array.from(rd.values())}function lo(n,e,t){let i=bD[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const l=[`Unable to register library "${i}" with version "${e}":`];r&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),os.warn(l.join(" "));return}Kl(new Sa(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID="firebase-heartbeat-database",CD=1,sd="firebase-heartbeat-store";let py=null;function rI(){return py||(py=HM(ID,CD,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(sd)}catch(t){console.warn(t)}}}}).catch(n=>{throw ao.create("idb-open",{originalErrorMessage:n.message})})),py}async function RD(n){try{const t=(await rI()).transaction(sd),i=await t.objectStore(sd).get(sI(n));return await t.done,i}catch(e){if(e instanceof ds)os.warn(e.message);else{const t=ao.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});os.warn(t.message)}}}async function tS(n,e){try{const i=(await rI()).transaction(sd,"readwrite");await i.objectStore(sd).put(e,sI(n)),await i.done}catch(t){if(t instanceof ds)os.warn(t.message);else{const i=ao.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});os.warn(i.message)}}}function sI(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND=1024,kD=30;class MD{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new PD(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=nS();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:r}),this._heartbeatsCache.heartbeats.length>kD){const l=OD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){os.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=nS(),{heartbeatsToSend:i,unsentEntries:r}=DD(this._heartbeatsCache.heartbeats),o=qh(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return os.warn(t),""}}}function nS(){return new Date().toISOString().substring(0,10)}function DD(n,e=ND){const t=[];let i=n.slice();for(const r of n){const o=t.find(l=>l.agent===r.agent);if(o){if(o.dates.push(r.date),iS(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),iS(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class PD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ZA()?EM().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await RD(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return tS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return tS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function iS(n){return qh(JSON.stringify({version:2,heartbeats:n})).length}function OD(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VD(n){Kl(new Sa("platform-logger",e=>new KM(e),"PRIVATE")),Kl(new Sa("heartbeat",e=>new MD(e),"PRIVATE")),lo(zy,Zb,n),lo(zy,Zb,"esm2020"),lo("fire-js","")}VD("");var UD="firebase",LD="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lo(UD,LD,"app");function oI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const BD=oI,aI=new Sd("auth","Firebase",oI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hh=new H_("@firebase/auth");function FD(n,...e){Hh.logLevel<=bt.WARN&&Hh.warn(`Auth (${pu}): ${n}`,...e)}function xh(n,...e){Hh.logLevel<=bt.ERROR&&Hh.error(`Auth (${pu}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bi(n,...e){throw K_(n,...e)}function nr(n,...e){return K_(n,...e)}function j_(n,e,t){const i={...BD(),[e]:t};return new Sd("auth","Firebase",i).create(e,{appName:n.name})}function kr(n){return j_(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lI(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Bi(n,"argument-error"),j_(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function K_(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return aI.create(n,...e)}function ot(n,e,...t){if(!n)throw K_(e,...t)}function ns(n){const e="INTERNAL ASSERTION FAILED: "+n;throw xh(e),new Error(e)}function as(n,e){n||ns(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hy(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function zD(){return rS()==="http:"||rS()==="https:"}function rS(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zD()||yM()||"connection"in navigator)?navigator.onLine:!0}function qD(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,t){this.shortDelay=e,this.longDelay=t,as(t>e,"Short delay should be less than long delay!"),this.isMobile=mM()||_M()}get(){return GD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J_(n,e){as(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ns("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ns("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ns("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],jD=new xd(3e4,6e4);function Eo(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function To(n,e,t,i,r={}){return cI(n,r,async()=>{let o={},l={};i&&(e==="GET"?l=i:o={body:JSON.stringify(i)});const c=wd({key:n.config.apiKey,...l}).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const f={method:e,headers:d,...o};return gM()||(f.referrerPolicy="no-referrer"),n.emulatorConfig&&Da(n.emulatorConfig.host)&&(f.credentials="include"),uI.fetch()(await dI(n,n.config.apiHost,t,c),f)})}async function cI(n,e,t){n._canInitEmulator=!1;const i={...HD,...e};try{const r=new JD(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw ah(n,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const c=o.ok?l.errorMessage:l.error.message,[d,f]=c.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw ah(n,"credential-already-in-use",l);if(d==="EMAIL_EXISTS")throw ah(n,"email-already-in-use",l);if(d==="USER_DISABLED")throw ah(n,"user-disabled",l);const m=i[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw j_(n,m,f);Bi(n,m)}}catch(r){if(r instanceof ds)throw r;Bi(n,"network-request-failed",{message:String(r)})}}async function Ad(n,e,t,i,r={}){const o=await To(n,e,t,i,r);return"mfaPendingCredential"in o&&Bi(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function dI(n,e,t,i){const r=`${e}${t}?${i}`,o=n,l=o.config.emulator?J_(n.config,r):`${n.config.apiScheme}://${r}`;return $D.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function KD(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class JD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(nr(this.auth,"network-request-failed")),jD.get())})}}function ah(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=nr(n,e,i);return r.customData._tokenResponse=t,r}function sS(n){return n!==void 0&&n.enterprise!==void 0}class YD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return KD(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function WD(n,e){return To(n,"GET","/v2/recaptchaConfig",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QD(n,e){return To(n,"POST","/v1/accounts:delete",e)}async function $h(n,e){return To(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function XD(n,e=!1){const t=Dn(n),i=await t.getIdToken(e),r=Y_(i);ot(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const o=typeof r.firebase=="object"?r.firebase:void 0,l=o==null?void 0:o.sign_in_provider;return{claims:r,token:i,authTime:jc(my(r.auth_time)),issuedAtTime:jc(my(r.iat)),expirationTime:jc(my(r.exp)),signInProvider:l||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function my(n){return Number(n)*1e3}function Y_(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return xh("JWT malformed, contained fewer than 3 sections"),null;try{const r=HA(t);return r?JSON.parse(r):(xh("Failed to decode base64 JWT payload"),null)}catch(r){return xh("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function oS(n){const e=Y_(n);return ot(e,"internal-error"),ot(typeof e.exp<"u","internal-error"),ot(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function od(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ds&&ZD(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function ZD({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=jc(this.lastLoginAt),this.creationTime=jc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jh(n){var v;const e=n.auth,t=await n.getIdToken(),i=await od(n,$h(e,{idToken:t}));ot(i==null?void 0:i.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const o=(v=r.providerUserInfo)!=null&&v.length?fI(r.providerUserInfo):[],l=nP(n.providerData,o),c=n.isAnonymous,d=!(n.email&&r.passwordHash)&&!(l!=null&&l.length),f=c?d:!1,m={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:l,metadata:new $y(r.createdAt,r.lastLoginAt),isAnonymous:f};Object.assign(n,m)}async function tP(n){const e=Dn(n);await jh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function nP(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function fI(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iP(n,e){const t=await cI(n,{},async()=>{const i=wd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,l=await dI(n,r,"/v1/token",`key=${o}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:c,body:i};return n.emulatorConfig&&Da(n.emulatorConfig.host)&&(d.credentials="include"),uI.fetch()(l,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function rP(n,e){return To(n,"POST","/v2/accounts:revokeToken",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ot(e.idToken,"internal-error"),ot(typeof e.idToken<"u","internal-error"),ot(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):oS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ot(e.length!==0,"internal-error");const t=oS(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ot(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:o}=await iP(e,t);this.updateTokensAndExpiration(i,r,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:o}=t,l=new Fl;return i&&(ot(typeof i=="string","internal-error",{appName:e}),l.refreshToken=i),r&&(ot(typeof r=="string","internal-error",{appName:e}),l.accessToken=r),o&&(ot(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fl,this.toJSON())}_performRefresh(){return ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(n,e){ot(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class tr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new eP(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new $y(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await od(this,this.stsTokenManager.getToken(this.auth,e));return ot(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return XD(this,e)}reload(){return tP(this)}_assign(e){this!==e&&(ot(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new tr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ot(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await jh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(oi(this.auth.app))return Promise.reject(kr(this.auth));const e=await this.getIdToken();return await od(this,QD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,o=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,d=t._redirectEventId??void 0,f=t.createdAt??void 0,m=t.lastLoginAt??void 0,{uid:v,emailVerified:E,isAnonymous:b,providerData:I,stsTokenManager:x}=t;ot(v&&x,e,"internal-error");const A=Fl.fromJSON(this.name,x);ot(typeof v=="string",e,"internal-error"),Ys(i,e.name),Ys(r,e.name),ot(typeof E=="boolean",e,"internal-error"),ot(typeof b=="boolean",e,"internal-error"),Ys(o,e.name),Ys(l,e.name),Ys(c,e.name),Ys(d,e.name),Ys(f,e.name),Ys(m,e.name);const N=new tr({uid:v,auth:e,email:r,emailVerified:E,displayName:i,isAnonymous:b,photoURL:l,phoneNumber:o,tenantId:c,stsTokenManager:A,createdAt:f,lastLoginAt:m});return I&&Array.isArray(I)&&(N.providerData=I.map(U=>({...U}))),d&&(N._redirectEventId=d),N}static async _fromIdTokenResponse(e,t,i=!1){const r=new Fl;r.updateFromServerResponse(t);const o=new tr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await jh(o),o}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];ot(r.localId!==void 0,"internal-error");const o=r.providerUserInfo!==void 0?fI(r.providerUserInfo):[],l=!(r.email&&r.passwordHash)&&!(o!=null&&o.length),c=new Fl;c.updateFromIdToken(i);const d=new tr({uid:r.localId,auth:e,stsTokenManager:c,isAnonymous:l}),f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new $y(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(o!=null&&o.length)};return Object.assign(d,f),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS=new Map;function is(n){as(n instanceof Function,"Expected a class definition");let e=aS.get(n);return e?(as(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,aS.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}hI.type="NONE";const lS=hI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ah(n,e,t){return`firebase:${n}:${e}:${t}`}class zl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:o}=this.auth;this.fullUserKey=Ah(this.userKey,r.apiKey,o),this.fullPersistenceKey=Ah("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await $h(this.auth,{idToken:e}).catch(()=>{});return t?tr._fromGetAccountInfoResponse(this.auth,t,e):null}return tr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new zl(is(lS),e,i);const r=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let o=r[0]||is(lS);const l=Ah(i,e.config.apiKey,e.name);let c=null;for(const f of t)try{const m=await f._get(l);if(m){let v;if(typeof m=="string"){const E=await $h(e,{idToken:m}).catch(()=>{});if(!E)break;v=await tr._fromGetAccountInfoResponse(e,E,m)}else v=tr._fromJSON(e,m);f!==o&&(c=v),o=f;break}}catch{}const d=r.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new zl(o,e,i):(o=d[0],c&&await o._set(l,c.toJSON()),await Promise.all(t.map(async f=>{if(f!==o)try{await f._remove(l)}catch{}})),new zl(o,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(yI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(pI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(vI(e))return"Blackberry";if(EI(e))return"Webos";if(mI(e))return"Safari";if((e.includes("chrome/")||gI(e))&&!e.includes("edge/"))return"Chrome";if(_I(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function pI(n=xn()){return/firefox\//i.test(n)}function mI(n=xn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function gI(n=xn()){return/crios\//i.test(n)}function yI(n=xn()){return/iemobile/i.test(n)}function _I(n=xn()){return/android/i.test(n)}function vI(n=xn()){return/blackberry/i.test(n)}function EI(n=xn()){return/webos/i.test(n)}function W_(n=xn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function sP(n=xn()){var e;return W_(n)&&!!((e=window.navigator)!=null&&e.standalone)}function oP(){return vM()&&document.documentMode===10}function TI(n=xn()){return W_(n)||_I(n)||EI(n)||vI(n)||/windows phone/i.test(n)||yI(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(n,e=[]){let t;switch(n){case"Browser":t=uS(xn());break;case"Worker":t=`${uS(xn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${pu}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=o=>new Promise((l,c)=>{try{const d=e(o);l(d)}catch(d){c(d)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lP(n,e={}){return To(n,"GET","/v2/passwordPolicy",Eo(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uP=6;class cP{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??uP,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cS(this),this.idTokenSubscription=new cS(this),this.beforeStateQueue=new aP(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=aI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=is(t)),this._initializationPromise=this.queue(async()=>{var i,r,o;if(!this._deleted&&(this.persistenceManager=await zl.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await $h(this,{idToken:e}),i=await tr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(oi(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(o=this.redirectUser)==null?void 0:o._redirectEventId,c=i==null?void 0:i._redirectEventId,d=await this.tryRedirectSignIn(e);(!l||l===c)&&(d!=null&&d.user)&&(i=d.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ot(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await jh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=qD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(oi(this.app))return Promise.reject(kr(this));const t=e?Dn(e):null;return t&&ot(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ot(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return oi(this.app)?Promise.reject(kr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return oi(this.app)?Promise.reject(kr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(is(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await lP(this),t=new cP(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Sd("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await rP(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&is(e)||this._popupRedirectResolver;ot(t,this,"argument-error"),this.redirectPersistenceManager=await zl.create(this,[is(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ot(c,this,"internal-error"),c.then(()=>{l||o(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,i,r);return()=>{l=!0,d()}}else{const d=e.addObserver(t);return()=>{l=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ot(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(oi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&FD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function fs(n){return Dn(n)}class cS{constructor(e){this.auth=e,this.observer=null,this.addObserver=xM(t=>this.observer=t)}get next(){return ot(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function fP(n){Cp=n}function SI(n){return Cp.loadJS(n)}function hP(){return Cp.recaptchaEnterpriseScript}function pP(){return Cp.gapiScript}function mP(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class gP{constructor(){this.enterprise=new yP}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class yP{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const _P="recaptcha-enterprise",wI="NO_RECAPTCHA";class vP{constructor(e){this.type=_P,this.auth=fs(e)}async verify(e="verify",t=!1){async function i(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,c)=>{WD(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const f=new YD(d);return o.tenantId==null?o._agentRecaptchaConfig=f:o._tenantRecaptchaConfigs[o.tenantId]=f,l(f.siteKey)}}).catch(d=>{c(d)})})}function r(o,l,c){const d=window.grecaptcha;sS(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:e}).then(f=>{l(f)}).catch(()=>{l(wI)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new gP().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{i(this.auth).then(c=>{if(!t&&sS(window.grecaptcha))r(c,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let d=hP();d.length!==0&&(d+=c),SI(d).then(()=>{r(c,o,l)}).catch(f=>{l(f)})}}).catch(c=>{l(c)})})}}async function dS(n,e,t,i=!1,r=!1){const o=new vP(n);let l;if(r)l=wI;else try{l=await o.verify(t)}catch{l=await o.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const d=c.phoneEnrollmentInfo.phoneNumber,f=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const d=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return i?Object.assign(c,{captchaResp:l}):Object.assign(c,{captchaResponse:l}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function fS(n,e,t,i,r){var o;if((o=n._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await dS(n,e,t,t==="getOobCode");return i(n,l)}else return i(n,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await dS(n,e,t,t==="getOobCode");return i(n,c)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EP(n,e){const t=Ip(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),o=t.getOptions();if(ho(o,e??{}))return r;Bi(r,"already-initialized")}return t.initialize({options:e})}function TP(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(is);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function bP(n,e,t){const i=fs(n);ot(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,o=xI(e),{host:l,port:c}=SP(e),d=c===null?"":`:${c}`,f={url:`${o}//${l}${d}/`},m=Object.freeze({host:l,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){ot(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),ot(ho(f,i.config.emulator)&&ho(m,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=f,i.emulatorConfig=m,i.settings.appVerificationDisabledForTesting=!0,Da(l)?(q_(`${o}//${l}${d}`),YA("Auth",!0)):wP()}function xI(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function SP(n){const e=xI(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const o=r[1];return{host:o,port:hS(i.substr(o.length+1))}}else{const[o,l]=i.split(":");return{host:o,port:hS(l)}}}function hS(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function wP(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ns("not implemented")}_getIdTokenResponse(e){return ns("not implemented")}_linkToIdToken(e,t){return ns("not implemented")}_getReauthenticationResolver(e){return ns("not implemented")}}async function xP(n,e){return To(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AP(n,e){return Ad(n,"POST","/v1/accounts:signInWithPassword",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IP(n,e){return Ad(n,"POST","/v1/accounts:signInWithEmailLink",Eo(n,e))}async function CP(n,e){return Ad(n,"POST","/v1/accounts:signInWithEmailLink",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad extends Q_{constructor(e,t,i,r=null){super("password",i),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new ad(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new ad(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return fS(e,t,"signInWithPassword",AP);case"emailLink":return IP(e,{email:this._email,oobCode:this._password});default:Bi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return fS(e,i,"signUpPassword",xP);case"emailLink":return CP(e,{idToken:t,email:this._email,oobCode:this._password});default:Bi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gl(n,e){return Ad(n,"POST","/v1/accounts:signInWithIdp",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP="http://localhost";class wa extends Q_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new wa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Bi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...o}=t;if(!i||!r)return null;const l=new wa(i,r);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Gl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Gl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Gl(e,t)}buildRequest(){const e={requestUri:RP,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=wd(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NP(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function kP(n){const e=Vc(Uc(n)).link,t=e?Vc(Uc(e)).deep_link_id:null,i=Vc(Uc(n)).deep_link_id;return(i?Vc(Uc(i)).link:null)||i||t||e||n}class X_{constructor(e){const t=Vc(Uc(e)),i=t.apiKey??null,r=t.oobCode??null,o=NP(t.mode??null);ot(i&&r&&o,"argument-error"),this.apiKey=i,this.operation=o,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=kP(e);try{return new X_(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(){this.providerId=mu.PROVIDER_ID}static credential(e,t){return ad._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=X_.parseLink(t);return ot(i,"argument-error"),ad._fromEmailAndCode(e,i.code,i.tenantId)}}mu.PROVIDER_ID="password";mu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";mu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id extends Rp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs extends Id{constructor(){super("facebook.com")}static credential(e){return wa._fromParams({providerId:Zs.PROVIDER_ID,signInMethod:Zs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zs.credentialFromTaggedObject(e)}static credentialFromError(e){return Zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zs.credential(e.oauthAccessToken)}catch{return null}}}Zs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends Id{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return wa._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return ts.credential(t,i)}catch{return null}}}ts.GOOGLE_SIGN_IN_METHOD="google.com";ts.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo extends Id{constructor(){super("github.com")}static credential(e){return wa._fromParams({providerId:eo.PROVIDER_ID,signInMethod:eo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return eo.credentialFromTaggedObject(e)}static credentialFromError(e){return eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return eo.credential(e.oauthAccessToken)}catch{return null}}}eo.GITHUB_SIGN_IN_METHOD="github.com";eo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to extends Id{constructor(){super("twitter.com")}static credential(e,t){return wa._fromParams({providerId:to.PROVIDER_ID,signInMethod:to.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return to.credentialFromTaggedObject(e)}static credentialFromError(e){return to.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return to.credential(t,i)}catch{return null}}}to.TWITTER_SIGN_IN_METHOD="twitter.com";to.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MP(n,e){return Ad(n,"POST","/v1/accounts:signUp",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const o=await tr._fromIdTokenResponse(e,i,r),l=pS(i);return new po({user:o,providerId:l,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=pS(i);return new po({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function pS(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DP(n){var r;if(oi(n.app))return Promise.reject(kr(n));const e=fs(n);if(await e._initializationPromise,(r=e.currentUser)!=null&&r.isAnonymous)return new po({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await MP(e,{returnSecureToken:!0}),i=await po._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh extends ds{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Kh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Kh(e,t,i,r)}}function AI(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Kh._fromErrorAndOperation(n,o,e,i):o})}async function PP(n,e,t=!1){const i=await od(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return po._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OP(n,e,t=!1){const{auth:i}=n;if(oi(i.app))return Promise.reject(kr(i));const r="reauthenticate";try{const o=await od(n,AI(i,r,e,n),t);ot(o.idToken,i,"internal-error");const l=Y_(o.idToken);ot(l,i,"internal-error");const{sub:c}=l;return ot(n.uid===c,i,"user-mismatch"),po._forOperation(n,r,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Bi(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function II(n,e,t=!1){if(oi(n.app))return Promise.reject(kr(n));const i="signIn",r=await AI(n,i,e),o=await po._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(o.user),o}async function VP(n,e){return II(fs(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UP(n){const e=fs(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function LP(n,e,t){return oi(n.app)?Promise.reject(kr(n)):VP(Dn(n),mu.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&UP(n),i})}function BP(n,e,t,i){return Dn(n).onIdTokenChanged(e,t,i)}function FP(n,e,t){return Dn(n).beforeAuthStateChanged(e,t)}function zP(n,e,t,i){return Dn(n).onAuthStateChanged(e,t,i)}const Jh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Jh,"1"),this.storage.removeItem(Jh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP=1e3,qP=10;class RI extends CI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=TI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,d)=>{this.notifyListeners(l,d)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const l=this.storage.getItem(i);!t&&this.localCache[i]===l||this.notifyListeners(i,l)},o=this.storage.getItem(i);oP()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,qP):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},GP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}RI.type="LOCAL";const HP=RI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI extends CI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}NI.type="SESSION";const kI=NI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $P(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Np(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:o}=t.data,l=this.handlersMap[r];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const c=Array.from(l).map(async f=>f(t.origin,o)),d=await $P(c);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Np.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z_(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,l;return new Promise((c,d)=>{const f=Z_("",20);r.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},i);l={messageChannel:r,onMessage(v){const E=v;if(E.data.eventId===f)switch(E.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(E.data.response);break;default:clearTimeout(m),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(l),r.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[r.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(){return window}function KP(n){Mr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MI(){return typeof Mr().WorkerGlobalScope<"u"&&typeof Mr().importScripts=="function"}async function JP(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function YP(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function WP(){return MI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI="firebaseLocalStorageDb",QP=1,Yh="firebaseLocalStorage",PI="fbase_key";class Cd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function kp(n,e){return n.transaction([Yh],e?"readwrite":"readonly").objectStore(Yh)}function XP(){const n=indexedDB.deleteDatabase(DI);return new Cd(n).toPromise()}function jy(){const n=indexedDB.open(DI,QP);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Yh,{keyPath:PI})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Yh)?e(i):(i.close(),await XP(),e(await jy()))})})}async function mS(n,e,t){const i=kp(n,!0).put({[PI]:e,value:t});return new Cd(i).toPromise()}async function ZP(n,e){const t=kp(n,!1).get(e),i=await new Cd(t).toPromise();return i===void 0?null:i.value}function gS(n,e){const t=kp(n,!0).delete(e);return new Cd(t).toPromise()}const eO=800,tO=3;class OI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await jy(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>tO)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return MI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Np._getInstance(WP()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await JP(),!this.activeServiceWorker)return;this.sender=new jP(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||YP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jy();return await mS(e,Jh,"1"),await gS(e,Jh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>mS(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>ZP(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>gS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const o=kp(r,!1).getAll();return new Cd(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:o}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(o)&&(this.notifyListeners(r,o),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),eO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}OI.type="LOCAL";const nO=OI;new xd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(n,e){return e?is(e):(ot(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv extends Q_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Gl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Gl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function iO(n){return II(n.auth,new tv(n),n.bypassAuthState)}function rO(n){const{auth:e,user:t}=n;return ot(t,e,"internal-error"),OP(t,new tv(n),n.bypassAuthState)}async function sO(n){const{auth:e,user:t}=n;return ot(t,e,"internal-error"),PP(t,new tv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e,t,i,r,o=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:o,error:l,type:c}=e;if(l){this.reject(l);return}const d={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(d))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return iO;case"linkViaPopup":case"linkViaRedirect":return sO;case"reauthViaPopup":case"reauthViaRedirect":return rO;default:Bi(this.auth,"internal-error")}}resolve(e){as(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){as(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO=new xd(2e3,1e4);async function aO(n,e,t){if(oi(n.app))return Promise.reject(nr(n,"operation-not-supported-in-this-environment"));const i=fs(n);lI(n,e,Rp);const r=ev(i,t);return new fa(i,"signInViaPopup",e,r).executeNotNull()}class fa extends VI{constructor(e,t,i,r,o){super(e,t,r,o),this.provider=i,this.authWindow=null,this.pollId=null,fa.currentPopupAction&&fa.currentPopupAction.cancel(),fa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ot(e,this.auth,"internal-error"),e}async onExecution(){as(this.filter.length===1,"Popup operations only handle one event");const e=Z_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(nr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(nr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(nr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,oO.get())};e()}}fa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO="pendingRedirect",Ih=new Map;class uO extends VI{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Ih.get(this.auth._key());if(!e){try{const i=await cO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Ih.set(this.auth._key(),e)}return this.bypassAuthState||Ih.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function cO(n,e){const t=LI(e),i=UI(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}async function dO(n,e){return UI(n)._set(LI(e),"true")}function fO(n,e){Ih.set(n._key(),e)}function UI(n){return is(n._redirectPersistence)}function LI(n){return Ah(lO,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hO(n,e,t){return pO(n,e,t)}async function pO(n,e,t){if(oi(n.app))return Promise.reject(kr(n));const i=fs(n);lI(n,e,Rp),await i._initializationPromise;const r=ev(i,t);return await dO(r,i),r._openRedirect(i,e,"signInViaRedirect")}async function mO(n,e,t=!1){if(oi(n.app))return Promise.reject(kr(n));const i=fs(n),r=ev(i,e),l=await new uO(i,r,t).execute();return l&&!t&&(delete l.user._redirectEventId,await i._persistUserIfCurrent(l.user),await i._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gO=600*1e3;class yO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!_O(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!BI(e)){const r=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(nr(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=gO&&this.cachedEventUids.clear(),this.cachedEventUids.has(yS(e))}saveEventToCache(e){this.cachedEventUids.add(yS(e)),this.lastProcessedEventTime=Date.now()}}function yS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function BI({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function _O(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return BI(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vO(n,e={}){return To(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,TO=/^https?/;async function bO(n){if(n.config.emulator)return;const{authorizedDomains:e}=await vO(n);for(const t of e)try{if(SO(t))return}catch{}Bi(n,"unauthorized-domain")}function SO(n){const e=Hy(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===i}if(!TO.test(t))return!1;if(EO.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wO=new xd(3e4,6e4);function _S(){const n=Mr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function xO(n){return new Promise((e,t)=>{var r,o,l;function i(){_S(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_S(),t(nr(n,"network-request-failed"))},timeout:wO.get()})}if((o=(r=Mr().gapi)==null?void 0:r.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((l=Mr().gapi)!=null&&l.load)i();else{const c=mP("iframefcb");return Mr()[c]=()=>{gapi.load?i():t(nr(n,"network-request-failed"))},SI(`${pP()}?onload=${c}`).catch(d=>t(d))}}).catch(e=>{throw Ch=null,e})}let Ch=null;function AO(n){return Ch=Ch||xO(n),Ch}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO=new xd(5e3,15e3),CO="__/auth/iframe",RO="emulator/auth/iframe",NO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function MO(n){const e=n.config;ot(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?J_(e,RO):`https://${n.config.authDomain}/${CO}`,i={apiKey:e.apiKey,appName:n.name,v:pu},r=kO.get(n.config.apiHost);r&&(i.eid=r);const o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${wd(i).slice(1)}`}async function DO(n){const e=await AO(n),t=Mr().gapi;return ot(t,n,"internal-error"),e.open({where:document.body,url:MO(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:NO,dontclear:!0},i=>new Promise(async(r,o)=>{await i.restyle({setHideOnLeave:!1});const l=nr(n,"network-request-failed"),c=Mr().setTimeout(()=>{o(l)},IO.get());function d(){Mr().clearTimeout(c),r(i)}i.ping(d).then(d,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},OO=500,VO=600,UO="_blank",LO="http://localhost";class vS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function BO(n,e,t,i=OO,r=VO){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),l=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const d={...PO,width:i.toString(),height:r.toString(),top:o,left:l},f=xn().toLowerCase();t&&(c=gI(f)?UO:t),pI(f)&&(e=e||LO,d.scrollbars="yes");const m=Object.entries(d).reduce((E,[b,I])=>`${E}${b}=${I},`,"");if(sP(f)&&c!=="_self")return FO(e||"",c),new vS(null);const v=window.open(e||"",c,m);ot(v,n,"popup-blocked");try{v.focus()}catch{}return new vS(v)}function FO(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zO="__/auth/handler",GO="emulator/auth/handler",qO=encodeURIComponent("fac");async function ES(n,e,t,i,r,o){ot(n.config.authDomain,n,"auth-domain-config-required"),ot(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:pu,eventId:r};if(e instanceof Rp){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",wM(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,v]of Object.entries({}))l[m]=v}if(e instanceof Id){const m=e.getScopes().filter(v=>v!=="");m.length>0&&(l.scopes=m.join(","))}n.tenantId&&(l.tid=n.tenantId);const c=l;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const d=await n._getAppCheckToken(),f=d?`#${qO}=${encodeURIComponent(d)}`:"";return`${HO(n)}?${wd(c).slice(1)}${f}`}function HO({config:n}){return n.emulator?J_(n,GO):`https://${n.authDomain}/${zO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy="webStorageSupport";class $O{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kI,this._completeRedirectFn=mO,this._overrideRedirectResult=fO}async _openPopup(e,t,i,r){var l;as((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const o=await ES(e,t,i,Hy(),r);return BO(e,o,Z_())}async _openRedirect(e,t,i,r){await this._originValidation(e);const o=await ES(e,t,i,Hy(),r);return KP(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(as(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await DO(e),i=new yO(e);return t.register("authEvent",r=>(ot(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(gy,{type:gy},r=>{var l;const o=(l=r==null?void 0:r[0])==null?void 0:l[gy];o!==void 0&&t(!!o),Bi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=bO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return TI()||mI()||W_()}}const jO=$O;var TS="@firebase/auth",bS="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ot(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JO(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function YO(n){Kl(new Sa("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=i.options;ot(l&&!l.includes(":"),"invalid-api-key",{appName:i.name});const d={apiKey:l,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bI(n)},f=new dP(i,r,o,d);return TP(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Kl(new Sa("auth-internal",e=>{const t=fs(e.getProvider("auth").getImmediate());return(i=>new KO(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),lo(TS,bS,JO(n)),lo(TS,bS,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO=300,QO=JA("authIdTokenMaxAge")||WO;let SS=null;const XO=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>QO)return;const r=t==null?void 0:t.token;SS!==r&&(SS=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function ZO(n=iI()){const e=Ip(n,"auth");if(e.isInitialized())return e.getImmediate();const t=EP(n,{popupRedirectResolver:jO,persistence:[nO,HP,kI]}),i=JA("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const l=XO(o.toString());FP(t,l,()=>l(t.currentUser)),BP(t,c=>l(c))}}const r=jA("auth");return r&&bP(t,`http://${r}`),t}function eV(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}fP({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const o=nr("internal-error");o.customData=r,t(o)},i.type="text/javascript",i.charset="UTF-8",eV().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});YO("Browser");var wS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uo,FI;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,V){function D(){}D.prototype=V.prototype,k.F=V.prototype,k.prototype=new D,k.prototype.constructor=k,k.D=function(z,G,M){for(var B=Array(arguments.length-2),O=2;O<arguments.length;O++)B[O-2]=arguments[O];return V.prototype[G].apply(z,B)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,V,D){D||(D=0);const z=Array(16);if(typeof V=="string")for(var G=0;G<16;++G)z[G]=V.charCodeAt(D++)|V.charCodeAt(D++)<<8|V.charCodeAt(D++)<<16|V.charCodeAt(D++)<<24;else for(G=0;G<16;++G)z[G]=V[D++]|V[D++]<<8|V[D++]<<16|V[D++]<<24;V=k.g[0],D=k.g[1],G=k.g[2];let M=k.g[3],B;B=V+(M^D&(G^M))+z[0]+3614090360&4294967295,V=D+(B<<7&4294967295|B>>>25),B=M+(G^V&(D^G))+z[1]+3905402710&4294967295,M=V+(B<<12&4294967295|B>>>20),B=G+(D^M&(V^D))+z[2]+606105819&4294967295,G=M+(B<<17&4294967295|B>>>15),B=D+(V^G&(M^V))+z[3]+3250441966&4294967295,D=G+(B<<22&4294967295|B>>>10),B=V+(M^D&(G^M))+z[4]+4118548399&4294967295,V=D+(B<<7&4294967295|B>>>25),B=M+(G^V&(D^G))+z[5]+1200080426&4294967295,M=V+(B<<12&4294967295|B>>>20),B=G+(D^M&(V^D))+z[6]+2821735955&4294967295,G=M+(B<<17&4294967295|B>>>15),B=D+(V^G&(M^V))+z[7]+4249261313&4294967295,D=G+(B<<22&4294967295|B>>>10),B=V+(M^D&(G^M))+z[8]+1770035416&4294967295,V=D+(B<<7&4294967295|B>>>25),B=M+(G^V&(D^G))+z[9]+2336552879&4294967295,M=V+(B<<12&4294967295|B>>>20),B=G+(D^M&(V^D))+z[10]+4294925233&4294967295,G=M+(B<<17&4294967295|B>>>15),B=D+(V^G&(M^V))+z[11]+2304563134&4294967295,D=G+(B<<22&4294967295|B>>>10),B=V+(M^D&(G^M))+z[12]+1804603682&4294967295,V=D+(B<<7&4294967295|B>>>25),B=M+(G^V&(D^G))+z[13]+4254626195&4294967295,M=V+(B<<12&4294967295|B>>>20),B=G+(D^M&(V^D))+z[14]+2792965006&4294967295,G=M+(B<<17&4294967295|B>>>15),B=D+(V^G&(M^V))+z[15]+1236535329&4294967295,D=G+(B<<22&4294967295|B>>>10),B=V+(G^M&(D^G))+z[1]+4129170786&4294967295,V=D+(B<<5&4294967295|B>>>27),B=M+(D^G&(V^D))+z[6]+3225465664&4294967295,M=V+(B<<9&4294967295|B>>>23),B=G+(V^D&(M^V))+z[11]+643717713&4294967295,G=M+(B<<14&4294967295|B>>>18),B=D+(M^V&(G^M))+z[0]+3921069994&4294967295,D=G+(B<<20&4294967295|B>>>12),B=V+(G^M&(D^G))+z[5]+3593408605&4294967295,V=D+(B<<5&4294967295|B>>>27),B=M+(D^G&(V^D))+z[10]+38016083&4294967295,M=V+(B<<9&4294967295|B>>>23),B=G+(V^D&(M^V))+z[15]+3634488961&4294967295,G=M+(B<<14&4294967295|B>>>18),B=D+(M^V&(G^M))+z[4]+3889429448&4294967295,D=G+(B<<20&4294967295|B>>>12),B=V+(G^M&(D^G))+z[9]+568446438&4294967295,V=D+(B<<5&4294967295|B>>>27),B=M+(D^G&(V^D))+z[14]+3275163606&4294967295,M=V+(B<<9&4294967295|B>>>23),B=G+(V^D&(M^V))+z[3]+4107603335&4294967295,G=M+(B<<14&4294967295|B>>>18),B=D+(M^V&(G^M))+z[8]+1163531501&4294967295,D=G+(B<<20&4294967295|B>>>12),B=V+(G^M&(D^G))+z[13]+2850285829&4294967295,V=D+(B<<5&4294967295|B>>>27),B=M+(D^G&(V^D))+z[2]+4243563512&4294967295,M=V+(B<<9&4294967295|B>>>23),B=G+(V^D&(M^V))+z[7]+1735328473&4294967295,G=M+(B<<14&4294967295|B>>>18),B=D+(M^V&(G^M))+z[12]+2368359562&4294967295,D=G+(B<<20&4294967295|B>>>12),B=V+(D^G^M)+z[5]+4294588738&4294967295,V=D+(B<<4&4294967295|B>>>28),B=M+(V^D^G)+z[8]+2272392833&4294967295,M=V+(B<<11&4294967295|B>>>21),B=G+(M^V^D)+z[11]+1839030562&4294967295,G=M+(B<<16&4294967295|B>>>16),B=D+(G^M^V)+z[14]+4259657740&4294967295,D=G+(B<<23&4294967295|B>>>9),B=V+(D^G^M)+z[1]+2763975236&4294967295,V=D+(B<<4&4294967295|B>>>28),B=M+(V^D^G)+z[4]+1272893353&4294967295,M=V+(B<<11&4294967295|B>>>21),B=G+(M^V^D)+z[7]+4139469664&4294967295,G=M+(B<<16&4294967295|B>>>16),B=D+(G^M^V)+z[10]+3200236656&4294967295,D=G+(B<<23&4294967295|B>>>9),B=V+(D^G^M)+z[13]+681279174&4294967295,V=D+(B<<4&4294967295|B>>>28),B=M+(V^D^G)+z[0]+3936430074&4294967295,M=V+(B<<11&4294967295|B>>>21),B=G+(M^V^D)+z[3]+3572445317&4294967295,G=M+(B<<16&4294967295|B>>>16),B=D+(G^M^V)+z[6]+76029189&4294967295,D=G+(B<<23&4294967295|B>>>9),B=V+(D^G^M)+z[9]+3654602809&4294967295,V=D+(B<<4&4294967295|B>>>28),B=M+(V^D^G)+z[12]+3873151461&4294967295,M=V+(B<<11&4294967295|B>>>21),B=G+(M^V^D)+z[15]+530742520&4294967295,G=M+(B<<16&4294967295|B>>>16),B=D+(G^M^V)+z[2]+3299628645&4294967295,D=G+(B<<23&4294967295|B>>>9),B=V+(G^(D|~M))+z[0]+4096336452&4294967295,V=D+(B<<6&4294967295|B>>>26),B=M+(D^(V|~G))+z[7]+1126891415&4294967295,M=V+(B<<10&4294967295|B>>>22),B=G+(V^(M|~D))+z[14]+2878612391&4294967295,G=M+(B<<15&4294967295|B>>>17),B=D+(M^(G|~V))+z[5]+4237533241&4294967295,D=G+(B<<21&4294967295|B>>>11),B=V+(G^(D|~M))+z[12]+1700485571&4294967295,V=D+(B<<6&4294967295|B>>>26),B=M+(D^(V|~G))+z[3]+2399980690&4294967295,M=V+(B<<10&4294967295|B>>>22),B=G+(V^(M|~D))+z[10]+4293915773&4294967295,G=M+(B<<15&4294967295|B>>>17),B=D+(M^(G|~V))+z[1]+2240044497&4294967295,D=G+(B<<21&4294967295|B>>>11),B=V+(G^(D|~M))+z[8]+1873313359&4294967295,V=D+(B<<6&4294967295|B>>>26),B=M+(D^(V|~G))+z[15]+4264355552&4294967295,M=V+(B<<10&4294967295|B>>>22),B=G+(V^(M|~D))+z[6]+2734768916&4294967295,G=M+(B<<15&4294967295|B>>>17),B=D+(M^(G|~V))+z[13]+1309151649&4294967295,D=G+(B<<21&4294967295|B>>>11),B=V+(G^(D|~M))+z[4]+4149444226&4294967295,V=D+(B<<6&4294967295|B>>>26),B=M+(D^(V|~G))+z[11]+3174756917&4294967295,M=V+(B<<10&4294967295|B>>>22),B=G+(V^(M|~D))+z[2]+718787259&4294967295,G=M+(B<<15&4294967295|B>>>17),B=D+(M^(G|~V))+z[9]+3951481745&4294967295,k.g[0]=k.g[0]+V&4294967295,k.g[1]=k.g[1]+(G+(B<<21&4294967295|B>>>11))&4294967295,k.g[2]=k.g[2]+G&4294967295,k.g[3]=k.g[3]+M&4294967295}i.prototype.v=function(k,V){V===void 0&&(V=k.length);const D=V-this.blockSize,z=this.C;let G=this.h,M=0;for(;M<V;){if(G==0)for(;M<=D;)r(this,k,M),M+=this.blockSize;if(typeof k=="string"){for(;M<V;)if(z[G++]=k.charCodeAt(M++),G==this.blockSize){r(this,z),G=0;break}}else for(;M<V;)if(z[G++]=k[M++],G==this.blockSize){r(this,z),G=0;break}}this.h=G,this.o+=V},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var V=1;V<k.length-8;++V)k[V]=0;V=this.o*8;for(var D=k.length-8;D<k.length;++D)k[D]=V&255,V/=256;for(this.v(k),k=Array(16),V=0,D=0;D<4;++D)for(let z=0;z<32;z+=8)k[V++]=this.g[D]>>>z&255;return k};function o(k,V){var D=c;return Object.prototype.hasOwnProperty.call(D,k)?D[k]:D[k]=V(k)}function l(k,V){this.h=V;const D=[];let z=!0;for(let G=k.length-1;G>=0;G--){const M=k[G]|0;z&&M==V||(D[G]=M,z=!1)}this.g=D}var c={};function d(k){return-128<=k&&k<128?o(k,function(V){return new l([V|0],V<0?-1:0)}):new l([k|0],k<0?-1:0)}function f(k){if(isNaN(k)||!isFinite(k))return v;if(k<0)return A(f(-k));const V=[];let D=1;for(let z=0;k>=D;z++)V[z]=k/D|0,D*=4294967296;return new l(V,0)}function m(k,V){if(k.length==0)throw Error("number format error: empty string");if(V=V||10,V<2||36<V)throw Error("radix out of range: "+V);if(k.charAt(0)=="-")return A(m(k.substring(1),V));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=f(Math.pow(V,8));let z=v;for(let M=0;M<k.length;M+=8){var G=Math.min(8,k.length-M);const B=parseInt(k.substring(M,M+G),V);G<8?(G=f(Math.pow(V,G)),z=z.j(G).add(f(B))):(z=z.j(D),z=z.add(f(B)))}return z}var v=d(0),E=d(1),b=d(16777216);n=l.prototype,n.m=function(){if(x(this))return-A(this).m();let k=0,V=1;for(let D=0;D<this.g.length;D++){const z=this.i(D);k+=(z>=0?z:4294967296+z)*V,V*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(I(this))return"0";if(x(this))return"-"+A(this).toString(k);const V=f(Math.pow(k,6));var D=this;let z="";for(;;){const G=$(D,V).g;D=N(D,G.j(V));let M=((D.g.length>0?D.g[0]:D.h)>>>0).toString(k);if(D=G,I(D))return M+z;for(;M.length<6;)M="0"+M;z=M+z}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function I(k){if(k.h!=0)return!1;for(let V=0;V<k.g.length;V++)if(k.g[V]!=0)return!1;return!0}function x(k){return k.h==-1}n.l=function(k){return k=N(this,k),x(k)?-1:I(k)?0:1};function A(k){const V=k.g.length,D=[];for(let z=0;z<V;z++)D[z]=~k.g[z];return new l(D,~k.h).add(E)}n.abs=function(){return x(this)?A(this):this},n.add=function(k){const V=Math.max(this.g.length,k.g.length),D=[];let z=0;for(let G=0;G<=V;G++){let M=z+(this.i(G)&65535)+(k.i(G)&65535),B=(M>>>16)+(this.i(G)>>>16)+(k.i(G)>>>16);z=B>>>16,M&=65535,B&=65535,D[G]=B<<16|M}return new l(D,D[D.length-1]&-2147483648?-1:0)};function N(k,V){return k.add(A(V))}n.j=function(k){if(I(this)||I(k))return v;if(x(this))return x(k)?A(this).j(A(k)):A(A(this).j(k));if(x(k))return A(this.j(A(k)));if(this.l(b)<0&&k.l(b)<0)return f(this.m()*k.m());const V=this.g.length+k.g.length,D=[];for(var z=0;z<2*V;z++)D[z]=0;for(z=0;z<this.g.length;z++)for(let G=0;G<k.g.length;G++){const M=this.i(z)>>>16,B=this.i(z)&65535,O=k.i(G)>>>16,oe=k.i(G)&65535;D[2*z+2*G]+=B*oe,U(D,2*z+2*G),D[2*z+2*G+1]+=M*oe,U(D,2*z+2*G+1),D[2*z+2*G+1]+=B*O,U(D,2*z+2*G+1),D[2*z+2*G+2]+=M*O,U(D,2*z+2*G+2)}for(k=0;k<V;k++)D[k]=D[2*k+1]<<16|D[2*k];for(k=V;k<2*V;k++)D[k]=0;return new l(D,0)};function U(k,V){for(;(k[V]&65535)!=k[V];)k[V+1]+=k[V]>>>16,k[V]&=65535,V++}function L(k,V){this.g=k,this.h=V}function $(k,V){if(I(V))throw Error("division by zero");if(I(k))return new L(v,v);if(x(k))return V=$(A(k),V),new L(A(V.g),A(V.h));if(x(V))return V=$(k,A(V)),new L(A(V.g),V.h);if(k.g.length>30){if(x(k)||x(V))throw Error("slowDivide_ only works with positive integers.");for(var D=E,z=V;z.l(k)<=0;)D=K(D),z=K(z);var G=j(D,1),M=j(z,1);for(z=j(z,2),D=j(D,2);!I(z);){var B=M.add(z);B.l(k)<=0&&(G=G.add(D),M=B),z=j(z,1),D=j(D,1)}return V=N(k,G.j(V)),new L(G,V)}for(G=v;k.l(V)>=0;){for(D=Math.max(1,Math.floor(k.m()/V.m())),z=Math.ceil(Math.log(D)/Math.LN2),z=z<=48?1:Math.pow(2,z-48),M=f(D),B=M.j(V);x(B)||B.l(k)>0;)D-=z,M=f(D),B=M.j(V);I(M)&&(M=E),G=G.add(M),k=N(k,B)}return new L(G,k)}n.B=function(k){return $(this,k).h},n.and=function(k){const V=Math.max(this.g.length,k.g.length),D=[];for(let z=0;z<V;z++)D[z]=this.i(z)&k.i(z);return new l(D,this.h&k.h)},n.or=function(k){const V=Math.max(this.g.length,k.g.length),D=[];for(let z=0;z<V;z++)D[z]=this.i(z)|k.i(z);return new l(D,this.h|k.h)},n.xor=function(k){const V=Math.max(this.g.length,k.g.length),D=[];for(let z=0;z<V;z++)D[z]=this.i(z)^k.i(z);return new l(D,this.h^k.h)};function K(k){const V=k.g.length+1,D=[];for(let z=0;z<V;z++)D[z]=k.i(z)<<1|k.i(z-1)>>>31;return new l(D,k.h)}function j(k,V){const D=V>>5;V%=32;const z=k.g.length-D,G=[];for(let M=0;M<z;M++)G[M]=V>0?k.i(M+D)>>>V|k.i(M+D+1)<<32-V:k.i(M+D);return new l(G,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,FI=i,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=f,l.fromString=m,uo=l}).apply(typeof wS<"u"?wS:typeof self<"u"?self:typeof window<"u"?window:{});var lh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zI,Lc,GI,Rh,Ky,qI,HI,$I;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof lh=="object"&&lh];for(var w=0;w<y.length;++w){var P=y[w];if(P&&P.Math==Math)return P}throw Error("Cannot find global object")}var i=t(this);function r(y,w){if(w)e:{var P=i;y=y.split(".");for(var H=0;H<y.length-1;H++){var fe=y[H];if(!(fe in P))break e;P=P[fe]}y=y[y.length-1],H=P[y],w=w(H),w!=H&&w!=null&&e(P,y,{configurable:!0,writable:!0,value:w})}}r("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(y){return y||function(w){var P=[],H;for(H in w)Object.prototype.hasOwnProperty.call(w,H)&&P.push([H,w[H]]);return P}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(y){var w=typeof y;return w=="object"&&y!=null||w=="function"}function d(y,w,P){return y.call.apply(y.bind,arguments)}function f(y,w,P){return f=d,f.apply(null,arguments)}function m(y,w){var P=Array.prototype.slice.call(arguments,1);return function(){var H=P.slice();return H.push.apply(H,arguments),y.apply(this,H)}}function v(y,w){function P(){}P.prototype=w.prototype,y.Z=w.prototype,y.prototype=new P,y.prototype.constructor=y,y.Ob=function(H,fe,ve){for(var Le=Array(arguments.length-2),ft=2;ft<arguments.length;ft++)Le[ft-2]=arguments[ft];return w.prototype[fe].apply(H,Le)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function b(y){const w=y.length;if(w>0){const P=Array(w);for(let H=0;H<w;H++)P[H]=y[H];return P}return[]}function I(y,w){for(let H=1;H<arguments.length;H++){const fe=arguments[H];var P=typeof fe;if(P=P!="object"?P:fe?Array.isArray(fe)?"array":P:"null",P=="array"||P=="object"&&typeof fe.length=="number"){P=y.length||0;const ve=fe.length||0;y.length=P+ve;for(let Le=0;Le<ve;Le++)y[P+Le]=fe[Le]}else y.push(fe)}}class x{constructor(w,P){this.i=w,this.j=P,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function A(y){l.setTimeout(()=>{throw y},0)}function N(){var y=k;let w=null;return y.g&&(w=y.g,y.g=y.g.next,y.g||(y.h=null),w.next=null),w}class U{constructor(){this.h=this.g=null}add(w,P){const H=L.get();H.set(w,P),this.h?this.h.next=H:this.g=H,this.h=H}}var L=new x(()=>new $,y=>y.reset());class ${constructor(){this.next=this.g=this.h=null}set(w,P){this.h=w,this.g=P,this.next=null}reset(){this.next=this.g=this.h=null}}let K,j=!1,k=new U,V=()=>{const y=Promise.resolve(void 0);K=()=>{y.then(D)}};function D(){for(var y;y=N();){try{y.h.call(y.g)}catch(P){A(P)}var w=L;w.j(y),w.h<100&&(w.h++,y.next=w.g,w.g=y)}j=!1}function z(){this.u=this.u,this.C=this.C}z.prototype.u=!1,z.prototype.dispose=function(){this.u||(this.u=!0,this.N())},z.prototype[Symbol.dispose]=function(){this.dispose()},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(y,w){this.type=y,this.g=this.target=w,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,w=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const P=()=>{};l.addEventListener("test",P,w),l.removeEventListener("test",P,w)}catch{}return y})();function B(y){return/^[\s\xa0]*$/.test(y)}function O(y,w){G.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,w)}v(O,G),O.prototype.init=function(y,w){const P=this.type=y.type,H=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=w,w=y.relatedTarget,w||(P=="mouseover"?w=y.fromElement:P=="mouseout"&&(w=y.toElement)),this.relatedTarget=w,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&O.Z.h.call(this)},O.prototype.h=function(){O.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var oe="closure_listenable_"+(Math.random()*1e6|0),X=0;function Q(y,w,P,H,fe){this.listener=y,this.proxy=null,this.src=w,this.type=P,this.capture=!!H,this.ha=fe,this.key=++X,this.da=this.fa=!1}function se(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function ne(y,w,P){for(const H in y)w.call(P,y[H],H,y)}function ue(y,w){for(const P in y)w.call(void 0,y[P],P,y)}function F(y){const w={};for(const P in y)w[P]=y[P];return w}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ye(y,w){let P,H;for(let fe=1;fe<arguments.length;fe++){H=arguments[fe];for(P in H)y[P]=H[P];for(let ve=0;ve<W.length;ve++)P=W[ve],Object.prototype.hasOwnProperty.call(H,P)&&(y[P]=H[P])}}function _e(y){this.src=y,this.g={},this.h=0}_e.prototype.add=function(y,w,P,H,fe){const ve=y.toString();y=this.g[ve],y||(y=this.g[ve]=[],this.h++);const Le=ze(y,w,H,fe);return Le>-1?(w=y[Le],P||(w.fa=!1)):(w=new Q(w,this.src,ve,!!H,fe),w.fa=P,y.push(w)),w};function Ee(y,w){const P=w.type;if(P in y.g){var H=y.g[P],fe=Array.prototype.indexOf.call(H,w,void 0),ve;(ve=fe>=0)&&Array.prototype.splice.call(H,fe,1),ve&&(se(w),y.g[P].length==0&&(delete y.g[P],y.h--))}}function ze(y,w,P,H){for(let fe=0;fe<y.length;++fe){const ve=y[fe];if(!ve.da&&ve.listener==w&&ve.capture==!!P&&ve.ha==H)return fe}return-1}var Qe="closure_lm_"+(Math.random()*1e6|0),Je={};function Ne(y,w,P,H,fe){if(Array.isArray(w)){for(let ve=0;ve<w.length;ve++)Ne(y,w[ve],P,H,fe);return null}return P=J(P),y&&y[oe]?y.J(w,P,c(H)?!!H.capture:!1,fe):Ge(y,w,P,!1,H,fe)}function Ge(y,w,P,H,fe,ve){if(!w)throw Error("Invalid event type");const Le=c(fe)?!!fe.capture:!!fe;let ft=re(y);if(ft||(y[Qe]=ft=new _e(y)),P=ft.add(w,P,H,Le,ve),P.proxy)return P;if(H=Ye(),P.proxy=H,H.src=y,H.listener=P,y.addEventListener)M||(fe=Le),fe===void 0&&(fe=!1),y.addEventListener(w.toString(),H,fe);else if(y.attachEvent)y.attachEvent(C(w.toString()),H);else if(y.addListener&&y.removeListener)y.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return P}function Ye(){function y(P){return w.call(y.src,y.listener,P)}const w=ie;return y}function gt(y,w,P,H,fe){if(Array.isArray(w))for(var ve=0;ve<w.length;ve++)gt(y,w[ve],P,H,fe);else H=c(H)?!!H.capture:!!H,P=J(P),y&&y[oe]?(y=y.i,ve=String(w).toString(),ve in y.g&&(w=y.g[ve],P=ze(w,P,H,fe),P>-1&&(se(w[P]),Array.prototype.splice.call(w,P,1),w.length==0&&(delete y.g[ve],y.h--)))):y&&(y=re(y))&&(w=y.g[w.toString()],y=-1,w&&(y=ze(w,P,H,fe)),(P=y>-1?w[y]:null)&&it(P))}function it(y){if(typeof y!="number"&&y&&!y.da){var w=y.src;if(w&&w[oe])Ee(w.i,y);else{var P=y.type,H=y.proxy;w.removeEventListener?w.removeEventListener(P,H,y.capture):w.detachEvent?w.detachEvent(C(P),H):w.addListener&&w.removeListener&&w.removeListener(H),(P=re(w))?(Ee(P,y),P.h==0&&(P.src=null,w[Qe]=null)):se(y)}}}function C(y){return y in Je?Je[y]:Je[y]="on"+y}function ie(y,w){if(y.da)y=!0;else{w=new O(w,this);const P=y.listener,H=y.ha||y.src;y.fa&&it(y),y=P.call(H,w)}return y}function re(y){return y=y[Qe],y instanceof _e?y:null}var Y="__closure_events_fn_"+(Math.random()*1e9>>>0);function J(y){return typeof y=="function"?y:(y[Y]||(y[Y]=function(w){return y.handleEvent(w)}),y[Y])}function ee(){z.call(this),this.i=new _e(this),this.M=this,this.G=null}v(ee,z),ee.prototype[oe]=!0,ee.prototype.removeEventListener=function(y,w,P,H){gt(this,y,w,P,H)};function be(y,w){var P,H=y.G;if(H)for(P=[];H;H=H.G)P.push(H);if(y=y.M,H=w.type||w,typeof w=="string")w=new G(w,y);else if(w instanceof G)w.target=w.target||y;else{var fe=w;w=new G(H,y),ye(w,fe)}fe=!0;let ve,Le;if(P)for(Le=P.length-1;Le>=0;Le--)ve=w.g=P[Le],fe=Ie(ve,H,!0,w)&&fe;if(ve=w.g=y,fe=Ie(ve,H,!0,w)&&fe,fe=Ie(ve,H,!1,w)&&fe,P)for(Le=0;Le<P.length;Le++)ve=w.g=P[Le],fe=Ie(ve,H,!1,w)&&fe}ee.prototype.N=function(){if(ee.Z.N.call(this),this.i){var y=this.i;for(const w in y.g){const P=y.g[w];for(let H=0;H<P.length;H++)se(P[H]);delete y.g[w],y.h--}}this.G=null},ee.prototype.J=function(y,w,P,H){return this.i.add(String(y),w,!1,P,H)},ee.prototype.K=function(y,w,P,H){return this.i.add(String(y),w,!0,P,H)};function Ie(y,w,P,H){if(w=y.i.g[String(w)],!w)return!0;w=w.concat();let fe=!0;for(let ve=0;ve<w.length;++ve){const Le=w[ve];if(Le&&!Le.da&&Le.capture==P){const ft=Le.listener,un=Le.ha||Le.src;Le.fa&&Ee(y.i,Le),fe=ft.call(un,H)!==!1&&fe}}return fe&&!H.defaultPrevented}function de(y,w){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=f(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:l.setTimeout(y,w||0)}function Me(y){y.g=de(()=>{y.g=null,y.i&&(y.i=!1,Me(y))},y.l);const w=y.h;y.h=null,y.m.apply(null,w)}class De extends z{constructor(w,P){super(),this.m=w,this.l=P,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:Me(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ke(y){z.call(this),this.h=y,this.g={}}v(ke,z);var He=[];function ct(y){ne(y.g,function(w,P){this.g.hasOwnProperty(P)&&it(w)},y),y.g={}}ke.prototype.N=function(){ke.Z.N.call(this),ct(this)},ke.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nt=l.JSON.stringify,Ht=l.JSON.parse,Rt=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function It(){}function le(){}var he={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ae(){G.call(this,"d")}v(Ae,G);function Ve(){G.call(this,"c")}v(Ve,G);var Re={},Be=null;function $e(){return Be=Be||new ee}Re.Ia="serverreachability";function wt(y){G.call(this,Re.Ia,y)}v(wt,G);function $t(y){const w=$e();be(w,new wt(w))}Re.STAT_EVENT="statevent";function rn(y,w){G.call(this,Re.STAT_EVENT,y),this.stat=w}v(rn,G);function Nt(y){const w=$e();be(w,new rn(w,y))}Re.Ja="timingevent";function dt(y,w){G.call(this,Re.Ja,y),this.size=w}v(dt,G);function pt(y,w){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},w)}function In(){this.g=!0}In.prototype.ua=function(){this.g=!1};function ys(y,w,P,H,fe,ve){y.info(function(){if(y.g)if(ve){var Le="",ft=ve.split("&");for(let Pt=0;Pt<ft.length;Pt++){var un=ft[Pt].split("=");if(un.length>1){const en=un[0];un=un[1];const Ai=en.split("_");Le=Ai.length>=2&&Ai[1]=="type"?Le+(en+"="+un+"&"):Le+(en+"=redacted&")}}}else Le=null;else Le=ve;return"XMLHTTP REQ ("+H+") [attempt "+fe+"]: "+w+`
`+P+`
`+Le})}function zi(y,w,P,H,fe,ve,Le){y.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+fe+"]: "+w+`
`+P+`
`+ve+" "+Le})}function Ut(y,w,P,H){y.info(function(){return"XMLHTTP TEXT ("+w+"): "+Va(y,P)+(H?" "+H:"")})}function ar(y,w){y.info(function(){return"TIMEOUT: "+w})}In.prototype.info=function(){};function Va(y,w){if(!y.g)return w;if(!w)return null;try{const ve=JSON.parse(w);if(ve){for(y=0;y<ve.length;y++)if(Array.isArray(ve[y])){var P=ve[y];if(!(P.length<2)){var H=P[1];if(Array.isArray(H)&&!(H.length<1)){var fe=H[0];if(fe!="noop"&&fe!="stop"&&fe!="close")for(let Le=1;Le<H.length;Le++)H[Le]=""}}}}return nt(ve)}catch{return w}}var Ro={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},xu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Au;function No(){}v(No,It),No.prototype.g=function(){return new XMLHttpRequest},Au=new No;function Or(y){return encodeURIComponent(String(y))}function Ud(y){var w=1;y=y.split(":");const P=[];for(;w>0&&y.length;)P.push(y.shift()),w--;return y.length&&P.push(y.join(":")),P}function Gi(y,w,P,H){this.j=y,this.i=w,this.l=P,this.S=H||1,this.V=new ke(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new qi}function qi(){this.i=null,this.g="",this.h=!1}var mn={},Cn={};function lr(y,w,P){y.M=1,y.A=ko(yn(w)),y.u=P,y.R=!0,Ua(y,null)}function Ua(y,w){y.F=Date.now(),ur(y),y.B=yn(y.A);var P=y.B,H=y.S;Array.isArray(H)||(H=[String(H)]),za(P.i,"t",H),y.C=0,P=y.j.L,y.h=new qi,y.g=Xd(y.j,P?w:null,!y.u),y.P>0&&(y.O=new De(f(y.Y,y,y.g),y.P)),w=y.V,P=y.g,H=y.ba;var fe="readystatechange";Array.isArray(fe)||(fe&&(He[0]=fe.toString()),fe=He);for(let ve=0;ve<fe.length;ve++){const Le=Ne(P,fe[ve],H||w.handleEvent,!1,w.h||w);if(!Le)break;w.g[Le.key]=Le}w=y.J?F(y.J):{},y.u?(y.v||(y.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,w)):(y.v="GET",y.g.ea(y.B,y.v,null,w)),$t(),ys(y.i,y.v,y.B,y.l,y.S,y.u)}Gi.prototype.ba=function(y){y=y.target;const w=this.O;w&&ji(y)==3?w.j():this.Y(y)},Gi.prototype.Y=function(y){try{if(y==this.g)e:{const ft=ji(this.g),un=this.g.ya(),Pt=this.g.ca();if(!(ft<3)&&(ft!=3||this.g&&(this.h.h||this.g.la()||On(this.g)))){this.K||ft!=4||un==7||(un==8||Pt<=0?$t(3):$t(2)),cr(this);var w=this.g.ca();this.X=w;var P=um(this);if(this.o=w==200,zi(this.i,this.v,this.B,this.l,this.S,ft,w),this.o){if(this.U&&!this.L){t:{if(this.g){var H,fe=this.g;if((H=fe.g?fe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(H)){var ve=H;break t}}ve=null}if(y=ve)Ut(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,dr(this,y);else{this.o=!1,this.m=3,Nt(12),ui(this),Si(this);break e}}if(this.R){y=!0;let en;for(;!this.K&&this.C<P.length;)if(en=Bd(this,P),en==Cn){ft==4&&(this.m=4,Nt(14),y=!1),Ut(this.i,this.l,null,"[Incomplete Response]");break}else if(en==mn){this.m=4,Nt(15),Ut(this.i,this.l,P,"[Invalid Chunk]"),y=!1;break}else Ut(this.i,this.l,en,null),dr(this,en);if(Ld(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ft!=4||P.length!=0||this.h.h||(this.m=1,Nt(16),y=!1),this.o=this.o&&y,!y)Ut(this.i,this.l,P,"[Invalid Chunked Response]"),ui(this),Si(this);else if(P.length>0&&!this.W){this.W=!0;var Le=this.j;Le.g==this&&Le.aa&&!Le.P&&(Le.j.info("Great, no buffering proxy detected. Bytes received: "+P.length),zu(Le),Le.P=!0,Nt(11))}}else Ut(this.i,this.l,P,null),dr(this,P);ft==4&&ui(this),this.o&&!this.K&&(ft==4?Jd(this.j,this):(this.o=!1,ur(this)))}else Ur(this.g),w==400&&P.indexOf("Unknown SID")>0?(this.m=3,Nt(12)):(this.m=0,Nt(13)),ui(this),Si(this)}}}catch{}finally{}};function um(y){if(!Ld(y))return y.g.la();const w=On(y.g);if(w==="")return"";let P="";const H=w.length,fe=ji(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return ui(y),Si(y),"";y.h.i=new l.TextDecoder}for(let ve=0;ve<H;ve++)y.h.h=!0,P+=y.h.i.decode(w[ve],{stream:!(fe&&ve==H-1)});return w.length=0,y.h.g+=P,y.C=0,y.h.g}function Ld(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function Bd(y,w){var P=y.C,H=w.indexOf(`
`,P);return H==-1?Cn:(P=Number(w.substring(P,H)),isNaN(P)?mn:(H+=1,H+P>w.length?Cn:(w=w.slice(H,H+P),y.C=H+P,w)))}Gi.prototype.cancel=function(){this.K=!0,ui(this)};function ur(y){y.T=Date.now()+y.H,La(y,y.H)}function La(y,w){if(y.D!=null)throw Error("WatchDog timer not null");y.D=pt(f(y.aa,y),w)}function cr(y){y.D&&(l.clearTimeout(y.D),y.D=null)}Gi.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(ar(this.i,this.B),this.M!=2&&($t(),Nt(17)),ui(this),this.m=2,Si(this)):La(this,this.T-y)};function Si(y){y.j.I==0||y.K||Jd(y.j,y)}function ui(y){cr(y);var w=y.O;w&&typeof w.dispose=="function"&&w.dispose(),y.O=null,ct(y.V),y.g&&(w=y.g,y.g=null,w.abort(),w.dispose())}function dr(y,w){try{var P=y.j;if(P.I!=0&&(P.g==y||hr(P.h,y))){if(!y.L&&hr(P.h,y)&&P.I==3){try{var H=P.Ba.g.parse(w)}catch{H=null}if(Array.isArray(H)&&H.length==3){var fe=H;if(fe[0]==0){e:if(!P.v){if(P.g)if(P.g.F+3e3<y.F)ja(P),xs(P);else break e;Lo(P),Nt(18)}}else P.xa=fe[1],0<P.xa-P.K&&fe[2]<37500&&P.F&&P.A==0&&!P.C&&(P.C=pt(f(P.Va,P),6e3));fr(P.h)<=1&&P.ta&&(P.ta=void 0)}else vr(P,11)}else if((y.L||P.g==y)&&ja(P),!B(w))for(fe=P.Ba.g.parse(w),w=0;w<fe.length;w++){let Pt=fe[w];const en=Pt[0];if(!(en<=P.K))if(P.K=en,Pt=Pt[1],P.I==2)if(Pt[0]=="c"){P.M=Pt[1],P.ba=Pt[2];const Ai=Pt[3];Ai!=null&&(P.ka=Ai,P.j.info("VER="+P.ka));const Er=Pt[4];Er!=null&&(P.za=Er,P.j.info("SVER="+P.za));const Ki=Pt[5];Ki!=null&&typeof Ki=="number"&&Ki>0&&(H=1.5*Ki,P.O=H,P.j.info("backChannelRequestTimeoutMs_="+H)),H=P;const Ji=y.g;if(Ji){const Bo=Ji.g?Ji.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bo){var ve=H.h;ve.g||Bo.indexOf("spdy")==-1&&Bo.indexOf("quic")==-1&&Bo.indexOf("h2")==-1||(ve.j=ve.l,ve.g=new Set,ve.h&&(Ru(ve,ve.h),ve.h=null))}if(H.G){const Ka=Ji.g?Ji.g.getResponseHeader("X-HTTP-Session-Id"):null;Ka&&(H.wa=Ka,Lt(H.J,H.G,Ka))}}P.I=3,P.l&&P.l.ra(),P.aa&&(P.T=Date.now()-y.F,P.j.info("Handshake RTT: "+P.T+"ms")),H=P;var Le=y;if(H.na=Qd(H,H.L?H.ba:null,H.W),Le.L){Nu(H.h,Le);var ft=Le,un=H.O;un&&(ft.H=un),ft.D&&(cr(ft),ur(ft)),H.g=Le}else jd(H);P.i.length>0&&_r(P)}else Pt[0]!="stop"&&Pt[0]!="close"||vr(P,7);else P.I==3&&(Pt[0]=="stop"||Pt[0]=="close"?Pt[0]=="stop"?vr(P,7):Bu(P):Pt[0]!="noop"&&P.l&&P.l.qa(Pt),P.A=0)}}$t(4)}catch{}}var gn=class{constructor(y,w){this.g=y,this.map=w}};function Iu(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Cu(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function fr(y){return y.h?1:y.g?y.g.size:0}function hr(y,w){return y.h?y.h==w:y.g?y.g.has(w):!1}function Ru(y,w){y.g?y.g.add(w):y.h=w}function Nu(y,w){y.h&&y.h==w?y.h=null:y.g&&y.g.has(w)&&y.g.delete(w)}Iu.prototype.cancel=function(){if(this.i=ku(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function ku(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let w=y.i;for(const P of y.g.values())w=w.concat(P.G);return w}return b(y.i)}var Fd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ba(y,w){if(y){y=y.split("&");for(let P=0;P<y.length;P++){const H=y[P].indexOf("=");let fe,ve=null;H>=0?(fe=y[P].substring(0,H),ve=y[P].substring(H+1)):fe=y[P],w(fe,ve?decodeURIComponent(ve.replace(/\+/g," ")):"")}}}function ci(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;y instanceof ci?(this.l=y.l,Rn(this,y.j),this.o=y.o,this.g=y.g,_s(this,y.u),this.h=y.h,Mu(this,Hd(y.i)),this.m=y.m):y&&(w=String(y).match(Fd))?(this.l=!1,Rn(this,w[1]||"",!0),this.o=pr(w[2]||""),this.g=pr(w[3]||"",!0),_s(this,w[4]),this.h=pr(w[5]||"",!0),Mu(this,w[6]||"",!0),this.m=pr(w[7]||"")):(this.l=!1,this.i=new Es(null,this.l))}ci.prototype.toString=function(){const y=[];var w=this.j;w&&y.push(Mo(w,Fa,!0),":");var P=this.g;return(P||w=="file")&&(y.push("//"),(w=this.o)&&y.push(Mo(w,Fa,!0),"@"),y.push(Or(P).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),P=this.u,P!=null&&y.push(":",String(P))),(P=this.h)&&(this.g&&P.charAt(0)!="/"&&y.push("/"),y.push(Mo(P,P.charAt(0)=="/"?Du:zd,!0))),(P=this.i.toString())&&y.push("?",P),(P=this.m)&&y.push("#",Mo(P,Gd)),y.join("")},ci.prototype.resolve=function(y){const w=yn(this);let P=!!y.j;P?Rn(w,y.j):P=!!y.o,P?w.o=y.o:P=!!y.g,P?w.g=y.g:P=y.u!=null;var H=y.h;if(P)_s(w,y.u);else if(P=!!y.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var fe=w.h.lastIndexOf("/");fe!=-1&&(H=w.h.slice(0,fe+1)+H)}if(fe=H,fe==".."||fe==".")H="";else if(fe.indexOf("./")!=-1||fe.indexOf("/.")!=-1){H=fe.lastIndexOf("/",0)==0,fe=fe.split("/");const ve=[];for(let Le=0;Le<fe.length;){const ft=fe[Le++];ft=="."?H&&Le==fe.length&&ve.push(""):ft==".."?((ve.length>1||ve.length==1&&ve[0]!="")&&ve.pop(),H&&Le==fe.length&&ve.push("")):(ve.push(ft),H=!0)}H=ve.join("/")}else H=fe}return P?w.h=H:P=y.i.toString()!=="",P?Mu(w,Hd(y.i)):P=!!y.m,P&&(w.m=y.m),w};function yn(y){return new ci(y)}function Rn(y,w,P){y.j=P?pr(w,!0):w,y.j&&(y.j=y.j.replace(/:$/,""))}function _s(y,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);y.u=w}else y.u=null}function Mu(y,w,P){w instanceof Es?(y.i=w,Ga(y.i,y.l)):(P||(w=Mo(w,vs)),y.i=new Es(w,y.l))}function Lt(y,w,P){y.i.set(w,P)}function ko(y){return Lt(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function pr(y,w){return y?w?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Mo(y,w,P){return typeof y=="string"?(y=encodeURI(y).replace(w,Zn),P&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Zn(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var Fa=/[#\/\?@]/g,zd=/[#\?:]/g,Du=/[#\?]/g,vs=/[#\?@]/g,Gd=/#/g;function Es(y,w){this.h=this.g=null,this.i=y||null,this.j=!!w}function ei(y){y.g||(y.g=new Map,y.h=0,y.i&&Ba(y.i,function(w,P){y.add(decodeURIComponent(w.replace(/\+/g," ")),P)}))}n=Es.prototype,n.add=function(y,w){ei(this),this.i=null,y=Ts(this,y);let P=this.g.get(y);return P||this.g.set(y,P=[]),P.push(w),this.h+=1,this};function qd(y,w){ei(y),w=Ts(y,w),y.g.has(w)&&(y.i=null,y.h-=y.g.get(w).length,y.g.delete(w))}function Pu(y,w){return ei(y),w=Ts(y,w),y.g.has(w)}n.forEach=function(y,w){ei(this),this.g.forEach(function(P,H){P.forEach(function(fe){y.call(w,fe,H,this)},this)},this)};function Ou(y,w){ei(y);let P=[];if(typeof w=="string")Pu(y,w)&&(P=P.concat(y.g.get(Ts(y,w))));else for(y=Array.from(y.g.values()),w=0;w<y.length;w++)P=P.concat(y[w]);return P}n.set=function(y,w){return ei(this),this.i=null,y=Ts(this,y),Pu(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[w]),this.h+=1,this},n.get=function(y,w){return y?(y=Ou(this,y),y.length>0?String(y[0]):w):w};function za(y,w,P){qd(y,w),P.length>0&&(y.i=null,y.g.set(Ts(y,w),b(P)),y.h+=P.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],w=Array.from(this.g.keys());for(let H=0;H<w.length;H++){var P=w[H];const fe=Or(P);P=Ou(this,P);for(let ve=0;ve<P.length;ve++){let Le=fe;P[ve]!==""&&(Le+="="+Or(P[ve])),y.push(Le)}}return this.i=y.join("&")};function Hd(y){const w=new Es;return w.i=y.i,y.g&&(w.g=new Map(y.g),w.h=y.h),w}function Ts(y,w){return w=String(w),y.j&&(w=w.toLowerCase()),w}function Ga(y,w){w&&!y.j&&(ei(y),y.i=null,y.g.forEach(function(P,H){const fe=H.toLowerCase();H!=fe&&(qd(this,H),za(this,fe,P))},y)),y.j=w}function Hi(y,w){const P=new In;if(l.Image){const H=new Image;H.onload=m(wi,P,"TestLoadImage: loaded",!0,w,H),H.onerror=m(wi,P,"TestLoadImage: error",!1,w,H),H.onabort=m(wi,P,"TestLoadImage: abort",!1,w,H),H.ontimeout=m(wi,P,"TestLoadImage: timeout",!1,w,H),l.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=y}else w(!1)}function Vu(y,w){const P=new In,H=new AbortController,fe=setTimeout(()=>{H.abort(),wi(P,"TestPingServer: timeout",!1,w)},1e4);fetch(y,{signal:H.signal}).then(ve=>{clearTimeout(fe),ve.ok?wi(P,"TestPingServer: ok",!0,w):wi(P,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(fe),wi(P,"TestPingServer: error",!1,w)})}function wi(y,w,P,H,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),H(P)}catch{}}function bs(){this.g=new Rt}function mr(y){this.i=y.Sb||null,this.h=y.ab||!1}v(mr,It),mr.prototype.g=function(){return new Do(this.i,this.h)};function Do(y,w){ee.call(this),this.H=y,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(Do,ee),n=Do.prototype,n.open=function(y,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=w,this.readyState=1,$i(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(w.body=y),(this.H||l).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ss(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,$i(this)),this.g&&(this.readyState=3,$i(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;qa(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function qa(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var w=y.value?y.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!y.done}))&&(this.response=this.responseText+=w)}y.done?Ss(this):$i(this),this.readyState==3&&qa(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,Ss(this))},n.Na=function(y){this.g&&(this.response=y,Ss(this))},n.ga=function(){this.g&&Ss(this)};function Ss(y){y.readyState=4,y.l=null,y.j=null,y.B=null,$i(y)}n.setRequestHeader=function(y,w){this.A.append(y,w)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],w=this.h.entries();for(var P=w.next();!P.done;)P=P.value,y.push(P[0]+": "+P[1]),P=w.next();return y.join(`\r
`)};function $i(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Do.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function xi(y){let w="";return ne(y,function(P,H){w+=H,w+=":",w+=P,w+=`\r
`}),w}function Po(y,w,P){e:{for(H in P){var H=!1;break e}H=!0}H||(P=xi(P),typeof y=="string"?P!=null&&Or(P):Lt(y,w,P))}function jt(y){ee.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(jt,ee);var gr=/^https?$/i,Uu=["POST","PUT"];n=jt.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,w,P,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);w=w?w.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Au.g(),this.g.onreadystatechange=E(f(this.Ca,this));try{this.B=!0,this.g.open(w,String(y),!0),this.B=!1}catch(ve){Oo(this,ve);return}if(y=P||"",P=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var fe in H)P.set(fe,H[fe]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const ve of H.keys())P.set(ve,H.get(ve));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(P.keys()).find(ve=>ve.toLowerCase()=="content-type"),fe=l.FormData&&y instanceof l.FormData,!(Array.prototype.indexOf.call(Uu,w,void 0)>=0)||H||fe||P.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ve,Le]of P)this.g.setRequestHeader(ve,Le);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(ve){Oo(this,ve)}};function Oo(y,w){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=w,y.o=5,Lu(y),Vr(y)}function Lu(y){y.A||(y.A=!0,be(y,"complete"),be(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,be(this,"complete"),be(this,"abort"),Vr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vr(this,!0)),jt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Vo(this):this.Xa())},n.Xa=function(){Vo(this)};function Vo(y){if(y.h&&typeof o<"u"){if(y.v&&ji(y)==4)setTimeout(y.Ca.bind(y),0);else if(be(y,"readystatechange"),ji(y)==4){y.h=!1;try{const ve=y.ca();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var P;if(!(P=w)){var H;if(H=ve===0){let Le=String(y.D).match(Fd)[1]||null;!Le&&l.self&&l.self.location&&(Le=l.self.location.protocol.slice(0,-1)),H=!gr.test(Le?Le.toLowerCase():"")}P=H}if(P)be(y,"complete"),be(y,"success");else{y.o=6;try{var fe=ji(y)>2?y.g.statusText:""}catch{fe=""}y.l=fe+" ["+y.ca()+"]",Lu(y)}}finally{Vr(y)}}}}function Vr(y,w){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const P=y.g;y.g=null,w||be(y,"ready");try{P.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ji(y){return y.g?y.g.readyState:0}n.ca=function(){try{return ji(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var w=this.g.responseText;return y&&w.indexOf(y)==0&&(w=w.substring(y.length)),Ht(w)}};function On(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function Ur(y){const w={};y=(y.g&&ji(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<y.length;H++){if(B(y[H]))continue;var P=Ud(y[H]);const fe=P[0];if(P=P[1],typeof P!="string")continue;P=P.trim();const ve=w[fe]||[];w[fe]=ve,ve.push(P)}ue(w,function(H){return H.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function yr(y,w,P){return P&&P.internalChannelParams&&P.internalChannelParams[y]||w}function ws(y){this.za=0,this.i=[],this.j=new In,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=yr("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=yr("baseRetryDelayMs",5e3,y),this.Za=yr("retryDelaySeedMs",1e4,y),this.Ta=yr("forwardChannelMaxRetries",2,y),this.va=yr("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Iu(y&&y.concurrentRequestLimit),this.Ba=new bs,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ws.prototype,n.ka=8,n.I=1,n.connect=function(y,w,P,H){Nt(0),this.W=y,this.H=w||{},P&&H!==void 0&&(this.H.OSID=P,this.H.OAID=H),this.F=this.X,this.J=Qd(this,null,this.W),_r(this)};function Bu(y){if(Ha(y),y.I==3){var w=y.V++,P=yn(y.J);if(Lt(P,"SID",y.M),Lt(P,"RID",w),Lt(P,"TYPE","terminate"),Uo(y,P),w=new Gi(y,y.j,w),w.M=2,w.A=ko(yn(P)),P=!1,l.navigator&&l.navigator.sendBeacon)try{P=l.navigator.sendBeacon(w.A.toString(),"")}catch{}!P&&l.Image&&(new Image().src=w.A,P=!0),P||(w.g=Xd(w.j,null),w.g.ea(w.A)),w.F=Date.now(),ur(w)}Wd(y)}function xs(y){y.g&&(zu(y),y.g.cancel(),y.g=null)}function Ha(y){xs(y),y.v&&(l.clearTimeout(y.v),y.v=null),ja(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&l.clearTimeout(y.m),y.m=null)}function _r(y){if(!Cu(y.h)&&!y.m){y.m=!0;var w=y.Ea;K||V(),j||(K(),j=!0),k.add(w,y),y.D=0}}function $a(y,w){return fr(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=w.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=pt(f(y.Ea,y,w),Yd(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const fe=new Gi(this,this.j,y);let ve=this.o;if(this.U&&(ve?(ve=F(ve),ye(ve,this.U)):ve=this.U),this.u!==null||this.R||(fe.J=ve,ve=null),this.S)e:{for(var w=0,P=0;P<this.i.length;P++){t:{var H=this.i[P];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(w+=H,w>4096){w=P;break e}if(w===4096||P===this.i.length-1){w=P+1;break e}}w=1e3}else w=1e3;w=$d(this,fe,w),P=yn(this.J),Lt(P,"RID",y),Lt(P,"CVER",22),this.G&&Lt(P,"X-HTTP-Session-Id",this.G),Uo(this,P),ve&&(this.R?w="headers="+Or(xi(ve))+"&"+w:this.u&&Po(P,this.u,ve)),Ru(this.h,fe),this.Ra&&Lt(P,"TYPE","init"),this.S?(Lt(P,"$req",w),Lt(P,"SID","null"),fe.U=!0,lr(fe,P,null)):lr(fe,P,w),this.I=2}}else this.I==3&&(y?Fu(this,y):this.i.length==0||Cu(this.h)||Fu(this))};function Fu(y,w){var P;w?P=w.l:P=y.V++;const H=yn(y.J);Lt(H,"SID",y.M),Lt(H,"RID",P),Lt(H,"AID",y.K),Uo(y,H),y.u&&y.o&&Po(H,y.u,y.o),P=new Gi(y,y.j,P,y.D+1),y.u===null&&(P.J=y.o),w&&(y.i=w.G.concat(y.i)),w=$d(y,P,1e3),P.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),Ru(y.h,P),lr(P,H,w)}function Uo(y,w){y.H&&ne(y.H,function(P,H){Lt(w,H,P)}),y.l&&ne({},function(P,H){Lt(w,H,P)})}function $d(y,w,P){P=Math.min(y.i.length,P);const H=y.l?f(y.l.Ka,y.l,y):null;e:{var fe=y.i;let ft=-1;for(;;){const un=["count="+P];ft==-1?P>0?(ft=fe[0].g,un.push("ofs="+ft)):ft=0:un.push("ofs="+ft);let Pt=!0;for(let en=0;en<P;en++){var ve=fe[en].g;const Ai=fe[en].map;if(ve-=ft,ve<0)ft=Math.max(0,fe[en].g-100),Pt=!1;else try{ve="req"+ve+"_"||"";try{var Le=Ai instanceof Map?Ai:Object.entries(Ai);for(const[Er,Ki]of Le){let Ji=Ki;c(Ki)&&(Ji=nt(Ki)),un.push(ve+Er+"="+encodeURIComponent(Ji))}}catch(Er){throw un.push(ve+"type="+encodeURIComponent("_badmap")),Er}}catch{H&&H(Ai)}}if(Pt){Le=un.join("&");break e}}Le=void 0}return y=y.i.splice(0,P),w.G=y,Le}function jd(y){if(!y.g&&!y.v){y.Y=1;var w=y.Da;K||V(),j||(K(),j=!0),k.add(w,y),y.A=0}}function Lo(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=pt(f(y.Da,y),Yd(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,Kd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=pt(f(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Nt(10),xs(this),Kd(this))};function zu(y){y.B!=null&&(l.clearTimeout(y.B),y.B=null)}function Kd(y){y.g=new Gi(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var w=yn(y.na);Lt(w,"RID","rpc"),Lt(w,"SID",y.M),Lt(w,"AID",y.K),Lt(w,"CI",y.F?"0":"1"),!y.F&&y.ia&&Lt(w,"TO",y.ia),Lt(w,"TYPE","xmlhttp"),Uo(y,w),y.u&&y.o&&Po(w,y.u,y.o),y.O&&(y.g.H=y.O);var P=y.g;y=y.ba,P.M=1,P.A=ko(yn(w)),P.u=null,P.R=!0,Ua(P,y)}n.Va=function(){this.C!=null&&(this.C=null,xs(this),Lo(this),Nt(19))};function ja(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function Jd(y,w){var P=null;if(y.g==w){ja(y),zu(y),y.g=null;var H=2}else if(hr(y.h,w))P=w.G,Nu(y.h,w),H=1;else return;if(y.I!=0){if(w.o)if(H==1){P=w.u?w.u.length:0,w=Date.now()-w.F;var fe=y.D;H=$e(),be(H,new dt(H,P)),_r(y)}else jd(y);else if(fe=w.m,fe==3||fe==0&&w.X>0||!(H==1&&$a(y,w)||H==2&&Lo(y)))switch(P&&P.length>0&&(w=y.h,w.i=w.i.concat(P)),fe){case 1:vr(y,5);break;case 4:vr(y,10);break;case 3:vr(y,6);break;default:vr(y,2)}}}function Yd(y,w){let P=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(P*=2),P*w}function vr(y,w){if(y.j.info("Error code "+w),w==2){var P=f(y.bb,y),H=y.Ua;const fe=!H;H=new ci(H||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Rn(H,"https"),ko(H),fe?Hi(H.toString(),P):Vu(H.toString(),P)}else Nt(2);y.I=0,y.l&&y.l.pa(w),Wd(y),Ha(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),Nt(2)):(this.j.info("Failed to ping google.com"),Nt(1))};function Wd(y){if(y.I=0,y.ja=[],y.l){const w=ku(y.h);(w.length!=0||y.i.length!=0)&&(I(y.ja,w),I(y.ja,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.oa()}}function Qd(y,w,P){var H=P instanceof ci?yn(P):new ci(P);if(H.g!="")w&&(H.g=w+"."+H.g),_s(H,H.u);else{var fe=l.location;H=fe.protocol,w=w?w+"."+fe.hostname:fe.hostname,fe=+fe.port;const ve=new ci(null);H&&Rn(ve,H),w&&(ve.g=w),fe&&_s(ve,fe),P&&(ve.h=P),H=ve}return P=y.G,w=y.wa,P&&w&&Lt(H,P,w),Lt(H,"VER",y.ka),Uo(y,H),H}function Xd(y,w,P){if(w&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=y.Aa&&!y.ma?new jt(new mr({ab:P})):new jt(y.ma),w.Fa(y.L),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zd(){}n=Zd.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function As(){}As.prototype.g=function(y,w){return new Jn(y,w)};function Jn(y,w){ee.call(this),this.g=new ws(w),this.l=y,this.h=w&&w.messageUrlParams||null,y=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(y?y["X-WebChannel-Content-Type"]=w.messageContentType:y={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(y?y["X-WebChannel-Client-Profile"]=w.sa:y={"X-WebChannel-Client-Profile":w.sa}),this.g.U=y,(y=w&&w.Qb)&&!B(y)&&(this.g.u=y),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!B(w)&&(this.g.G=w,y=this.h,y!==null&&w in y&&(y=this.h,w in y&&delete y[w])),this.j=new Lr(this)}v(Jn,ee),Jn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Jn.prototype.close=function(){Bu(this.g)},Jn.prototype.o=function(y){var w=this.g;if(typeof y=="string"){var P={};P.__data__=y,y=P}else this.v&&(P={},P.__data__=nt(y),y=P);w.i.push(new gn(w.Ya++,y)),w.I==3&&_r(w)},Jn.prototype.N=function(){this.g.l=null,delete this.j,Bu(this.g),delete this.g,Jn.Z.N.call(this)};function ef(y){Ae.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var w=y.__sm__;if(w){e:{for(const P in w){y=P;break e}y=void 0}(this.i=y)&&(y=this.i,w=w!==null&&y in w?w[y]:void 0),this.data=w}else this.data=y}v(ef,Ae);function tf(){Ve.call(this),this.status=1}v(tf,Ve);function Lr(y){this.g=y}v(Lr,Zd),Lr.prototype.ra=function(){be(this.g,"a")},Lr.prototype.qa=function(y){be(this.g,new ef(y))},Lr.prototype.pa=function(y){be(this.g,new tf)},Lr.prototype.oa=function(){be(this.g,"b")},As.prototype.createWebChannel=As.prototype.g,Jn.prototype.send=Jn.prototype.o,Jn.prototype.open=Jn.prototype.m,Jn.prototype.close=Jn.prototype.close,$I=function(){return new As},HI=function(){return $e()},qI=Re,Ky={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ro.NO_ERROR=0,Ro.TIMEOUT=8,Ro.HTTP_ERROR=6,Rh=Ro,xu.COMPLETE="complete",GI=xu,le.EventType=he,he.OPEN="a",he.CLOSE="b",he.ERROR="c",he.MESSAGE="d",ee.prototype.listen=ee.prototype.J,Lc=le,jt.prototype.listenOnce=jt.prototype.K,jt.prototype.getLastError=jt.prototype.Ha,jt.prototype.getLastErrorCode=jt.prototype.ya,jt.prototype.getStatus=jt.prototype.ca,jt.prototype.getResponseJson=jt.prototype.La,jt.prototype.getResponseText=jt.prototype.la,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Fa,zI=jt}).apply(typeof lh<"u"?lh:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mn.UNAUTHENTICATED=new Mn(null),Mn.GOOGLE_CREDENTIALS=new Mn("google-credentials-uid"),Mn.FIRST_PARTY=new Mn("first-party-uid"),Mn.MOCK_USER=new Mn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gu="12.9.0";function tV(n){gu=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xa=new H_("@firebase/firestore");function kl(){return xa.logLevel}function Pe(n,...e){if(xa.logLevel<=bt.DEBUG){const t=e.map(nv);xa.debug(`Firestore (${gu}): ${n}`,...t)}}function fn(n,...e){if(xa.logLevel<=bt.ERROR){const t=e.map(nv);xa.error(`Firestore (${gu}): ${n}`,...t)}}function Aa(n,...e){if(xa.logLevel<=bt.WARN){const t=e.map(nv);xa.warn(`Firestore (${gu}): ${n}`,...t)}}function nv(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function je(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,jI(n,i,t)}function jI(n,e,t){let i=`FIRESTORE (${gu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw fn(i),new Error(i)}function Ze(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||jI(e,r,i)}function We(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends ds{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KI{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class nV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Mn.UNAUTHENTICATED)))}shutdown(){}}class iV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class rV{constructor(e){this.t=e,this.currentUser=Mn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0,42304);let i=this.i;const r=d=>this.i!==i?(i=this.i,t(d)):Promise.resolve();let o=new ss;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ss,e.enqueueRetryable((()=>r(this.currentUser)))};const l=()=>{const d=o;e.enqueueRetryable((async()=>{await d.promise,await r(this.currentUser)}))},c=d=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((d=>c(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ss)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ze(typeof i.accessToken=="string",31837,{l:i}),new KI(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new Mn(e)}}class sV{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Mn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class oV{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new sV(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Mn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class xS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class aV{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,oi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ze(this.o===void 0,3512);const i=o=>{o.error!=null&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,Pe("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>i(o)))};const r=o=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>r(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?r(o):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new xS(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new xS(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lV(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=lV(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<t&&(i+=e.charAt(r[o]%62))}return i}}function at(n,e){return n<e?-1:n>e?1:0}function Jy(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),o=e.charAt(i);if(r!==o)return yy(r)===yy(o)?at(r,o):yy(r)?1:-1}return at(n.length,e.length)}const uV=55296,cV=57343;function yy(n){const e=n.charCodeAt(0);return e>=uV&&e<=cV}function Jl(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function JI(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS="__name__";class Ar{constructor(e,t,i){t===void 0?t=0:t>e.length&&je(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&je(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ar.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ar?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const o=Ar.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return at(e.length,t.length)}static compareSegments(e,t){const i=Ar.isNumericId(e),r=Ar.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Ar.extractNumericId(e).compare(Ar.extractNumericId(t)):Jy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return uo.fromString(e.substring(4,e.length-2))}}class Vt extends Ar{construct(e,t,i){return new Vt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ue(Se.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Vt(t)}static emptyPath(){return new Vt([])}}const dV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class sn extends Ar{construct(e,t,i){return new sn(e,t,i)}static isValidIdentifier(e){return dV.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),sn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===AS}static keyField(){return new sn([AS])}static fromServerFormat(e){const t=[];let i="",r=0;const o=()=>{if(i.length===0)throw new Ue(Se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let l=!1;for(;r<e.length;){const c=e[r];if(c==="\\"){if(r+1===e.length)throw new Ue(Se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[r+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Ue(Se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=d,r+=2}else c==="`"?(l=!l,r++):c!=="."||l?(i+=c,r++):(o(),r++)}if(o(),l)throw new Ue(Se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new sn(t)}static emptyPath(){return new sn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(Vt.fromString(e))}static fromName(e){return new Fe(Vt.fromString(e).popFirst(5))}static empty(){return new Fe(Vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Vt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Vt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new Vt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YI(n,e,t){if(!t)throw new Ue(Se.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function fV(n,e,t,i){if(e===!0&&i===!0)throw new Ue(Se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function IS(n){if(!Fe.isDocumentKey(n))throw new Ue(Se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function CS(n){if(Fe.isDocumentKey(n))throw new Ue(Se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function WI(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Mp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":je(12329,{type:typeof n})}function Ui(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ue(Se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Mp(n);throw new Ue(Se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Rd(n,e){if(!WI(n))throw new Ue(Se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,o="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const l=n[i];if(r&&typeof l!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(o!==void 0&&l!==o.value){t=`Expected '${i}' field to equal '${o.value}'`;break}}if(t)throw new Ue(Se.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS=-62135596800,NS=1e6;class zt{static now(){return zt.fromMillis(Date.now())}static fromDate(e){return zt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*NS);return new zt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ue(Se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ue(Se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<RS)throw new Ue(Se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ue(Se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/NS}_compareTo(e){return this.seconds===e.seconds?at(this.nanoseconds,e.nanoseconds):at(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:zt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Rd(e,zt._jsonSchema))return new zt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-RS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}zt._jsonSchemaVersion="firestore/timestamp/1.0",zt._jsonSchema={type:Sn("string",zt._jsonSchemaVersion),seconds:Sn("number"),nanoseconds:Sn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{static fromTimestamp(e){return new tt(e)}static min(){return new tt(new zt(0,0))}static max(){return new tt(new zt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl=-1;class Wh{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Yy(n){return n.fields.find((e=>e.kind===2))}function ia(n){return n.fields.filter((e=>e.kind!==2))}Wh.UNKNOWN_ID=-1;class Nh{constructor(e,t){this.fieldPath=e,this.kind=t}}class ld{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ld(0,bi.min())}}function QI(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=tt.fromTimestamp(i===1e9?new zt(t+1,0):new zt(t,i));return new bi(r,Fe.empty(),e)}function XI(n){return new bi(n.readTime,n.key,Yl)}class bi{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new bi(tt.min(),Fe.empty(),Yl)}static max(){return new bi(tt.max(),Fe.empty(),Yl)}}function rv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Fe.comparator(n.documentKey,e.documentKey),t!==0?t:at(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class e1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bo(n){if(n.code!==Se.FAILED_PRECONDITION||n.message!==ZI)throw n;Pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&je(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce(((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.reject(t)}static resolve(e){return new ce(((t,i)=>{t(e)}))}static reject(e){return new ce(((t,i)=>{i(e)}))}static waitFor(e){return new ce(((t,i)=>{let r=0,o=0,l=!1;e.forEach((c=>{++r,c.next((()=>{++o,l&&o===r&&t()}),(d=>i(d)))})),l=!0,o===r&&t()}))}static or(e){let t=ce.resolve(!1);for(const i of e)t=t.next((r=>r?ce.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,o)=>{i.push(t.call(this,r,o))})),this.waitFor(i)}static mapArray(e,t){return new ce(((i,r)=>{const o=e.length,l=new Array(o);let c=0;for(let d=0;d<o;d++){const f=d;t(e[f]).next((m=>{l[f]=m,++c,c===o&&i(l)}),(m=>r(m)))}}))}static doWhile(e,t){return new ce(((i,r)=>{const o=()=>{e()===!0?t().next((()=>{o()}),r):i()};o()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i="SimpleDb";class Dp{static open(e,t,i,r){try{return new Dp(t,e.transaction(r,i))}catch(o){throw new Kc(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ss,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Kc(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=sv(i.target.error);this.S.reject(new Kc(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Pe(_i,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new pV(t)}}class co{static delete(e){return Pe(_i,"Removing database:",e),oa($A().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ZA())return!1;if(co.F())return!0;const e=xn(),t=co.M(e),i=0<t&&t<10,r=t1(e),o=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||o)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,co.M(xn())===12.2&&fn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Pe(_i,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=o=>{const l=o.target.result;t(l)},r.onblocked=()=>{i(new Kc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=o=>{const l=o.target.error;l.name==="VersionError"?i(new Ue(Se.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?i(new Ue(Se.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):i(new Kc(e,l))},r.onupgradeneeded=o=>{Pe(_i,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const l=o.target.result;this.N.k(l,r.transaction,o.oldVersion,this.version).next((()=>{Pe(_i,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const o=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const c=Dp.open(this.db,e,o?"readonly":"readwrite",i),d=r(c).next((f=>(c.C(),f))).catch((f=>(c.abort(f),ce.reject(f)))).toPromise();return d.catch((()=>{})),await c.D,d}catch(c){const d=c,f=d.name!=="FirebaseError"&&l<3;if(Pe(_i,"Transaction failed with error:",d.message,"Retrying:",f),this.close(),!f)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function t1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class hV{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return oa(this.U.delete())}}class Kc extends Ue{constructor(e,t){super(Se.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function So(n){return n.name==="IndexedDbTransactionError"}class pV{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(Pe(_i,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(Pe(_i,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),oa(i)}add(e){return Pe(_i,"ADD",this.store.name,e,e),oa(this.store.add(e))}get(e){return oa(this.store.get(e)).next((t=>(t===void 0&&(t=null),Pe(_i,"GET",this.store.name,e,t),t)))}delete(e){return Pe(_i,"DELETE",this.store.name,e),oa(this.store.delete(e))}count(){return Pe(_i,"COUNT",this.store.name),oa(this.store.count())}H(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const o=r.getAll(i.range);return new ce(((l,c)=>{o.onerror=d=>{c(d.target.error)},o.onsuccess=d=>{l(d.target.result)}}))}{const o=this.cursor(i),l=[];return this.J(o,((c,d)=>{l.push(d)})).next((()=>l))}}Z(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new ce(((r,o)=>{i.onerror=l=>{o(l.target.error)},i.onsuccess=l=>{r(l.target.result)}}))}X(e,t){Pe(_i,"DELETE ALL",this.store.name);const i=this.options(e,t);i.Y=!1;const r=this.cursor(i);return this.J(r,((o,l,c)=>c.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.J(r,t)}te(e){const t=this.cursor({});return new ce(((i,r)=>{t.onerror=o=>{const l=sv(o.target.error);r(l)},t.onsuccess=o=>{const l=o.target.result;l?e(l.primaryKey,l.value).next((c=>{c?l.continue():i()})):i()}}))}J(e,t){const i=[];return new ce(((r,o)=>{e.onerror=l=>{o(l.target.error)},e.onsuccess=l=>{const c=l.target.result;if(!c)return void r();const d=new hV(c),f=t(c.primaryKey,c.value,d);if(f instanceof ce){const m=f.catch((v=>(d.done(),ce.reject(v))));i.push(m)}d.isDone?r():d.G===null?c.continue():c.continue(d.G)}})).next((()=>ce.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.Y?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function oa(n){return new ce(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=sv(i.target.error);t(r)}}))}let kS=!1;function sv(n){const e=co.M(xn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Ue("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return kS||(kS=!0,setTimeout((()=>{throw i}),0)),i}}return n}const Jc="IndexBackfiller";class mV{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Pe(Jc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Pe(Jc,`Documents written: ${t}`)}catch(t){So(t)?Pe(Jc,"Ignoring IndexedDB error during index backfill: ",t):await bo(t)}await this.re(6e4)}))}}class gV{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,o=!0;return ce.doWhile((()=>o===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!i.has(l))return Pe(Jc,`Processing collection: ${l}`),this.oe(e,l,r).next((c=>{r-=c,i.add(l)}));o=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((o=>{const l=o.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(r,o))).next((c=>(Pe(Jc,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>l.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,o)=>{const l=XI(o);rv(l,i)>0&&(i=l)})),new bi(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ai.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ma=-1;function Pp(n){return n==null}function ud(n){return n===0&&1/n==-1/0}function n1(n){return typeof n=="number"&&Number.isInteger(n)&&!ud(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qh="";function Kn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=MS(e)),e=yV(n.get(t),e);return MS(e)}function yV(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const o=n.charAt(r);switch(o){case"\0":t+="";break;case Qh:t+="";break;default:t+=o}}return t}function MS(n){return n+Qh+""}function Rr(n){const e=n.length;if(Ze(e>=2,64408,{path:n}),e===2)return Ze(n.charAt(0)===Qh&&n.charAt(1)==="",56145,{path:n}),Vt.emptyPath();const t=e-2,i=[];let r="";for(let o=0;o<e;){const l=n.indexOf(Qh,o);switch((l<0||l>t)&&je(50515,{path:n}),n.charAt(l+1)){case"":const c=n.substring(o,l);let d;r.length===0?d=c:(r+=c,d=r,r=""),i.push(d);break;case"":r+=n.substring(o,l),r+="\0";break;case"":r+=n.substring(o,l+1);break;default:je(61167,{path:n})}o=l+2}return new Vt(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra="remoteDocuments",Nd="owner",Sl="owner",cd="mutationQueues",_V="userId",Zi="mutations",DS="batchId",ha="userMutationsIndex",PS=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(n,e){return[n,Kn(e)]}function i1(n,e,t){return[n,Kn(e),t]}const vV={},Wl="documentMutations",Xh="remoteDocumentsV14",EV=["prefixPath","collectionGroup","readTime","documentId"],Mh="documentKeyIndex",TV=["prefixPath","collectionGroup","documentId"],r1="collectionGroupIndex",bV=["collectionGroup","readTime","prefixPath","documentId"],dd="remoteDocumentGlobal",Wy="remoteDocumentGlobalKey",Ql="targets",s1="queryTargetsIndex",SV=["canonicalId","targetId"],Xl="targetDocuments",wV=["targetId","path"],ov="documentTargetsIndex",xV=["path","targetId"],Zh="targetGlobalKey",ga="targetGlobal",fd="collectionParents",AV=["collectionId","parent"],Zl="clientMetadata",IV="clientId",Op="bundles",CV="bundleId",Vp="namedQueries",RV="name",av="indexConfiguration",NV="indexId",Qy="collectionGroupIndex",kV="collectionGroup",Yc="indexState",MV=["indexId","uid"],o1="sequenceNumberIndex",DV=["uid","sequenceNumber"],Wc="indexEntries",PV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],a1="documentKeyIndex",OV=["indexId","uid","orderedDocumentKey"],Up="documentOverlays",VV=["userId","collectionPath","documentId"],Xy="collectionPathOverlayIndex",UV=["userId","collectionPath","largestBatchId"],l1="collectionGroupOverlayIndex",LV=["userId","collectionGroup","largestBatchId"],lv="globals",BV="name",u1=[cd,Zi,Wl,ra,Ql,Nd,ga,Xl,Zl,dd,fd,Op,Vp],FV=[...u1,Up],c1=[cd,Zi,Wl,Xh,Ql,Nd,ga,Xl,Zl,dd,fd,Op,Vp,Up],d1=c1,uv=[...d1,av,Yc,Wc],zV=uv,f1=[...uv,lv],GV=f1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy extends e1{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function An(n,e){const t=We(n);return co.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function h1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,t){this.comparator=e,this.root=t||Fn.EMPTY}insert(e,t){return new Qt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Fn.BLACK,null,null))}remove(e){return new Qt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new uh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new uh(this.root,e,this.comparator,!1)}getReverseIterator(){return new uh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new uh(this.root,e,this.comparator,!0)}}class uh{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fn{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??Fn.RED,this.left=r??Fn.EMPTY,this.right=o??Fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,o){return new Fn(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Fn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Fn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw je(43730,{key:this.key,value:this.value});if(this.right.isRed())throw je(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw je(27949);return e+(this.isRed()?0:1)}}Fn.EMPTY=null,Fn.RED=!0,Fn.BLACK=!1;Fn.EMPTY=new class{constructor(){this.size=0}get key(){throw je(57766)}get value(){throw je(16141)}get color(){throw je(16727)}get left(){throw je(29726)}get right(){throw je(36894)}copy(e,t,i,r,o){return this}insert(e,t,i){return new Fn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.comparator=e,this.data=new Qt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new VS(this.data.getIterator())}getIteratorFrom(e){return new VS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof qt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new qt(this.comparator);return t.data=e,t}}class VS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function wl(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e){this.fields=e,e.sort(sn.comparator)}static empty(){return new li([])}unionWith(e){let t=new qt(sn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new li(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new p1("Invalid base64 string: "+o):o}})(e);return new pn(t)}static fromUint8Array(e){const t=(function(r){let o="";for(let l=0;l<r.length;++l)o+=String.fromCharCode(r[l]);return o})(e);return new pn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return at(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pn.EMPTY_BYTE_STRING=new pn("");const qV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ls(n){if(Ze(!!n,39018),typeof n=="string"){let e=0;const t=qV.exec(n);if(Ze(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:nn(n.seconds),nanos:nn(n.nanos)}}function nn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function us(n){return typeof n=="string"?pn.fromBase64String(n):pn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1="server_timestamp",g1="__type__",y1="__previous_value__",_1="__local_write_time__";function cv(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[g1])==null?void 0:i.stringValue)===m1}function Lp(n){const e=n.mapValue.fields[y1];return cv(e)?Lp(e):e}function hd(n){const e=ls(n.mapValue.fields[_1].timestampValue);return new zt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e,t,i,r,o,l,c,d,f,m,v){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=c,this.longPollingOptions=d,this.useFetchStreams=f,this.isUsingEmulator=m,this.apiKey=v}}const pd="(default)";class Ia{constructor(e,t){this.projectId=e,this.database=t||pd}static empty(){return new Ia("","")}get isDefaultDatabase(){return this.database===pd}isEqual(e){return e instanceof Ia&&e.projectId===this.projectId&&e.database===this.database}}function $V(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Ue(Se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ia(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv="__type__",v1="__max__",so={mapValue:{fields:{__type__:{stringValue:v1}}}},fv="__vector__",eu="value",Dh={nullValue:"NULL_VALUE"};function mo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?cv(n)?4:E1(n)?9007199254740991:Bp(n)?10:11:je(28295,{value:n})}function Pr(n,e){if(n===e)return!0;const t=mo(n);if(t!==mo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return hd(n).isEqual(hd(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;const l=ls(r.timestampValue),c=ls(o.timestampValue);return l.seconds===c.seconds&&l.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return us(r.bytesValue).isEqual(us(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return nn(r.geoPointValue.latitude)===nn(o.geoPointValue.latitude)&&nn(r.geoPointValue.longitude)===nn(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return nn(r.integerValue)===nn(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){const l=nn(r.doubleValue),c=nn(o.doubleValue);return l===c?ud(l)===ud(c):isNaN(l)&&isNaN(c)}return!1})(n,e);case 9:return Jl(n.arrayValue.values||[],e.arrayValue.values||[],Pr);case 10:case 11:return(function(r,o){const l=r.mapValue.fields||{},c=o.mapValue.fields||{};if(OS(l)!==OS(c))return!1;for(const d in l)if(l.hasOwnProperty(d)&&(c[d]===void 0||!Pr(l[d],c[d])))return!1;return!0})(n,e);default:return je(52216,{left:n})}}function md(n,e){return(n.values||[]).find((t=>Pr(t,e)))!==void 0}function go(n,e){if(n===e)return 0;const t=mo(n),i=mo(e);if(t!==i)return at(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return at(n.booleanValue,e.booleanValue);case 2:return(function(o,l){const c=nn(o.integerValue||o.doubleValue),d=nn(l.integerValue||l.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1})(n,e);case 3:return US(n.timestampValue,e.timestampValue);case 4:return US(hd(n),hd(e));case 5:return Jy(n.stringValue,e.stringValue);case 6:return(function(o,l){const c=us(o),d=us(l);return c.compareTo(d)})(n.bytesValue,e.bytesValue);case 7:return(function(o,l){const c=o.split("/"),d=l.split("/");for(let f=0;f<c.length&&f<d.length;f++){const m=at(c[f],d[f]);if(m!==0)return m}return at(c.length,d.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,l){const c=at(nn(o.latitude),nn(l.latitude));return c!==0?c:at(nn(o.longitude),nn(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return LS(n.arrayValue,e.arrayValue);case 10:return(function(o,l){var E,b,I,x;const c=o.fields||{},d=l.fields||{},f=(E=c[eu])==null?void 0:E.arrayValue,m=(b=d[eu])==null?void 0:b.arrayValue,v=at(((I=f==null?void 0:f.values)==null?void 0:I.length)||0,((x=m==null?void 0:m.values)==null?void 0:x.length)||0);return v!==0?v:LS(f,m)})(n.mapValue,e.mapValue);case 11:return(function(o,l){if(o===so.mapValue&&l===so.mapValue)return 0;if(o===so.mapValue)return 1;if(l===so.mapValue)return-1;const c=o.fields||{},d=Object.keys(c),f=l.fields||{},m=Object.keys(f);d.sort(),m.sort();for(let v=0;v<d.length&&v<m.length;++v){const E=Jy(d[v],m[v]);if(E!==0)return E;const b=go(c[d[v]],f[m[v]]);if(b!==0)return b}return at(d.length,m.length)})(n.mapValue,e.mapValue);default:throw je(23264,{he:t})}}function US(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return at(n,e);const t=ls(n),i=ls(e),r=at(t.seconds,i.seconds);return r!==0?r:at(t.nanos,i.nanos)}function LS(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const o=go(t[r],i[r]);if(o)return o}return at(t.length,i.length)}function tu(n){return e_(n)}function e_(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ls(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return us(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Fe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const o of t.values||[])r?r=!1:i+=",",i+=e_(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",o=!0;for(const l of i)o?o=!1:r+=",",r+=`${l}:${e_(t.fields[l])}`;return r+"}"})(n.mapValue):je(61005,{value:n})}function Ph(n){switch(mo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Lp(n);return e?16+Ph(e):16;case 5:return 2*n.stringValue.length;case 6:return us(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,o)=>r+Ph(o)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return wo(i.fields,((o,l)=>{r+=o.length+Ph(l)})),r})(n.mapValue);default:throw je(13486,{value:n})}}function gd(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function t_(n){return!!n&&"integerValue"in n}function yd(n){return!!n&&"arrayValue"in n}function BS(n){return!!n&&"nullValue"in n}function FS(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Oh(n){return!!n&&"mapValue"in n}function Bp(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[dv])==null?void 0:i.stringValue)===fv}function Qc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return wo(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Qc(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Qc(n.arrayValue.values[t]);return e}return{...n}}function E1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===v1}const T1={mapValue:{fields:{[dv]:{stringValue:fv},[eu]:{arrayValue:{}}}}};function jV(n){return"nullValue"in n?Dh:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?gd(Ia.empty(),Fe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Bp(n)?T1:{mapValue:{}}:je(35942,{value:n})}function KV(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?gd(Ia.empty(),Fe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?T1:"mapValue"in n?Bp(n)?{mapValue:{}}:so:je(61959,{value:n})}function zS(n,e){const t=go(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function GS(n,e){const t=go(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.value=e}static empty(){return new Hn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Oh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qc(t)}setAll(e){let t=sn.emptyPath(),i={},r=[];e.forEach(((l,c)=>{if(!t.isImmediateParentOf(c)){const d=this.getFieldsMap(t);this.applyChanges(d,i,r),i={},r=[],t=c.popLast()}l?i[c.lastSegment()]=Qc(l):r.push(c.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,i,r)}delete(e){const t=this.field(e.popLast());Oh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Pr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Oh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){wo(t,((r,o)=>e[r]=o));for(const r of i)delete e[r]}clone(){return new Hn(Qc(this.value))}}function b1(n){const e=[];return wo(n.fields,((t,i)=>{const r=new sn([t]);if(Oh(i)){const o=b1(i.mapValue).fields;if(o.length===0)e.push(r);else for(const l of o)e.push(r.child(l))}else e.push(r)})),new li(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,t,i,r,o,l,c){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=o,this.data=l,this.documentState=c}static newInvalidDocument(e){return new ln(e,0,tt.min(),tt.min(),tt.min(),Hn.empty(),0)}static newFoundDocument(e,t,i,r){return new ln(e,1,t,tt.min(),i,r,0)}static newNoDocument(e,t){return new ln(e,2,t,tt.min(),tt.min(),Hn.empty(),0)}static newUnknownDocument(e,t){return new ln(e,3,t,tt.min(),tt.min(),Hn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(tt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Hn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Hn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ln&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ln(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e,t){this.position=e,this.inclusive=t}}function qS(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const o=e[r],l=n.position[r];if(o.field.isKeyField()?i=Fe.comparator(Fe.fromName(l.referenceValue),t.key):i=go(l,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function HS(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Pr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,t="asc"){this.field=e,this.dir=t}}function JV(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{}class St extends S1{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new YV(e,t,i):t==="array-contains"?new XV(e,i):t==="in"?new R1(e,i):t==="not-in"?new ZV(e,i):t==="array-contains-any"?new eU(e,i):new St(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new WV(e,i):new QV(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(go(t,this.value)):t!==null&&mo(this.value)===mo(t)&&this.matchesComparison(go(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return je(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Gt extends S1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Gt(e,t)}matches(e){return iu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function iu(n){return n.op==="and"}function n_(n){return n.op==="or"}function hv(n){return w1(n)&&iu(n)}function w1(n){for(const e of n.filters)if(e instanceof Gt)return!1;return!0}function i_(n){if(n instanceof St)return n.field.canonicalString()+n.op.toString()+tu(n.value);if(hv(n))return n.filters.map((e=>i_(e))).join(",");{const e=n.filters.map((t=>i_(t))).join(",");return`${n.op}(${e})`}}function x1(n,e){return n instanceof St?(function(i,r){return r instanceof St&&i.op===r.op&&i.field.isEqual(r.field)&&Pr(i.value,r.value)})(n,e):n instanceof Gt?(function(i,r){return r instanceof Gt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((o,l,c)=>o&&x1(l,r.filters[c])),!0):!1})(n,e):void je(19439)}function A1(n,e){const t=n.filters.concat(e);return Gt.create(t,n.op)}function I1(n){return n instanceof St?(function(t){return`${t.field.canonicalString()} ${t.op} ${tu(t.value)}`})(n):n instanceof Gt?(function(t){return t.op.toString()+" {"+t.getFilters().map(I1).join(" ,")+"}"})(n):"Filter"}class YV extends St{constructor(e,t,i){super(e,t,i),this.key=Fe.fromName(i.referenceValue)}matches(e){const t=Fe.comparator(e.key,this.key);return this.matchesComparison(t)}}class WV extends St{constructor(e,t){super(e,"in",t),this.keys=C1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class QV extends St{constructor(e,t){super(e,"not-in",t),this.keys=C1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function C1(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>Fe.fromName(i.referenceValue)))}class XV extends St{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return yd(t)&&md(t.arrayValue,this.value)}}class R1 extends St{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&md(this.value.arrayValue,t)}}class ZV extends St{constructor(e,t){super(e,"not-in",t)}matches(e){if(md(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!md(this.value.arrayValue,t)}}class eU extends St{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!yd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>md(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(e,t=null,i=[],r=[],o=null,l=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=l,this.endAt=c,this.Te=null}}function r_(n,e=null,t=[],i=[],r=null,o=null,l=null){return new tU(n,e,t,i,r,o,l)}function Ca(n){const e=We(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>i_(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(o){return o.field.canonicalString()+o.dir})(i))).join(","),Pp(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>tu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>tu(i))).join(",")),e.Te=t}return e.Te}function kd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!JV(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!x1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!HS(n.startAt,e.startAt)&&HS(n.endAt,e.endAt)}function ep(n){return Fe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function tp(n,e){return n.filters.filter((t=>t instanceof St&&t.field.isEqual(e)))}function $S(n,e,t){let i=Dh,r=!0;for(const o of tp(n,e)){let l=Dh,c=!0;switch(o.op){case"<":case"<=":l=jV(o.value);break;case"==":case"in":case">=":l=o.value;break;case">":l=o.value,c=!1;break;case"!=":case"not-in":l=Dh}zS({value:i,inclusive:r},{value:l,inclusive:c})<0&&(i=l,r=c)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const l=t.position[o];zS({value:i,inclusive:r},{value:l,inclusive:t.inclusive})<0&&(i=l,r=t.inclusive);break}}return{value:i,inclusive:r}}function jS(n,e,t){let i=so,r=!0;for(const o of tp(n,e)){let l=so,c=!0;switch(o.op){case">=":case">":l=KV(o.value),c=!1;break;case"==":case"in":case"<=":l=o.value;break;case"<":l=o.value,c=!1;break;case"!=":case"not-in":l=so}GS({value:i,inclusive:r},{value:l,inclusive:c})>0&&(i=l,r=c)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const l=t.position[o];GS({value:i,inclusive:r},{value:l,inclusive:t.inclusive})>0&&(i=l,r=t.inclusive);break}}return{value:i,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e,t=null,i=[],r=[],o=null,l="F",c=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=l,this.startAt=c,this.endAt=d,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function N1(n,e,t,i,r,o,l,c){return new yu(n,e,t,i,r,o,l,c)}function Fp(n){return new yu(n)}function KS(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function nU(n){return Fe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function k1(n){return n.collectionGroup!==null}function Xc(n){const e=We(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let c=new qt(sn.comparator);return l.filters.forEach((d=>{d.getFlattenedFilters().forEach((f=>{f.isInequality()&&(c=c.add(f.field))}))})),c})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new _d(o,i))})),t.has(sn.keyField().canonicalString())||e.Ie.push(new _d(sn.keyField(),i))}return e.Ie}function Ti(n){const e=We(n);return e.Ee||(e.Ee=iU(e,Xc(n))),e.Ee}function iU(n,e){if(n.limitType==="F")return r_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const o=r.dir==="desc"?"asc":"desc";return new _d(r.field,o)}));const t=n.endAt?new nu(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new nu(n.startAt.position,n.startAt.inclusive):null;return r_(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function s_(n,e){const t=n.filters.concat([e]);return new yu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function rU(n,e){const t=n.explicitOrderBy.concat([e]);return new yu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function o_(n,e,t){return new yu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function zp(n,e){return kd(Ti(n),Ti(e))&&n.limitType===e.limitType}function M1(n){return`${Ca(Ti(n))}|lt:${n.limitType}`}function Ml(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>I1(r))).join(", ")}]`),Pp(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>tu(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>tu(r))).join(",")),`Target(${i})`})(Ti(n))}; limitType=${n.limitType})`}function Md(n,e){return e.isFoundDocument()&&(function(i,r){const o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Fe.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,r){for(const o of Xc(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const o of i.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(l,c,d){const f=qS(l,c,d);return l.inclusive?f<=0:f<0})(i.startAt,Xc(i),r)||i.endAt&&!(function(l,c,d){const f=qS(l,c,d);return l.inclusive?f>=0:f>0})(i.endAt,Xc(i),r))})(n,e)}function D1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function P1(n){return(e,t)=>{let i=!1;for(const r of Xc(n)){const o=sU(r,e,t);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function sU(n,e,t){const i=n.field.isKeyField()?Fe.comparator(e.key,t.key):(function(o,l,c){const d=l.data.field(o),f=c.data.field(o);return d!==null&&f!==null?go(d,f):je(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return je(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){wo(this.inner,((t,i)=>{for(const[r,o]of i)e(r,o)}))}isEmpty(){return h1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oU=new Qt(Fe.comparator);function Ei(){return oU}const O1=new Qt(Fe.comparator);function Bc(...n){let e=O1;for(const t of n)e=e.insert(t.key,t);return e}function V1(n){let e=O1;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Nr(){return Zc()}function U1(){return Zc()}function Zc(){return new hs((n=>n.toString()),((n,e)=>n.isEqual(e)))}const aU=new Qt(Fe.comparator),lU=new qt(Fe.comparator);function yt(...n){let e=lU;for(const t of n)e=e.add(t);return e}const uU=new qt(at);function pv(){return uU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ud(e)?"-0":e}}function L1(n){return{integerValue:""+n}}function cU(n,e){return n1(e)?L1(e):mv(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(){this._=void 0}}function dU(n,e,t){return n instanceof ru?(function(r,o){const l={fields:{[g1]:{stringValue:m1},[_1]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&cv(o)&&(o=Lp(o)),o&&(l.fields[y1]=o),{mapValue:l}})(t,e):n instanceof su?F1(n,e):n instanceof ou?z1(n,e):(function(r,o){const l=B1(r,o),c=JS(l)+JS(r.Ae);return t_(l)&&t_(r.Ae)?L1(c):mv(r.serializer,c)})(n,e)}function fU(n,e,t){return n instanceof su?F1(n,e):n instanceof ou?z1(n,e):t}function B1(n,e){return n instanceof vd?(function(i){return t_(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}class ru extends Gp{}class su extends Gp{constructor(e){super(),this.elements=e}}function F1(n,e){const t=G1(e);for(const i of n.elements)t.some((r=>Pr(r,i)))||t.push(i);return{arrayValue:{values:t}}}class ou extends Gp{constructor(e){super(),this.elements=e}}function z1(n,e){let t=G1(e);for(const i of n.elements)t=t.filter((r=>!Pr(r,i)));return{arrayValue:{values:t}}}class vd extends Gp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function JS(n){return nn(n.integerValue||n.doubleValue)}function G1(n){return yd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(e,t){this.field=e,this.transform=t}}function hU(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof su&&r instanceof su||i instanceof ou&&r instanceof ou?Jl(i.elements,r.elements,Pr):i instanceof vd&&r instanceof vd?Pr(i.Ae,r.Ae):i instanceof ru&&r instanceof ru})(n.transform,e.transform)}class pU{constructor(e,t){this.version=e,this.transformResults=t}}class $n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new $n}static exists(e){return new $n(void 0,e)}static updateTime(e){return new $n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Vh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class qp{}function H1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Hp(n.key,$n.none()):new _u(n.key,n.data,$n.none());{const t=n.data,i=Hn.empty();let r=new qt(sn.comparator);for(let o of e.fields)if(!r.has(o)){let l=t.field(o);l===null&&o.length>1&&(o=o.popLast(),l=t.field(o)),l===null?i.delete(o):i.set(o,l),r=r.add(o)}return new ps(n.key,i,new li(r.toArray()),$n.none())}}function mU(n,e,t){n instanceof _u?(function(r,o,l){const c=r.value.clone(),d=WS(r.fieldTransforms,o,l.transformResults);c.setAll(d),o.convertToFoundDocument(l.version,c).setHasCommittedMutations()})(n,e,t):n instanceof ps?(function(r,o,l){if(!Vh(r.precondition,o))return void o.convertToUnknownDocument(l.version);const c=WS(r.fieldTransforms,o,l.transformResults),d=o.data;d.setAll($1(r)),d.setAll(c),o.convertToFoundDocument(l.version,d).setHasCommittedMutations()})(n,e,t):(function(r,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function ed(n,e,t,i){return n instanceof _u?(function(o,l,c,d){if(!Vh(o.precondition,l))return c;const f=o.value.clone(),m=QS(o.fieldTransforms,d,l);return f.setAll(m),l.convertToFoundDocument(l.version,f).setHasLocalMutations(),null})(n,e,t,i):n instanceof ps?(function(o,l,c,d){if(!Vh(o.precondition,l))return c;const f=QS(o.fieldTransforms,d,l),m=l.data;return m.setAll($1(o)),m.setAll(f),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((v=>v.field)))})(n,e,t,i):(function(o,l,c){return Vh(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):c})(n,e,t)}function gU(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),o=B1(i.transform,r||null);o!=null&&(t===null&&(t=Hn.empty()),t.set(i.field,o))}return t||null}function YS(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Jl(i,r,((o,l)=>hU(o,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class _u extends qp{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ps extends qp{constructor(e,t,i,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function $1(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function WS(n,e,t){const i=new Map;Ze(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let r=0;r<t.length;r++){const o=n[r],l=o.transform,c=e.data.field(o.field);i.set(o.field,fU(l,c,t[r]))}return i}function QS(n,e,t){const i=new Map;for(const r of n){const o=r.transform,l=t.data.field(r.field);i.set(r.field,dU(o,l,e))}return i}class Hp extends qp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class j1 extends qp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const o=this.mutations[r];o.key.isEqual(e.key)&&mU(o,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=ed(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=ed(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=U1();return this.mutations.forEach((r=>{const o=e.get(r.key),l=o.overlayedDocument;let c=this.applyToLocalView(l,o.mutatedFields);c=t.has(r.key)?null:c;const d=H1(l,c);d!==null&&i.set(r.key,d),l.isValidDocument()||l.convertToNoDocument(tt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),yt())}isEqual(e){return this.batchId===e.batchId&&Jl(this.mutations,e.mutations,((t,i)=>YS(t,i)))&&Jl(this.baseMutations,e.baseMutations,((t,i)=>YS(t,i)))}}class yv{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Ze(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return aU})();const o=e.mutations;for(let l=0;l<o.length;l++)r=r.insert(o[l].key,i[l].version);return new yv(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bn,At;function _U(n){switch(n){case Se.OK:return je(64938);case Se.CANCELLED:case Se.UNKNOWN:case Se.DEADLINE_EXCEEDED:case Se.RESOURCE_EXHAUSTED:case Se.INTERNAL:case Se.UNAVAILABLE:case Se.UNAUTHENTICATED:return!1;case Se.INVALID_ARGUMENT:case Se.NOT_FOUND:case Se.ALREADY_EXISTS:case Se.PERMISSION_DENIED:case Se.FAILED_PRECONDITION:case Se.ABORTED:case Se.OUT_OF_RANGE:case Se.UNIMPLEMENTED:case Se.DATA_LOSS:return!0;default:return je(15467,{code:n})}}function K1(n){if(n===void 0)return fn("GRPC error has no .code"),Se.UNKNOWN;switch(n){case bn.OK:return Se.OK;case bn.CANCELLED:return Se.CANCELLED;case bn.UNKNOWN:return Se.UNKNOWN;case bn.DEADLINE_EXCEEDED:return Se.DEADLINE_EXCEEDED;case bn.RESOURCE_EXHAUSTED:return Se.RESOURCE_EXHAUSTED;case bn.INTERNAL:return Se.INTERNAL;case bn.UNAVAILABLE:return Se.UNAVAILABLE;case bn.UNAUTHENTICATED:return Se.UNAUTHENTICATED;case bn.INVALID_ARGUMENT:return Se.INVALID_ARGUMENT;case bn.NOT_FOUND:return Se.NOT_FOUND;case bn.ALREADY_EXISTS:return Se.ALREADY_EXISTS;case bn.PERMISSION_DENIED:return Se.PERMISSION_DENIED;case bn.FAILED_PRECONDITION:return Se.FAILED_PRECONDITION;case bn.ABORTED:return Se.ABORTED;case bn.OUT_OF_RANGE:return Se.OUT_OF_RANGE;case bn.UNIMPLEMENTED:return Se.UNIMPLEMENTED;case bn.DATA_LOSS:return Se.DATA_LOSS;default:return je(39323,{code:n})}}(At=bn||(bn={}))[At.OK=0]="OK",At[At.CANCELLED=1]="CANCELLED",At[At.UNKNOWN=2]="UNKNOWN",At[At.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",At[At.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",At[At.NOT_FOUND=5]="NOT_FOUND",At[At.ALREADY_EXISTS=6]="ALREADY_EXISTS",At[At.PERMISSION_DENIED=7]="PERMISSION_DENIED",At[At.UNAUTHENTICATED=16]="UNAUTHENTICATED",At[At.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",At[At.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",At[At.ABORTED=10]="ABORTED",At[At.OUT_OF_RANGE=11]="OUT_OF_RANGE",At[At.UNIMPLEMENTED=12]="UNIMPLEMENTED",At[At.INTERNAL=13]="INTERNAL",At[At.UNAVAILABLE=14]="UNAVAILABLE",At[At.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vU(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EU=new uo([4294967295,4294967295],0);function XS(n){const e=vU().encode(n),t=new FI;return t.update(e),new Uint8Array(t.digest())}function ZS(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new uo([t,i],0),new uo([r,o],0)]}class vv{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Fc(`Invalid padding: ${t}`);if(i<0)throw new Fc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Fc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Fc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=uo.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(uo.fromNumber(i)));return r.compare(EU)===1&&(r=new uo([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=XS(e),[i,r]=ZS(t);for(let o=0;o<this.hashCount;o++){const l=this.ye(i,r,o);if(!this.we(l))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new vv(o,r,t);return i.forEach((c=>l.insert(c))),l}insert(e){if(this.ge===0)return;const t=XS(e),[i,r]=ZS(t);for(let o=0;o<this.hashCount;o++){const l=this.ye(i,r,o);this.be(l)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Fc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(e,t,i,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Pd.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Dd(tt.min(),r,new Qt(at),Ei(),yt())}}class Pd{constructor(e,t,i,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Pd(i,t,yt(),yt(),yt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=r}}class J1{constructor(e,t){this.targetId=e,this.Ce=t}}class Y1{constructor(e,t,i=pn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class ew{constructor(){this.ve=0,this.Fe=tw(),this.Me=pn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=yt(),t=yt(),i=yt();return this.Fe.forEach(((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:je(38017,{changeType:o})}})),new Pd(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=tw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Ze(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class TU{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ei(),this.He=ch(),this.Je=ch(),this.Ze=new Qt(at)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:je(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const o=r.target;if(ep(o))if(i===0){const l=new Fe(o.path);this.et(t,l,ln.newNoDocument(l,tt.min()))}else Ze(i===1,20013,{expectedCount:i});else{const l=this._t(t);if(l!==i){const c=this.ut(e),d=c?this.ct(c,e,l):1;if(d!==0){this.it(t);const f=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,f)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=t;let l,c;try{l=us(i).toUint8Array()}catch(d){if(d instanceof p1)return Aa("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{c=new vv(l,r,o)}catch(d){return Aa(d instanceof Fc?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return c.ge===0?null:c}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((o=>{const l=this.Ge.ht(),c=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.et(t,o,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((o,l)=>{const c=this.ot(l);if(c){if(o.current&&ep(c.target)){const d=new Fe(c.target.path);this.It(d).has(l)||this.Et(l,d)||this.et(l,d,ln.newNoDocument(d,e))}o.Be&&(t.set(l,o.ke()),o.Ke())}}));let i=yt();this.Je.forEach(((o,l)=>{let c=!0;l.forEachWhile((d=>{const f=this.ot(d);return!f||f.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(i=i.add(o))})),this.je.forEach(((o,l)=>l.setReadTime(e)));const r=new Dd(e,t,this.Ze,this.je,i);return this.je=Ei(),this.He=ch(),this.Je=ch(),this.Ze=new Qt(at),r}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new ew,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new qt(at),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new qt(at),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ew),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ch(){return new Qt(Fe.comparator)}function tw(){return new Qt(Fe.comparator)}const bU={asc:"ASCENDING",desc:"DESCENDING"},SU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wU={and:"AND",or:"OR"};class xU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function a_(n,e){return n.useProto3Json||Pp(e)?e:{value:e}}function au(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function W1(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function AU(n,e){return au(n,e.toTimestamp())}function Qn(n){return Ze(!!n,49232),tt.fromTimestamp((function(t){const i=ls(t);return new zt(i.seconds,i.nanos)})(n))}function Ev(n,e){return l_(n,e).canonicalString()}function l_(n,e){const t=(function(r){return new Vt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Q1(n){const e=Vt.fromString(n);return Ze(oC(e),10190,{key:e.toString()}),e}function np(n,e){return Ev(n.databaseId,e.path)}function ya(n,e){const t=Q1(e);if(t.get(1)!==n.databaseId.projectId)throw new Ue(Se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ue(Se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Fe(eC(t))}function X1(n,e){return Ev(n.databaseId,e)}function Z1(n){const e=Q1(n);return e.length===4?Vt.emptyPath():eC(e)}function u_(n){return new Vt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function eC(n){return Ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function nw(n,e,t){return{name:np(n,e),fields:t.value.mapValue.fields}}function IU(n,e,t){const i=ya(n,e.name),r=Qn(e.updateTime),o=e.createTime?Qn(e.createTime):tt.min(),l=new Hn({mapValue:{fields:e.fields}}),c=ln.newFoundDocument(i,r,o,l);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function CU(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:je(39313,{state:f})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(f,m){return f.useProto3Json?(Ze(m===void 0||typeof m=="string",58123),pn.fromBase64String(m||"")):(Ze(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),pn.fromUint8Array(m||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,c=l&&(function(f){const m=f.code===void 0?Se.UNKNOWN:K1(f.code);return new Ue(m,f.message||"")})(l);t=new Y1(i,r,o,c||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=ya(n,i.document.name),o=Qn(i.document.updateTime),l=i.document.createTime?Qn(i.document.createTime):tt.min(),c=new Hn({mapValue:{fields:i.document.fields}}),d=ln.newFoundDocument(r,o,l,c),f=i.targetIds||[],m=i.removedTargetIds||[];t=new Uh(f,m,d.key,d)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=ya(n,i.document),o=i.readTime?Qn(i.readTime):tt.min(),l=ln.newNoDocument(r,o),c=i.removedTargetIds||[];t=new Uh([],c,l.key,l)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=ya(n,i.document),o=i.removedTargetIds||[];t=new Uh([],o,r,null)}else{if(!("filter"in e))return je(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:o}=i,l=new yU(r,o),c=i.targetId;t=new J1(c,l)}}return t}function ip(n,e){let t;if(e instanceof _u)t={update:nw(n,e.key,e.value)};else if(e instanceof Hp)t={delete:np(n,e.key)};else if(e instanceof ps)t={update:nw(n,e.key,e.data),updateMask:PU(e.fieldMask)};else{if(!(e instanceof j1))return je(16599,{dt:e.type});t={verify:np(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(o,l){const c=l.transform;if(c instanceof ru)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof su)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ou)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof vd)return{fieldPath:l.field.canonicalString(),increment:c.Ae};throw je(20930,{transform:l.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:AU(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:je(27497)})(n,e.precondition)),t}function c_(n,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?$n.updateTime(Qn(o.updateTime)):o.exists!==void 0?$n.exists(o.exists):$n.none()})(e.currentDocument):$n.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(l,c){let d=null;if("setToServerValue"in c)Ze(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),d=new ru;else if("appendMissingElements"in c){const m=c.appendMissingElements.values||[];d=new su(m)}else if("removeAllFromArray"in c){const m=c.removeAllFromArray.values||[];d=new ou(m)}else"increment"in c?d=new vd(l,c.increment):je(16584,{proto:c});const f=sn.fromServerFormat(c.fieldPath);return new q1(f,d)})(n,r))):[];if(e.update){e.update.name;const r=ya(n,e.update.name),o=new Hn({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(d){const f=d.fieldPaths||[];return new li(f.map((m=>sn.fromServerFormat(m))))})(e.updateMask);return new ps(r,o,l,t,i)}return new _u(r,o,t,i)}if(e.delete){const r=ya(n,e.delete);return new Hp(r,t)}if(e.verify){const r=ya(n,e.verify);return new j1(r,t)}return je(1463,{proto:e})}function RU(n,e){return n&&n.length>0?(Ze(e!==void 0,14353),n.map((t=>(function(r,o){let l=r.updateTime?Qn(r.updateTime):Qn(o);return l.isEqual(tt.min())&&(l=Qn(o)),new pU(l,r.transformResults||[])})(t,e)))):[]}function tC(n,e){return{documents:[X1(n,e.path)]}}function nC(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=X1(n,r);const o=(function(f){if(f.length!==0)return sC(Gt.create(f,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const l=(function(f){if(f.length!==0)return f.map((m=>(function(E){return{field:Dl(E.field),direction:kU(E.dir)}})(m)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const c=a_(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(f){return{before:f.inclusive,values:f.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(f){return{before:!f.inclusive,values:f.position}})(e.endAt)),{ft:t,parent:r}}function iC(n){let e=Z1(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Ze(i===1,65062);const m=t.from[0];m.allDescendants?r=m.collectionId:e=e.child(m.collectionId)}let o=[];t.where&&(o=(function(v){const E=rC(v);return E instanceof Gt&&hv(E)?E.getFilters():[E]})(t.where));let l=[];t.orderBy&&(l=(function(v){return v.map((E=>(function(I){return new _d(Pl(I.field),(function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(I.direction))})(E)))})(t.orderBy));let c=null;t.limit&&(c=(function(v){let E;return E=typeof v=="object"?v.value:v,Pp(E)?null:E})(t.limit));let d=null;t.startAt&&(d=(function(v){const E=!!v.before,b=v.values||[];return new nu(b,E)})(t.startAt));let f=null;return t.endAt&&(f=(function(v){const E=!v.before,b=v.values||[];return new nu(b,E)})(t.endAt)),N1(e,r,l,o,c,"F",d,f)}function NU(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return je(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function rC(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Pl(t.unaryFilter.field);return St.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Pl(t.unaryFilter.field);return St.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Pl(t.unaryFilter.field);return St.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Pl(t.unaryFilter.field);return St.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return je(61313);default:return je(60726)}})(n):n.fieldFilter!==void 0?(function(t){return St.create(Pl(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return je(58110);default:return je(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Gt.create(t.compositeFilter.filters.map((i=>rC(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return je(1026)}})(t.compositeFilter.op))})(n):je(30097,{filter:n})}function kU(n){return bU[n]}function MU(n){return SU[n]}function DU(n){return wU[n]}function Dl(n){return{fieldPath:n.canonicalString()}}function Pl(n){return sn.fromServerFormat(n.fieldPath)}function sC(n){return n instanceof St?(function(t){if(t.op==="=="){if(FS(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NAN"}};if(BS(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(FS(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NOT_NAN"}};if(BS(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Dl(t.field),op:MU(t.op),value:t.value}}})(n):n instanceof Gt?(function(t){const i=t.getFilters().map((r=>sC(r)));return i.length===1?i[0]:{compositeFilter:{op:DU(t.op),filters:i}}})(n):je(54877,{filter:n})}function PU(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function oC(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function aC(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,t,i,r,o=tt.min(),l=tt.min(),c=pn.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=c,this.expectedCount=d}withSequenceNumber(e){return new rs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new rs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new rs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new rs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e){this.yt=e}}function OU(n,e){let t;if(e.document)t=IU(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Fe.fromSegments(e.noDocument.path),r=Na(e.noDocument.readTime);t=ln.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return je(56709);{const i=Fe.fromSegments(e.unknownDocument.path),r=Na(e.unknownDocument.version);t=ln.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const o=new zt(r[0],r[1]);return tt.fromTimestamp(o)})(e.readTime)),t}function iw(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:rp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(o,l){return{name:np(o,l.key),fields:l.data.value.mapValue.fields,updateTime:au(o,l.version.toTimestamp()),createTime:au(o,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Ra(e.version)};else{if(!e.isUnknownDocument())return je(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Ra(e.version)}}return i}function rp(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ra(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Na(n){const e=new zt(n.seconds,n.nanoseconds);return tt.fromTimestamp(e)}function aa(n,e){const t=(e.baseMutations||[]).map((o=>c_(n.yt,o)));for(let o=0;o<e.mutations.length-1;++o){const l=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const c=e.mutations[o+1];l.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const i=e.mutations.map((o=>c_(n.yt,o))),r=zt.fromMillis(e.localWriteTimeMs);return new gv(e.batchId,r,t,i)}function zc(n){const e=Na(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Na(n.lastLimboFreeSnapshotVersion):tt.min();let i;return i=(function(o){return o.documents!==void 0})(n.query)?(function(o){const l=o.documents.length;return Ze(l===1,1966,{count:l}),Ti(Fp(Z1(o.documents[0])))})(n.query):(function(o){return Ti(iC(o))})(n.query),new rs(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,pn.fromBase64String(n.resumeToken))}function uC(n,e){const t=Ra(e.snapshotVersion),i=Ra(e.lastLimboFreeSnapshotVersion);let r;r=ep(e.target)?tC(n.yt,e.target):nC(n.yt,e.target).ft;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ca(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function cC(n){const e=iC({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?o_(e,e.limit,"L"):e}function _y(n,e){return new _v(e.largestBatchId,c_(n.yt,e.overlayMutation))}function rw(n,e){const t=e.path.lastSegment();return[n,Kn(e.path.popLast()),t]}function sw(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ra(i.readTime),documentKey:Kn(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{getBundleMetadata(e,t){return ow(e).get(t).next((i=>{if(i)return(function(o){return{id:o.bundleId,createTime:Na(o.createTime),version:o.version}})(i)}))}saveBundleMetadata(e,t){return ow(e).put((function(r){return{bundleId:r.id,createTime:Ra(Qn(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return aw(e).get(t).next((i=>{if(i)return(function(o){return{name:o.name,query:cC(o.bundledQuery),readTime:Na(o.readTime)}})(i)}))}saveNamedQuery(e,t){return aw(e).put((function(r){return{name:r.name,readTime:Ra(Qn(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function ow(n){return An(n,Op)}function aw(n){return An(n,Vp)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new $p(e,i)}getOverlay(e,t){return Ac(e).get(rw(this.userId,t)).next((i=>i?_y(this.serializer,i):null))}getOverlays(e,t){const i=Nr();return ce.forEach(t,(r=>this.getOverlay(e,r).next((o=>{o!==null&&i.set(r,o)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((o,l)=>{const c=new _v(t,l);r.push(this.bt(e,c))})),ce.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((l=>r.add(Kn(l.getCollectionPath()))));const o=[];return r.forEach((l=>{const c=IDBKeyRange.bound([this.userId,l,i],[this.userId,l,i+1],!1,!0);o.push(Ac(e).X(Xy,c))})),ce.waitFor(o)}getOverlaysForCollection(e,t,i){const r=Nr(),o=Kn(t),l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Ac(e).H(Xy,l).next((c=>{for(const d of c){const f=_y(this.serializer,d);r.set(f.getKey(),f)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const o=Nr();let l;const c=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ac(e).ee({index:l1,range:c},((d,f,m)=>{const v=_y(this.serializer,f);o.size()<r||v.largestBatchId===l?(o.set(v.getKey(),v),l=v.largestBatchId):m.done()})).next((()=>o))}bt(e,t){return Ac(e).put((function(r,o,l){const[c,d,f]=rw(o,l.mutation.key);return{userId:o,collectionPath:d,documentId:f,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:ip(r.yt,l.mutation)}})(this.serializer,this.userId,t))}}function Ac(n){return An(n,Up)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{St(e){return An(e,lv)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const i=t==null?void 0:t.value;return i?pn.fromUint8Array(i):pn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(nn(e.integerValue));else if("doubleValue"in e){const i=nn(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),ud(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ls(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(us(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?E1(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Bp(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):je(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){var l,c;const i=e.fields||{};this.Ft(t,53);const r=eu,o=((c=(l=i[r].arrayValue)==null?void 0:l.values)==null?void 0:c.length)||0;this.Ft(t,15),t.Mt(nn(o)),this.Ot(r,t),this.Ct(i[r],t)}qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Fe.fromName(e).path.forEach((i=>{this.Ft(t,60),this.$t(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}la.Wt=new la;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xl=255;function LU(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function lw(n){const e=64-(function(i){let r=0;for(let o=0;o<8;++o){const l=LU(255&i[o]);if(r+=l,l!==8)break}return r})(n);return Math.ceil(e/8)}class BU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ht(i.value),i=t.next();this.Jt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Xt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ht(i);else if(i<2048)this.Ht(960|i>>>6),this.Ht(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|i>>>12),this.Ht(128|63&i>>>6),this.Ht(128|63&i);else{const r=t.codePointAt(0);this.Ht(240|r>>>18),this.Ht(128|63&r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r)}}this.Jt()}Yt(e){const t=this.en(e),i=lw(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=lw(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(xl),this.sn(255)}_n(){this.an(xl),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(o){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,o,!1),new Uint8Array(l.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===xl?(this.sn(xl),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===xl?(this.an(xl),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class FU{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class zU{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Ic{constructor(){this.cn=new BU,this.ascending=new FU(this.cn),this.descending=new zU(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e,t,i,r){this.hn=e,this.Pn=t,this.Tn=i,this.In=r}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.In,0),t!==e?i.set([0],this.In.length):++i[i.length-1],new ua(this.hn,this.Pn,this.Tn,i)}Rn(e,t,i){return{indexId:this.hn,uid:e,arrayValue:Lh(this.Tn),directionalValue:Lh(this.In),orderedDocumentKey:Lh(t),documentKey:i.path.toArray()}}An(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Ws(n,e){let t=n.hn-e.hn;return t!==0?t:(t=uw(n.Tn,e.Tn),t!==0?t:(t=uw(n.In,e.In),t!==0?t:Fe.comparator(n.Pn,e.Pn)))}function uw(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Lh(n){return XA()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function cw(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class dw{constructor(e){this.Vn=new qt(((t,i)=>sn.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const i=t;i.isInequality()?this.Vn=this.Vn.add(i):this.mn.push(i)}}get fn(){return this.Vn.size>1}gn(e){if(Ze(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=Yy(e);if(t!==void 0&&!this.pn(t))return!1;const i=ia(e);let r=new Set,o=0,l=0;for(;o<i.length&&this.pn(i[o]);++o)r=r.add(i[o].fieldPath.canonicalString());if(o===i.length)return!0;if(this.Vn.size>0){const c=this.Vn.getIterator().getNext();if(!r.has(c.field.canonicalString())){const d=i[o];if(!this.yn(c,d)||!this.wn(this.dn[l++],d))return!1}++o}for(;o<i.length;++o){const c=i[o];if(l>=this.dn.length||!this.wn(this.dn[l++],c))return!1}return!0}bn(){if(this.fn)return null;let e=new qt(sn.comparator);const t=[];for(const i of this.mn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Nh(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Nh(i.field,0))}for(const i of this.dn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Nh(i.field,i.dir==="asc"?0:1)));return new Wh(Wh.UNKNOWN_ID,this.collectionId,t,ld.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dC(n){var t,i;if(Ze(n instanceof St||n instanceof Gt,20012),n instanceof St){if(n instanceof R1){const r=((i=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:i.map((o=>St.create(n.field,"==",o))))||[];return Gt.create(r,"or")}return n}const e=n.filters.map((r=>dC(r)));return Gt.create(e,n.op)}function GU(n){if(n.getFilters().length===0)return[];const e=h_(dC(n));return Ze(fC(e),7391),d_(e)||f_(e)?[e]:e.getFilters()}function d_(n){return n instanceof St}function f_(n){return n instanceof Gt&&hv(n)}function fC(n){return d_(n)||f_(n)||(function(t){if(t instanceof Gt&&n_(t)){for(const i of t.getFilters())if(!d_(i)&&!f_(i))return!1;return!0}return!1})(n)}function h_(n){if(Ze(n instanceof St||n instanceof Gt,34018),n instanceof St)return n;if(n.filters.length===1)return h_(n.filters[0]);const e=n.filters.map((i=>h_(i)));let t=Gt.create(e,n.op);return t=sp(t),fC(t)?t:(Ze(t instanceof Gt,64498),Ze(iu(t),40251),Ze(t.filters.length>1,57927),t.filters.reduce(((i,r)=>Tv(i,r))))}function Tv(n,e){let t;return Ze(n instanceof St||n instanceof Gt,38388),Ze(e instanceof St||e instanceof Gt,25473),t=n instanceof St?e instanceof St?(function(r,o){return Gt.create([r,o],"and")})(n,e):fw(n,e):e instanceof St?fw(e,n):(function(r,o){if(Ze(r.filters.length>0&&o.filters.length>0,48005),iu(r)&&iu(o))return A1(r,o.getFilters());const l=n_(r)?r:o,c=n_(r)?o:r,d=l.filters.map((f=>Tv(f,c)));return Gt.create(d,"or")})(n,e),sp(t)}function fw(n,e){if(iu(e))return A1(e,n.getFilters());{const t=e.filters.map((i=>Tv(n,i)));return Gt.create(t,"or")}}function sp(n){if(Ze(n instanceof St||n instanceof Gt,11850),n instanceof St)return n;const e=n.getFilters();if(e.length===1)return sp(e[0]);if(w1(n))return n;const t=e.map((r=>sp(r))),i=[];return t.forEach((r=>{r instanceof St?i.push(r):r instanceof Gt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:Gt.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(){this.Sn=new bv}addToCollectionParentIndex(e,t){return this.Sn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(bi.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(bi.min())}updateCollectionGroup(e,t,i){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class bv{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new qt(Vt.comparator),o=!r.has(i);return this.index[t]=r.add(i),o}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new qt(Vt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hw="IndexedDbIndexManager",dh=new Uint8Array(0);class HU{constructor(e,t){this.databaseId=t,this.Dn=new bv,this.Cn=new hs((i=>Ca(i)),((i,r)=>kd(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const o={collectionId:i,parent:Kn(r)};return pw(e).put(o)}return ce.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[JI(t),""],!1,!0);return pw(e).H(r).next((o=>{for(const l of o){if(l.collectionId!==t)break;i.push(Rr(l.parent))}return i}))}addFieldIndex(e,t){const i=Cc(e),r=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((d=>[d.fieldPath.canonicalString(),d.kind]))}})(t);delete r.indexId;const o=i.add(r);if(t.indexState){const l=Il(e);return o.next((c=>{l.put(sw(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const i=Cc(e),r=Il(e),o=Al(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Cc(e),i=Al(e),r=Il(e);return t.X().next((()=>i.X())).next((()=>r.X()))}createTargetIndexes(e,t){return ce.forEach(this.vn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const o=new dw(i).bn();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const i=Al(e);let r=!0;const o=new Map;return ce.forEach(this.vn(t),(l=>this.Fn(e,l).next((c=>{r&&(r=!!c),o.set(l,c)})))).next((()=>{if(r){let l=yt();const c=[];return ce.forEach(o,((d,f)=>{Pe(hw,`Using index ${(function(L){return`id=${L.indexId}|cg=${L.collectionGroup}|f=${L.fields.map(($=>`${$.fieldPath}:${$.kind}`)).join(",")}`})(d)} to execute ${Ca(t)}`);const m=(function(L,$){const K=Yy($);if(K===void 0)return null;for(const j of tp(L,K.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null})(f,d),v=(function(L,$){const K=new Map;for(const j of ia($))for(const k of tp(L,j.fieldPath))switch(k.op){case"==":case"in":K.set(j.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return K.set(j.fieldPath.canonicalString(),k.value),Array.from(K.values())}return null})(f,d),E=(function(L,$){const K=[];let j=!0;for(const k of ia($)){const V=k.kind===0?$S(L,k.fieldPath,L.startAt):jS(L,k.fieldPath,L.startAt);K.push(V.value),j&&(j=V.inclusive)}return new nu(K,j)})(f,d),b=(function(L,$){const K=[];let j=!0;for(const k of ia($)){const V=k.kind===0?jS(L,k.fieldPath,L.endAt):$S(L,k.fieldPath,L.endAt);K.push(V.value),j&&(j=V.inclusive)}return new nu(K,j)})(f,d),I=this.Mn(d,f,E),x=this.Mn(d,f,b),A=this.xn(d,f,v),N=this.On(d.indexId,m,I,E.inclusive,x,b.inclusive,A);return ce.forEach(N,(U=>i.Z(U,t.limit).next((L=>{L.forEach(($=>{const K=Fe.fromSegments($.documentKey);l.has(K)||(l=l.add(K),c.push(K))}))}))))})).next((()=>c))}return ce.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=GU(Gt.create(e.filters,"and")).map((i=>r_(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,i,r,o,l,c){const d=(t!=null?t.length:1)*Math.max(i.length,o.length),f=d/(t!=null?t.length:1),m=[];for(let v=0;v<d;++v){const E=t?this.Nn(t[v/f]):dh,b=this.Bn(e,E,i[v%f],r),I=this.Ln(e,E,o[v%f],l),x=c.map((A=>this.Bn(e,E,A,!0)));m.push(...this.createRange(b,I,x))}return m}Bn(e,t,i,r){const o=new ua(e,Fe.empty(),t,i);return r?o:o.En()}Ln(e,t,i,r){const o=new ua(e,Fe.empty(),t,i);return r?o.En():o}Fn(e,t){const i=new dw(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((o=>{let l=null;for(const c of o)i.gn(c)&&(!l||c.fields.length>l.fields.length)&&(l=c);return l}))}getIndexType(e,t){let i=2;const r=this.vn(t);return ce.forEach(r,(o=>this.Fn(e,o).next((l=>{l?i!==0&&l.fields.length<(function(d){let f=new qt(sn.comparator),m=!1;for(const v of d.filters)for(const E of v.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?m=!0:f=f.add(E.field));for(const v of d.orderBy)v.field.isKeyField()||(f=f.add(v.field));return f.size+(m?1:0)})(o)&&(i=1):i=0})))).next((()=>(function(l){return l.limit!==null})(t)&&r.length>1&&i===2?1:i))}kn(e,t){const i=new Ic;for(const r of ia(e)){const o=t.data.field(r.fieldPath);if(o==null)return null;const l=i.ln(r.kind);la.Wt.Dt(o,l)}return i.un()}Nn(e){const t=new Ic;return la.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const i=new Ic;return la.Wt.Dt(gd(this.databaseId,t),i.ln((function(o){const l=ia(o);return l.length===0?0:l[l.length-1].kind})(e))),i.un()}xn(e,t,i){if(i===null)return[];let r=[];r.push(new Ic);let o=0;for(const l of ia(e)){const c=i[o++];for(const d of r)if(this.qn(t,l.fieldPath)&&yd(c))r=this.Un(r,l,c);else{const f=d.ln(l.kind);la.Wt.Dt(c,f)}}return this.$n(r)}Mn(e,t,i){return this.xn(e,t,i.position)}$n(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Un(e,t,i){const r=[...e],o=[];for(const l of i.arrayValue.values||[])for(const c of r){const d=new Ic;d.seed(c.un()),la.Wt.Dt(l,d.ln(t.kind)),o.push(d)}return o}qn(e,t){return!!e.filters.find((i=>i instanceof St&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Cc(e),r=Il(e);return(t?i.H(Qy,IDBKeyRange.bound(t,t)):i.H()).next((o=>{const l=[];return ce.forEach(o,(c=>r.get([c.indexId,this.uid]).next((d=>{l.push((function(m,v){const E=v?new ld(v.sequenceNumber,new bi(Na(v.readTime),new Fe(Rr(v.documentKey)),v.largestBatchId)):ld.empty(),b=m.fields.map((([I,x])=>new Nh(sn.fromServerFormat(I),x)));return new Wh(m.indexId,m.collectionGroup,b,E)})(c,d))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const o=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return o!==0?o:at(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Cc(e),o=Il(e);return this.Wn(e).next((l=>r.H(Qy,IDBKeyRange.bound(t,t)).next((c=>ce.forEach(c,(d=>o.put(sw(d.indexId,this.uid,l,i))))))))}updateIndexEntries(e,t){const i=new Map;return ce.forEach(t,((r,o)=>{const l=i.get(r.collectionGroup);return(l?ce.resolve(l):this.getFieldIndexes(e,r.collectionGroup)).next((c=>(i.set(r.collectionGroup,c),ce.forEach(c,(d=>this.Qn(e,r,d).next((f=>{const m=this.Gn(o,d);return f.isEqual(m)?ce.resolve():this.zn(e,o,d,f,m)})))))))}))}jn(e,t,i,r){return Al(e).put(r.Rn(this.uid,this.Kn(i,t.key),t.key))}Hn(e,t,i,r){return Al(e).delete(r.An(this.uid,this.Kn(i,t.key),t.key))}Qn(e,t,i){const r=Al(e);let o=new qt(Ws);return r.ee({index:a1,range:IDBKeyRange.only([i.indexId,this.uid,Lh(this.Kn(i,t))])},((l,c)=>{o=o.add(new ua(i.indexId,t,cw(c.arrayValue),cw(c.directionalValue)))})).next((()=>o))}Gn(e,t){let i=new qt(Ws);const r=this.kn(t,e);if(r==null)return i;const o=Yy(t);if(o!=null){const l=e.data.field(o.fieldPath);if(yd(l))for(const c of l.arrayValue.values||[])i=i.add(new ua(t.indexId,e.key,this.Nn(c),r))}else i=i.add(new ua(t.indexId,e.key,dh,r));return i}zn(e,t,i,r,o){Pe(hw,"Updating index entries for document '%s'",t.key);const l=[];return(function(d,f,m,v,E){const b=d.getIterator(),I=f.getIterator();let x=wl(b),A=wl(I);for(;x||A;){let N=!1,U=!1;if(x&&A){const L=m(x,A);L<0?U=!0:L>0&&(N=!0)}else x!=null?U=!0:N=!0;N?(v(A),A=wl(I)):U?(E(x),x=wl(b)):(x=wl(b),A=wl(I))}})(r,o,Ws,(c=>{l.push(this.jn(e,t,i,c))}),(c=>{l.push(this.Hn(e,t,i,c))})),ce.waitFor(l)}Wn(e){let t=1;return Il(e).ee({index:o1,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,o)=>{o.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((l,c)=>Ws(l,c))).filter(((l,c,d)=>!c||Ws(l,d[c-1])!==0));const r=[];r.push(e);for(const l of i){const c=Ws(l,e),d=Ws(l,t);if(c===0)r[0]=e.En();else if(c>0&&d<0)r.push(l),r.push(l.En());else if(d>0)break}r.push(t);const o=[];for(let l=0;l<r.length;l+=2){if(this.Jn(r[l],r[l+1]))return[];const c=r[l].An(this.uid,dh,Fe.empty()),d=r[l+1].An(this.uid,dh,Fe.empty());o.push(IDBKeyRange.bound(c,d))}return o}Jn(e,t){return Ws(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(mw)}getMinOffset(e,t){return ce.mapArray(this.vn(t),(i=>this.Fn(e,i).next((r=>r||je(44426))))).next(mw)}}function pw(n){return An(n,fd)}function Al(n){return An(n,Wc)}function Cc(n){return An(n,av)}function Il(n){return An(n,Yc)}function mw(n){Ze(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;rv(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new bi(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hC=41943040;class qn{static withCacheSize(e){return new qn(e,qn.DEFAULT_COLLECTION_PERCENTILE,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pC(n,e,t){const i=n.store(Zi),r=n.store(Wl),o=[],l=IDBKeyRange.only(t.batchId);let c=0;const d=i.ee({range:l},((m,v,E)=>(c++,E.delete())));o.push(d.next((()=>{Ze(c===1,47070,{batchId:t.batchId})})));const f=[];for(const m of t.mutations){const v=i1(e,m.key.path,t.batchId);o.push(r.delete(v)),f.push(m.key)}return ce.waitFor(o).next((()=>f))}function op(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw je(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qn.DEFAULT_COLLECTION_PERCENTILE=10,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qn.DEFAULT=new qn(hC,qn.DEFAULT_COLLECTION_PERCENTILE,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qn.DISABLED=new qn(-1,0,0);class jp{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Zn={}}static wt(e,t,i,r){Ze(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new jp(o,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qs(e).ee({index:ha,range:i},((r,o,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const o=Ol(e),l=Qs(e);return l.add({}).next((c=>{Ze(typeof c=="number",49019);const d=new gv(c,t,i,r),f=(function(b,I,x){const A=x.baseMutations.map((U=>ip(b.yt,U))),N=x.mutations.map((U=>ip(b.yt,U)));return{userId:I,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:A,mutations:N}})(this.serializer,this.userId,d),m=[];let v=new qt(((E,b)=>at(E.canonicalString(),b.canonicalString())));for(const E of r){const b=i1(this.userId,E.key.path,c);v=v.add(E.key.path.popLast()),m.push(l.put(f)),m.push(o.put(b,vV))}return v.forEach((E=>{m.push(this.indexManager.addToCollectionParentIndex(e,E))})),e.addOnCommittedListener((()=>{this.Zn[c]=d.keys()})),ce.waitFor(m).next((()=>d))}))}lookupMutationBatch(e,t){return Qs(e).get(t).next((i=>i?(Ze(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),aa(this.serializer,i)):null))}Xn(e,t){return this.Zn[t]?ce.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Zn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let o=null;return Qs(e).ee({index:ha,range:r},((l,c,d)=>{c.userId===this.userId&&(Ze(c.batchId>=i,47524,{Yn:i}),o=aa(this.serializer,c)),d.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ma;return Qs(e).ee({index:ha,range:t,reverse:!0},((r,o,l)=>{i=o.batchId,l.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ma],[this.userId,Number.POSITIVE_INFINITY]);return Qs(e).H(ha,t).next((i=>i.map((r=>aa(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=kh(this.userId,t.path),r=IDBKeyRange.lowerBound(i),o=[];return Ol(e).ee({range:r},((l,c,d)=>{const[f,m,v]=l,E=Rr(m);if(f===this.userId&&t.path.isEqual(E))return Qs(e).get(v).next((b=>{if(!b)throw je(61480,{er:l,batchId:v});Ze(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:v}),o.push(aa(this.serializer,b))}));d.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new qt(at);const r=[];return t.forEach((o=>{const l=kh(this.userId,o.path),c=IDBKeyRange.lowerBound(l),d=Ol(e).ee({range:c},((f,m,v)=>{const[E,b,I]=f,x=Rr(b);E===this.userId&&o.path.isEqual(x)?i=i.add(I):v.done()}));r.push(d)})),ce.waitFor(r).next((()=>this.tr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,o=kh(this.userId,i),l=IDBKeyRange.lowerBound(o);let c=new qt(at);return Ol(e).ee({range:l},((d,f,m)=>{const[v,E,b]=d,I=Rr(E);v===this.userId&&i.isPrefixOf(I)?I.length===r&&(c=c.add(b)):m.done()})).next((()=>this.tr(e,c)))}tr(e,t){const i=[],r=[];return t.forEach((o=>{r.push(Qs(e).get(o).next((l=>{if(l===null)throw je(35274,{batchId:o});Ze(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:o}),i.push(aa(this.serializer,l))})))})),ce.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return pC(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),ce.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ce.resolve();const i=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),r=[];return Ol(e).ee({range:i},((o,l,c)=>{if(o[0]===this.userId){const d=Rr(o[1]);r.push(d)}else c.done()})).next((()=>{Ze(r.length===0,56720,{rr:r.map((o=>o.canonicalString()))})}))}))}containsKey(e,t){return mC(e,this.userId,t)}ir(e){return gC(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:ma,lastStreamToken:""}))}}function mC(n,e,t){const i=kh(e,t.path),r=i[1],o=IDBKeyRange.lowerBound(i);let l=!1;return Ol(n).ee({range:o,Y:!0},((c,d,f)=>{const[m,v,E]=c;m===e&&v===r&&(l=!0),f.done()})).next((()=>l))}function Qs(n){return An(n,Zi)}function Ol(n){return An(n,Wl)}function gC(n){return An(n,cd)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ka(0)}static ar(){return new ka(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const i=new ka(t.highestTargetId);return t.highestTargetId=i.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>tt.fromTimestamp(new zt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.ur(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.cr(e,r))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((i=>(i.targetCount+=1,this.hr(t,i),this.cr(e,i))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Cl(e).delete(t.targetId))).next((()=>this.ur(e))).next((i=>(Ze(i.targetCount>0,8065),i.targetCount-=1,this.cr(e,i))))}removeTargets(e,t,i){let r=0;const o=[];return Cl(e).ee(((l,c)=>{const d=zc(c);d.sequenceNumber<=t&&i.get(d.targetId)===null&&(r++,o.push(this.removeTargetData(e,d)))})).next((()=>ce.waitFor(o))).next((()=>r))}forEachTarget(e,t){return Cl(e).ee(((i,r)=>{const o=zc(r);t(o)}))}ur(e){return yw(e).get(Zh).next((t=>(Ze(t!==null,2888),t)))}cr(e,t){return yw(e).put(Zh,t)}lr(e,t){return Cl(e).put(uC(this.serializer,t))}hr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Ca(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let o=null;return Cl(e).ee({range:r,index:s1},((l,c,d)=>{const f=zc(c);kd(t,f.target)&&(o=f,d.done())})).next((()=>o))}addMatchingKeys(e,t,i){const r=[],o=no(e);return t.forEach((l=>{const c=Kn(l.path);r.push(o.put({targetId:i,path:c})),r.push(this.referenceDelegate.addReference(e,i,l))})),ce.waitFor(r)}removeMatchingKeys(e,t,i){const r=no(e);return ce.forEach(t,(o=>{const l=Kn(o.path);return ce.waitFor([r.delete([i,l]),this.referenceDelegate.removeReference(e,i,o)])}))}removeMatchingKeysForTargetId(e,t){const i=no(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=no(e);let o=yt();return r.ee({range:i,Y:!0},((l,c,d)=>{const f=Rr(l[1]),m=new Fe(f);o=o.add(m)})).next((()=>o))}containsKey(e,t){const i=Kn(t.path),r=IDBKeyRange.bound([i],[JI(i)],!1,!0);let o=0;return no(e).ee({index:ov,Y:!0,range:r},(([l,c],d,f)=>{l!==0&&(o++,f.done())})).next((()=>o>0))}At(e,t){return Cl(e).get(t).next((i=>i?zc(i):null))}}function Cl(n){return An(n,Ql)}function yw(n){return An(n,ga)}function no(n){return An(n,Xl)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w="LruGarbageCollector",yC=1048576;function vw([n,e],[t,i]){const r=at(n,t);return r===0?at(e,i):r}class jU{constructor(e){this.Pr=e,this.buffer=new qt(vw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();vw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class _C{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Pe(_w,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){So(t)?Pe(_w,"Ignoring IndexedDB error during garbage collection: ",t):await bo(t)}await this.Ar(3e5)}))}}class KU{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return ce.resolve(ai.ce);const i=new jU(t);return this.Vr.forEachTarget(e,(r=>i.Er(r.sequenceNumber))).next((()=>this.Vr.mr(e,(r=>i.Er(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Pe("LruGarbageCollector","Garbage collection skipped; disabled"),ce.resolve(gw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),gw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,r,o,l,c,d,f;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),r=this.params.maximumSequenceNumbersToCollect):r=v,l=Date.now(),this.nthSequenceNumber(e,r)))).next((v=>(i=v,c=Date.now(),this.removeTargets(e,i,t)))).next((v=>(o=v,d=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(f=Date.now(),kl()<=bt.DEBUG&&Pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-m}ms
	Determined least recently used ${r} in `+(c-l)+`ms
	Removed ${o} targets in `+(d-c)+`ms
	Removed ${v} documents in `+(f-d)+`ms
Total Duration: ${f-m}ms`),ce.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:v}))))}}function vC(n,e){return new KU(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(e,t){this.db=e,this.garbageCollector=vC(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((i,r)=>t(r)))}addReference(e,t,i){return fh(e,i)}removeReference(e,t,i){return fh(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return fh(e,t)}wr(e,t){return(function(r,o){let l=!1;return gC(r).te((c=>mC(r,c,o).next((d=>(d&&(l=!0),ce.resolve(!d)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let o=0;return this.yr(e,((l,c)=>{if(c<=t){const d=this.wr(e,l).next((f=>{if(!f)return o++,i.getEntry(e,l).next((()=>(i.removeEntry(l,tt.min()),no(e).delete((function(v){return[0,Kn(v.path)]})(l)))))}));r.push(d)}})).next((()=>ce.waitFor(r))).next((()=>i.apply(e))).next((()=>o))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return fh(e,t)}yr(e,t){const i=no(e);let r,o=ai.ce;return i.ee({index:ov},(([l,c],{path:d,sequenceNumber:f})=>{l===0?(o!==ai.ce&&t(new Fe(Rr(r)),o),o=f,r=d):o=ai.ce})).next((()=>{o!==ai.ce&&t(new Fe(Rr(r)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function fh(n,e){return no(n).put((function(i,r){return{targetId:0,path:Kn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(){this.changes=new hs((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ln.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?ce.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return ta(e).put(i)}removeEntry(e,t,i){return ta(e).delete((function(o,l){const c=o.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],rp(l),c[c.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.br(e,i))))}getEntry(e,t){let i=ln.newInvalidDocument(t);return ta(e).ee({index:Mh,range:IDBKeyRange.only(Rc(t))},((r,o)=>{i=this.Sr(t,o)})).next((()=>i))}Dr(e,t){let i={size:0,document:ln.newInvalidDocument(t)};return ta(e).ee({index:Mh,range:IDBKeyRange.only(Rc(t))},((r,o)=>{i={document:this.Sr(t,o),size:op(o)}})).next((()=>i))}getEntries(e,t){let i=Ei();return this.Cr(e,t,((r,o)=>{const l=this.Sr(r,o);i=i.insert(r,l)})).next((()=>i))}vr(e,t){let i=Ei(),r=new Qt(Fe.comparator);return this.Cr(e,t,((o,l)=>{const c=this.Sr(o,l);i=i.insert(o,c),r=r.insert(o,op(l))})).next((()=>({documents:i,Fr:r})))}Cr(e,t,i){if(t.isEmpty())return ce.resolve();let r=new qt(bw);t.forEach((d=>r=r.add(d)));const o=IDBKeyRange.bound(Rc(r.first()),Rc(r.last())),l=r.getIterator();let c=l.getNext();return ta(e).ee({index:Mh,range:o},((d,f,m)=>{const v=Fe.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;c&&bw(c,v)<0;)i(c,null),c=l.getNext();c&&c.isEqual(v)&&(i(c,f),c=l.hasNext()?l.getNext():null),c?m.j(Rc(c)):m.done()})).next((()=>{for(;c;)i(c,null),c=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,o){const l=t.path,c=[l.popLast().toArray(),l.lastSegment(),rp(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],d=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ta(e).H(IDBKeyRange.bound(c,d,!0)).next((f=>{o==null||o.incrementDocumentReadCount(f.length);let m=Ei();for(const v of f){const E=this.Sr(Fe.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);E.isFoundDocument()&&(Md(t,E)||r.has(E.key))&&(m=m.insert(E.key,E))}return m}))}getAllFromCollectionGroup(e,t,i,r){let o=Ei();const l=Tw(t,i),c=Tw(t,bi.max());return ta(e).ee({index:r1,range:IDBKeyRange.bound(l,c,!0)},((d,f,m)=>{const v=this.Sr(Fe.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);o=o.insert(v.key,v),o.size===r&&m.done()})).next((()=>o))}newChangeBuffer(e){return new WU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return Ew(e).get(Wy).next((t=>(Ze(!!t,20021),t)))}br(e,t){return Ew(e).put(Wy,t)}Sr(e,t){if(t){const i=OU(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(tt.min())))return i}return ln.newInvalidDocument(e)}}function TC(n){return new YU(n)}class WU extends EC{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new hs((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new qt(((o,l)=>at(o.canonicalString(),l.canonicalString())));return this.changes.forEach(((o,l)=>{const c=this.Or.get(o);if(t.push(this.Mr.removeEntry(e,o,c.readTime)),l.isValidDocument()){const d=iw(this.Mr.serializer,l);r=r.add(o.path.popLast());const f=op(d);i+=f-c.size,t.push(this.Mr.addEntry(e,o,d))}else if(i-=c.size,this.trackRemovals){const d=iw(this.Mr.serializer,l.convertToNoDocument(tt.min()));t.push(this.Mr.addEntry(e,o,d))}})),r.forEach((o=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.Mr.updateMetadata(e,i)),ce.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((i=>(this.Or.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:i,Fr:r})=>(r.forEach(((o,l)=>{this.Or.set(o,{size:l,readTime:i.get(o).readTime})})),i)))}}function Ew(n){return An(n,dd)}function ta(n){return An(n,Xh)}function Rc(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Tw(n,e){const t=e.documentKey.path.toArray();return[n,rp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function bw(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let o=0;o<t.length-2&&o<i.length-2;++o)if(r=at(t[o],i[o]),r)return r;return r=at(t.length,i.length),r||(r=at(t[t.length-2],i[i.length-2]),r||at(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&ed(i.mutation,r,li.empty(),zt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,yt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=yt()){const r=Nr();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((o=>{let l=Bc();return o.forEach(((c,d)=>{l=l.insert(c,d.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const i=Nr();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,yt())))}populateOverlays(e,t,i){const r=[];return i.forEach((o=>{t.has(o)||r.push(o)})),this.documentOverlayCache.getOverlays(e,r).next((o=>{o.forEach(((l,c)=>{t.set(l,c)}))}))}computeViews(e,t,i,r){let o=Ei();const l=Zc(),c=(function(){return Zc()})();return t.forEach(((d,f)=>{const m=i.get(f.key);r.has(f.key)&&(m===void 0||m.mutation instanceof ps)?o=o.insert(f.key,f):m!==void 0?(l.set(f.key,m.mutation.getFieldMask()),ed(m.mutation,f,m.mutation.getFieldMask(),zt.now())):l.set(f.key,li.empty())})),this.recalculateAndSaveOverlays(e,o).next((d=>(d.forEach(((f,m)=>l.set(f,m))),t.forEach(((f,m)=>c.set(f,new QU(m,l.get(f)??null)))),c)))}recalculateAndSaveOverlays(e,t){const i=Zc();let r=new Qt(((l,c)=>l-c)),o=yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const c of l)c.keys().forEach((d=>{const f=t.get(d);if(f===null)return;let m=i.get(d)||li.empty();m=c.applyToLocalView(f,m),i.set(d,m);const v=(r.get(c.batchId)||yt()).add(d);r=r.insert(c.batchId,v)}))})).next((()=>{const l=[],c=r.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),f=d.key,m=d.value,v=U1();m.forEach((E=>{if(!o.has(E)){const b=H1(t.get(E),i.get(E));b!==null&&v.set(E,b),o=o.add(E)}})),l.push(this.documentOverlayCache.saveOverlays(e,f,v))}return ce.waitFor(l)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return nU(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):k1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((o=>{const l=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-o.size):ce.resolve(Nr());let c=Yl,d=o;return l.next((f=>ce.forEach(f,((m,v)=>(c<v.largestBatchId&&(c=v.largestBatchId),o.get(m)?ce.resolve():this.remoteDocumentCache.getEntry(e,m).next((E=>{d=d.insert(m,E)}))))).next((()=>this.populateOverlays(e,f,o))).next((()=>this.computeViews(e,d,f,yt()))).next((m=>({batchId:c,changes:V1(m)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Fe(t)).next((i=>{let r=Bc();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const o=t.collectionGroup;let l=Bc();return this.indexManager.getCollectionParents(e,o).next((c=>ce.forEach(c,(d=>{const f=(function(v,E){return new yu(E,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,f,i,r).next((m=>{m.forEach(((v,E)=>{l=l.insert(v,E)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,r)))).next((l=>{o.forEach(((d,f)=>{const m=f.getKey();l.get(m)===null&&(l=l.insert(m,ln.newInvalidDocument(m)))}));let c=Bc();return l.forEach(((d,f)=>{const m=o.get(d);m!==void 0&&ed(m.mutation,f,li.empty(),zt.now()),Md(t,f)&&(c=c.insert(d,f))})),c}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ce.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Qn(r.createTime)}})(t)),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:cC(r.bundledQuery),readTime:Qn(r.readTime)}})(t)),ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(){this.overlays=new Qt(Fe.comparator),this.Lr=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Nr();return ce.forEach(t,(r=>this.getOverlay(e,r).next((o=>{o!==null&&i.set(r,o)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,o)=>{this.bt(e,t,o)})),ce.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.Lr.get(i);return r!==void 0&&(r.forEach((o=>this.overlays=this.overlays.remove(o))),this.Lr.delete(i)),ce.resolve()}getOverlaysForCollection(e,t,i){const r=Nr(),o=t.length+1,l=new Fe(t.child("")),c=this.overlays.getIteratorFrom(l);for(;c.hasNext();){const d=c.getNext().value,f=d.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===o&&d.largestBatchId>i&&r.set(d.getKey(),d)}return ce.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let o=new Qt(((f,m)=>f-m));const l=this.overlays.getIterator();for(;l.hasNext();){const f=l.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>i){let m=o.get(f.largestBatchId);m===null&&(m=Nr(),o=o.insert(f.largestBatchId,m)),m.set(f.getKey(),f)}}const c=Nr(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((f,m)=>c.set(f,m))),!(c.size()>=r)););return ce.resolve(c)}bt(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const l=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new _v(t,i));let o=this.Lr.get(t);o===void 0&&(o=yt(),this.Lr.set(t,o)),this.Lr.set(t,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(){this.sessionToken=pn.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(){this.kr=new qt(kn.Kr),this.qr=new qt(kn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new kn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new kn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Fe(new Vt([])),i=new kn(t,e),r=new kn(t,e+1),o=[];return this.qr.forEachInRange([i,r],(l=>{this.Wr(l),o.push(l.key)})),o}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Fe(new Vt([])),i=new kn(t,e),r=new kn(t,e+1);let o=yt();return this.qr.forEachInRange([i,r],(l=>{o=o.add(l.key)})),o}containsKey(e){const t=new kn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class kn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Fe.comparator(e.key,t.key)||at(e.Hr,t.Hr)}static Ur(e,t){return at(e.Hr,t.Hr)||Fe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new qt(kn.Kr)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new gv(o,t,i,r);this.mutationQueue.push(l);for(const c of r)this.Jr=this.Jr.add(new kn(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ce.resolve(l)}lookupMutationBatch(e,t){return ce.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.Xr(i),o=r<0?0:r;return ce.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?ma:this.Yn-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new kn(t,0),r=new kn(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([i,r],(l=>{const c=this.Zr(l.Hr);o.push(c)})),ce.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new qt(at);return t.forEach((r=>{const o=new kn(r,0),l=new kn(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,l],(c=>{i=i.add(c.Hr)}))})),ce.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let o=i;Fe.isDocumentKey(o)||(o=o.child(""));const l=new kn(new Fe(o),0);let c=new qt(at);return this.Jr.forEachWhile((d=>{const f=d.key.path;return!!i.isPrefixOf(f)&&(f.length===r&&(c=c.add(d.Hr)),!0)}),l),ce.resolve(this.Yr(c))}Yr(e){const t=[];return e.forEach((i=>{const r=this.Zr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Ze(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return ce.forEach(t.mutations,(r=>{const o=new kn(r.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new kn(t,0),r=this.Jr.firstAfterOrEqual(i);return ce.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(e){this.ti=e,this.docs=(function(){return new Qt(Fe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),o=r?r.size:0,l=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return ce.resolve(i?i.document.mutableCopy():ln.newInvalidDocument(t))}getEntries(e,t){let i=Ei();return t.forEach((r=>{const o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():ln.newInvalidDocument(r))})),ce.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let o=Ei();const l=t.path,c=new Fe(l.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(c);for(;d.hasNext();){const{key:f,value:{document:m}}=d.getNext();if(!l.isPrefixOf(f.path))break;f.path.length>l.length+1||rv(XI(m),i)<=0||(r.has(m.key)||Md(t,m))&&(o=o.insert(m.key,m.mutableCopy()))}return ce.resolve(o)}getAllFromCollectionGroup(e,t,i,r){je(9500)}ni(e,t){return ce.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new iL(this)}getSize(e){return ce.resolve(this.size)}}class iL extends EC{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(i)})),ce.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e){this.persistence=e,this.ri=new hs((t=>Ca(t)),kd),this.lastRemoteSnapshotVersion=tt.min(),this.highestTargetId=0,this.ii=0,this.si=new Sv,this.targetCount=0,this.oi=ka._r()}forEachTarget(e,t){return this.ri.forEach(((i,r)=>t(r))),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),ce.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ka(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.lr(t),ce.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,i){let r=0;const o=[];return this.ri.forEach(((l,c)=>{c.sequenceNumber<=t&&i.get(c.targetId)===null&&(this.ri.delete(l),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)})),ce.waitFor(o).next((()=>r))}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return ce.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),ce.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const r=this.persistence.referenceDelegate,o=[];return r&&t.forEach((l=>{o.push(r.markPotentiallyOrphaned(e,l))})),ce.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return ce.resolve(i)}containsKey(e,t){return ce.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e,t){this._i={},this.overlays={},this.ai=new ai(0),this.ui=!1,this.ui=!0,this.ci=new eL,this.referenceDelegate=e(this),this.li=new rL(this),this.indexManager=new qU,this.remoteDocumentCache=(function(r){return new nL(r)})((i=>this.referenceDelegate.hi(i))),this.serializer=new lC(t),this.Pi=new XU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ZU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new tL(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Pe("MemoryPersistence","Starting transaction:",e);const r=new sL(this.ai.next());return this.referenceDelegate.Ti(),i(r).next((o=>this.referenceDelegate.Ii(r).next((()=>o)))).toPromise().then((o=>(r.raiseOnCommittedEvent(),o)))}Ei(e,t){return ce.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class sL extends e1{constructor(e){super(),this.currentSequenceNumber=e}}class Kp{constructor(e){this.persistence=e,this.Ri=new Sv,this.Ai=null}static Vi(e){return new Kp(e)}get di(){if(this.Ai)return this.Ai;throw je(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),ce.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((r=>this.di.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((o=>this.di.add(o.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.di,(i=>{const r=Fe.fromPath(i);return this.mi(e,r).next((o=>{o||t.removeEntry(r,tt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return ce.or([()=>ce.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class ap{constructor(e,t){this.persistence=e,this.fi=new hs((i=>Kn(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=vC(this,t)}static Vi(e,t){return new ap(e,t)}Ti(){}Ii(e){return ce.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return ce.forEach(this.fi,((i,r)=>this.wr(e,i,r).next((o=>o?ce.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.ni(e,(l=>this.wr(e,l,t).next((c=>{c||(i++,o.removeEntry(l,tt.min()))})))).next((()=>o.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ce.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ce.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ce.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ce.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ph(e.data.value)),t}wr(e,t,i){return ce.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.fi.get(t);return ce.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e){this.serializer=e}k(e,t,i,r){const o=new Dp("createOrUpgrade",t);i<1&&r>=1&&((function(d){d.createObjectStore(Nd)})(e),(function(d){d.createObjectStore(cd,{keyPath:_V}),d.createObjectStore(Zi,{keyPath:DS,autoIncrement:!0}).createIndex(ha,PS,{unique:!0}),d.createObjectStore(Wl)})(e),Sw(e),(function(d){d.createObjectStore(ra)})(e));let l=ce.resolve();return i<3&&r>=3&&(i!==0&&((function(d){d.deleteObjectStore(Xl),d.deleteObjectStore(Ql),d.deleteObjectStore(ga)})(e),Sw(e)),l=l.next((()=>(function(d){const f=d.store(ga),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:tt.min().toTimestamp(),targetCount:0};return f.put(Zh,m)})(o)))),i<4&&r>=4&&(i!==0&&(l=l.next((()=>(function(d,f){return f.store(Zi).H().next((v=>{d.deleteObjectStore(Zi),d.createObjectStore(Zi,{keyPath:DS,autoIncrement:!0}).createIndex(ha,PS,{unique:!0});const E=f.store(Zi),b=v.map((I=>E.put(I)));return ce.waitFor(b)}))})(e,o)))),l=l.next((()=>{(function(d){d.createObjectStore(Zl,{keyPath:IV})})(e)}))),i<5&&r>=5&&(l=l.next((()=>this.gi(o)))),i<6&&r>=6&&(l=l.next((()=>((function(d){d.createObjectStore(dd)})(e),this.pi(o))))),i<7&&r>=7&&(l=l.next((()=>this.yi(o)))),i<8&&r>=8&&(l=l.next((()=>this.wi(e,o)))),i<9&&r>=9&&(l=l.next((()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(l=l.next((()=>this.bi(o)))),i<11&&r>=11&&(l=l.next((()=>{(function(d){d.createObjectStore(Op,{keyPath:CV})})(e),(function(d){d.createObjectStore(Vp,{keyPath:RV})})(e)}))),i<12&&r>=12&&(l=l.next((()=>{(function(d){const f=d.createObjectStore(Up,{keyPath:VV});f.createIndex(Xy,UV,{unique:!1}),f.createIndex(l1,LV,{unique:!1})})(e)}))),i<13&&r>=13&&(l=l.next((()=>(function(d){const f=d.createObjectStore(Xh,{keyPath:EV});f.createIndex(Mh,TV),f.createIndex(r1,bV)})(e))).next((()=>this.Si(e,o))).next((()=>e.deleteObjectStore(ra)))),i<14&&r>=14&&(l=l.next((()=>this.Di(e,o)))),i<15&&r>=15&&(l=l.next((()=>(function(d){d.createObjectStore(av,{keyPath:NV,autoIncrement:!0}).createIndex(Qy,kV,{unique:!1}),d.createObjectStore(Yc,{keyPath:MV}).createIndex(o1,DV,{unique:!1}),d.createObjectStore(Wc,{keyPath:PV}).createIndex(a1,OV,{unique:!1})})(e)))),i<16&&r>=16&&(l=l.next((()=>{t.objectStore(Yc).clear()})).next((()=>{t.objectStore(Wc).clear()}))),i<17&&r>=17&&(l=l.next((()=>{(function(d){d.createObjectStore(lv,{keyPath:BV})})(e)}))),i<18&&r>=18&&XA()&&(l=l.next((()=>{t.objectStore(Yc).clear()})).next((()=>{t.objectStore(Wc).clear()}))),l}pi(e){let t=0;return e.store(ra).ee(((i,r)=>{t+=op(r)})).next((()=>{const i={byteSize:t};return e.store(dd).put(Wy,i)}))}gi(e){const t=e.store(cd),i=e.store(Zi);return t.H().next((r=>ce.forEach(r,(o=>{const l=IDBKeyRange.bound([o.userId,ma],[o.userId,o.lastAcknowledgedBatchId]);return i.H(ha,l).next((c=>ce.forEach(c,(d=>{Ze(d.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:d.batchId});const f=aa(this.serializer,d);return pC(e,o.userId,f).next((()=>{}))}))))}))))}yi(e){const t=e.store(Xl),i=e.store(ra);return e.store(ga).get(Zh).next((r=>{const o=[];return i.ee(((l,c)=>{const d=new Vt(l),f=(function(v){return[0,Kn(v)]})(d);o.push(t.get(f).next((m=>m?ce.resolve():(v=>t.put({targetId:0,path:Kn(v),sequenceNumber:r.highestListenSequenceNumber}))(d))))})).next((()=>ce.waitFor(o)))}))}wi(e,t){e.createObjectStore(fd,{keyPath:AV});const i=t.store(fd),r=new bv,o=l=>{if(r.add(l)){const c=l.lastSegment(),d=l.popLast();return i.put({collectionId:c,parent:Kn(d)})}};return t.store(ra).ee({Y:!0},((l,c)=>{const d=new Vt(l);return o(d.popLast())})).next((()=>t.store(Wl).ee({Y:!0},(([l,c,d],f)=>{const m=Rr(c);return o(m.popLast())}))))}bi(e){const t=e.store(Ql);return t.ee(((i,r)=>{const o=zc(r),l=uC(this.serializer,o);return t.put(l)}))}Si(e,t){const i=t.store(ra),r=[];return i.ee(((o,l)=>{const c=t.store(Xh),d=(function(v){return v.document?new Fe(Vt.fromString(v.document.name).popFirst(5)):v.noDocument?Fe.fromSegments(v.noDocument.path):v.unknownDocument?Fe.fromSegments(v.unknownDocument.path):je(36783)})(l).path.toArray(),f={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};r.push(c.put(f))})).next((()=>ce.waitFor(r)))}Di(e,t){const i=t.store(Zi),r=TC(this.serializer),o=new wv(Kp.Vi,this.serializer.yt);return i.H().next((l=>{const c=new Map;return l.forEach((d=>{let f=c.get(d.userId)??yt();aa(this.serializer,d).keys().forEach((m=>f=f.add(m))),c.set(d.userId,f)})),ce.forEach(c,((d,f)=>{const m=new Mn(f),v=$p.wt(this.serializer,m),E=o.getIndexManager(m),b=jp.wt(m,this.serializer,E,o.referenceDelegate);return new bC(r,b,v,E).recalculateAndSaveOverlaysForDocumentKeys(new Zy(t,ai.ce),d).next()}))}))}}function Sw(n){n.createObjectStore(Xl,{keyPath:wV}).createIndex(ov,xV,{unique:!0}),n.createObjectStore(Ql,{keyPath:"targetId"}).createIndex(s1,SV,{unique:!0}),n.createObjectStore(ga)}const Xs="IndexedDbPersistence",vy=18e5,Ey=5e3,Ty="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",aL="main";class xv{constructor(e,t,i,r,o,l,c,d,f,m,v=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Ci=o,this.window=l,this.document=c,this.Fi=f,this.Mi=m,this.xi=v,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=E=>Promise.resolve(),!xv.v())throw new Ue(Se.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new JU(this,r),this.Ki=t+aL,this.serializer=new lC(d),this.qi=new co(this.Ki,this.xi,new oL(this.serializer)),this.ci=new UU,this.li=new $U(this.referenceDelegate,this.serializer),this.remoteDocumentCache=TC(this.serializer),this.Pi=new VU,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,m===!1&&fn(Xs,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ue(Se.FAILED_PRECONDITION,Ty);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new ai(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>hh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(So(e))return Pe(Xs,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Pe(Xs,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return Nc(e).get(Sl).next((t=>ce.resolve(this.Xi(t))))}Yi(e){return hh(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,vy)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=An(t,Zl);return i.H().next((r=>{const o=this.ns(r,vy),l=r.filter((c=>o.indexOf(c)===-1));return ce.forEach(l,(c=>i.delete(c.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?ce.resolve(!0):Nc(e).get(Sl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Ey)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new Ue(Se.FAILED_PRECONDITION,Ty);return!1}}return!(!this.networkEnabled||!this.inForeground)||hh(e).H().next((i=>this.ns(i,Ey).find((r=>{if(this.clientId!==r.clientId){const o=!this.networkEnabled&&r.networkEnabled,l=!this.inForeground&&r.inForeground,c=this.networkEnabled===r.networkEnabled;if(o||l&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Pe(Xs,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[Nd,Zl],(e=>{const t=new Zy(e,ai.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((i=>this.ts(i.updateTimeMs,t)&&!this.ss(i.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>hh(e).H().next((t=>this.ns(t,vy).map((i=>i.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return jp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new HU(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return $p.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,i){Pe(Xs,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",o=(function(d){return d===18?GV:d===17?f1:d===16?zV:d===15?uv:d===14?d1:d===13?c1:d===12?FV:d===11?u1:void je(60245)})(this.xi);let l;return this.qi.runTransaction(e,r,o,(c=>(l=new Zy(c,this.ai?this.ai.next():ai.ce),t==="readwrite-primary"?this.ji(l).next((d=>!!d||this.Hi(l))).next((d=>{if(!d)throw fn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new Ue(Se.FAILED_PRECONDITION,ZI);return i(l)})).next((d=>this.Zi(l).next((()=>d)))):this.Ps(l).next((()=>i(l)))))).then((c=>(l.raiseOnCommittedEvent(),c)))}Ps(e){return Nc(e).get(Sl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Ey)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ue(Se.FAILED_PRECONDITION,Ty)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Nc(e).put(Sl,t)}static v(){return co.v()}Ji(e){const t=Nc(e);return t.get(Sl).next((i=>this.Xi(i)?(Pe(Xs,"Releasing primary lease."),t.delete(Sl)):ce.resolve()))}ts(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(fn(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const t=/(?:Version|Mobile)\/1[456]/;QA()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var t;try{const i=((t=this.Ui)==null?void 0:t.getItem(this.rs(e)))!==null;return Pe(Xs,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return fn(Xs,"Failed to get zombied client id.",i),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){fn("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Nc(n){return An(n,Nd)}function hh(n){return An(n,Zl)}function SC(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=r}static Es(e,t){let i=yt(),r=yt();for(const o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new Av(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return QA()?8:t1(xn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const o={result:null};return this.gs(e,t).next((l=>{o.result=l})).next((()=>{if(!o.result)return this.ps(e,t,r,i).next((l=>{o.result=l}))})).next((()=>{if(o.result)return;const l=new lL;return this.ys(e,t,l).next((c=>{if(o.result=c,this.As)return this.ws(e,t,l,c.size)}))})).next((()=>o.result))}ws(e,t,i,r){return i.documentReadCount<this.Vs?(kl()<=bt.DEBUG&&Pe("QueryEngine","SDK will not create cache indexes for query:",Ml(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ce.resolve()):(kl()<=bt.DEBUG&&Pe("QueryEngine","Query:",Ml(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(kl()<=bt.DEBUG&&Pe("QueryEngine","The SDK decides to create cache indexes for query:",Ml(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ti(t))):ce.resolve())}gs(e,t){if(KS(t))return ce.resolve(null);let i=Ti(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=o_(t,null,"F"),i=Ti(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((o=>{const l=yt(...o);return this.fs.getDocuments(e,l).next((c=>this.indexManager.getMinOffset(e,i).next((d=>{const f=this.bs(t,c);return this.Ss(t,f,l,d.readTime)?this.gs(e,o_(t,null,"F")):this.Ds(e,f,t,d)}))))})))))}ps(e,t,i,r){return KS(t)||r.isEqual(tt.min())?ce.resolve(null):this.fs.getDocuments(e,i).next((o=>{const l=this.bs(t,o);return this.Ss(t,l,i,r)?ce.resolve(null):(kl()<=bt.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ml(t)),this.Ds(e,l,t,QI(r,Yl)).next((c=>c)))}))}bs(e,t){let i=new qt(P1(e));return t.forEach(((r,o)=>{Md(e,o)&&(i=i.add(o))})),i}Ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}ys(e,t,i){return kl()<=bt.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",Ml(t)),this.fs.getDocumentsMatchingQuery(e,t,bi.min(),i)}Ds(e,t,i,r){return this.fs.getDocumentsMatchingQuery(e,i,r).next((o=>(t.forEach((l=>{o=o.insert(l.key,l)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="LocalStore",uL=3e8;class cL{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new Qt(at),this.Fs=new hs((o=>Ca(o)),kd),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bC(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function xC(n,e,t,i){return new cL(n,e,t,i)}async function AC(n,e){const t=We(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((o=>(r=o,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((o=>{const l=[],c=[];let d=yt();for(const f of r){l.push(f.batchId);for(const m of f.mutations)d=d.add(m.key)}for(const f of o){c.push(f.batchId);for(const m of f.mutations)d=d.add(m.key)}return t.localDocuments.getDocuments(i,d).next((f=>({Ns:f,removedBatchIds:l,addedBatchIds:c})))}))}))}function dL(n,e){const t=We(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(c,d,f,m){const v=f.batch,E=v.keys();let b=ce.resolve();return E.forEach((I=>{b=b.next((()=>m.getEntry(d,I))).next((x=>{const A=f.docVersions.get(I);Ze(A!==null,48541),x.version.compareTo(A)<0&&(v.applyToRemoteDocument(x,f),x.isValidDocument()&&(x.setReadTime(f.commitVersion),m.addEntry(x)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(d,v)))})(t,i,e,o).next((()=>o.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(c){let d=yt();for(let f=0;f<c.mutationResults.length;++f)c.mutationResults[f].transformResults.length>0&&(d=d.add(c.batch.mutations[f].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function IC(n){const e=We(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function fL(n,e){const t=We(n),i=e.snapshotVersion;let r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const l=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;const c=[];e.targetChanges.forEach(((m,v)=>{const E=r.get(v);if(!E)return;c.push(t.li.removeMatchingKeys(o,m.removedDocuments,v).next((()=>t.li.addMatchingKeys(o,m.addedDocuments,v))));let b=E.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?b=b.withResumeToken(pn.EMPTY_BYTE_STRING,tt.min()).withLastLimboFreeSnapshotVersion(tt.min()):m.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(m.resumeToken,i)),r=r.insert(v,b),(function(x,A,N){return x.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=uL?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0})(E,b,m)&&c.push(t.li.updateTargetData(o,b))}));let d=Ei(),f=yt();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(o,m))})),c.push(hL(o,l,e.documentUpdates).next((m=>{d=m.Bs,f=m.Ls}))),!i.isEqual(tt.min())){const m=t.li.getLastRemoteSnapshotVersion(o).next((v=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,i)));c.push(m)}return ce.waitFor(c).next((()=>l.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,d,f))).next((()=>d))})).then((o=>(t.vs=r,o)))}function hL(n,e,t){let i=yt(),r=yt();return t.forEach((o=>i=i.add(o))),e.getEntries(n,i).next((o=>{let l=Ei();return t.forEach(((c,d)=>{const f=o.get(c);d.isFoundDocument()!==f.isFoundDocument()&&(r=r.add(c)),d.isNoDocument()&&d.version.isEqual(tt.min())?(e.removeEntry(c,d.readTime),l=l.insert(c,d)):!f.isValidDocument()||d.version.compareTo(f.version)>0||d.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(d),l=l.insert(c,d)):Pe(Iv,"Ignoring outdated watch update for ",c,". Current version:",f.version," Watch version:",d.version)})),{Bs:l,Ls:r}}))}function pL(n,e){const t=We(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ma),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function lp(n,e){const t=We(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.li.getTargetData(i,e).next((o=>o?(r=o,ce.resolve(r)):t.li.allocateTargetId(i).next((l=>(r=new rs(e,l,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function lu(n,e,t){const i=We(n),r=i.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,(l=>i.persistence.referenceDelegate.removeTarget(l,r)))}catch(l){if(!So(l))throw l;Pe(Iv,`Failed to update sequence numbers for target ${e}: ${l}`)}i.vs=i.vs.remove(e),i.Fs.delete(r.target)}function p_(n,e,t){const i=We(n);let r=tt.min(),o=yt();return i.persistence.runTransaction("Execute query","readwrite",(l=>(function(d,f,m){const v=We(d),E=v.Fs.get(m);return E!==void 0?ce.resolve(v.vs.get(E)):v.li.getTargetData(f,m)})(i,l,Ti(e)).next((c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(l,c.targetId).next((d=>{o=d}))})).next((()=>i.Cs.getDocumentsMatchingQuery(l,e,t?r:tt.min(),t?o:yt()))).next((c=>(NC(i,D1(e),c),{documents:c,ks:o})))))}function CC(n,e){const t=We(n),i=We(t.li),r=t.vs.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",(o=>i.At(o,e).next((l=>l?l.target:null))))}function RC(n,e){const t=We(n),i=t.Ms.get(e)||tt.min();return t.persistence.runTransaction("Get new document changes","readonly",(r=>t.xs.getAllFromCollectionGroup(r,e,QI(i,Yl),Number.MAX_SAFE_INTEGER))).then((r=>(NC(t,e,r),r)))}function NC(n,e,t){let i=n.Ms.get(e)||tt.min();t.forEach(((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)})),n.Ms.set(e,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC="firestore_clients";function ww(n,e){return`${kC}_${n}_${e}`}const MC="firestore_mutations";function xw(n,e,t){let i=`${MC}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const DC="firestore_targets";function by(n,e){return`${DC}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir="SharedClientState";class up{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static $s(e,t,i){const r=JSON.parse(i);let o,l=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return l&&r.error&&(l=typeof r.error.message=="string"&&typeof r.error.code=="string",l&&(o=new Ue(r.error.code,r.error.message))),l?new up(e,t,r.state,o):(fn(Ir,`Failed to parse mutation state for ID '${t}': ${i}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class td{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static $s(e,t){const i=JSON.parse(t);let r,o=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(r=new Ue(i.error.code,i.error.message))),o?new td(e,i.state,r):(fn(Ir,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class cp{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const i=JSON.parse(t);let r=typeof i=="object"&&i.activeTargetIds instanceof Array,o=pv();for(let l=0;r&&l<i.activeTargetIds.length;++l)r=n1(i.activeTargetIds[l]),o=o.add(i.activeTargetIds[l]);return r?new cp(e,o):(fn(Ir,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Cv{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Cv(t.clientId,t.onlineState):(fn(Ir,`Failed to parse online state: ${e}`),null)}}class m_{constructor(){this.activeTargetIds=pv()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Sy{constructor(e,t,i,r,o){this.window=e,this.Ci=t,this.persistenceKey=i,this.zs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new Qt(at),this.started=!1,this.Zs=[];const l=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Xs=ww(this.persistenceKey,this.zs),this.Ys=(function(d){return`firestore_sequence_number_${d}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new m_),this.eo=new RegExp(`^${kC}_${l}_([^_]*)$`),this.no=new RegExp(`^${MC}_${l}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${DC}_${l}_(\\d+)$`),this.io=(function(d){return`firestore_online_state_${d}`})(this.persistenceKey),this.so=(function(d){return`firestore_bundle_loaded_v2_${d}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const i of e){if(i===this.zs)continue;const r=this.getItem(ww(this.persistenceKey,i));if(r){const o=cp.$s(i,r);o&&(this.Js=this.Js.insert(o.clientId,o))}}this.oo();const t=this.storage.getItem(this.io);if(t){const i=this._o(t);i&&this.ao(i)}for(const i of this.Zs)this.Hs(i);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,i){this.co(e,t,i),this.lo(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(by(this.persistenceKey,e));if(r){const o=td.$s(e,r);o&&(i=o.state)}}return t&&this.ho.Qs(e),this.oo(),i}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(by(this.persistenceKey,e))}updateQueryState(e,t,i){this.Po(e,t,i)}handleUserChange(e,t,i){t.forEach((r=>{this.lo(r)})),this.currentUser=e,i.forEach((r=>{this.addPendingMutation(r)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Pe(Ir,"READ",e,t),t}setItem(e,t){Pe(Ir,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Pe(Ir,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(Pe(Ir,"EVENT",t.key,t.newValue),t.key===this.Xs)return void fn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const i=this.Eo(t.key);return this.Ro(i,null)}{const i=this.Ao(t.key,t.newValue);if(i)return this.Ro(i.clientId,i)}}else if(this.no.test(t.key)){if(t.newValue!==null){const i=this.Vo(t.key,t.newValue);if(i)return this.mo(i)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const i=this.fo(t.key,t.newValue);if(i)return this.po(i)}}else if(t.key===this.io){if(t.newValue!==null){const i=this._o(t.newValue);if(i)return this.ao(i)}}else if(t.key===this.Ys){const i=(function(o){let l=ai.ce;if(o!=null)try{const c=JSON.parse(o);Ze(typeof c=="number",30636,{yo:o}),l=c}catch(c){fn(Ir,"Failed to read sequence number from WebStorage",c)}return l})(t.newValue);i!==ai.ce&&this.sequenceNumberHandler(i)}else if(t.key===this.so){const i=this.wo(t.newValue);await Promise.all(i.map((r=>this.syncEngine.bo(r))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,i){const r=new up(this.currentUser,e,t,i),o=xw(this.persistenceKey,this.currentUser,e);this.setItem(o,r.Ws())}lo(e){const t=xw(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,i){const r=by(this.persistenceKey,e),o=new td(e,t,i);this.setItem(r,o.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const i=this.Eo(e);return cp.$s(i,t)}Vo(e,t){const i=this.no.exec(e),r=Number(i[1]),o=i[2]!==void 0?i[2]:null;return up.$s(new Mn(o),r,t)}fo(e,t){const i=this.ro.exec(e),r=Number(i[1]);return td.$s(r,t)}_o(e){return Cv.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);Pe(Ir,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const i=t?this.Js.insert(e,t):this.Js.remove(e),r=this.uo(this.Js),o=this.uo(i),l=[],c=[];return o.forEach((d=>{r.has(d)||l.push(d)})),r.forEach((d=>{o.has(d)||c.push(d)})),this.syncEngine.Co(l,c).then((()=>{this.Js=i}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=pv();return e.forEach(((i,r)=>{t=t.unionWith(r.activeTargetIds)})),t}}class PC{constructor(){this.vo=new m_,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new m_,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw="ConnectivityMonitor";class Iw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Pe(Aw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Pe(Aw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ph=null;function g_(){return ph===null?ph=(function(){return 268435456+Math.round(2147483648*Math.random())})():ph++,"0x"+ph.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wy="RestConnection",gL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class yL{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===pd?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,o){const l=g_(),c=this.Qo(e,t.toUriEncodedString());Pe(wy,`Sending RPC '${e}' ${l}:`,c,i);const d={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(d,r,o);const{host:f}=new URL(c),m=Da(f);return this.zo(e,c,d,i,m).then((v=>(Pe(wy,`Received RPC '${e}' ${l}: `,v),v)),(v=>{throw Aa(wy,`RPC '${e}' ${l} failed with error: `,v,"url: ",c,"request:",i),v}))}jo(e,t,i,r,o,l){return this.Wo(e,t,i,r,o)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+gu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,o)=>e[o]=r)),i&&i.headers.forEach(((r,o)=>e[o]=r))}Qo(e,t){const i=gL[e];let r=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn="WebChannelConnection",kc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(r){setTimeout((()=>{throw r}),0)}}))};class ql extends yL{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!ql.c_){const e=HI();kc(e,qI.STAT_EVENT,(t=>{t.stat===Ky.PROXY?Pe(Gn,"STAT_EVENT: detected buffering proxy"):t.stat===Ky.NOPROXY&&Pe(Gn,"STAT_EVENT: detected no buffering proxy")})),ql.c_=!0}}zo(e,t,i,r,o){const l=g_();return new Promise(((c,d)=>{const f=new zI;f.setWithCredentials(!0),f.listenOnce(GI.COMPLETE,(()=>{try{switch(f.getLastErrorCode()){case Rh.NO_ERROR:const v=f.getResponseJson();Pe(Gn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(v)),c(v);break;case Rh.TIMEOUT:Pe(Gn,`RPC '${e}' ${l} timed out`),d(new Ue(Se.DEADLINE_EXCEEDED,"Request time out"));break;case Rh.HTTP_ERROR:const E=f.getStatus();if(Pe(Gn,`RPC '${e}' ${l} failed with status:`,E,"response text:",f.getResponseText()),E>0){let b=f.getResponseJson();Array.isArray(b)&&(b=b[0]);const I=b==null?void 0:b.error;if(I&&I.status&&I.message){const x=(function(N){const U=N.toLowerCase().replace(/_/g,"-");return Object.values(Se).indexOf(U)>=0?U:Se.UNKNOWN})(I.status);d(new Ue(x,I.message))}else d(new Ue(Se.UNKNOWN,"Server responded with status "+f.getStatus()))}else d(new Ue(Se.UNAVAILABLE,"Connection failed."));break;default:je(9055,{l_:e,streamId:l,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{Pe(Gn,`RPC '${e}' ${l} completed.`)}}));const m=JSON.stringify(r);Pe(Gn,`RPC '${e}' ${l} sending request:`,r),f.send(t,"POST",m,i,15)}))}T_(e,t,i){const r=g_(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=this.createWebChannelTransport(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Go(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;const f=o.join("");Pe(Gn,`Creating RPC '${e}' stream ${r}: ${f}`,c);const m=l.createWebChannel(f,c);this.I_(m);let v=!1,E=!1;const b=new _L({Ho:I=>{E?Pe(Gn,`Not sending because RPC '${e}' stream ${r} is closed:`,I):(v||(Pe(Gn,`Opening RPC '${e}' stream ${r} transport.`),m.open(),v=!0),Pe(Gn,`RPC '${e}' stream ${r} sending:`,I),m.send(I))},Jo:()=>m.close()});return kc(m,Lc.EventType.OPEN,(()=>{E||(Pe(Gn,`RPC '${e}' stream ${r} transport opened.`),b.i_())})),kc(m,Lc.EventType.CLOSE,(()=>{E||(E=!0,Pe(Gn,`RPC '${e}' stream ${r} transport closed`),b.o_(),this.E_(m))})),kc(m,Lc.EventType.ERROR,(I=>{E||(E=!0,Aa(Gn,`RPC '${e}' stream ${r} transport errored. Name:`,I.name,"Message:",I.message),b.o_(new Ue(Se.UNAVAILABLE,"The operation could not be completed")))})),kc(m,Lc.EventType.MESSAGE,(I=>{var x;if(!E){const A=I.data[0];Ze(!!A,16349);const N=A,U=(N==null?void 0:N.error)||((x=N[0])==null?void 0:x.error);if(U){Pe(Gn,`RPC '${e}' stream ${r} received error:`,U);const L=U.status;let $=(function(k){const V=bn[k];if(V!==void 0)return K1(V)})(L),K=U.message;L==="NOT_FOUND"&&K.includes("database")&&K.includes("does not exist")&&K.includes(this.databaseId.database)&&Aa(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),$===void 0&&($=Se.INTERNAL,K="Unknown error status: "+L+" with message "+U.message),E=!0,b.o_(new Ue($,K)),m.close()}else Pe(Gn,`RPC '${e}' stream ${r} received:`,A),b.__(A)}})),ql.u_(),setTimeout((()=>{b.s_()}),0),b}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return $I()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vL(n){return new ql(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OC(){return typeof window<"u"?window:null}function Bh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jp(n){return new xU(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ql.c_=!1;class VC{constructor(e,t,i=1e3,r=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=r,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&Pe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cw="PersistentStream";class UC{constructor(e,t,i,r,o,l,c,d){this.Ci=e,this.b_=i,this.S_=r,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new VC(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Se.RESOURCE_EXHAUSTED?(fn(t.toString()),fn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Ue(Se.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.H_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Pe(Cw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Pe(Cw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class EL extends UC{constructor(e,t,i,r,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,l),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=CU(this.serializer,e),i=(function(o){if(!("targetChange"in o))return tt.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?tt.min():l.readTime?Qn(l.readTime):tt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=u_(this.serializer),t.addTarget=(function(o,l){let c;const d=l.target;if(c=ep(d)?{documents:tC(o,d)}:{query:nC(o,d).ft},c.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){c.resumeToken=W1(o,l.resumeToken);const f=a_(o,l.expectedCount);f!==null&&(c.expectedCount=f)}else if(l.snapshotVersion.compareTo(tt.min())>0){c.readTime=au(o,l.snapshotVersion.toTimestamp());const f=a_(o,l.expectedCount);f!==null&&(c.expectedCount=f)}return c})(this.serializer,e);const i=NU(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=u_(this.serializer),t.removeTarget=e,this.K_(t)}}class TL extends UC{constructor(e,t,i,r,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,l),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=RU(e.writeResults,e.commitTime),i=Qn(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=u_(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>ip(this.serializer,i)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{}class SL extends bL{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ue(Se.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Wo(e,l_(t,i),r,o,l))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ue(Se.UNKNOWN,o.toString())}))}jo(e,t,i,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.jo(e,l_(t,i),r,l,c,o))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ue(Se.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function wL(n,e,t,i){return new SL(n,e,t,i)}class xL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(fn(t),this.aa=!1):Pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma="RemoteStore";class AL{constructor(e,t,i,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo((l=>{i.enqueueAndForget((async()=>{Pa(this)&&(Pe(Ma,"Restarting streams for network reachability change."),await(async function(d){const f=We(d);f.Ea.add(4),await Od(f),f.Va.set("Unknown"),f.Ea.delete(4),await Yp(f)})(this))}))})),this.Va=new xL(i,r)}}async function Yp(n){if(Pa(n))for(const e of n.Ra)await e(!0)}async function Od(n){for(const e of n.Ra)await e(!1)}function Wp(n,e){const t=We(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),kv(t)?Nv(t):Eu(t).O_()&&Rv(t,e))}function uu(n,e){const t=We(n),i=Eu(t);t.Ia.delete(e),i.O_()&&LC(t,e),t.Ia.size===0&&(i.O_()?i.L_():Pa(t)&&t.Va.set("Unknown"))}function Rv(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(tt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Eu(n).Z_(e)}function LC(n,e){n.da.$e(e),Eu(n).X_(e)}function Nv(n){n.da=new TU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Eu(n).start(),n.Va.ua()}function kv(n){return Pa(n)&&!Eu(n).x_()&&n.Ia.size>0}function Pa(n){return We(n).Ea.size===0}function BC(n){n.da=void 0}async function IL(n){n.Va.set("Online")}async function CL(n){n.Ia.forEach(((e,t)=>{Rv(n,e)}))}async function RL(n,e){BC(n),kv(n)?(n.Va.ha(e),Nv(n)):n.Va.set("Unknown")}async function NL(n,e,t){if(n.Va.set("Online"),e instanceof Y1&&e.state===2&&e.cause)try{await(async function(r,o){const l=o.cause;for(const c of o.targetIds)r.Ia.has(c)&&(await r.remoteSyncer.rejectListen(c,l),r.Ia.delete(c),r.da.removeTarget(c))})(n,e)}catch(i){Pe(Ma,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await dp(n,i)}else if(e instanceof Uh?n.da.Xe(e):e instanceof J1?n.da.st(e):n.da.tt(e),!t.isEqual(tt.min()))try{const i=await IC(n.localStore);t.compareTo(i)>=0&&await(function(o,l){const c=o.da.Tt(l);return c.targetChanges.forEach(((d,f)=>{if(d.resumeToken.approximateByteSize()>0){const m=o.Ia.get(f);m&&o.Ia.set(f,m.withResumeToken(d.resumeToken,l))}})),c.targetMismatches.forEach(((d,f)=>{const m=o.Ia.get(d);if(!m)return;o.Ia.set(d,m.withResumeToken(pn.EMPTY_BYTE_STRING,m.snapshotVersion)),LC(o,d);const v=new rs(m.target,d,f,m.sequenceNumber);Rv(o,v)})),o.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(i){Pe(Ma,"Failed to raise snapshot:",i),await dp(n,i)}}async function dp(n,e,t){if(!So(e))throw e;n.Ea.add(1),await Od(n),n.Va.set("Offline"),t||(t=()=>IC(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Pe(Ma,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Yp(n)}))}function FC(n,e){return e().catch((t=>dp(n,t,e)))}async function vu(n){const e=We(n),t=yo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ma;for(;kL(e);)try{const r=await pL(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,ML(e,r)}catch(r){await dp(e,r)}zC(e)&&GC(e)}function kL(n){return Pa(n)&&n.Ta.length<10}function ML(n,e){n.Ta.push(e);const t=yo(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function zC(n){return Pa(n)&&!yo(n).x_()&&n.Ta.length>0}function GC(n){yo(n).start()}async function DL(n){yo(n).ra()}async function PL(n){const e=yo(n);for(const t of n.Ta)e.ea(t.mutations)}async function OL(n,e,t){const i=n.Ta.shift(),r=yv.from(i,e,t);await FC(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await vu(n)}async function VL(n,e){e&&yo(n).Y_&&await(async function(i,r){if((function(l){return _U(l)&&l!==Se.ABORTED})(r.code)){const o=i.Ta.shift();yo(i).B_(),await FC(i,(()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r))),await vu(i)}})(n,e),zC(n)&&GC(n)}async function Rw(n,e){const t=We(n);t.asyncQueue.verifyOperationInProgress(),Pe(Ma,"RemoteStore received new credentials");const i=Pa(t);t.Ea.add(3),await Od(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Yp(t)}async function y_(n,e){const t=We(n);e?(t.Ea.delete(2),await Yp(t)):e||(t.Ea.add(2),await Od(t),t.Va.set("Unknown"))}function Eu(n){return n.ma||(n.ma=(function(t,i,r){const o=We(t);return o.sa(),new EL(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:IL.bind(null,n),Yo:CL.bind(null,n),t_:RL.bind(null,n),J_:NL.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),kv(n)?Nv(n):n.Va.set("Unknown")):(await n.ma.stop(),BC(n))}))),n.ma}function yo(n){return n.fa||(n.fa=(function(t,i,r){const o=We(t);return o.sa(),new TL(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:DL.bind(null,n),t_:VL.bind(null,n),ta:PL.bind(null,n),na:OL.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await vu(n)):(await n.fa.stop(),n.Ta.length>0&&(Pe(Ma,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,t,i,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new ss,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,o){const l=Date.now()+i,c=new Mv(e,t,l,r,o);return c.start(i),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ue(Se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Dv(n,e){if(fn("AsyncQueue",`${e}: ${n}`),So(n))return new Ue(Se.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{static emptySet(e){return new Hl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Fe.comparator(t.key,i.key):(t,i)=>Fe.comparator(t.key,i.key),this.keyedMap=Bc(),this.sortedSet=new Qt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Hl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Hl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(){this.ga=new Qt(Fe.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):je(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class cu{constructor(e,t,i,r,o,l,c,d,f){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=c,this.excludesMetadataChanges=d,this.hasCachedResults=f}static fromInitialDocuments(e,t,i,r,o){const l=[];return t.forEach((c=>{l.push({type:0,doc:c})})),new cu(e,t,Hl.emptySet(t),l,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&zp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UL{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class LL{constructor(){this.queries=kw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=We(t),o=r.queries;r.queries=kw(),o.forEach(((l,c)=>{for(const d of c.ba)d.onError(i)}))})(this,new Ue(Se.ABORTED,"Firestore shutting down"))}}function kw(){return new hs((n=>M1(n)),zp)}async function qC(n,e){const t=We(n);let i=3;const r=e.query;let o=t.queries.get(r);o?!o.Sa()&&e.Da()&&(i=2):(o=new UL,i=e.Da()?0:1);try{switch(i){case 0:o.wa=await t.onListen(r,!0);break;case 1:o.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(l){const c=Dv(l,`Initialization of query '${Ml(e.query)}' failed`);return void e.onError(c)}t.queries.set(r,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&Pv(t)}async function HC(n,e){const t=We(n),i=e.query;let r=3;const o=t.queries.get(i);if(o){const l=o.ba.indexOf(e);l>=0&&(o.ba.splice(l,1),o.ba.length===0?r=e.Da()?0:1:!o.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function BL(n,e){const t=We(n);let i=!1;for(const r of e){const o=r.query,l=t.queries.get(o);if(l){for(const c of l.ba)c.Fa(r)&&(i=!0);l.wa=r}}i&&Pv(t)}function FL(n,e,t){const i=We(n),r=i.queries.get(e);if(r)for(const o of r.ba)o.onError(t);i.queries.delete(e)}function Pv(n){n.Ca.forEach((e=>{e.next()}))}var __,Mw;(Mw=__||(__={})).Ma="default",Mw.Cache="cache";class $C{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new cu(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=cu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==__.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e){this.key=e}}class KC{constructor(e){this.key=e}}class zL{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=yt(),this.mutatedKeys=yt(),this.eu=P1(e),this.tu=new Hl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Nw,r=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,l=r,c=!1;const d=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,f=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((m,v)=>{const E=r.get(m),b=Md(this.query,v)?v:null,I=!!E&&this.mutatedKeys.has(E.key),x=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let A=!1;E&&b?E.data.isEqual(b.data)?I!==x&&(i.track({type:3,doc:b}),A=!0):this.su(E,b)||(i.track({type:2,doc:b}),A=!0,(d&&this.eu(b,d)>0||f&&this.eu(b,f)<0)&&(c=!0)):!E&&b?(i.track({type:0,doc:b}),A=!0):E&&!b&&(i.track({type:1,doc:E}),A=!0,(d||f)&&(c=!0)),A&&(b?(l=l.add(b),o=x?o.add(m):o.delete(m)):(l=l.delete(m),o=o.delete(m)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const m=this.query.limitType==="F"?l.last():l.first();l=l.delete(m.key),o=o.delete(m.key),i.track({type:1,doc:m})}return{tu:l,iu:i,Ss:c,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((m,v)=>(function(b,I){const x=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return je(20277,{Vt:A})}};return x(b)-x(I)})(m.type,v.type)||this.eu(m.doc,v.doc))),this.ou(i),r=r??!1;const c=t&&!r?this._u():[],d=this.Ya.size===0&&this.current&&!r?1:0,f=d!==this.Xa;return this.Xa=d,l.length!==0||f?{snapshot:new cu(this.query,e.tu,o,l,e.mutatedKeys,d===0,f,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Nw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=yt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new KC(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new jC(i))})),t}cu(e){this.Za=e.ks,this.Ya=yt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return cu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Tu="SyncEngine";class GL{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class qL{constructor(e){this.key=e,this.hu=!1}}class HL{constructor(e,t,i,r,o,l){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new hs((c=>M1(c)),zp),this.Iu=new Map,this.Eu=new Set,this.Ru=new Qt(Fe.comparator),this.Au=new Map,this.Vu=new Sv,this.du={},this.mu=new Map,this.fu=ka.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function $L(n,e,t=!0){const i=Qp(n);let r;const o=i.Tu.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.lu()):r=await JC(i,e,t,!0),r}async function jL(n,e){const t=Qp(n);await JC(t,e,!0,!1)}async function JC(n,e,t,i){const r=await lp(n.localStore,Ti(e)),o=r.targetId,l=n.sharedClientState.addLocalQueryTarget(o,t);let c;return i&&(c=await Ov(n,e,o,l==="current",r.resumeToken)),n.isPrimaryClient&&t&&Wp(n.remoteStore,r),c}async function Ov(n,e,t,i,r){n.pu=(v,E,b)=>(async function(x,A,N,U){let L=A.view.ru(N);L.Ss&&(L=await p_(x.localStore,A.query,!1).then((({documents:k})=>A.view.ru(k,L))));const $=U&&U.targetChanges.get(A.targetId),K=U&&U.targetMismatches.get(A.targetId)!=null,j=A.view.applyChanges(L,x.isPrimaryClient,$,K);return v_(x,A.targetId,j.au),j.snapshot})(n,v,E,b);const o=await p_(n.localStore,e,!0),l=new zL(e,o.ks),c=l.ru(o.documents),d=Pd.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),f=l.applyChanges(c,n.isPrimaryClient,d);v_(n,t,f.au);const m=new GL(e,t,l);return n.Tu.set(e,m),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),f.snapshot}async function KL(n,e,t){const i=We(n),r=i.Tu.get(e),o=i.Iu.get(r.targetId);if(o.length>1)return i.Iu.set(r.targetId,o.filter((l=>!zp(l,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await lu(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&uu(i.remoteStore,r.targetId),du(i,r.targetId)})).catch(bo)):(du(i,r.targetId),await lu(i.localStore,r.targetId,!0))}async function JL(n,e){const t=We(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),uu(t.remoteStore,i.targetId))}async function YL(n,e,t){const i=Bv(n);try{const r=await(function(l,c){const d=We(l),f=zt.now(),m=c.reduce(((b,I)=>b.add(I.key)),yt());let v,E;return d.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let I=Ei(),x=yt();return d.xs.getEntries(b,m).next((A=>{I=A,I.forEach(((N,U)=>{U.isValidDocument()||(x=x.add(N))}))})).next((()=>d.localDocuments.getOverlayedDocuments(b,I))).next((A=>{v=A;const N=[];for(const U of c){const L=gU(U,v.get(U.key).overlayedDocument);L!=null&&N.push(new ps(U.key,L,b1(L.value.mapValue),$n.exists(!0)))}return d.mutationQueue.addMutationBatch(b,f,N,c)})).next((A=>{E=A;const N=A.applyToLocalDocumentSet(v,x);return d.documentOverlayCache.saveOverlays(b,A.batchId,N)}))})).then((()=>({batchId:E.batchId,changes:V1(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(l,c,d){let f=l.du[l.currentUser.toKey()];f||(f=new Qt(at)),f=f.insert(c,d),l.du[l.currentUser.toKey()]=f})(i,r.batchId,t),await xo(i,r.changes),await vu(i.remoteStore)}catch(r){const o=Dv(r,"Failed to persist write");t.reject(o)}}async function YC(n,e){const t=We(n);try{const i=await fL(t.localStore,e);e.targetChanges.forEach(((r,o)=>{const l=t.Au.get(o);l&&(Ze(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?l.hu=!0:r.modifiedDocuments.size>0?Ze(l.hu,14607):r.removedDocuments.size>0&&(Ze(l.hu,42227),l.hu=!1))})),await xo(t,i,e)}catch(i){await bo(i)}}function Dw(n,e,t){const i=We(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((o,l)=>{const c=l.view.va(e);c.snapshot&&r.push(c.snapshot)})),(function(l,c){const d=We(l);d.onlineState=c;let f=!1;d.queries.forEach(((m,v)=>{for(const E of v.ba)E.va(c)&&(f=!0)})),f&&Pv(d)})(i.eventManager,e),r.length&&i.Pu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function WL(n,e,t){const i=We(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),o=r&&r.key;if(o){let l=new Qt(Fe.comparator);l=l.insert(o,ln.newNoDocument(o,tt.min()));const c=yt().add(o),d=new Dd(tt.min(),new Map,new Qt(at),l,c);await YC(i,d),i.Ru=i.Ru.remove(o),i.Au.delete(e),Lv(i)}else await lu(i.localStore,e,!1).then((()=>du(i,e,t))).catch(bo)}async function QL(n,e){const t=We(n),i=e.batch.batchId;try{const r=await dL(t.localStore,e);Uv(t,i,null),Vv(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await xo(t,r)}catch(r){await bo(r)}}async function XL(n,e,t){const i=We(n);try{const r=await(function(l,c){const d=We(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",(f=>{let m;return d.mutationQueue.lookupMutationBatch(f,c).next((v=>(Ze(v!==null,37113),m=v.keys(),d.mutationQueue.removeMutationBatch(f,v)))).next((()=>d.mutationQueue.performConsistencyCheck(f))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(f,m,c))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m))).next((()=>d.localDocuments.getDocuments(f,m)))}))})(i.localStore,e);Uv(i,e,t),Vv(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await xo(i,r)}catch(r){await bo(r)}}function Vv(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Uv(n,e,t){const i=We(n);let r=i.du[i.currentUser.toKey()];if(r){const o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),i.du[i.currentUser.toKey()]=r}}function du(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||WC(n,i)}))}function WC(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(uu(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Lv(n))}function v_(n,e,t){for(const i of t)i instanceof jC?(n.Vu.addReference(i.key,e),ZL(n,i)):i instanceof KC?(Pe(Tu,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||WC(n,i.key)):je(19791,{wu:i})}function ZL(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(Pe(Tu,"New document in limbo: "+t),n.Eu.add(i),Lv(n))}function Lv(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Fe(Vt.fromString(e)),i=n.fu.next();n.Au.set(i,new qL(t)),n.Ru=n.Ru.insert(t,i),Wp(n.remoteStore,new rs(Ti(Fp(t.path)),i,"TargetPurposeLimboResolution",ai.ce))}}async function xo(n,e,t){const i=We(n),r=[],o=[],l=[];i.Tu.isEmpty()||(i.Tu.forEach(((c,d)=>{l.push(i.pu(d,e,t).then((f=>{var m;if((f||t)&&i.isPrimaryClient){const v=f?!f.fromCache:(m=t==null?void 0:t.targetChanges.get(d.targetId))==null?void 0:m.current;i.sharedClientState.updateQueryState(d.targetId,v?"current":"not-current")}if(f){r.push(f);const v=Av.Es(d.targetId,f);o.push(v)}})))})),await Promise.all(l),i.Pu.J_(r),await(async function(d,f){const m=We(d);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ce.forEach(f,(E=>ce.forEach(E.Ts,(b=>m.persistence.referenceDelegate.addReference(v,E.targetId,b))).next((()=>ce.forEach(E.Is,(b=>m.persistence.referenceDelegate.removeReference(v,E.targetId,b)))))))))}catch(v){if(!So(v))throw v;Pe(Iv,"Failed to update sequence numbers: "+v)}for(const v of f){const E=v.targetId;if(!v.fromCache){const b=m.vs.get(E),I=b.snapshotVersion,x=b.withLastLimboFreeSnapshotVersion(I);m.vs=m.vs.insert(E,x)}}})(i.localStore,o))}async function e5(n,e){const t=We(n);if(!t.currentUser.isEqual(e)){Pe(Tu,"User change. New user:",e.toKey());const i=await AC(t.localStore,e);t.currentUser=e,(function(o,l){o.mu.forEach((c=>{c.forEach((d=>{d.reject(new Ue(Se.CANCELLED,l))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await xo(t,i.Ns)}}function t5(n,e){const t=We(n),i=t.Au.get(e);if(i&&i.hu)return yt().add(i.key);{let r=yt();const o=t.Iu.get(e);if(!o)return r;for(const l of o){const c=t.Tu.get(l);r=r.unionWith(c.view.nu)}return r}}async function n5(n,e){const t=We(n),i=await p_(t.localStore,e.query,!0),r=e.view.cu(i);return t.isPrimaryClient&&v_(t,e.targetId,r.au),r}async function i5(n,e){const t=We(n);return RC(t.localStore,e).then((i=>xo(t,i)))}async function r5(n,e,t,i){const r=We(n),o=await(function(c,d){const f=We(c),m=We(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",(v=>m.Xn(v,d).next((E=>E?f.localDocuments.getDocuments(v,E):ce.resolve(null)))))})(r.localStore,e);o!==null?(t==="pending"?await vu(r.remoteStore):t==="acknowledged"||t==="rejected"?(Uv(r,e,i||null),Vv(r,e),(function(c,d){We(We(c).mutationQueue).nr(d)})(r.localStore,e)):je(6720,"Unknown batchState",{bu:t}),await xo(r,o)):Pe(Tu,"Cannot apply mutation batch with id: "+e)}async function s5(n,e){const t=We(n);if(Qp(t),Bv(t),e===!0&&t.gu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),r=await Pw(t,i.toArray());t.gu=!0,await y_(t.remoteStore,!0);for(const o of r)Wp(t.remoteStore,o)}else if(e===!1&&t.gu!==!1){const i=[];let r=Promise.resolve();t.Iu.forEach(((o,l)=>{t.sharedClientState.isLocalQueryTarget(l)?i.push(l):r=r.then((()=>(du(t,l),lu(t.localStore,l,!0)))),uu(t.remoteStore,l)})),await r,await Pw(t,i),(function(l){const c=We(l);c.Au.forEach(((d,f)=>{uu(c.remoteStore,f)})),c.Vu.zr(),c.Au=new Map,c.Ru=new Qt(Fe.comparator)})(t),t.gu=!1,await y_(t.remoteStore,!1)}}async function Pw(n,e,t){const i=We(n),r=[],o=[];for(const l of e){let c;const d=i.Iu.get(l);if(d&&d.length!==0){c=await lp(i.localStore,Ti(d[0]));for(const f of d){const m=i.Tu.get(f),v=await n5(i,m);v.snapshot&&o.push(v.snapshot)}}else{const f=await CC(i.localStore,l);c=await lp(i.localStore,f),await Ov(i,QC(f),l,!1,c.resumeToken)}r.push(c)}return i.Pu.J_(o),r}function QC(n){return N1(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function o5(n){return(function(t){return We(We(t).persistence).hs()})(We(n).localStore)}async function a5(n,e,t,i){const r=We(n);if(r.gu)return void Pe(Tu,"Ignoring unexpected query state notification.");const o=r.Iu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const l=await RC(r.localStore,D1(o[0])),c=Dd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",pn.EMPTY_BYTE_STRING);await xo(r,l,c);break}case"rejected":await lu(r.localStore,e,!0),du(r,e,i);break;default:je(64155,t)}}async function l5(n,e,t){const i=Qp(n);if(i.gu){for(const r of e){if(i.Iu.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){Pe(Tu,"Adding an already active target "+r);continue}const o=await CC(i.localStore,r),l=await lp(i.localStore,o);await Ov(i,QC(o),l.targetId,!1,l.resumeToken),Wp(i.remoteStore,l)}for(const r of t)i.Iu.has(r)&&await lu(i.localStore,r,!1).then((()=>{uu(i.remoteStore,r),du(i,r)})).catch(bo)}}function Qp(n){const e=We(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=YC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=t5.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=WL.bind(null,e),e.Pu.J_=BL.bind(null,e.eventManager),e.Pu.yu=FL.bind(null,e.eventManager),e}function Bv(n){const e=We(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=QL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=XL.bind(null,e),e}class Ed{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Jp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return xC(this.persistence,new wC,e.initialUser,this.serializer)}Cu(e){return new wv(Kp.Vi,this.serializer)}Du(e){return new PC}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ed.provider={build:()=>new Ed};class XC extends Ed{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ze(this.persistence.referenceDelegate instanceof ap,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new _C(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?qn.withCacheSize(this.cacheSizeBytes):qn.DEFAULT;return new wv((i=>ap.Vi(i,t)),this.serializer)}}class ZC extends Ed{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Bv(this.xu.syncEngine),await vu(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return xC(this.persistence,new wC,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new _C(i,e.asyncQueue,t)}Mu(e,t){const i=new gV(t,this.persistence);return new mV(e.asyncQueue,i)}Cu(e){const t=SC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?qn.withCacheSize(this.cacheSizeBytes):qn.DEFAULT;return new xv(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,OC(),Bh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new PC}}class u5 extends ZC{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Sy&&(this.sharedClientState.syncEngine={So:r5.bind(null,t),Do:a5.bind(null,t),Co:l5.bind(null,t),hs:o5.bind(null,t),bo:i5.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async i=>{await s5(this.xu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Du(e){const t=OC();if(!Sy.v(t))throw new Ue(Se.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=SC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Sy(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class fu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Dw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=e5.bind(null,this.syncEngine),await y_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new LL})()}createDatastore(e){const t=Jp(e.databaseInfo.databaseId),i=vL(e.databaseInfo);return wL(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,o,l,c){return new AL(i,r,o,l,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>Dw(this.syncEngine,t,0)),(function(){return Iw.v()?new Iw:new mL})())}createSyncEngine(e,t){return(function(r,o,l,c,d,f,m){const v=new HL(r,o,l,c,d,f);return m&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const o=We(r);Pe(Ma,"RemoteStore shutting down."),o.Ea.add(5),await Od(o),o.Aa.shutdown(),o.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}fu.provider={build:()=>new fu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):fn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _o="FirestoreClient";class c5{constructor(e,t,i,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=r,this.user=Mn.UNAUTHENTICATED,this.clientId=iv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,(async l=>{Pe(_o,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(i,(l=>(Pe(_o,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ss;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Dv(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function xy(n,e){n.asyncQueue.verifyOperationInProgress(),Pe(_o,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await AC(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Ow(n,e){n.asyncQueue.verifyOperationInProgress();const t=await d5(n);Pe(_o,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Rw(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>Rw(e.remoteStore,r))),n._onlineComponents=e}async function d5(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Pe(_o,"Using user provided OfflineComponentProvider");try{await xy(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===Se.FAILED_PRECONDITION||r.code===Se.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;Aa("Error using user provided cache. Falling back to memory cache: "+t),await xy(n,new Ed)}}else Pe(_o,"Using default OfflineComponentProvider"),await xy(n,new XC(void 0));return n._offlineComponents}async function tR(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Pe(_o,"Using user provided OnlineComponentProvider"),await Ow(n,n._uninitializedComponentsProvider._online)):(Pe(_o,"Using default OnlineComponentProvider"),await Ow(n,new fu))),n._onlineComponents}function f5(n){return tR(n).then((e=>e.syncEngine))}async function E_(n){const e=await tR(n),t=e.eventManager;return t.onListen=$L.bind(null,e.syncEngine),t.onUnlisten=KL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=jL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=JL.bind(null,e.syncEngine),t}function h5(n,e,t,i){const r=new eR(i),o=new $C(e,r,t);return n.asyncQueue.enqueueAndForget((async()=>qC(await E_(n),o))),()=>{r.Nu(),n.asyncQueue.enqueueAndForget((async()=>HC(await E_(n),o)))}}function p5(n,e,t={}){const i=new ss;return n.asyncQueue.enqueueAndForget((async()=>(function(o,l,c,d,f){const m=new eR({next:E=>{m.Nu(),l.enqueueAndForget((()=>HC(o,v))),E.fromCache&&d.source==="server"?f.reject(new Ue(Se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(E)},error:E=>f.reject(E)}),v=new $C(c,m,{includeMetadataChanges:!0,Ka:!0});return qC(o,v)})(await E_(n),n.asyncQueue,e,t,i))),i.promise}function m5(n,e){const t=new ss;return n.asyncQueue.enqueueAndForget((async()=>YL(await f5(n),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nR(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g5="ComponentProvider",Vw=new Map;function y5(n,e,t,i,r){return new HV(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,nR(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iR="firestore.googleapis.com",Uw=!0;class Lw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ue(Se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=iR,this.ssl=Uw}else this.host=e.host,this.ssl=e.ssl??Uw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=hC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yC)throw new Ue(Se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}fV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nR(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ue(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ue(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ue(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Xp{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Lw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ue(Se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ue(Se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Lw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new nV;switch(i.type){case"firstParty":return new oV(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ue(Se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Vw.get(t);i&&(Pe(g5,"Removing Datastore"),Vw.delete(t),i.terminate())})(this),Promise.resolve()}}function _5(n,e,t,i={}){var f;n=Ui(n,Xp);const r=Da(e),o=n._getSettings(),l={...o,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;r&&(q_(`https://${c}`),YA("Firestore",!0)),o.host!==iR&&o.host!==c&&Aa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...o,host:c,ssl:r,emulatorOptions:i};if(!ho(d,l)&&(n._setSettings(d),i.mockUserToken)){let m,v;if(typeof i.mockUserToken=="string")m=i.mockUserToken,v=Mn.MOCK_USER;else{m=fM(i.mockUserToken,(f=n._app)==null?void 0:f.options.projectId);const E=i.mockUserToken.sub||i.mockUserToken.user_id;if(!E)throw new Ue(Se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new Mn(E)}n._authCredentials=new iV(new KI(m,v))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Ao(this.firestore,e,this._query)}}class hn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hn(this.firestore,e,this._key)}toJSON(){return{type:hn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Rd(t,hn._jsonSchema))return new hn(e,i||null,new Fe(Vt.fromString(t.referencePath)))}}hn._jsonSchemaVersion="firestore/documentReference/1.0",hn._jsonSchema={type:Sn("string",hn._jsonSchemaVersion),referencePath:Sn("string")};class fo extends Ao{constructor(e,t,i){super(e,t,Fp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hn(this.firestore,null,new Fe(e))}withConverter(e){return new fo(this.firestore,e,this._path)}}function U9(n,e,...t){if(n=Dn(n),YI("collection","path",e),n instanceof Xp){const i=Vt.fromString(e,...t);return CS(i),new fo(n,null,i)}{if(!(n instanceof hn||n instanceof fo))throw new Ue(Se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Vt.fromString(e,...t));return CS(i),new fo(n.firestore,null,i)}}function rR(n,e,...t){if(n=Dn(n),arguments.length===1&&(e=iv.newId()),YI("doc","path",e),n instanceof Xp){const i=Vt.fromString(e,...t);return IS(i),new hn(n,null,new Fe(i))}{if(!(n instanceof hn||n instanceof fo))throw new Ue(Se.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Vt.fromString(e,...t));return IS(i),new hn(n.firestore,n instanceof fo?n.converter:null,new Fe(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bw="AsyncQueue";class Fw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new VC(this,"async_queue_retry"),this._c=()=>{const i=Bh();i&&Pe(Bw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Bh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Bh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ss;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!So(e))throw e;Pe(Bw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,fn("INTERNAL UNHANDLED ERROR: ",zw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Mv.createAndSchedule(this,e,t,i,(o=>this.hc(o)));return this.tc.push(r),r}uc(){this.nc&&je(47125,{Pc:zw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function zw(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class vo extends Xp{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Fw,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Fw(e),this._firestoreClient=void 0,await e}}}function Gw(n,e,t){t||(t=pd);const i=Ip(n,"firestore");if(i.isInitialized(t)){const r=i.getImmediate({identifier:t}),o=i.getOptions(t);if(ho(o,e))return r;throw new Ue(Se.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Ue(Se.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yC)throw new Ue(Se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Da(e.host)&&q_(e.host),i.initialize({options:e,instanceIdentifier:t})}function qw(n,e){const t=typeof n=="object"?n:iI(),i=typeof n=="string"?n:pd,r=Ip(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const o=cM("firestore");o&&_5(r,...o)}return r}function Fv(n){if(n._terminated)throw new Ue(Se.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||v5(n),n._firestoreClient}function v5(n){var i,r,o,l;const e=n._freezeSettings(),t=y5(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,(r=n._app)==null?void 0:r.options.apiKey,e);n._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new c5(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(d){const f=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(f),_online:f}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vi(pn.fromBase64String(e))}catch(t){throw new Ue(Se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Vi(pn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Rd(e,Vi._jsonSchema))return Vi.fromBase64String(e.bytes)}}Vi._jsonSchemaVersion="firestore/bytes/1.0",Vi._jsonSchema={type:Sn("string",Vi._jsonSchemaVersion),bytes:Sn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ue(Se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new sn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ue(Se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ue(Se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return at(this._lat,e._lat)||at(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Dr._jsonSchemaVersion}}static fromJSON(e){if(Rd(e,Dr._jsonSchema))return new Dr(e.latitude,e.longitude)}}Dr._jsonSchemaVersion="firestore/geoPoint/1.0",Dr._jsonSchema={type:Sn("string",Dr._jsonSchemaVersion),latitude:Sn("number"),longitude:Sn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ir._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Rd(e,ir._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ir(e.vectorValues);throw new Ue(Se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ir._jsonSchemaVersion="firestore/vectorValue/1.0",ir._jsonSchema={type:Sn("string",ir._jsonSchemaVersion),vectorValues:Sn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5=/^__.*__$/;class T5{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new ps(e,this.data,this.fieldMask,t,this.fieldTransforms):new _u(e,this.data,t,this.fieldTransforms)}}class sR{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new ps(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function oR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw je(40011,{dataSource:n})}}class Gv{constructor(e,t,i,r,o,l){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Gv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return fp(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(oR(this.dataSource)&&E5.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class b5{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Jp(e)}createContext(e,t,i,r=!1){return new Gv({dataSource:e,methodName:t,targetDoc:i,path:sn.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function em(n){const e=n._freezeSettings(),t=Jp(n._databaseId);return new b5(n._databaseId,!!e.ignoreUndefinedProperties,t)}function aR(n,e,t,i,r,o={}){const l=n.createContext(o.merge||o.mergeFields?2:0,e,t,r);Hv("Data must be an object, but it was:",l,i);const c=lR(i,l);let d,f;if(o.merge)d=new li(l.fieldMask),f=l.fieldTransforms;else if(o.mergeFields){const m=[];for(const v of o.mergeFields){const E=hu(e,v,t);if(!l.contains(E))throw new Ue(Se.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);dR(m,E)||m.push(E)}d=new li(m),f=l.fieldTransforms.filter((v=>d.covers(v.field)))}else d=null,f=l.fieldTransforms;return new T5(new Hn(c),d,f)}class tm extends Zp{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof tm}}class qv extends Zp{_toFieldTransform(e){return new q1(e.path,new ru)}isEqual(e){return e instanceof qv}}function S5(n,e,t,i){const r=n.createContext(1,e,t);Hv("Data must be an object, but it was:",r,i);const o=[],l=Hn.empty();wo(i,((d,f)=>{const m=cR(e,d,t);f=Dn(f);const v=r.childContextForFieldPath(m);if(f instanceof tm)o.push(m);else{const E=Vd(f,v);E!=null&&(o.push(m),l.set(m,E))}}));const c=new li(o);return new sR(l,c,r.fieldTransforms)}function w5(n,e,t,i,r,o){const l=n.createContext(1,e,t),c=[hu(e,i,t)],d=[r];if(o.length%2!=0)throw new Ue(Se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<o.length;E+=2)c.push(hu(e,o[E])),d.push(o[E+1]);const f=[],m=Hn.empty();for(let E=c.length-1;E>=0;--E)if(!dR(f,c[E])){const b=c[E];let I=d[E];I=Dn(I);const x=l.childContextForFieldPath(b);if(I instanceof tm)f.push(b);else{const A=Vd(I,x);A!=null&&(f.push(b),m.set(b,A))}}const v=new li(f);return new sR(m,v,l.fieldTransforms)}function x5(n,e,t,i=!1){return Vd(t,n.createContext(i?4:3,e))}function Vd(n,e){if(uR(n=Dn(n)))return Hv("Unsupported field value:",e,n),lR(n,e);if(n instanceof Zp)return(function(i,r){if(!oR(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,r){const o=[];let l=0;for(const c of i){let d=Vd(c,r.childContextForArray(l));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),l++}return{arrayValue:{values:o}}})(n,e)}return(function(i,r){if((i=Dn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return cU(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=zt.fromDate(i);return{timestampValue:au(r.serializer,o)}}if(i instanceof zt){const o=new zt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:au(r.serializer,o)}}if(i instanceof Dr)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Vi)return{bytesValue:W1(r.serializer,i._byteString)};if(i instanceof hn){const o=r.databaseId,l=i.firestore._databaseId;if(!l.isEqual(o))throw r.createError(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Ev(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof ir)return(function(l,c){const d=l instanceof ir?l.toArray():l;return{mapValue:{fields:{[dv]:{stringValue:fv},[eu]:{arrayValue:{values:d.map((m=>{if(typeof m!="number")throw c.createError("VectorValues must only contain numeric values.");return mv(c.serializer,m)}))}}}}}})(i,r);if(aC(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${Mp(i)}`)})(n,e)}function lR(n,e){const t={};return h1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wo(n,((i,r)=>{const o=Vd(r,e.childContextForField(i));o!=null&&(t[i]=o)})),{mapValue:{fields:t}}}function uR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof zt||n instanceof Dr||n instanceof Vi||n instanceof hn||n instanceof Zp||n instanceof ir||aC(n))}function Hv(n,e,t){if(!uR(t)||!WI(t)){const i=Mp(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function hu(n,e,t){if((e=Dn(e))instanceof zv)return e._internalPath;if(typeof e=="string")return cR(n,e);throw fp("Field path arguments must be of type string or ",n,!1,void 0,t)}const A5=new RegExp("[~\\*/\\[\\]]");function cR(n,e,t){if(e.search(A5)>=0)throw fp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new zv(...e.split("."))._internalPath}catch{throw fp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fp(n,e,t,i,r){const o=i&&!i.isEmpty(),l=r!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let d="";return(o||l)&&(d+=" (found",o&&(d+=` in field ${i}`),l&&(d+=` in document ${r}`),d+=")"),new Ue(Se.INVALID_ARGUMENT,c+n+d)}function dR(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I5{convertValue(e,t="none"){switch(mo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw je(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return wo(e,((r,o)=>{i[r]=this.convertValue(o,t)})),i}convertVectorValue(e){var i,r,o;const t=(o=(r=(i=e.fields)==null?void 0:i[eu].arrayValue)==null?void 0:r.values)==null?void 0:o.map((l=>nn(l.doubleValue)));return new ir(t)}convertGeoPoint(e){return new Dr(nn(e.latitude),nn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Lp(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(hd(e));default:return null}}convertTimestamp(e){const t=ls(e);return new zt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Vt.fromString(e);Ze(oC(i),9688,{name:e});const r=new Ia(i.get(1),i.get(3)),o=new Fe(i.popFirst(5));return r.isEqual(t)||fn(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v extends I5{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new hn(this.firestore,null,t)}}function L9(){return new qv("serverTimestamp")}const Hw="@firebase/firestore",$w="4.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const o of i)if(o in r&&typeof r[o]=="function")return!0;return!1})(n,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e,t,i,r,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new hn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new C5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(hu("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class C5 extends fR{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ue(Se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class jv{}class pR extends jv{}function B9(n,e,...t){let i=[];e instanceof jv&&i.push(e),i=i.concat(t),(function(o){const l=o.filter((d=>d instanceof Jv)).length,c=o.filter((d=>d instanceof Kv)).length;if(l>1||l>0&&c>0)throw new Ue(Se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class Kv extends pR{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Kv(e,t,i)}_apply(e){const t=this._parse(e);return mR(e._query,t),new Ao(e.firestore,e.converter,s_(e._query,t))}_parse(e){const t=em(e.firestore);return(function(o,l,c,d,f,m,v){let E;if(f.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new Ue(Se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){Jw(v,m);const I=[];for(const x of v)I.push(Kw(d,o,x));E={arrayValue:{values:I}}}else E=Kw(d,o,v)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||Jw(v,m),E=x5(c,l,v,m==="in"||m==="not-in");return St.create(f,m,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class Jv extends jv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Jv(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Gt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,o){let l=r;const c=o.getFlattenedFilters();for(const d of c)mR(l,d),l=s_(l,d)})(e._query,t),new Ao(e.firestore,e.converter,s_(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Yv extends pR{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Yv(e,t)}_apply(e){const t=(function(r,o,l){if(r.startAt!==null)throw new Ue(Se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Ue(Se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _d(o,l)})(e._query,this._field,this._direction);return new Ao(e.firestore,e.converter,rU(e._query,t))}}function F9(n,e="asc"){const t=e,i=hu("orderBy",n);return Yv._create(i,t)}function Kw(n,e,t){if(typeof(t=Dn(t))=="string"){if(t==="")throw new Ue(Se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!k1(e)&&t.indexOf("/")!==-1)throw new Ue(Se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Vt.fromString(t));if(!Fe.isDocumentKey(i))throw new Ue(Se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return gd(n,new Fe(i))}if(t instanceof hn)return gd(n,t._key);throw new Ue(Se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Mp(t)}.`)}function Jw(n,e){if(!Array.isArray(n)||n.length===0)throw new Ue(Se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function mR(n,e){const t=(function(r,o){for(const l of r)for(const c of l.getFlattenedFilters())if(o.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ue(Se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ue(Se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function gR(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class R5{constructor(e){this.kind="memory",this._onlineComponentProvider=fu.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new XC(void 0)}}toJSON(){return{kind:this.kind}}}class N5{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=O5(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function k5(n){return new R5(n)}function M5(n){return new N5(n)}class D5{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=fu.provider,this._offlineComponentProvider={build:t=>new ZC(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class P5{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=fu.provider,this._offlineComponentProvider={build:t=>new u5(t,e==null?void 0:e.cacheSizeBytes)}}}function O5(n){return new D5(n==null?void 0:n.forceOwnership)}function V5(){return new P5}class Gc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class _a extends fR{constructor(e,t,i,r,o,l){super(e,t,i,r,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Fh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(hu("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(Se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=_a._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}_a._jsonSchemaVersion="firestore/documentSnapshot/1.0",_a._jsonSchema={type:Sn("string",_a._jsonSchemaVersion),bundleSource:Sn("string","DocumentSnapshot"),bundleName:Sn("string"),bundle:Sn("string")};class Fh extends _a{data(e={}){return super.data(e)}}class va{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Gc(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Fh(this._firestore,this._userDataWriter,i.key,i,new Gc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ue(Se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,o){if(r._snapshot.oldDocs.isEmpty()){let l=0;return r._snapshot.docChanges.map((c=>{const d=new Fh(r._firestore,r._userDataWriter,c.doc.key,c.doc,new Gc(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:d,oldIndex:-1,newIndex:l++}}))}{let l=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((c=>o||c.type!==3)).map((c=>{const d=new Fh(r._firestore,r._userDataWriter,c.doc.key,c.doc,new Gc(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);let f=-1,m=-1;return c.type!==0&&(f=l.indexOf(c.doc.key),l=l.delete(c.doc.key)),c.type!==1&&(l=l.add(c.doc),m=l.indexOf(c.doc.key)),{type:U5(c.type),doc:d,oldIndex:f,newIndex:m}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(Se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=va._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=iv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function U5(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return je(61501,{type:n})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */va._jsonSchemaVersion="firestore/querySnapshot/1.0",va._jsonSchema={type:Sn("string",va._jsonSchemaVersion),bundleSource:Sn("string","QuerySnapshot"),bundleName:Sn("string"),bundle:Sn("string")};function z9(n){n=Ui(n,Ao);const e=Ui(n.firestore,vo),t=Fv(e),i=new $v(e);return hR(n._query),p5(t,n._query).then((r=>new va(e,i,n,r)))}function L5(n,e,t){n=Ui(n,hn);const i=Ui(n.firestore,vo),r=gR(n.converter,e,t),o=em(i);return nm(i,[aR(o,"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,$n.none())])}function G9(n,e,t,...i){n=Ui(n,hn);const r=Ui(n.firestore,vo),o=em(r);let l;return l=typeof(e=Dn(e))=="string"||e instanceof zv?w5(o,"updateDoc",n._key,e,t,i):S5(o,"updateDoc",n._key,e),nm(r,[l.toMutation(n._key,$n.exists(!0))])}function q9(n){return nm(Ui(n.firestore,vo),[new Hp(n._key,$n.none())])}function H9(n,e){const t=Ui(n.firestore,vo),i=rR(n),r=gR(n.converter,e),o=em(n.firestore);return nm(t,[aR(o,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,$n.exists(!1))]).then((()=>i))}function $9(n,...e){var f,m,v;n=Dn(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||jw(e[i])||(t=e[i++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(jw(e[i])){const E=e[i];e[i]=(f=E.next)==null?void 0:f.bind(E),e[i+1]=(m=E.error)==null?void 0:m.bind(E),e[i+2]=(v=E.complete)==null?void 0:v.bind(E)}let o,l,c;if(n instanceof hn)l=Ui(n.firestore,vo),c=Fp(n._key.path),o={next:E=>{e[i]&&e[i](B5(l,n,E))},error:e[i+1],complete:e[i+2]};else{const E=Ui(n,Ao);l=Ui(E.firestore,vo),c=E._query;const b=new $v(l);o={next:I=>{e[i]&&e[i](new va(l,b,E,I))},error:e[i+1],complete:e[i+2]},hR(n._query)}const d=Fv(l);return h5(d,c,r,o)}function nm(n,e){const t=Fv(n);return m5(t,e)}function B5(n,e,t){const i=t.docs.get(e._key),r=new $v(n);return new _a(n,r,e._key,i,new Gc(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){tV(pu),Kl(new Sa("firestore",((i,{instanceIdentifier:r,options:o})=>{const l=i.getProvider("app").getImmediate(),c=new vo(new rV(i.getProvider("auth-internal")),new aV(l,i.getProvider("app-check-internal")),$V(l,r),l);return o={useFetchStreams:t,...o},c._setSettings(o),c}),"PUBLIC").setMultipleInstances(!0)),lo(Hw,$w,e),lo(Hw,$w,"esm2020")})();const F5=[".web.app",".firebaseapp.com"],z5=[".scf.usercontent.goog",".usercontent.goog"],G5=new Set(["localhost","127.0.0.1","0.0.0.0"]),q5=n=>{const e=n.match(/\/apps\/drive\/([^/?#]+)/i);if(!(!e||!e[1]))return decodeURIComponent(e[1])},er=()=>{var l;if(typeof window>"u")return{kind:"local",host:"",pathname:"",protocol:""};const n=globalThis==null?void 0:globalThis.chrome;if(!!((l=n==null?void 0:n.runtime)!=null&&l.id))return{kind:"extension",host:String(window.location.hostname||""),pathname:String(window.location.pathname||""),protocol:String(window.location.protocol||"")};const t=String(window.location.hostname||"").toLowerCase(),i=String(window.location.pathname||""),r=String(window.location.protocol||"").toLowerCase(),o=q5(i);return t==="aistudio.google.com"||z5.some(c=>t.endsWith(c))||o?{kind:"studio",host:t,pathname:i,protocol:r,studioAppId:o}:F5.some(c=>t.endsWith(c))||t==="root.caravanflow.com"?{kind:"firebase",host:t,pathname:i,protocol:r}:r==="file:"||G5.has(t)||/^\d+\.\d+\.\d+\.\d+$/.test(t)?{kind:"local",host:t,pathname:i,protocol:r}:{kind:"web",host:t,pathname:i,protocol:r}},yR=n=>{const e=n.kind==="extension",t=n.kind==="studio";return{canUseBrowserAutomation:e,canReloadExtension:e,canUseGooglePopupAuth:!e&&!t,canUseStudioTokenAuth:t}},H5=(n,e)=>n==="studio"?{operationMode:"local",requireAuth:!1,executionPolicy:"read",enableGoogleSearch:!1,enableFullExecutionMode:!1,enableDomMode:!1}:n==="firebase"?{operationMode:"cloud",requireAuth:e}:n==="local"?{operationMode:"local",requireAuth:!1,executionPolicy:"read",enableDomMode:!1}:n==="extension"?{operationMode:"local",executionPolicy:"yolo",enableDomMode:!0}:{},Yw=(n,e)=>e.kind==="studio"?{...n,operationMode:"local",requireAuth:!1,enableGoogleSearch:!1,enableFullExecutionMode:!1,enableDomMode:!1}:e.kind!=="extension"?{...n,enableDomMode:!1}:n,$5="AIzaSyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",j5={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyCv7XAlseHNzqHcVk4xVUToppzTEHEtZ3E",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"bilge-22504.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"bilge-22504",NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET:"bilge-22504.firebasestorage.app",NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID:"747317322292",NEXT_PUBLIC_FIREBASE_APP_ID:"1:747317322292:web:8d7ce860292594dea4a061",FIREBASE_API_KEY:void 0,FIREBASE_AUTH_DOMAIN:void 0,FIREBASE_PROJECT_ID:void 0,FIREBASE_STORAGE_BUCKET:void 0,FIREBASE_MESSAGING_SENDER_ID:void 0,FIREBASE_APP_ID:void 0},Oi=n=>{const e=j5[n];return typeof e=="string"?e:void 0},Rl=n=>typeof n!="string"?"":n.trim(),_R=n=>/^AIza[0-9A-Za-z_-]{35}$/.test(n),K5=er(),vR=K5.kind==="studio",J5=()=>{try{const n=localStorage.getItem("bilge_firebase_config");if(n){const e=JSON.parse(n);if(e&&typeof e=="object")return e}}catch{}return{apiKey:Oi("NEXT_PUBLIC_FIREBASE_API_KEY")||Oi("FIREBASE_API_KEY"),authDomain:Oi("NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN")||Oi("FIREBASE_AUTH_DOMAIN"),projectId:Oi("NEXT_PUBLIC_FIREBASE_PROJECT_ID")||Oi("FIREBASE_PROJECT_ID"),storageBucket:Oi("NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET")||Oi("FIREBASE_STORAGE_BUCKET"),messagingSenderId:Oi("NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID")||Oi("FIREBASE_MESSAGING_SENDER_ID"),appId:Oi("NEXT_PUBLIC_FIREBASE_APP_ID")||Oi("FIREBASE_APP_ID")}},Nl=J5(),Cr={apiKey:Rl(Nl.apiKey),authDomain:Rl(Nl.authDomain),projectId:Rl(Nl.projectId),storageBucket:Rl(Nl.storageBucket),messagingSenderId:Rl(Nl.messagingSenderId),appId:Rl(Nl.appId)},io=!vR&&!!(_R(Cr.apiKey)&&Cr.projectId&&Cr.authDomain),Ay=Cr.projectId||"bilge-local",Y5={apiKey:_R(Cr.apiKey)?Cr.apiKey:$5,authDomain:Cr.authDomain||`${Ay}.firebaseapp.com`,projectId:Ay,storageBucket:Cr.storageBucket||`${Ay}.appspot.com`,messagingSenderId:Cr.messagingSenderId||"000000000000",appId:Cr.appId||"1:000000000000:web:0000000000000000000000"},es=(()=>{if(vR)return null;const n=AD();return n.length===0?nI(Y5):n[0]})(),Xi=es?ZO(es):null,Ww=(()=>{if(!es||typeof window>"u"||!io)return es?qw(es):null;try{return Gw(es,{localCache:M5({tabManager:V5()})})}catch(n){console.warn("[Firestore] Persistent cache init failed; using memory cache.",n);try{return Gw(es,{localCache:k5()})}catch{return qw(es)}}})(),Iy=es?new ts:null,ER="bilge_force_local_mode";let hp=!1;if(typeof window<"u")try{hp=localStorage.getItem(ER)==="1"}catch{}const j9=()=>!io||hp,W5=n=>{if(hp=!!n,!(typeof window>"u"))try{localStorage.setItem(ER,hp?"1":"0")}catch{}};class Q5{constructor(){this.services=new Map,this.listeners=[],this.stateChangeCallbacks=new Map,this.initializeRegistry()}initializeRegistry(){const e=typeof chrome<"u"&&!!chrome.runtime&&!!chrome.runtime.id;[{id:"gemini",name:"Gemini Driver",description:"Core LLM orchestration and streaming.",status:"active",isEssential:!0,category:"compute"},{id:"openai",name:"ChatGPT Fallback",description:"OpenAI API gateway for Gemini quota recovery.",status:"active",isEssential:!0,category:"compute"},{id:"cortex",name:"Bilge Cortex",description:"Context resolution and project tree analysis.",status:"active",isEssential:!0,category:"intelligence"},{id:"mcp",name:"VFS Driver (MCP)",description:"Virtual File System and shell tool execution.",status:"active",isEssential:!0,category:"data"},{id:"firebase",name:"Auth Kernel",description:"Google Identity and Firebase Auth.",status:"active",isEssential:!0,category:"utility"},{id:"telemetry",name:"Neural Link (Telemetry)",description:"High-speed event logging and performance monitoring.",status:"active",isEssential:!0,category:"utility"},{id:"knowledge",name:"The Librarian",description:"Adaptive RAG engine and auto-tagging.",status:"active",isEssential:!1,category:"intelligence"},{id:"cost",name:"Treasurer (Cost)",description:"Real-time token tracking and financial auditing.",status:"stopped",isEssential:!1,category:"utility"},{id:"fusion",name:"Fusion Engine",description:"Tri-agent cross-branch diffing and patching.",status:"stopped",isEssential:!1,category:"intelligence"},{id:"git",name:"DevOps Agent",description:"Intelligent git commit and sync logic.",status:"stopped",isEssential:!1,category:"utility"},{id:"firestore",name:"Cloud Persistence",description:"Firebase database bridge.",status:"active",isEssential:!0,category:"data"},{id:"novita",name:"DeepSeek Gateway",description:"Novita AI API bridge for R1/Llama.",status:"active",isEssential:!0,category:"compute"},{id:"github",name:"GitHub API",description:"Low-level GitHub REST connector.",status:"stopped",isEssential:!1,category:"data"},{id:"browser",name:"Browser Driver",description:"Chrome extension bridge for DOM automation.",status:e?"active":"stopped",isEssential:!1,category:"utility"}].forEach(i=>this.services.set(i.id,i))}onStateChange(e,t){this.stateChangeCallbacks.has(e)||this.stateChangeCallbacks.set(e,[]),this.stateChangeCallbacks.get(e).push(t),t(this.isServiceActive(e))}isServiceActive(e){var t;return((t=this.services.get(e))==null?void 0:t.status)==="active"}async toggleService(e){const t=this.services.get(e);t&&(t.status==="active"?(t.status="stopped",this.notifyStateChange(e,!1)):(t.status="provisioning",this.notify(),await new Promise(i=>setTimeout(i,1200)),t.status="active",t.uptime=Date.now(),this.notifyStateChange(e,!0)),this.notify())}async startAllServices(){const e=Array.from(this.services.values()).filter(t=>t.status==="stopped");e.length!==0&&(e.forEach(t=>{t.status="provisioning"}),this.notify(),await new Promise(t=>setTimeout(t,1500)),e.forEach(t=>{t.status="active",t.uptime=Date.now(),this.notifyStateChange(t.id,!0)}),this.notify())}async stopAllServices(){const e=Array.from(this.services.values()).filter(t=>t.status==="active"&&!t.isEssential);e.length!==0&&(e.forEach(t=>{t.status="stopped",this.notifyStateChange(t.id,!1)}),this.notify())}getServices(){return Array.from(this.services.values())}subscribe(e){return this.listeners.push(e),e(this.getServices()),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}notify(){this.listeners.forEach(e=>e(this.getServices()))}notifyStateChange(e,t){const i=this.stateChangeCallbacks.get(e);i&&i.forEach(r=>r(t))}}const Qw=new Q5,X5=4;class Z5{constructor(){this.rates={"gemini-3-flash-preview":{input:.1,output:.4},"gemini-3-pro-preview":{input:2,output:8},"deepseek/deepseek-r1-turbo":{input:7,output:25},"deepseek/deepseek-v3-turbo":{input:4,output:13},"deepseek/deepseek-v3.2":{input:2.69,output:4},"meta-llama/llama-3.3-70b-instruct":{input:1.35,output:4},"meta-llama/llama-3.1-8b-instruct":{input:.2,output:.5},default:{input:.5,output:1.5}},this.sessionCost=0,this.listeners=[],this.logs=[]}getRate(e){return this.rates[e]||this.rates.default}estimateTokens(e){return Math.ceil(e.length/X5)}trackTransaction(e,t,i){const r={inputTokens:t,outputTokens:i,cost:0};if(!Qw.isServiceActive("cost"))return r;const o=this.getRate(e),l=t/1e6*o.input,c=i/1e6*o.output,d=l+c;return this.sessionCost+=d,this.logs.push({model:e,inputTokens:t,outputTokens:i,cost:d,timestamp:Date.now()}),this.notifyListeners(),r.cost=d,r}trackDatabaseOperation(e,t=1){if(!Qw.isServiceActive("cost"))return;const r=(e==="write"?18e-5:6e-5)*t;this.sessionCost+=r,this.notifyListeners()}subscribe(e){return this.listeners.push(e),e(this.sessionCost),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}notifyListeners(){this.listeners.forEach(e=>e(this.sessionCost))}}const ca=new Z5,TR=Oe.createContext(void 0),e4=typeof chrome<"u"&&!!chrome.runtime&&!!chrome.runtime.id,t4=typeof window<"u"&&window.location.search.includes("fullscreenApplet=true"),nd=er(),Ul=nd.kind,n4=yR(nd),bR="https://mcp.caravanflow.com",pp="profile_default_auto",i4=new Set(["auto","reasoning","coding","general","low-latency","search"]),r4=new Set(["none","read","build","yolo"]),s4=n=>{const e=String(n||"").trim().toLowerCase();return i4.has(e)?e:"auto"},SR=n=>{const e=String(n||"").trim().toLowerCase();return r4.has(e)?e:"read"},wR=(n,e)=>n.includes("gemini")?"gemini":e||"novita",o4=n=>{const e=String(n.defaultModelId||"").trim()||"deepseek/deepseek-r1-turbo",t=wR(e,n.defaultProvider||"novita"),i=SR(n.executionPolicy);return{id:pp,name:"Default Auto",gearMode:"auto",provider:t,modelId:e,enableDomMode:!!n.enableDomMode,enableThinking:!!n.enableThinking,enableGoogleSearch:!!n.enableGoogleSearch,executionPolicy:i}},a4=(n,e)=>{const t=o4(e),i=[];if(Array.isArray(n))for(const[r,o]of n.entries()){if(!o||typeof o!="object")continue;const l=o,c=String(l.modelId||"").trim()||t.modelId,d=wR(c,String(l.provider||"").trim()==="gemini"?"gemini":t.provider),f={id:String(l.id||"").trim()||`profile_${r+1}`,name:String(l.name||"").trim()||`Profile ${r+1}`,gearMode:s4(l.gearMode),provider:d,modelId:c,enableDomMode:!!l.enableDomMode,enableThinking:!!l.enableThinking,enableGoogleSearch:!!l.enableGoogleSearch,executionPolicy:SR(l.executionPolicy)};i.push(f)}return i.length===0?[t]:i},l4=()=>{const n="https://mcp.caravanflow.com".trim();return n||bR},xR=(()=>{if("kagan".trim())return!0;const e="AIzaSyCv7XAlseHNzqHcVk4xVUToppzTEHEtZ3E".trim(),t="bilge-22504".trim();return!!(e&&t)})(),u4={theme:"system",operationMode:"cloud",executionPolicy:"read",requireAuth:xR,defaultProvider:"novita",defaultModelId:"deepseek/deepseek-r1-turbo",defaultTemperature:.7,enableNotifications:!0,reducedMotion:!1,developerMode:!1,enableGoogleSearch:!1,enableThinking:!0,flowExecutionMode:"batch",flowLiveHudEnabled:!0,flowLiveHudFlash:!1,flowFlashUiEnabled:!1,enableAutoGit:!1,enableInstacart:!1,enableSurgeryMode:!1,enableFullExecutionMode:!1,enableDomMode:!1,automationProfiles:[{id:pp,name:"Default Auto",gearMode:"auto",provider:"novita",modelId:"deepseek/deepseek-r1-turbo",enableDomMode:Ul==="extension",enableThinking:!0,enableGoogleSearch:!1,executionPolicy:"read"}],activeAutomationProfileId:pp,currentBranch:"main",gitAgentModel:"deepseek/deepseek-v3.2",githubRepo:"",githubToken:"",mcpBaseUrl:l4(),mcpApiToken:"fETRiYbbIuKj48kx31WnVJfzePYSiAa-Yj3Oyx4VrNY",mcpServers:[{id:"browser-native",name:"Browser Native Tools",url:"internal://browser",status:"connected",enabled:!0}],routingMode:"builtin"},mh={...u4,...H5(Ul,xR)},Cy="bilge_app_settings",c4=({children:n})=>{const[e,t]=Oe.useState(mh),[i,r]=Oe.useState(!1);Oe.useEffect(()=>{const d=localStorage.getItem(Cy);if(!d){t(mh);return}try{const f=JSON.parse(d),m=Yw({...mh,...f},nd);if(Ul==="extension"&&!Object.prototype.hasOwnProperty.call(f||{},"enableDomMode")&&(m.enableDomMode=!0),Ul==="extension"){const N=(typeof(f==null?void 0:f.mcpBaseUrl)=="string"?f.mcpBaseUrl.trim():"").replace(/\/+$/,""),U=N==="http://127.0.0.1:18080",L=N.includes("://root.caravanflow.com")||N.includes("://console.caravanflow.com");(!N||U||L)&&(m.mcpBaseUrl=bR)}const E=(typeof(f==null?void 0:f.defaultModelId)=="string"?f.defaultModelId.trim():"")||String(m.defaultModelId||"").trim();E?(m.defaultModelId=E,m.defaultProvider=E.includes("gemini")?"gemini":"novita"):m.defaultModelId=m.defaultProvider==="gemini"?"gemini-3-flash-preview":"deepseek/deepseek-r1-turbo";const b=a4(f==null?void 0:f.automationProfiles,m);m.automationProfiles=b;const I=String((f==null?void 0:f.activeAutomationProfileId)||"").trim(),x=b.find(A=>A.id===I)||b[0];m.activeAutomationProfileId=(x==null?void 0:x.id)||pp,x&&(m.defaultProvider=x.provider,m.defaultModelId=x.modelId,m.enableThinking=x.enableThinking,m.enableGoogleSearch=x.enableGoogleSearch,m.executionPolicy=x.executionPolicy,m.enableFullExecutionMode=x.executionPolicy==="yolo",Ul==="extension"&&(m.enableDomMode=x.enableDomMode)),t(m)}catch{t(mh)}},[]),Oe.useEffect(()=>{var f;localStorage.setItem(Cy,JSON.stringify(e));const d=window.document.documentElement;if(d.classList.remove("light","dark"),e.theme==="system"){const m=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";d.classList.add(m)}else d.classList.add(e.theme);W5(e.operationMode==="local"),typeof chrome<"u"&&((f=chrome.storage)!=null&&f.local)&&chrome.storage.local.set({[Cy]:e})},[e]);const o=d=>{t(f=>Yw({...f,...d},nd))},l=()=>r(!0),c=()=>r(!1);return S.jsx(TR.Provider,{value:{settings:e,updateSettings:o,isSettingsOpen:i,openSettings:l,closeSettings:c,isExtension:e4,isLab:t4,runtimeEnvironment:Ul,runtimeInfo:nd,runtimeCapabilities:n4},children:n})},Io=()=>{const n=Oe.useContext(TR);if(!n)throw new Error("useSettings must be used within a SettingsProvider");return n},mp="bilge_proxy_session_token",T_="bilge_proxy_session_user",d4="bilge_proxy_base_url",b_="https://root.caravanflow.com".trim(),AR=n=>{if(typeof localStorage>"u")return"";try{return String(localStorage.getItem(n)||"")}catch{return""}},IR=(n,e)=>{if(!(typeof localStorage>"u"))try{localStorage.setItem(n,e)}catch{}},gp=n=>{if(!(typeof localStorage>"u"))try{localStorage.removeItem(n)}catch{}},f4=n=>{const e=String(n||"").trim();if(!e)return b_;try{const t=new URL(e);return t.hash="",t.search="",`${t.origin}${t.pathname.replace(/\/+$/,"")}`.replace(/\/+$/,"")}catch{return b_}},CR=()=>{const n=AR(d4).trim();return f4(n||b_)},pa=()=>AR(mp).trim(),RR=n=>{const e=String(n||"").trim();if(!e){gp(mp);return}IR(mp,e)},NR=n=>{if(!n){gp(T_);return}IR(T_,JSON.stringify(n))},Ry=()=>{gp(mp),gp(T_)},h4=n=>{try{return JSON.parse(n)}catch{return null}},p4=(n,e,t)=>{const i=String((t==null?void 0:t.message)||(t==null?void 0:t.detail)||e||"Proxy request failed.").trim();return new Error(`${i} (HTTP ${n})`)},kR=async(n,e)=>{const t=CR(),i=await fetch(`${t}${n}`,e),r=await i.text(),o=h4(r);if(!i.ok)throw p4(i.status,r||i.statusText,o);return o||{}},m4=n=>({Authorization:`Bearer ${String(n||"").trim()}`}),MR=n=>{if(!n||typeof n!="object")throw new Error("Invalid proxy auth response.");const e=n.user;if(!e||typeof e!="object")throw new Error("Proxy auth response missing user profile.");if(!String(e.email||"").trim())throw new Error("Proxy auth response missing user email.")},Ny=async n=>{const e=String(n||pa()).trim();if(!e)throw new Error("Missing Bilge proxy token.");const t=await kR("/bilge-api/auth/me",{method:"GET",headers:m4(e)});return MR(t),RR(e),NR(t.user),t},g4=async(n,e)=>{const t=await kR("/bilge-api/auth/basic",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:String(n||"").trim(),password:String(e||"")})});return MR(t),RR(t.token),NR(t.user),t};var y4={};const DR=Oe.createContext(void 0),xr="bilge_user_session",Xw="bilge_firebase_anon_disabled",Zw="bilge_firebase_password_disabled",_4=({children:n})=>{const{settings:e}=Io(),[t,i]=Oe.useState(null),[r,o]=Oe.useState(!0),l=Oe.useRef(!1),c=Oe.useRef(e),d=()=>{const A="admin".trim(),N="kagan".trim();return{expectedUser:A,expectedPass:N}};Oe.useEffect(()=>{c.current=e},[e]);const f=()=>({id:`guest-${Date.now()}`,name:"Guest Developer",email:"guest@bilge.ai",avatar:"https://api.dicebear.com/7.x/notionists/svg?seed=Bilge",provider:"guest"}),m=A=>{const N=String((A==null?void 0:A.email)||"").trim(),U=String((A==null?void 0:A.name)||N||"Bilge User").trim(),$=String((A==null?void 0:A.provider)||"basic").toLowerCase()==="google"?"google":"basic",K=encodeURIComponent(N||U||"bilge-proxy");return{id:String((A==null?void 0:A.sub)||`proxy-${N||U||Date.now()}`).trim(),name:U,email:N,avatar:String((A==null?void 0:A.picture)||`https://api.dicebear.com/7.x/notionists/svg?seed=${K}`),provider:$}};Oe.useEffect(()=>{const A=er();e.requireAuth&&(t==null?void 0:t.provider)==="guest"?x():!e.requireAuth&&!t&&A.kind!=="studio"&&I()},[e.requireAuth]),Oe.useEffect(()=>{if(io&&Xi){const A=zP(Xi,async N=>{if(N){const U=!!N.isAnonymous,L=Array.isArray(N.providerData)?N.providerData.map(z=>z==null?void 0:z.providerId).filter(Boolean):[],$=L.includes("google.com"),K=L.includes("password"),j=U?"guest":$?"google":"basic",k=U?"Guest Developer":N.displayName||N.email||"User",V=U?"":N.email||"",D={id:N.uid,name:k,email:V,avatar:N.photoURL||`https://api.dicebear.com/7.x/notionists/svg?seed=${encodeURIComponent(N.uid)}`,provider:j};if(i(D),localStorage.setItem(xr,JSON.stringify(D)),Ww)try{await L5(rR(Ww,"users",N.uid),{uid:N.uid,name:k,email:V,photoURL:N.photoURL||void 0,isAnonymous:U,provider:j,lastLogin:Date.now(),metadata:{lastSeen:new Date().toISOString()}},{merge:!0}),ca.trackDatabaseOperation("write")}catch(z){console.error("Failed to sync profile:",z)}}else{const U=c.current,L=er(),$=L.kind==="studio"&&!!pa();if(L.kind==="studio"){const j=pa();if(j)try{const k=await Ny(j),V=m(k.user);i(V),localStorage.setItem(xr,JSON.stringify(V)),o(!1);return}catch(k){console.warn("Studio proxy session invalid; clearing token.",k),Ry()}}!U.requireAuth&&U.operationMode==="cloud"&&io&&Xi&&!l.current&&localStorage.getItem(Xw)!=="1"&&(l.current=!0,DP(Xi).catch(j=>{console.warn("Anon Auth failed",j);const k=String((j==null?void 0:j.code)||"");if(k==="auth/configuration-not-found"||k==="auth/operation-not-allowed")try{localStorage.setItem(Xw,"1")}catch{}}).finally(()=>{l.current=!1}));const K=localStorage.getItem(xr);if(K)try{const j=JSON.parse(K);(U.requireAuth||L.kind==="studio")&&(j.provider==="guest"||L.kind==="studio"&&!$)?i(null):i(j)}catch{i(null)}else!U.requireAuth&&L.kind!=="studio"&&I()}o(!1)});return()=>A()}else{const A=er(),N=A.kind==="studio"&&!!pa();if(A.kind==="studio"){const L=pa();if(L){Ny(L).then($=>{const K=m($.user);i(K),localStorage.setItem(xr,JSON.stringify(K))}).catch(()=>{Ry()}).finally(()=>o(!1));return}}const U=localStorage.getItem(xr);if(U)try{const L=JSON.parse(U);(e.requireAuth||A.kind==="studio")&&(L.provider==="guest"||A.kind==="studio"&&!N)?i(null):i(L)}catch{i(null)}else!e.requireAuth&&A.kind!=="studio"&&I();o(!1)}},[]);const v=async()=>{if(!io||!Xi||!Iy)throw new Error("Firebase is not configured for Google sign-in.");const A=er();if(A.kind==="extension"||A.kind==="studio")throw new Error("Google popup sign-in is disabled in this runtime due CSP restrictions. Use Basic login here, or sign in on the hosted web app.");if(String(y4.BILGE_GOOGLE_AUTH_MODE||"redirect").trim().toLowerCase()!=="popup"){await hO(Xi,Iy);return}await aO(Xi,Iy)},E=async(A,N)=>{const U=String(A||"").trim(),L=String(N||"");if(!U||!L)throw new Error("Username and password are required.");if(er().kind==="studio"){const D=await g4(U,L),z=m(D.user);i(z),localStorage.setItem(xr,JSON.stringify(z));return}const{expectedUser:K,expectedPass:j}=d();if(!j)throw new Error("Basic auth is not configured (missing BILGE_BASIC_AUTH_PASS or MCP_API_TOKEN).");if(U!==K||L!==j)throw new Error("Invalid credentials.");if(c.current.operationMode==="cloud"&&io&&Xi){const D="rustamtm@gmail.com".trim(),z=(()=>{try{return localStorage.getItem(Zw)==="1"}catch{return!1}})();if(!D)throw new Error("Cloud sync requires BILGE_BASIC_AUTH_EMAIL to be set to a Firebase Auth email.");if(z)throw new Error("Firebase email/password auth is currently disabled in this browser. Enable Email/Password in Firebase Auth, then clear localStorage key bilge_firebase_password_disabled and retry.");if(D)try{await LP(Xi,D,j);return}catch(G){const M=String((G==null?void 0:G.code)||"");if(M==="auth/configuration-not-found"||M==="auth/operation-not-allowed"){try{localStorage.setItem(Zw,"1")}catch{}console.warn("Firebase Email/Password provider is disabled; falling back to local basic session.",G)}else console.warn(M==="auth/invalid-credential"||M==="auth/wrong-password"||M==="auth/user-not-found"||M==="auth/invalid-email"?`Firebase email/password sign-in failed for ${D}; falling back to local basic session.`:`Firebase sign-in failed (${M||"unknown"}); falling back to local basic session.`,G)}}const V={id:`basic-${K}`,name:K,email:"",avatar:`https://api.dicebear.com/7.x/notionists/svg?seed=${encodeURIComponent(K)}`,provider:"basic"};i(V),localStorage.setItem(xr,JSON.stringify(V))},b=async A=>{if(er().kind!=="studio")throw new Error("Proxy token login is only available in AI Studio runtime.");const U=await Ny(A),L=m(U.user);i(L),localStorage.setItem(xr,JSON.stringify(L))},I=()=>{const A=f();i(A),localStorage.setItem(xr,JSON.stringify(A))},x=async()=>{io&&Xi&&await Xi.signOut(),Ry(),i(null),localStorage.removeItem(xr)};return S.jsx(DR.Provider,{value:{user:t,login:v,loginWithBasic:E,loginWithProxyToken:b,loginAsGuest:I,logout:x,isLoading:r},children:n})},Wv=()=>{const n=Oe.useContext(DR);if(!n)throw new Error("useAuth must be used within an AuthProvider");return n},v4=()=>{const{user:n,login:e,loginWithBasic:t,loginWithProxyToken:i,isLoading:r}=Wv(),{settings:o,runtimeEnvironment:l,runtimeCapabilities:c}=Io(),[d,f]=Oe.useState(""),[m,v]=Oe.useState(""),[E,b]=Oe.useState(null),[I,x]=Oe.useState(!1),[A,N]=Oe.useState(null),[U,L]=Oe.useState(""),[$,K]=Oe.useState(null),[j,k]=Oe.useState(!1),V=Oe.useMemo(()=>!!"kagan".trim(),[]);if(n||r)return null;const D=async()=>{var O;if(N(null),!c.canUseGooglePopupAuth){N("Google sign-in popup is not supported in this runtime due CSP. Use Basic login here, or sign in from the hosted web app.");return}if(!io){N("Firebase is not configured. Set NEXT_PUBLIC_FIREBASE_API_KEY, NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN, and NEXT_PUBLIC_FIREBASE_PROJECT_ID (plus the other NEXT_PUBLIC_FIREBASE_* values) in Bilge/bilge-webapp/.env.local.");return}try{await e()}catch(oe){const X=typeof window<"u"&&((O=window==null?void 0:window.location)!=null&&O.hostname)?String(window.location.hostname):"",Q=String((oe==null?void 0:oe.code)||"");N(Q==="auth/unauthorized-domain"?`Firebase Auth error: unauthorized domain.${X?` Add this domain in Firebase Console -> Authentication -> Settings -> Authorized domains: ${X}`:" Add your current domain in Firebase Console -> Authentication -> Settings -> Authorized domains."}`:Q==="auth/operation-not-allowed"?"Firebase Auth error: operation not allowed. Enable Google as a sign-in provider in Firebase Console -> Authentication -> Sign-in method.":Q==="auth/popup-blocked"?"Popup blocked. Allow popups for this site, then retry.":Q==="auth/popup-closed-by-user"?"Popup closed before completing sign-in.":(oe==null?void 0:oe.message)||"Login failed.")}},z=async O=>{O.preventDefault(),b(null),x(!0);try{await t(d,m)}catch(oe){b((oe==null?void 0:oe.message)||"Login failed.")}finally{x(!1)}},G=async O=>{O.preventDefault(),K(null),k(!0);try{await i(U)}catch(oe){K((oe==null?void 0:oe.message)||"Proxy token sign-in failed.")}finally{k(!1)}},M=!c.canUseGooglePopupAuth,B=c.canUseStudioTokenAuth||l==="studio";return S.jsx("div",{className:"fixed inset-0 z-[100] bg-white/30 backdrop-blur-xl flex items-center justify-center p-4 animate-fade-in",children:S.jsxs("div",{className:"bg-white border border-white/20 shadow-2xl rounded-2xl p-8 max-w-sm w-full relative overflow-hidden",children:[S.jsx("div",{className:"absolute -top-20 -left-20 w-40 h-40 bg-blue-500/10 rounded-full blur-3xl pointer-events-none"}),S.jsx("div",{className:"absolute -bottom-20 -right-20 w-40 h-40 bg-purple-500/10 rounded-full blur-3xl pointer-events-none"}),S.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[S.jsx("div",{className:"w-12 h-12 bg-surface rounded-xl flex items-center justify-center mb-6 shadow-sm border border-black/5",children:S.jsx(Nk,{className:"w-6 h-6 text-primary",strokeWidth:1.5})}),S.jsx("h1",{className:"text-2xl font-semibold text-primary mb-2 tracking-tight",children:"Welcome to Bilge"}),S.jsx("p",{className:"text-secondary text-sm mb-8 max-w-[280px]",children:"The intelligent workspace for agents, research, and infrastructure management."}),B&&S.jsxs("form",{onSubmit:G,className:"w-full space-y-3 mb-4",children:[S.jsx("div",{className:"grid grid-cols-1 gap-2",children:S.jsx("input",{value:U,onChange:O=>L(O.target.value),placeholder:"Bilge Studio token",autoComplete:"off",className:"w-full bg-white border border-border rounded-lg px-3 py-2.5 text-xs font-mono focus:outline-none focus:border-accent/50 transition-all"})}),$&&S.jsx("div",{className:"text-[11px] text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:$}),S.jsx("button",{type:"submit",disabled:j,className:"w-full flex items-center justify-center gap-2 bg-slate-900 text-white hover:bg-slate-800 transition-colors font-medium py-3 rounded-lg text-sm shadow-sm disabled:opacity-60",children:j?"Connecting":"Connect Studio Token"}),S.jsx("div",{className:"text-[10px] text-secondary/70 leading-relaxed text-left",children:"Recommended in AI Studio: generate a server session token first, then paste it here."})]}),o.requireAuth&&(V||B)&&S.jsxs("form",{onSubmit:z,className:"w-full space-y-3",children:[S.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[S.jsx("input",{value:d,onChange:O=>f(O.target.value),placeholder:"Username",autoComplete:"username",className:"w-full bg-white border border-border rounded-lg px-3 py-2.5 text-sm focus:outline-none focus:border-accent/50 transition-all"}),S.jsx("input",{value:m,onChange:O=>v(O.target.value),placeholder:"Password",type:"password",autoComplete:"current-password",className:"w-full bg-white border border-border rounded-lg px-3 py-2.5 text-sm focus:outline-none focus:border-accent/50 transition-all"})]}),E&&S.jsx("div",{className:"text-[11px] text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:E}),S.jsx("button",{type:"submit",disabled:I,className:"w-full flex items-center justify-center gap-2 bg-accent text-white hover:bg-accent/90 transition-colors font-medium py-3 rounded-lg text-sm shadow-sm disabled:opacity-60",children:I?"Signing in":"Sign in"}),S.jsx("div",{className:"text-[10px] text-secondary/60 leading-relaxed",children:B?"In Studio runtime this uses the secure proxy basic-auth exchange on the server.":"Basic login uses build-time credentials (`BILGE_BASIC_AUTH_USER` + `BILGE_BASIC_AUTH_PASS`). In Cloud mode it also attempts Firebase email/password sign-in (`BILGE_BASIC_AUTH_EMAIL`) for sync."})]}),S.jsxs("button",{onClick:D,disabled:M,className:"w-full flex items-center justify-center gap-3 bg-white border border-border hover:bg-gray-50 transition-colors text-primary font-medium py-3 rounded-lg text-sm shadow-sm mt-4 disabled:opacity-50 disabled:cursor-not-allowed",children:[S.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[S.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),S.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),S.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.84z",fill:"#FBBC05"}),S.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),M?"Google Sign-In Unavailable Here":"Sign in with Google"]}),A&&S.jsx("div",{className:"mt-3 w-full text-[11px] text-red-700 bg-red-50 border border-red-200 rounded-lg px-3 py-2 text-left",children:A}),S.jsx("div",{className:"mt-8 text-[10px] text-secondary/60 max-w-[260px] leading-relaxed",children:B?"Studio runtime: tokenized proxy auth enabled.":V&&o.requireAuth?"Basic auth enabled (Google optional).":"Protected by Google Identity Services."})]})]})})},E4=({onClick:n})=>{const[e,t]=Oe.useState(0);return Oe.useEffect(()=>ca.subscribe(r=>{t(r)}),[]),S.jsxs("button",{onClick:n,className:"flex items-center gap-1.5 px-3 py-1.5 bg-green-500/10 border border-green-500/20 rounded-full hover:bg-green-500/20 transition-colors cursor-pointer",title:"Open Cost Estimator",children:[S.jsx(Dk,{size:12,className:"text-green-600",strokeWidth:2.5}),S.jsx("span",{className:"text-xs font-mono font-medium text-green-700",children:e.toFixed(4)})]})},T4=({isOpen:n,onClose:e})=>{const{user:t,logout:i}=Wv(),{openSettings:r}=Io();if(!n||!t)return null;const o=()=>{e(),r()};return S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"fixed inset-0 z-40 bg-black/20 backdrop-blur-sm",onClick:e}),S.jsxs("div",{className:"absolute top-16 right-4 md:right-6 z-50 w-80 bg-white dark:bg-[#1C1C1E] rounded-2xl shadow-spotlight border border-border/50 animate-fade-in overflow-hidden",children:[S.jsxs("div",{className:"p-4 border-b border-border/40 flex items-start justify-between bg-surface/30",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[t.avatar?S.jsx("img",{src:t.avatar,alt:t.name,className:"w-10 h-10 rounded-full border border-black/5"}):S.jsx("div",{className:"w-10 h-10 rounded-full bg-accent/10 flex items-center justify-center text-accent",children:S.jsx(zA,{size:20})}),S.jsxs("div",{className:"flex flex-col",children:[S.jsx("span",{className:"text-sm font-semibold text-primary",children:t.name}),S.jsx("span",{className:"text-xs text-secondary truncate max-w-[140px]",children:t.email})]})]}),S.jsx("button",{onClick:e,className:"text-secondary hover:text-primary transition-colors",children:S.jsx(G_,{size:16})})]}),S.jsxs("div",{className:"p-4 space-y-4",children:[S.jsxs("div",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[10px] font-bold text-secondary uppercase tracking-wider",children:"Current Session"}),S.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface rounded-xl border border-black/5 dark:border-white/5",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"p-1.5 bg-green-500/10 rounded-md",children:S.jsx(kk,{size:14,className:"text-green-600"})}),S.jsx("span",{className:"text-xs font-medium text-primary",children:"Est. Cost"})]}),S.jsx(E4,{})]})]}),S.jsxs("div",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[10px] font-bold text-secondary uppercase tracking-wider",children:"Account"}),S.jsx("button",{onClick:o,className:"flex items-center justify-between p-2 hover:bg-surface rounded-lg group transition-colors",children:S.jsxs("div",{className:"flex items-center gap-2 text-primary text-sm",children:[S.jsx(BA,{size:14,className:"text-secondary group-hover:text-primary"}),S.jsx("span",{children:"Settings"})]})})]})]}),S.jsx("div",{className:"p-3 border-t border-border/40 bg-surface/30",children:S.jsxs("button",{onClick:()=>{i(),e()},className:"w-full flex items-center justify-center gap-2 text-xs font-medium text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 py-2 rounded-lg transition-colors",children:[S.jsx(jk,{size:14}),"Sign Out"]})})]})]})},b4=Object.prototype.toString,S4=n=>b4.call(n)==="[object Error]",w4=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function x4(n){if(!(n&&S4(n)&&n.name==="TypeError"&&typeof n.message=="string"))return!1;const{message:t,stack:i}=n;return t==="Load failed"?i===void 0||"__sentry_captured__"in n:t.startsWith("error sending request for url")?!0:w4.has(t)}function A4(n){if(typeof n=="number"){if(n<0)throw new TypeError("Expected `retries` to be a non-negative number.");if(Number.isNaN(n))throw new TypeError("Expected `retries` to be a valid number or Infinity, got NaN.")}else if(n!==void 0)throw new TypeError("Expected `retries` to be a number or Infinity.")}function gh(n,e,{min:t=0,allowInfinity:i=!1}={}){if(e!==void 0){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected \`${n}\` to be a number${i?" or Infinity":""}.`);if(!i&&!Number.isFinite(e))throw new TypeError(`Expected \`${n}\` to be a finite number.`);if(e<t)throw new TypeError(`Expected \`${n}\` to be  ${t}.`)}}class PR extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}function I4(n,e){const t=Math.max(1,n+1),i=e.randomize?Math.random()+1:1;let r=Math.round(i*e.minTimeout*e.factor**(t-1));return r=Math.min(r,e.maxTimeout),r}function ex(n,e){return Number.isFinite(e)?e-(performance.now()-n):e}async function C4({error:n,attemptNumber:e,retriesConsumed:t,startTime:i,options:r}){var b,I,x,A;const o=n instanceof Error?n:new TypeError(`Non-error was thrown: "${n}". You should only throw errors.`);if(o instanceof PR)throw o.originalError;const l=Number.isFinite(r.retries)?Math.max(0,r.retries-t):r.retries,c=r.maxRetryTime??Number.POSITIVE_INFINITY,d=Object.freeze({error:o,attemptNumber:e,retriesLeft:l,retriesConsumed:t});if(await r.onFailedAttempt(d),ex(i,c)<=0)throw o;const f=await r.shouldConsumeRetry(d),m=ex(i,c);if(m<=0||l<=0)throw o;if(o instanceof TypeError&&!x4(o)){if(f)throw o;return(b=r.signal)==null||b.throwIfAborted(),!1}if(!await r.shouldRetry(d))throw o;if(!f)return(I=r.signal)==null||I.throwIfAborted(),!1;const v=I4(t,r),E=Math.min(v,m);return(x=r.signal)==null||x.throwIfAborted(),E>0&&await new Promise((N,U)=>{var K,j;const L=()=>{var k;clearTimeout($),(k=r.signal)==null||k.removeEventListener("abort",L),U(r.signal.reason)},$=setTimeout(()=>{var k;(k=r.signal)==null||k.removeEventListener("abort",L),N()},E);r.unref&&((K=$.unref)==null||K.call($)),(j=r.signal)==null||j.addEventListener("abort",L,{once:!0})}),(A=r.signal)==null||A.throwIfAborted(),!0}async function R4(n,e={}){var o,l,c;if(e={...e},A4(e.retries),Object.hasOwn(e,"forever"))throw new Error("The `forever` option is no longer supported. For many use-cases, you can set `retries: Infinity` instead.");e.retries??(e.retries=10),e.factor??(e.factor=2),e.minTimeout??(e.minTimeout=1e3),e.maxTimeout??(e.maxTimeout=Number.POSITIVE_INFINITY),e.maxRetryTime??(e.maxRetryTime=Number.POSITIVE_INFINITY),e.randomize??(e.randomize=!1),e.onFailedAttempt??(e.onFailedAttempt=()=>{}),e.shouldRetry??(e.shouldRetry=()=>!0),e.shouldConsumeRetry??(e.shouldConsumeRetry=()=>!0),gh("factor",e.factor,{min:0,allowInfinity:!1}),gh("minTimeout",e.minTimeout,{min:0,allowInfinity:!1}),gh("maxTimeout",e.maxTimeout,{min:0,allowInfinity:!0}),gh("maxRetryTime",e.maxRetryTime,{min:0,allowInfinity:!0}),e.factor>0||(e.factor=1),(o=e.signal)==null||o.throwIfAborted();let t=0,i=0;const r=performance.now();for(;!Number.isFinite(e.retries)||i<=e.retries;){t++;try{(l=e.signal)==null||l.throwIfAborted();const d=await n(t);return(c=e.signal)==null||c.throwIfAborted(),d}catch(d){await C4({error:d,attemptNumber:t,retriesConsumed:i,startTime:r,options:e})&&i++}}throw new Error("Retry attempts exhausted without throwing an error.")}var N4={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let k4,M4;function D4(){return{geminiUrl:k4,vertexUrl:M4}}function P4(n,e,t,i){var r,o;if(!(n!=null&&n.baseUrl)){const l=D4();return e?(r=l.vertexUrl)!==null&&r!==void 0?r:t:(o=l.geminiUrl)!==null&&o!==void 0?o:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ms{}function qe(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const o=e[r];return o!=null?String(o):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function g(n,e,t){for(let o=0;o<e.length-1;o++){const l=e[o];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in n))if(Array.isArray(t))n[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(n[c])){const d=n[c];if(Array.isArray(t))for(let f=0;f<d.length;f++){const m=d[f];g(m,e.slice(o+1),t[f])}else for(const f of d)g(f,e.slice(o+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in n||(n[c]=[{}]);const d=n[c];g(d[0],e.slice(o+1),t);return}(!n[l]||typeof n[l]!="object")&&(n[l]={}),n=n[l]}const i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function p(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const r=e[i];if(r.endsWith("[]")){const o=r.slice(0,-2);if(o in n){const l=n[o];return Array.isArray(l)?l.map(c=>p(c,e.slice(i+1),t)):t}else return t}else n=n[r]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function O4(n,e){for(const[t,i]of Object.entries(e)){const r=t.split("."),o=i.split("."),l=new Set;let c=-1;for(let d=0;d<r.length;d++)if(r[d]==="*"){c=d;break}if(c!==-1&&o.length>c)for(let d=c;d<o.length;d++){const f=o[d];f!=="*"&&!f.endsWith("[]")&&!f.endsWith("[0]")&&l.add(f)}S_(n,r,o,0,l)}}function S_(n,e,t,i,r){if(i>=e.length||typeof n!="object"||n===null)return;const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2),c=n;if(l in c&&Array.isArray(c[l]))for(const d of c[l])S_(d,e,t,i+1,r)}else if(o==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const l=n,c=Object.keys(l).filter(f=>!f.startsWith("_")&&!r.has(f)),d={};for(const f of c)d[f]=l[f];for(const[f,m]of Object.entries(d)){const v=[];for(const E of t.slice(i))E==="*"?v.push(f):v.push(E);g(l,v,m)}for(const f of c)delete l[f]}}else{const l=n;o in l&&S_(l[o],e,t,i+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qv(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function V4(n){const e={},t=p(n,["operationName"]);t!=null&&g(e,["operationName"],t);const i=p(n,["resourceName"]);return i!=null&&g(e,["_url","resourceName"],i),e}function U4(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=p(n,["done"]);r!=null&&g(e,["done"],r);const o=p(n,["error"]);o!=null&&g(e,["error"],o);const l=p(n,["response","generateVideoResponse"]);return l!=null&&g(e,["response"],B4(l)),e}function L4(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=p(n,["done"]);r!=null&&g(e,["done"],r);const o=p(n,["error"]);o!=null&&g(e,["error"],o);const l=p(n,["response"]);return l!=null&&g(e,["response"],F4(l)),e}function B4(n){const e={},t=p(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>z4(l))),g(e,["generatedVideos"],o)}const i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);const r=p(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function F4(n){const e={},t=p(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>G4(l))),g(e,["generatedVideos"],o)}const i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);const r=p(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function z4(n){const e={},t=p(n,["video"]);return t!=null&&g(e,["video"],J4(t)),e}function G4(n){const e={},t=p(n,["_self"]);return t!=null&&g(e,["video"],Y4(t)),e}function q4(n){const e={},t=p(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function H4(n){const e={},t=p(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function $4(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=p(n,["done"]);r!=null&&g(e,["done"],r);const o=p(n,["error"]);o!=null&&g(e,["error"],o);const l=p(n,["response"]);return l!=null&&g(e,["response"],j4(l)),e}function j4(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["parent"]);i!=null&&g(e,["parent"],i);const r=p(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function OR(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=p(n,["done"]);r!=null&&g(e,["done"],r);const o=p(n,["error"]);o!=null&&g(e,["error"],o);const l=p(n,["response"]);return l!=null&&g(e,["response"],K4(l)),e}function K4(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["parent"]);i!=null&&g(e,["parent"],i);const r=p(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function J4(n){const e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);const i=p(n,["encodedVideo"]);i!=null&&g(e,["videoBytes"],Qv(i));const r=p(n,["encoding"]);return r!=null&&g(e,["mimeType"],r),e}function Y4(n){const e={},t=p(n,["gcsUri"]);t!=null&&g(e,["uri"],t);const i=p(n,["bytesBase64Encoded"]);i!=null&&g(e,["videoBytes"],Qv(i));const r=p(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var tx;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(tx||(tx={}));var nx;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(nx||(nx={}));var ix;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(ix||(ix={}));var Ct;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Ct||(Ct={}));var rx;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(rx||(rx={}));var sx;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(sx||(sx={}));var ox;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(ox||(ox={}));var ax;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(ax||(ax={}));var lx;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(lx||(lx={}));var ux;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(ux||(ux={}));var cx;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(cx||(cx={}));var dx;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(dx||(dx={}));var fx;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(fx||(fx={}));var hx;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(hx||(hx={}));var px;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(px||(px={}));var mx;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(mx||(mx={}));var gx;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(gx||(gx={}));var yx;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(yx||(yx={}));var _x;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(_x||(_x={}));var vx;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(vx||(vx={}));var Ex;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Ex||(Ex={}));var yp;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(yp||(yp={}));var Tx;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Tx||(Tx={}));var bx;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(bx||(bx={}));var Sx;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Sx||(Sx={}));var w_;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(w_||(w_={}));var wx;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(wx||(wx={}));var xx;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(xx||(xx={}));var x_;(function(n){n.COLLECTION="COLLECTION"})(x_||(x_={}));var Ax;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(Ax||(Ax={}));var Ix;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Ix||(Ix={}));var Cx;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Cx||(Cx={}));var Rx;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(Rx||(Rx={}));var Nx;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(Nx||(Nx={}));var kx;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(kx||(kx={}));var Mx;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Mx||(Mx={}));var Dx;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Dx||(Dx={}));var Px;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Px||(Px={}));var Ox;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(Ox||(Ox={}));var Vx;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(Vx||(Vx={}));var Ux;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(Ux||(Ux={}));var Lx;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(Lx||(Lx={}));var Bx;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING",n.DISTILLATION="DISTILLATION"})(Bx||(Bx={}));var Fx;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(Fx||(Fx={}));var zx;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(zx||(zx={}));var Gx;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED",n.REGISTERED="REGISTERED"})(Gx||(Gx={}));var qx;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(qx||(qx={}));var Hx;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(Hx||(Hx={}));var $x;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})($x||($x={}));var jx;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.ACTIVITY_START="ACTIVITY_START",n.ACTIVITY_END="ACTIVITY_END"})(jx||(jx={}));var Kx;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Kx||(Kx={}));var Jx;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Jx||(Jx={}));var Yx;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(Yx||(Yx={}));var Wx;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Wx||(Wx={}));var Qx;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Qx||(Qx={}));var Xx;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(Xx||(Xx={}));var Ll;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Ll||(Ll={}));class A_{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Mc{get text(){var e,t,i,r,o,l,c,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",m=!1;const v=[];for(const E of(d=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[b,I]of Object.entries(E))b!=="text"&&b!=="thought"&&b!=="thoughtSignature"&&(I!==null||I!==void 0)&&v.push(b);if(typeof E.text=="string"){if(typeof E.thought=="boolean"&&E.thought)continue;m=!0,f+=E.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),m?f:void 0}get data(){var e,t,i,r,o,l,c,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const m=[];for(const v of(d=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[E,b]of Object.entries(v))E!=="inlineData"&&(b!==null||b!==void 0)&&m.push(E);v.inlineData&&typeof v.inlineData.data=="string"&&(f+=atob(v.inlineData.data))}return m.length>0&&console.warn(`there are non-data parts ${m} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,t,i,r,o,l,c,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(d=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(m=>m.functionCall).map(m=>m.functionCall).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var e,t,i,r,o,l,c,d,f;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const m=(d=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(f=m==null?void 0:m[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,t,i,r,o,l,c,d,f;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const m=(d=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(f=m==null?void 0:m[0])===null||f===void 0?void 0:f.output}}class Zx{}class eA{}class W4{}class Q4{}class X4{}class Z4{}class tA{}class nA{}class iA{}class e3{}class _p{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new _p;let r;const o=e;return t?r=L4(o):r=U4(o),Object.assign(i,r),i}}class rA{}class sA{}class oA{}class aA{}class t3{}class n3{}class i3{}class Xv{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Xv,o=$4(e);return Object.assign(i,o),i}}class r3{}class s3{}class o3{}class a3{}class lA{}class l3{get text(){var e,t,i;let r="",o=!1;const l=[];for(const c of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[d,f]of Object.entries(c))d!=="text"&&d!=="thought"&&f!==null&&l.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;o=!0,r+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?r:void 0}get data(){var e,t,i;let r="";const o=[];for(const l of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[c,d]of Object.entries(l))c!=="inlineData"&&d!==null&&o.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(r+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class u3{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Zv{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Zv,o=OR(e);return Object.assign(i,o),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Dt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function VR(n,e){const t=Dt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function UR(n){return Array.isArray(n)?n.map(e=>vp(e)):[vp(n)]}function vp(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function LR(n){const e=vp(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function BR(n){const e=vp(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function uA(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function FR(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>uA(e)):[uA(n)]}function I_(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function cA(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function dA(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function jn(n){if(n==null)throw new Error("ContentUnion is required");return I_(n)?n:{role:"user",parts:FR(n)}}function e0(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=jn(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=jn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>jn(t)):[jn(e)]}function Li(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(cA(n)||dA(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[jn(n)]}const e=[],t=[],i=I_(n[0]);for(const r of n){const o=I_(r);if(o!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(r);else{if(cA(r)||dA(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:FR(t)}),e}function c3(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(Ct).includes(t[0].toUpperCase())?t[0].toUpperCase():Ct.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(Ct).includes(i.toUpperCase())?i.toUpperCase():Ct.TYPE_UNSPECIFIED})}}function $l(n){const e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=n.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,n=o[1]):o[1].type==="null"&&(e.nullable=!0,n=o[0])),n.type instanceof Array&&c3(n.type,e);for(const[l,c]of Object.entries(n))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(Ct).includes(c.toUpperCase())?c.toUpperCase():Ct.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=$l(c);else if(i.includes(l)){const d=[];for(const f of c){if(f.type=="null"){e.nullable=!0;continue}d.push($l(f))}e[l]=d}else if(r.includes(l)){const d={};for(const[f,m]of Object.entries(c))d[f]=$l(m);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=c}return e}function t0(n){return $l(n)}function n0(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function i0(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function bu(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=$l(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=$l(e.response));return n}function Su(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function d3(n,e,t,i=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function gs(n,e){if(typeof e!="string")throw new Error("name must be a string");return d3(n,e,"cachedContents")}function zR(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Co(n){return Qv(n)}function f3(n){return n!=null&&typeof n=="object"&&"name"in n}function h3(n){return n!=null&&typeof n=="object"&&"video"in n}function p3(n){return n!=null&&typeof n=="object"&&"uri"in n}function GR(n){var e;let t;if(f3(n)&&(t=n.name),!(p3(n)&&(t=n.uri,t===void 0))&&!(h3(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function qR(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function HR(n){for(const e of["models","tunedModels","publisherModels"])if(m3(n,e))return n[e];return[]}function m3(n,e){return n!==null&&typeof n=="object"&&e in n}function g3(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function y3(n,e={}){const t=[],i=new Set;for(const r of n){const o=r.name;if(i.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);i.add(o);const l=g3(r,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function $R(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function _3(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function jR(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let o=!1;for(const l of r){if(typeof l!="object"||l===null)continue;const d=l.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function wu(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function KR(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function v3(n){const e={},t=p(n,["responsesFile"]);t!=null&&g(e,["fileName"],t);const i=p(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>Z3(l))),g(e,["inlinedResponses"],o)}const r=p(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["inlinedEmbedContentResponses"],o)}return e}function E3(n){const e={},t=p(n,["predictionsFormat"]);t!=null&&g(e,["format"],t);const i=p(n,["gcsDestination","outputUriPrefix"]);i!=null&&g(e,["gcsUri"],i);const r=p(n,["bigqueryDestination","outputUri"]);return r!=null&&g(e,["bigqueryUri"],r),e}function T3(n){const e={},t=p(n,["format"]);t!=null&&g(e,["predictionsFormat"],t);const i=p(n,["gcsUri"]);i!=null&&g(e,["gcsDestination","outputUriPrefix"],i);const r=p(n,["bigqueryUri"]);if(r!=null&&g(e,["bigqueryDestination","outputUri"],r),p(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(p(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function zh(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata","displayName"]);i!=null&&g(e,["displayName"],i);const r=p(n,["metadata","state"]);r!=null&&g(e,["state"],KR(r));const o=p(n,["metadata","createTime"]);o!=null&&g(e,["createTime"],o);const l=p(n,["metadata","endTime"]);l!=null&&g(e,["endTime"],l);const c=p(n,["metadata","updateTime"]);c!=null&&g(e,["updateTime"],c);const d=p(n,["metadata","model"]);d!=null&&g(e,["model"],d);const f=p(n,["metadata","output"]);return f!=null&&g(e,["dest"],v3(jR(f))),e}function C_(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["displayName"]);i!=null&&g(e,["displayName"],i);const r=p(n,["state"]);r!=null&&g(e,["state"],KR(r));const o=p(n,["error"]);o!=null&&g(e,["error"],o);const l=p(n,["createTime"]);l!=null&&g(e,["createTime"],l);const c=p(n,["startTime"]);c!=null&&g(e,["startTime"],c);const d=p(n,["endTime"]);d!=null&&g(e,["endTime"],d);const f=p(n,["updateTime"]);f!=null&&g(e,["updateTime"],f);const m=p(n,["model"]);m!=null&&g(e,["model"],m);const v=p(n,["inputConfig"]);v!=null&&g(e,["src"],b3(v));const E=p(n,["outputConfig"]);E!=null&&g(e,["dest"],E3(jR(E)));const b=p(n,["completionStats"]);return b!=null&&g(e,["completionStats"],b),e}function b3(n){const e={},t=p(n,["instancesFormat"]);t!=null&&g(e,["format"],t);const i=p(n,["gcsSource","uris"]);i!=null&&g(e,["gcsUri"],i);const r=p(n,["bigquerySource","inputUri"]);return r!=null&&g(e,["bigqueryUri"],r),e}function S3(n,e){const t={};if(p(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=p(e,["fileName"]);i!=null&&g(t,["fileName"],i);const r=p(e,["inlinedRequests"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>X3(n,l))),g(t,["requests","requests"],o)}return t}function w3(n){const e={},t=p(n,["format"]);t!=null&&g(e,["instancesFormat"],t);const i=p(n,["gcsUri"]);i!=null&&g(e,["gcsSource","uris"],i);const r=p(n,["bigqueryUri"]);if(r!=null&&g(e,["bigquerySource","inputUri"],r),p(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function x3(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function A3(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],wu(n,i)),t}function I3(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],wu(n,i)),t}function C3(n){const e={},t=p(n,["content"]);t!=null&&g(e,["content"],t);const i=p(n,["citationMetadata"]);i!=null&&g(e,["citationMetadata"],R3(i));const r=p(n,["tokenCount"]);r!=null&&g(e,["tokenCount"],r);const o=p(n,["finishReason"]);o!=null&&g(e,["finishReason"],o);const l=p(n,["avgLogprobs"]);l!=null&&g(e,["avgLogprobs"],l);const c=p(n,["groundingMetadata"]);c!=null&&g(e,["groundingMetadata"],c);const d=p(n,["index"]);d!=null&&g(e,["index"],d);const f=p(n,["logprobsResult"]);f!=null&&g(e,["logprobsResult"],f);const m=p(n,["safetyRatings"]);if(m!=null){let E=m;Array.isArray(E)&&(E=E.map(b=>b)),g(e,["safetyRatings"],E)}const v=p(n,["urlContextMetadata"]);return v!=null&&g(e,["urlContextMetadata"],v),e}function R3(n){const e={},t=p(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),g(e,["citations"],i)}return e}function JR(n){const e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>o6(o))),g(e,["parts"],r)}const i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function N3(n,e){const t={},i=p(n,["displayName"]);if(e!==void 0&&i!=null&&g(e,["batch","displayName"],i),p(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function k3(n,e){const t={},i=p(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);const r=p(n,["dest"]);return e!==void 0&&r!=null&&g(e,["outputConfig"],T3(_3(r))),t}function fA(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Dt(n,i));const r=p(e,["src"]);r!=null&&g(t,["batch","inputConfig"],S3(n,$R(n,r)));const o=p(e,["config"]);return o!=null&&N3(o,t),t}function M3(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["model"],Dt(n,i));const r=p(e,["src"]);r!=null&&g(t,["inputConfig"],w3($R(n,r)));const o=p(e,["config"]);return o!=null&&k3(o,t),t}function D3(n,e){const t={},i=p(n,["displayName"]);return e!==void 0&&i!=null&&g(e,["batch","displayName"],i),t}function P3(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Dt(n,i));const r=p(e,["src"]);r!=null&&g(t,["batch","inputConfig"],z3(n,r));const o=p(e,["config"]);return o!=null&&D3(o,t),t}function O3(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],wu(n,i)),t}function V3(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],wu(n,i)),t}function U3(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["name"]);i!=null&&g(e,["name"],i);const r=p(n,["done"]);r!=null&&g(e,["done"],r);const o=p(n,["error"]);return o!=null&&g(e,["error"],o),e}function L3(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["name"]);i!=null&&g(e,["name"],i);const r=p(n,["done"]);r!=null&&g(e,["done"],r);const o=p(n,["error"]);return o!=null&&g(e,["error"],o),e}function B3(n,e){const t={},i=p(e,["contents"]);if(i!=null){let o=e0(n,i);Array.isArray(o)&&(o=o.map(l=>l)),g(t,["requests[]","request","content"],o)}const r=p(e,["config"]);return r!=null&&(g(t,["_self"],F3(r,t)),O4(t,{"requests[].*":"requests[].request.*"})),t}function F3(n,e){const t={},i=p(n,["taskType"]);e!==void 0&&i!=null&&g(e,["requests[]","taskType"],i);const r=p(n,["title"]);e!==void 0&&r!=null&&g(e,["requests[]","title"],r);const o=p(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&g(e,["requests[]","outputDimensionality"],o),p(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function z3(n,e){const t={},i=p(e,["fileName"]);i!=null&&g(t,["file_name"],i);const r=p(e,["inlinedRequests"]);return r!=null&&g(t,["requests"],B3(n,r)),t}function G3(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function q3(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const i=p(n,["args"]);i!=null&&g(e,["args"],i);const r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function H3(n){const e={},t=p(n,["allowedFunctionNames"]);t!=null&&g(e,["allowedFunctionNames"],t);const i=p(n,["mode"]);if(i!=null&&g(e,["mode"],i),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function $3(n,e,t){const i={},r=p(e,["systemInstruction"]);t!==void 0&&r!=null&&g(t,["systemInstruction"],JR(jn(r)));const o=p(e,["temperature"]);o!=null&&g(i,["temperature"],o);const l=p(e,["topP"]);l!=null&&g(i,["topP"],l);const c=p(e,["topK"]);c!=null&&g(i,["topK"],c);const d=p(e,["candidateCount"]);d!=null&&g(i,["candidateCount"],d);const f=p(e,["maxOutputTokens"]);f!=null&&g(i,["maxOutputTokens"],f);const m=p(e,["stopSequences"]);m!=null&&g(i,["stopSequences"],m);const v=p(e,["responseLogprobs"]);v!=null&&g(i,["responseLogprobs"],v);const E=p(e,["logprobs"]);E!=null&&g(i,["logprobs"],E);const b=p(e,["presencePenalty"]);b!=null&&g(i,["presencePenalty"],b);const I=p(e,["frequencyPenalty"]);I!=null&&g(i,["frequencyPenalty"],I);const x=p(e,["seed"]);x!=null&&g(i,["seed"],x);const A=p(e,["responseMimeType"]);A!=null&&g(i,["responseMimeType"],A);const N=p(e,["responseSchema"]);N!=null&&g(i,["responseSchema"],t0(N));const U=p(e,["responseJsonSchema"]);if(U!=null&&g(i,["responseJsonSchema"],U),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const L=p(e,["safetySettings"]);if(t!==void 0&&L!=null){let B=L;Array.isArray(B)&&(B=B.map(O=>a6(O))),g(t,["safetySettings"],B)}const $=p(e,["tools"]);if(t!==void 0&&$!=null){let B=Su($);Array.isArray(B)&&(B=B.map(O=>u6(bu(O)))),g(t,["tools"],B)}const K=p(e,["toolConfig"]);if(t!==void 0&&K!=null&&g(t,["toolConfig"],l6(K)),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const j=p(e,["cachedContent"]);t!==void 0&&j!=null&&g(t,["cachedContent"],gs(n,j));const k=p(e,["responseModalities"]);k!=null&&g(i,["responseModalities"],k);const V=p(e,["mediaResolution"]);V!=null&&g(i,["mediaResolution"],V);const D=p(e,["speechConfig"]);if(D!=null&&g(i,["speechConfig"],n0(D)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const z=p(e,["thinkingConfig"]);z!=null&&g(i,["thinkingConfig"],z);const G=p(e,["imageConfig"]);G!=null&&g(i,["imageConfig"],Q3(G));const M=p(e,["enableEnhancedCivicAnswers"]);if(M!=null&&g(i,["enableEnhancedCivicAnswers"],M),p(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function j3(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["candidates"]);if(i!=null){let d=i;Array.isArray(d)&&(d=d.map(f=>C3(f))),g(e,["candidates"],d)}const r=p(n,["modelVersion"]);r!=null&&g(e,["modelVersion"],r);const o=p(n,["promptFeedback"]);o!=null&&g(e,["promptFeedback"],o);const l=p(n,["responseId"]);l!=null&&g(e,["responseId"],l);const c=p(n,["usageMetadata"]);return c!=null&&g(e,["usageMetadata"],c),e}function K3(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],wu(n,i)),t}function J3(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],wu(n,i)),t}function Y3(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function W3(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function Q3(n){const e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);const i=p(n,["imageSize"]);if(i!=null&&g(e,["imageSize"],i),p(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(p(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function X3(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["request","model"],Dt(n,i));const r=p(e,["contents"]);if(r!=null){let c=Li(r);Array.isArray(c)&&(c=c.map(d=>JR(d))),g(t,["request","contents"],c)}const o=p(e,["metadata"]);o!=null&&g(t,["metadata"],o);const l=p(e,["config"]);return l!=null&&g(t,["request","generationConfig"],$3(n,l,p(t,["request"],{}))),t}function Z3(n){const e={},t=p(n,["response"]);t!=null&&g(e,["response"],j3(t));const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=p(n,["error"]);return r!=null&&g(e,["error"],r),e}function e6(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=p(n,["pageToken"]);if(e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),p(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function t6(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=p(n,["pageToken"]);e!==void 0&&r!=null&&g(e,["_query","pageToken"],r);const o=p(n,["filter"]);return e!==void 0&&o!=null&&g(e,["_query","filter"],o),t}function n6(n){const e={},t=p(n,["config"]);return t!=null&&e6(t,e),e}function i6(n){const e={},t=p(n,["config"]);return t!=null&&t6(t,e),e}function r6(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=p(n,["operations"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>zh(l))),g(e,["batchJobs"],o)}return e}function s6(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=p(n,["batchPredictionJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>C_(l))),g(e,["batchJobs"],o)}return e}function o6(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);const o=p(n,["fileData"]);o!=null&&g(e,["fileData"],G3(o));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],q3(l));const c=p(n,["functionResponse"]);c!=null&&g(e,["functionResponse"],c);const d=p(n,["inlineData"]);d!=null&&g(e,["inlineData"],x3(d));const f=p(n,["text"]);f!=null&&g(e,["text"],f);const m=p(n,["thought"]);m!=null&&g(e,["thought"],m);const v=p(n,["thoughtSignature"]);v!=null&&g(e,["thoughtSignature"],v);const E=p(n,["videoMetadata"]);return E!=null&&g(e,["videoMetadata"],E),e}function a6(n){const e={},t=p(n,["category"]);if(t!=null&&g(e,["category"],t),p(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=p(n,["threshold"]);return i!=null&&g(e,["threshold"],i),e}function l6(n){const e={},t=p(n,["retrievalConfig"]);t!=null&&g(e,["retrievalConfig"],t);const i=p(n,["functionCallingConfig"]);return i!=null&&g(e,["functionCallingConfig"],H3(i)),e}function u6(n){const e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);const i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(n,["functionDeclarations"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(v=>v)),g(e,["functionDeclarations"],m)}const l=p(n,["googleMaps"]);l!=null&&g(e,["googleMaps"],Y3(l));const c=p(n,["googleSearch"]);c!=null&&g(e,["googleSearch"],W3(c));const d=p(n,["googleSearchRetrieval"]);d!=null&&g(e,["googleSearchRetrieval"],d);const f=p(n,["urlContext"]);return f!=null&&g(e,["urlContext"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var cs;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(cs||(cs={}));class Oa{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!i||Object.keys(i).length===0?l={config:{}}:typeof i=="object"?l=Object.assign({},i):l=i,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(r=l.config)===null||r===void 0?void 0:r.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class c6 extends ms{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Oa(cs.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=fA(this.apiClient,e),i=t._url,r=qe("{model}:batchGenerateContent",i),c=t.batch.inputConfig.requests,d=c.requests,f=[];for(const m of d){const v=Object.assign({},m);if(v.systemInstruction){const E=v.systemInstruction;delete v.systemInstruction;const b=v.request;b.systemInstruction=E,v.request=b}f.push(v)}return c.requests=f,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){const o=this.getGcsUri(e),l=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?i.dest=`${o.slice(0,-6)}/dest`:i.dest=`${o}_dest_${r}`;else if(l)i.dest=`${l}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=M3(this.apiClient,e);return c=qe("batchPredictionJobs",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),l.then(m=>C_(m))}else{const f=fA(this.apiClient,e);return c=qe("{model}:batchGenerateContent",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>zh(m))}}async createEmbeddingsInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=P3(this.apiClient,e);return o=qe("{model}:asyncBatchEmbedContent",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>zh(d))}}async get(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=J3(this.apiClient,e);return c=qe("batchPredictionJobs/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),l.then(m=>C_(m))}else{const f=K3(this.apiClient,e);return c=qe("batches/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>zh(m))}}async cancel(e){var t,i,r,o;let l="",c={};if(this.apiClient.isVertexAI()){const d=I3(this.apiClient,e);l=qe("batchPredictionJobs/{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const d=A3(this.apiClient,e);l=qe("batches/{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=i6(e);return c=qe("batchPredictionJobs",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=s6(m),E=new lA;return Object.assign(E,v),E})}else{const f=n6(e);return c=qe("batches",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=r6(m),E=new lA;return Object.assign(E,v),E})}}async delete(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=V3(this.apiClient,e);return c=qe("batchPredictionJobs/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>L3(m))}else{const f=O3(this.apiClient,e);return c=qe("batches/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>U3(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function d6(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function hA(n){const e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>P6(o))),g(e,["parts"],r)}const i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function f6(n,e){const t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const r=p(n,["expireTime"]);e!==void 0&&r!=null&&g(e,["expireTime"],r);const o=p(n,["displayName"]);e!==void 0&&o!=null&&g(e,["displayName"],o);const l=p(n,["contents"]);if(e!==void 0&&l!=null){let m=Li(l);Array.isArray(m)&&(m=m.map(v=>hA(v))),g(e,["contents"],m)}const c=p(n,["systemInstruction"]);e!==void 0&&c!=null&&g(e,["systemInstruction"],hA(jn(c)));const d=p(n,["tools"]);if(e!==void 0&&d!=null){let m=d;Array.isArray(m)&&(m=m.map(v=>V6(v))),g(e,["tools"],m)}const f=p(n,["toolConfig"]);if(e!==void 0&&f!=null&&g(e,["toolConfig"],O6(f)),p(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function h6(n,e){const t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const r=p(n,["expireTime"]);e!==void 0&&r!=null&&g(e,["expireTime"],r);const o=p(n,["displayName"]);e!==void 0&&o!=null&&g(e,["displayName"],o);const l=p(n,["contents"]);if(e!==void 0&&l!=null){let v=Li(l);Array.isArray(v)&&(v=v.map(E=>E)),g(e,["contents"],v)}const c=p(n,["systemInstruction"]);e!==void 0&&c!=null&&g(e,["systemInstruction"],jn(c));const d=p(n,["tools"]);if(e!==void 0&&d!=null){let v=d;Array.isArray(v)&&(v=v.map(E=>U6(E))),g(e,["tools"],v)}const f=p(n,["toolConfig"]);e!==void 0&&f!=null&&g(e,["toolConfig"],f);const m=p(n,["kmsKeyName"]);return e!==void 0&&m!=null&&g(e,["encryption_spec","kmsKeyName"],m),t}function p6(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["model"],VR(n,i));const r=p(e,["config"]);return r!=null&&f6(r,t),t}function m6(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["model"],VR(n,i));const r=p(e,["config"]);return r!=null&&h6(r,t),t}function g6(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],gs(n,i)),t}function y6(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],gs(n,i)),t}function _6(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function v6(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function E6(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function T6(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const i=p(n,["args"]);i!=null&&g(e,["args"],i);const r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function b6(n){const e={},t=p(n,["allowedFunctionNames"]);t!=null&&g(e,["allowedFunctionNames"],t);const i=p(n,["mode"]);if(i!=null&&g(e,["mode"],i),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function S6(n){const e={},t=p(n,["description"]);t!=null&&g(e,["description"],t);const i=p(n,["name"]);i!=null&&g(e,["name"],i);const r=p(n,["parameters"]);r!=null&&g(e,["parameters"],r);const o=p(n,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);const l=p(n,["response"]);l!=null&&g(e,["response"],l);const c=p(n,["responseJsonSchema"]);if(c!=null&&g(e,["responseJsonSchema"],c),p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function w6(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],gs(n,i)),t}function x6(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],gs(n,i)),t}function A6(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function I6(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function C6(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function R6(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function N6(n){const e={},t=p(n,["config"]);return t!=null&&C6(t,e),e}function k6(n){const e={},t=p(n,["config"]);return t!=null&&R6(t,e),e}function M6(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=p(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["cachedContents"],o)}return e}function D6(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=p(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["cachedContents"],o)}return e}function P6(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);const o=p(n,["fileData"]);o!=null&&g(e,["fileData"],E6(o));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],T6(l));const c=p(n,["functionResponse"]);c!=null&&g(e,["functionResponse"],c);const d=p(n,["inlineData"]);d!=null&&g(e,["inlineData"],d6(d));const f=p(n,["text"]);f!=null&&g(e,["text"],f);const m=p(n,["thought"]);m!=null&&g(e,["thought"],m);const v=p(n,["thoughtSignature"]);v!=null&&g(e,["thoughtSignature"],v);const E=p(n,["videoMetadata"]);return E!=null&&g(e,["videoMetadata"],E),e}function O6(n){const e={},t=p(n,["retrievalConfig"]);t!=null&&g(e,["retrievalConfig"],t);const i=p(n,["functionCallingConfig"]);return i!=null&&g(e,["functionCallingConfig"],b6(i)),e}function V6(n){const e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);const i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(n,["functionDeclarations"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(v=>v)),g(e,["functionDeclarations"],m)}const l=p(n,["googleMaps"]);l!=null&&g(e,["googleMaps"],A6(l));const c=p(n,["googleSearch"]);c!=null&&g(e,["googleSearch"],I6(c));const d=p(n,["googleSearchRetrieval"]);d!=null&&g(e,["googleSearchRetrieval"],d);const f=p(n,["urlContext"]);return f!=null&&g(e,["urlContext"],f),e}function U6(n){const e={},t=p(n,["retrieval"]);t!=null&&g(e,["retrieval"],t);const i=p(n,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=p(n,["codeExecution"]);r!=null&&g(e,["codeExecution"],r);const o=p(n,["enterpriseWebSearch"]);o!=null&&g(e,["enterpriseWebSearch"],o);const l=p(n,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(E=>S6(E))),g(e,["functionDeclarations"],v)}const c=p(n,["googleMaps"]);c!=null&&g(e,["googleMaps"],c);const d=p(n,["googleSearch"]);d!=null&&g(e,["googleSearch"],d);const f=p(n,["googleSearchRetrieval"]);f!=null&&g(e,["googleSearchRetrieval"],f);const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function L6(n,e){const t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const r=p(n,["expireTime"]);return e!==void 0&&r!=null&&g(e,["expireTime"],r),t}function B6(n,e){const t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const r=p(n,["expireTime"]);return e!==void 0&&r!=null&&g(e,["expireTime"],r),t}function F6(n,e){const t={},i=p(e,["name"]);i!=null&&g(t,["_url","name"],gs(n,i));const r=p(e,["config"]);return r!=null&&L6(r,t),t}function z6(n,e){const t={},i=p(e,["name"]);i!=null&&g(t,["_url","name"],gs(n,i));const r=p(e,["config"]);return r!=null&&B6(r,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class G6 extends ms{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Oa(cs.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=m6(this.apiClient,e);return c=qe("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),l.then(m=>m)}else{const f=p6(this.apiClient,e);return c=qe("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>m)}}async get(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=x6(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),l.then(m=>m)}else{const f=w6(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>m)}}async delete(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=y6(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=v6(m),E=new oA;return Object.assign(E,v),E})}else{const f=g6(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=_6(m),E=new oA;return Object.assign(E,v),E})}}async update(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=z6(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),l.then(m=>m)}else{const f=F6(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>m)}}async listInternal(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=k6(e);return c=qe("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=D6(m),E=new aA;return Object.assign(E,v),E})}else{const f=N6(e);return c=qe("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=M6(m),E=new aA;return Object.assign(E,v),E})}}}function Ep(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function pA(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function lt(n){return this instanceof lt?(this.v=n,this):new lt(n)}function rr(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),r[Symbol.asyncIterator]=function(){return this},r;function l(b){return function(I){return Promise.resolve(I).then(b,v)}}function c(b,I){i[b]&&(r[b]=function(x){return new Promise(function(A,N){o.push([b,x,A,N])>1||d(b,x)})},I&&(r[b]=I(r[b])))}function d(b,I){try{f(i[b](I))}catch(x){E(o[0][3],x)}}function f(b){b.value instanceof lt?Promise.resolve(b.value.v).then(m,v):E(o[0][2],b)}function m(b){d("next",b)}function v(b){d("throw",b)}function E(b,I){b(I),o.shift(),o.length&&d(o[0][0],o[0][1])}}function sr(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof pA=="function"?pA(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(l){return new Promise(function(c,d){l=n[o](l),r(c,d,l.done,l.value)})}}function r(o,l,c,d){Promise.resolve(d).then(function(f){o({value:f,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function q6(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:YR(t)}function YR(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function H6(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function mA(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const r=[];let o=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),o&&!YR(n[i])&&(o=!1),i++;o?e.push(...r):e.pop()}return e}class $6{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new j6(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class j6{constructor(e,t,i,r={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=o,this.sendPromise=Promise.resolve(),H6(o)}async sendMessage(e){var t;await this.sendPromise;const i=jn(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l,c;const d=await r,f=(l=(o=d.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,m=d.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let E=[];m!=null&&(E=(c=m.slice(v))!==null&&c!==void 0?c:[]);const b=f?[f]:[];this.recordHistory(i,b,E)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const i=jn(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const o=await r;return this.processStreamResponse(o,i)}getHistory(e=!1){const t=e?mA(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return rr(this,arguments,function*(){var r,o,l,c,d,f;const m=[];try{for(var v=!0,E=sr(e),b;b=yield lt(E.next()),r=b.done,!r;v=!0){c=b.value,v=!1;const I=c;if(q6(I)){const x=(f=(d=I.candidates)===null||d===void 0?void 0:d[0])===null||f===void 0?void 0:f.content;x!==void 0&&m.push(x)}yield yield lt(I)}}catch(I){o={error:I}}finally{try{!v&&!r&&(l=E.return)&&(yield lt(l.call(E)))}finally{if(o)throw o.error}}this.recordHistory(t,m)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(o=>o.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...mA(i)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Td extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Td.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function K6(n){const e={},t=p(n,["file"]);return t!=null&&g(e,["file"],t),e}function J6(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function Y6(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","file"],GR(t)),e}function W6(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function Q6(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","file"],GR(t)),e}function X6(n){const e={},t=p(n,["uris"]);return t!=null&&g(e,["uris"],t),e}function Z6(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function eB(n){const e={},t=p(n,["config"]);return t!=null&&Z6(t,e),e}function tB(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=p(n,["files"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["files"],o)}return e}function nB(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["files"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),g(e,["files"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class iB extends ms{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Oa(cs.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async registerFiles(e){throw new Error("registerFiles is only supported in Node.js environments.")}async _registerFiles(e){return this.registerFilesInternal(e)}async listInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=eB(e);return o=qe("files",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>{const f=tB(d),m=new r3;return Object.assign(m,f),m})}}async createInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=K6(e);return o=qe("upload/v1beta/files",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const f=J6(d),m=new s3;return Object.assign(m,f),m})}}async get(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Q6(e);return o=qe("files/{file}",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Y6(e);return o=qe("files/{file}",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>{const f=W6(d),m=new o3;return Object.assign(m,f),m})}}async registerFilesInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=X6(e);return o=qe("files:register",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const f=nB(d),m=new a3;return Object.assign(m,f),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gh(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function rB(n){const e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>EB(o))),g(e,["parts"],r)}const i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function sB(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function oB(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const i=p(n,["args"]);i!=null&&g(e,["args"],i);const r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function aB(n){const e={},t=p(n,["description"]);t!=null&&g(e,["description"],t);const i=p(n,["name"]);i!=null&&g(e,["name"],i);const r=p(n,["parameters"]);r!=null&&g(e,["parameters"],r);const o=p(n,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);const l=p(n,["response"]);l!=null&&g(e,["response"],l);const c=p(n,["responseJsonSchema"]);if(c!=null&&g(e,["responseJsonSchema"],c),p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function lB(n){const e={},t=p(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);const i=p(n,["responseJsonSchema"]);i!=null&&g(e,["responseJsonSchema"],i);const r=p(n,["audioTimestamp"]);r!=null&&g(e,["audioTimestamp"],r);const o=p(n,["candidateCount"]);o!=null&&g(e,["candidateCount"],o);const l=p(n,["enableAffectiveDialog"]);l!=null&&g(e,["enableAffectiveDialog"],l);const c=p(n,["frequencyPenalty"]);c!=null&&g(e,["frequencyPenalty"],c);const d=p(n,["logprobs"]);d!=null&&g(e,["logprobs"],d);const f=p(n,["maxOutputTokens"]);f!=null&&g(e,["maxOutputTokens"],f);const m=p(n,["mediaResolution"]);m!=null&&g(e,["mediaResolution"],m);const v=p(n,["presencePenalty"]);v!=null&&g(e,["presencePenalty"],v);const E=p(n,["responseLogprobs"]);E!=null&&g(e,["responseLogprobs"],E);const b=p(n,["responseMimeType"]);b!=null&&g(e,["responseMimeType"],b);const I=p(n,["responseModalities"]);I!=null&&g(e,["responseModalities"],I);const x=p(n,["responseSchema"]);x!=null&&g(e,["responseSchema"],x);const A=p(n,["routingConfig"]);A!=null&&g(e,["routingConfig"],A);const N=p(n,["seed"]);N!=null&&g(e,["seed"],N);const U=p(n,["speechConfig"]);U!=null&&g(e,["speechConfig"],U);const L=p(n,["stopSequences"]);L!=null&&g(e,["stopSequences"],L);const $=p(n,["temperature"]);$!=null&&g(e,["temperature"],$);const K=p(n,["thinkingConfig"]);K!=null&&g(e,["thinkingConfig"],K);const j=p(n,["topK"]);j!=null&&g(e,["topK"],j);const k=p(n,["topP"]);if(k!=null&&g(e,["topP"],k),p(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function uB(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function cB(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function dB(n,e){const t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],i);const r=p(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);const o=p(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);const l=p(n,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const c=p(n,["topK"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","topK"],c);const d=p(n,["maxOutputTokens"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","maxOutputTokens"],d);const f=p(n,["mediaResolution"]);e!==void 0&&f!=null&&g(e,["setup","generationConfig","mediaResolution"],f);const m=p(n,["seed"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","seed"],m);const v=p(n,["speechConfig"]);e!==void 0&&v!=null&&g(e,["setup","generationConfig","speechConfig"],i0(v));const E=p(n,["thinkingConfig"]);e!==void 0&&E!=null&&g(e,["setup","generationConfig","thinkingConfig"],E);const b=p(n,["enableAffectiveDialog"]);e!==void 0&&b!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],b);const I=p(n,["systemInstruction"]);e!==void 0&&I!=null&&g(e,["setup","systemInstruction"],rB(jn(I)));const x=p(n,["tools"]);if(e!==void 0&&x!=null){let j=Su(x);Array.isArray(j)&&(j=j.map(k=>bB(bu(k)))),g(e,["setup","tools"],j)}const A=p(n,["sessionResumption"]);e!==void 0&&A!=null&&g(e,["setup","sessionResumption"],TB(A));const N=p(n,["inputAudioTranscription"]);e!==void 0&&N!=null&&g(e,["setup","inputAudioTranscription"],N);const U=p(n,["outputAudioTranscription"]);e!==void 0&&U!=null&&g(e,["setup","outputAudioTranscription"],U);const L=p(n,["realtimeInputConfig"]);e!==void 0&&L!=null&&g(e,["setup","realtimeInputConfig"],L);const $=p(n,["contextWindowCompression"]);e!==void 0&&$!=null&&g(e,["setup","contextWindowCompression"],$);const K=p(n,["proactivity"]);if(e!==void 0&&K!=null&&g(e,["setup","proactivity"],K),p(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function fB(n,e){const t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],lB(i));const r=p(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);const o=p(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);const l=p(n,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const c=p(n,["topK"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","topK"],c);const d=p(n,["maxOutputTokens"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","maxOutputTokens"],d);const f=p(n,["mediaResolution"]);e!==void 0&&f!=null&&g(e,["setup","generationConfig","mediaResolution"],f);const m=p(n,["seed"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","seed"],m);const v=p(n,["speechConfig"]);e!==void 0&&v!=null&&g(e,["setup","generationConfig","speechConfig"],i0(v));const E=p(n,["thinkingConfig"]);e!==void 0&&E!=null&&g(e,["setup","generationConfig","thinkingConfig"],E);const b=p(n,["enableAffectiveDialog"]);e!==void 0&&b!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],b);const I=p(n,["systemInstruction"]);e!==void 0&&I!=null&&g(e,["setup","systemInstruction"],jn(I));const x=p(n,["tools"]);if(e!==void 0&&x!=null){let k=Su(x);Array.isArray(k)&&(k=k.map(V=>SB(bu(V)))),g(e,["setup","tools"],k)}const A=p(n,["sessionResumption"]);e!==void 0&&A!=null&&g(e,["setup","sessionResumption"],A);const N=p(n,["inputAudioTranscription"]);e!==void 0&&N!=null&&g(e,["setup","inputAudioTranscription"],N);const U=p(n,["outputAudioTranscription"]);e!==void 0&&U!=null&&g(e,["setup","outputAudioTranscription"],U);const L=p(n,["realtimeInputConfig"]);e!==void 0&&L!=null&&g(e,["setup","realtimeInputConfig"],L);const $=p(n,["contextWindowCompression"]);e!==void 0&&$!=null&&g(e,["setup","contextWindowCompression"],$);const K=p(n,["proactivity"]);e!==void 0&&K!=null&&g(e,["setup","proactivity"],K);const j=p(n,["explicitVadSignal"]);return e!==void 0&&j!=null&&g(e,["setup","explicitVadSignal"],j),t}function hB(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],Dt(n,i));const r=p(e,["config"]);return r!=null&&g(t,["config"],dB(r,t)),t}function pB(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],Dt(n,i));const r=p(e,["config"]);return r!=null&&g(t,["config"],fB(r,t)),t}function mB(n){const e={},t=p(n,["musicGenerationConfig"]);return t!=null&&g(e,["musicGenerationConfig"],t),e}function gB(n){const e={},t=p(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),g(e,["weightedPrompts"],i)}return e}function yB(n){const e={},t=p(n,["media"]);if(t!=null){let f=UR(t);Array.isArray(f)&&(f=f.map(m=>Gh(m))),g(e,["mediaChunks"],f)}const i=p(n,["audio"]);i!=null&&g(e,["audio"],Gh(BR(i)));const r=p(n,["audioStreamEnd"]);r!=null&&g(e,["audioStreamEnd"],r);const o=p(n,["video"]);o!=null&&g(e,["video"],Gh(LR(o)));const l=p(n,["text"]);l!=null&&g(e,["text"],l);const c=p(n,["activityStart"]);c!=null&&g(e,["activityStart"],c);const d=p(n,["activityEnd"]);return d!=null&&g(e,["activityEnd"],d),e}function _B(n){const e={},t=p(n,["media"]);if(t!=null){let f=UR(t);Array.isArray(f)&&(f=f.map(m=>m)),g(e,["mediaChunks"],f)}const i=p(n,["audio"]);i!=null&&g(e,["audio"],BR(i));const r=p(n,["audioStreamEnd"]);r!=null&&g(e,["audioStreamEnd"],r);const o=p(n,["video"]);o!=null&&g(e,["video"],LR(o));const l=p(n,["text"]);l!=null&&g(e,["text"],l);const c=p(n,["activityStart"]);c!=null&&g(e,["activityStart"],c);const d=p(n,["activityEnd"]);return d!=null&&g(e,["activityEnd"],d),e}function vB(n){const e={},t=p(n,["setupComplete"]);t!=null&&g(e,["setupComplete"],t);const i=p(n,["serverContent"]);i!=null&&g(e,["serverContent"],i);const r=p(n,["toolCall"]);r!=null&&g(e,["toolCall"],r);const o=p(n,["toolCallCancellation"]);o!=null&&g(e,["toolCallCancellation"],o);const l=p(n,["usageMetadata"]);l!=null&&g(e,["usageMetadata"],wB(l));const c=p(n,["goAway"]);c!=null&&g(e,["goAway"],c);const d=p(n,["sessionResumptionUpdate"]);d!=null&&g(e,["sessionResumptionUpdate"],d);const f=p(n,["voiceActivityDetectionSignal"]);f!=null&&g(e,["voiceActivityDetectionSignal"],f);const m=p(n,["voiceActivity"]);return m!=null&&g(e,["voiceActivity"],xB(m)),e}function EB(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);const o=p(n,["fileData"]);o!=null&&g(e,["fileData"],sB(o));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],oB(l));const c=p(n,["functionResponse"]);c!=null&&g(e,["functionResponse"],c);const d=p(n,["inlineData"]);d!=null&&g(e,["inlineData"],Gh(d));const f=p(n,["text"]);f!=null&&g(e,["text"],f);const m=p(n,["thought"]);m!=null&&g(e,["thought"],m);const v=p(n,["thoughtSignature"]);v!=null&&g(e,["thoughtSignature"],v);const E=p(n,["videoMetadata"]);return E!=null&&g(e,["videoMetadata"],E),e}function TB(n){const e={},t=p(n,["handle"]);if(t!=null&&g(e,["handle"],t),p(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function bB(n){const e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);const i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(n,["functionDeclarations"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(v=>v)),g(e,["functionDeclarations"],m)}const l=p(n,["googleMaps"]);l!=null&&g(e,["googleMaps"],uB(l));const c=p(n,["googleSearch"]);c!=null&&g(e,["googleSearch"],cB(c));const d=p(n,["googleSearchRetrieval"]);d!=null&&g(e,["googleSearchRetrieval"],d);const f=p(n,["urlContext"]);return f!=null&&g(e,["urlContext"],f),e}function SB(n){const e={},t=p(n,["retrieval"]);t!=null&&g(e,["retrieval"],t);const i=p(n,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=p(n,["codeExecution"]);r!=null&&g(e,["codeExecution"],r);const o=p(n,["enterpriseWebSearch"]);o!=null&&g(e,["enterpriseWebSearch"],o);const l=p(n,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(E=>aB(E))),g(e,["functionDeclarations"],v)}const c=p(n,["googleMaps"]);c!=null&&g(e,["googleMaps"],c);const d=p(n,["googleSearch"]);d!=null&&g(e,["googleSearch"],d);const f=p(n,["googleSearchRetrieval"]);f!=null&&g(e,["googleSearchRetrieval"],f);const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function wB(n){const e={},t=p(n,["promptTokenCount"]);t!=null&&g(e,["promptTokenCount"],t);const i=p(n,["cachedContentTokenCount"]);i!=null&&g(e,["cachedContentTokenCount"],i);const r=p(n,["candidatesTokenCount"]);r!=null&&g(e,["responseTokenCount"],r);const o=p(n,["toolUsePromptTokenCount"]);o!=null&&g(e,["toolUsePromptTokenCount"],o);const l=p(n,["thoughtsTokenCount"]);l!=null&&g(e,["thoughtsTokenCount"],l);const c=p(n,["totalTokenCount"]);c!=null&&g(e,["totalTokenCount"],c);const d=p(n,["promptTokensDetails"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(I=>I)),g(e,["promptTokensDetails"],b)}const f=p(n,["cacheTokensDetails"]);if(f!=null){let b=f;Array.isArray(b)&&(b=b.map(I=>I)),g(e,["cacheTokensDetails"],b)}const m=p(n,["candidatesTokensDetails"]);if(m!=null){let b=m;Array.isArray(b)&&(b=b.map(I=>I)),g(e,["responseTokensDetails"],b)}const v=p(n,["toolUsePromptTokensDetails"]);if(v!=null){let b=v;Array.isArray(b)&&(b=b.map(I=>I)),g(e,["toolUsePromptTokensDetails"],b)}const E=p(n,["trafficType"]);return E!=null&&g(e,["trafficType"],E),e}function xB(n){const e={},t=p(n,["type"]);return t!=null&&g(e,["voiceActivityType"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AB(n,e){const t={},i=p(n,["data"]);if(i!=null&&g(t,["data"],i),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(n,["mimeType"]);return r!=null&&g(t,["mimeType"],r),t}function IB(n,e){const t={},i=p(n,["content"]);i!=null&&g(t,["content"],i);const r=p(n,["citationMetadata"]);r!=null&&g(t,["citationMetadata"],CB(r));const o=p(n,["tokenCount"]);o!=null&&g(t,["tokenCount"],o);const l=p(n,["finishReason"]);l!=null&&g(t,["finishReason"],l);const c=p(n,["avgLogprobs"]);c!=null&&g(t,["avgLogprobs"],c);const d=p(n,["groundingMetadata"]);d!=null&&g(t,["groundingMetadata"],d);const f=p(n,["index"]);f!=null&&g(t,["index"],f);const m=p(n,["logprobsResult"]);m!=null&&g(t,["logprobsResult"],m);const v=p(n,["safetyRatings"]);if(v!=null){let b=v;Array.isArray(b)&&(b=b.map(I=>I)),g(t,["safetyRatings"],b)}const E=p(n,["urlContextMetadata"]);return E!=null&&g(t,["urlContextMetadata"],E),t}function CB(n,e){const t={},i=p(n,["citationSources"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),g(t,["citations"],r)}return t}function RB(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["contents"]);if(o!=null){let l=Li(o);Array.isArray(l)&&(l=l.map(c=>c)),g(i,["contents"],l)}return i}function NB(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["tokensInfo"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),g(t,["tokensInfo"],o)}return t}function kB(n,e){const t={},i=p(n,["values"]);i!=null&&g(t,["values"],i);const r=p(n,["statistics"]);return r!=null&&g(t,["statistics"],MB(r)),t}function MB(n,e){const t={},i=p(n,["truncated"]);i!=null&&g(t,["truncated"],i);const r=p(n,["token_count"]);return r!=null&&g(t,["tokenCount"],r),t}function im(n,e){const t={},i=p(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>zF(l))),g(t,["parts"],o)}const r=p(n,["role"]);return r!=null&&g(t,["role"],r),t}function DB(n,e){const t={},i=p(n,["controlType"]);i!=null&&g(t,["controlType"],i);const r=p(n,["enableControlImageComputation"]);return r!=null&&g(t,["computeControl"],r),t}function PB(n,e){const t={};if(p(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(p(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(p(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function OB(n,e,t){const i={},r=p(n,["systemInstruction"]);e!==void 0&&r!=null&&g(e,["systemInstruction"],jn(r));const o=p(n,["tools"]);if(e!==void 0&&o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>ZR(d))),g(e,["tools"],c)}const l=p(n,["generationConfig"]);return e!==void 0&&l!=null&&g(e,["generationConfig"],AF(l)),i}function VB(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["contents"]);if(o!=null){let c=Li(o);Array.isArray(c)&&(c=c.map(d=>im(d))),g(i,["contents"],c)}const l=p(e,["config"]);return l!=null&&PB(l),i}function UB(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["contents"]);if(o!=null){let c=Li(o);Array.isArray(c)&&(c=c.map(d=>d)),g(i,["contents"],c)}const l=p(e,["config"]);return l!=null&&OB(l,i),i}function LB(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["totalTokens"]);r!=null&&g(t,["totalTokens"],r);const o=p(n,["cachedContentTokenCount"]);return o!=null&&g(t,["cachedContentTokenCount"],o),t}function BB(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["totalTokens"]);return r!=null&&g(t,["totalTokens"],r),t}function FB(n,e,t){const i={},r=p(e,["model"]);return r!=null&&g(i,["_url","name"],Dt(n,r)),i}function zB(n,e,t){const i={},r=p(e,["model"]);return r!=null&&g(i,["_url","name"],Dt(n,r)),i}function GB(n,e){const t={},i=p(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function qB(n,e){const t={},i=p(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function HB(n,e,t){const i={},r=p(n,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);const o=p(n,["negativePrompt"]);e!==void 0&&o!=null&&g(e,["parameters","negativePrompt"],o);const l=p(n,["numberOfImages"]);e!==void 0&&l!=null&&g(e,["parameters","sampleCount"],l);const c=p(n,["aspectRatio"]);e!==void 0&&c!=null&&g(e,["parameters","aspectRatio"],c);const d=p(n,["guidanceScale"]);e!==void 0&&d!=null&&g(e,["parameters","guidanceScale"],d);const f=p(n,["seed"]);e!==void 0&&f!=null&&g(e,["parameters","seed"],f);const m=p(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&g(e,["parameters","safetySetting"],m);const v=p(n,["personGeneration"]);e!==void 0&&v!=null&&g(e,["parameters","personGeneration"],v);const E=p(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&g(e,["parameters","includeSafetyAttributes"],E);const b=p(n,["includeRaiReason"]);e!==void 0&&b!=null&&g(e,["parameters","includeRaiReason"],b);const I=p(n,["language"]);e!==void 0&&I!=null&&g(e,["parameters","language"],I);const x=p(n,["outputMimeType"]);e!==void 0&&x!=null&&g(e,["parameters","outputOptions","mimeType"],x);const A=p(n,["outputCompressionQuality"]);e!==void 0&&A!=null&&g(e,["parameters","outputOptions","compressionQuality"],A);const N=p(n,["addWatermark"]);e!==void 0&&N!=null&&g(e,["parameters","addWatermark"],N);const U=p(n,["labels"]);e!==void 0&&U!=null&&g(e,["labels"],U);const L=p(n,["editMode"]);e!==void 0&&L!=null&&g(e,["parameters","editMode"],L);const $=p(n,["baseSteps"]);return e!==void 0&&$!=null&&g(e,["parameters","editConfig","baseSteps"],$),i}function $B(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["prompt"]);o!=null&&g(i,["instances[0]","prompt"],o);const l=p(e,["referenceImages"]);if(l!=null){let d=l;Array.isArray(d)&&(d=d.map(f=>KF(f))),g(i,["instances[0]","referenceImages"],d)}const c=p(e,["config"]);return c!=null&&HB(c,i),i}function jB(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>rm(l))),g(t,["generatedImages"],o)}return t}function KB(n,e,t){const i={},r=p(n,["taskType"]);e!==void 0&&r!=null&&g(e,["requests[]","taskType"],r);const o=p(n,["title"]);e!==void 0&&o!=null&&g(e,["requests[]","title"],o);const l=p(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&g(e,["requests[]","outputDimensionality"],l),p(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return i}function JB(n,e,t){const i={},r=p(n,["taskType"]);e!==void 0&&r!=null&&g(e,["instances[]","task_type"],r);const o=p(n,["title"]);e!==void 0&&o!=null&&g(e,["instances[]","title"],o);const l=p(n,["outputDimensionality"]);e!==void 0&&l!=null&&g(e,["parameters","outputDimensionality"],l);const c=p(n,["mimeType"]);e!==void 0&&c!=null&&g(e,["instances[]","mimeType"],c);const d=p(n,["autoTruncate"]);return e!==void 0&&d!=null&&g(e,["parameters","autoTruncate"],d),i}function YB(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["contents"]);if(o!=null){let d=e0(n,o);Array.isArray(d)&&(d=d.map(f=>f)),g(i,["requests[]","content"],d)}const l=p(e,["config"]);l!=null&&KB(l,i);const c=p(e,["model"]);return c!==void 0&&g(i,["requests[]","model"],Dt(n,c)),i}function WB(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["contents"]);if(o!=null){let c=e0(n,o);Array.isArray(c)&&(c=c.map(d=>d)),g(i,["instances[]","content"],c)}const l=p(e,["config"]);return l!=null&&JB(l,i),i}function QB(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["embeddings"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),g(t,["embeddings"],l)}const o=p(n,["metadata"]);return o!=null&&g(t,["metadata"],o),t}function XB(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["predictions[]","embeddings"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>kB(c))),g(t,["embeddings"],l)}const o=p(n,["metadata"]);return o!=null&&g(t,["metadata"],o),t}function ZB(n,e){const t={},i=p(n,["endpoint"]);i!=null&&g(t,["name"],i);const r=p(n,["deployedModelId"]);return r!=null&&g(t,["deployedModelId"],r),t}function eF(n,e){const t={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=p(n,["fileUri"]);i!=null&&g(t,["fileUri"],i);const r=p(n,["mimeType"]);return r!=null&&g(t,["mimeType"],r),t}function tF(n,e){const t={},i=p(n,["id"]);i!=null&&g(t,["id"],i);const r=p(n,["args"]);r!=null&&g(t,["args"],r);const o=p(n,["name"]);if(o!=null&&g(t,["name"],o),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function nF(n,e){const t={},i=p(n,["allowedFunctionNames"]);i!=null&&g(t,["allowedFunctionNames"],i);const r=p(n,["mode"]);if(r!=null&&g(t,["mode"],r),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function iF(n,e){const t={},i=p(n,["description"]);i!=null&&g(t,["description"],i);const r=p(n,["name"]);r!=null&&g(t,["name"],r);const o=p(n,["parameters"]);o!=null&&g(t,["parameters"],o);const l=p(n,["parametersJsonSchema"]);l!=null&&g(t,["parametersJsonSchema"],l);const c=p(n,["response"]);c!=null&&g(t,["response"],c);const d=p(n,["responseJsonSchema"]);if(d!=null&&g(t,["responseJsonSchema"],d),p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function rF(n,e,t,i){const r={},o=p(e,["systemInstruction"]);t!==void 0&&o!=null&&g(t,["systemInstruction"],im(jn(o)));const l=p(e,["temperature"]);l!=null&&g(r,["temperature"],l);const c=p(e,["topP"]);c!=null&&g(r,["topP"],c);const d=p(e,["topK"]);d!=null&&g(r,["topK"],d);const f=p(e,["candidateCount"]);f!=null&&g(r,["candidateCount"],f);const m=p(e,["maxOutputTokens"]);m!=null&&g(r,["maxOutputTokens"],m);const v=p(e,["stopSequences"]);v!=null&&g(r,["stopSequences"],v);const E=p(e,["responseLogprobs"]);E!=null&&g(r,["responseLogprobs"],E);const b=p(e,["logprobs"]);b!=null&&g(r,["logprobs"],b);const I=p(e,["presencePenalty"]);I!=null&&g(r,["presencePenalty"],I);const x=p(e,["frequencyPenalty"]);x!=null&&g(r,["frequencyPenalty"],x);const A=p(e,["seed"]);A!=null&&g(r,["seed"],A);const N=p(e,["responseMimeType"]);N!=null&&g(r,["responseMimeType"],N);const U=p(e,["responseSchema"]);U!=null&&g(r,["responseSchema"],t0(U));const L=p(e,["responseJsonSchema"]);if(L!=null&&g(r,["responseJsonSchema"],L),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const $=p(e,["safetySettings"]);if(t!==void 0&&$!=null){let O=$;Array.isArray(O)&&(O=O.map(oe=>JF(oe))),g(t,["safetySettings"],O)}const K=p(e,["tools"]);if(t!==void 0&&K!=null){let O=Su(K);Array.isArray(O)&&(O=O.map(oe=>tz(bu(oe)))),g(t,["tools"],O)}const j=p(e,["toolConfig"]);if(t!==void 0&&j!=null&&g(t,["toolConfig"],ez(j)),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=p(e,["cachedContent"]);t!==void 0&&k!=null&&g(t,["cachedContent"],gs(n,k));const V=p(e,["responseModalities"]);V!=null&&g(r,["responseModalities"],V);const D=p(e,["mediaResolution"]);D!=null&&g(r,["mediaResolution"],D);const z=p(e,["speechConfig"]);if(z!=null&&g(r,["speechConfig"],n0(z)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const G=p(e,["thinkingConfig"]);G!=null&&g(r,["thinkingConfig"],G);const M=p(e,["imageConfig"]);M!=null&&g(r,["imageConfig"],kF(M));const B=p(e,["enableEnhancedCivicAnswers"]);if(B!=null&&g(r,["enableEnhancedCivicAnswers"],B),p(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function sF(n,e,t,i){const r={},o=p(e,["systemInstruction"]);t!==void 0&&o!=null&&g(t,["systemInstruction"],jn(o));const l=p(e,["temperature"]);l!=null&&g(r,["temperature"],l);const c=p(e,["topP"]);c!=null&&g(r,["topP"],c);const d=p(e,["topK"]);d!=null&&g(r,["topK"],d);const f=p(e,["candidateCount"]);f!=null&&g(r,["candidateCount"],f);const m=p(e,["maxOutputTokens"]);m!=null&&g(r,["maxOutputTokens"],m);const v=p(e,["stopSequences"]);v!=null&&g(r,["stopSequences"],v);const E=p(e,["responseLogprobs"]);E!=null&&g(r,["responseLogprobs"],E);const b=p(e,["logprobs"]);b!=null&&g(r,["logprobs"],b);const I=p(e,["presencePenalty"]);I!=null&&g(r,["presencePenalty"],I);const x=p(e,["frequencyPenalty"]);x!=null&&g(r,["frequencyPenalty"],x);const A=p(e,["seed"]);A!=null&&g(r,["seed"],A);const N=p(e,["responseMimeType"]);N!=null&&g(r,["responseMimeType"],N);const U=p(e,["responseSchema"]);U!=null&&g(r,["responseSchema"],t0(U));const L=p(e,["responseJsonSchema"]);L!=null&&g(r,["responseJsonSchema"],L);const $=p(e,["routingConfig"]);$!=null&&g(r,["routingConfig"],$);const K=p(e,["modelSelectionConfig"]);K!=null&&g(r,["modelConfig"],K);const j=p(e,["safetySettings"]);if(t!==void 0&&j!=null){let se=j;Array.isArray(se)&&(se=se.map(ne=>ne)),g(t,["safetySettings"],se)}const k=p(e,["tools"]);if(t!==void 0&&k!=null){let se=Su(k);Array.isArray(se)&&(se=se.map(ne=>ZR(bu(ne)))),g(t,["tools"],se)}const V=p(e,["toolConfig"]);t!==void 0&&V!=null&&g(t,["toolConfig"],V);const D=p(e,["labels"]);t!==void 0&&D!=null&&g(t,["labels"],D);const z=p(e,["cachedContent"]);t!==void 0&&z!=null&&g(t,["cachedContent"],gs(n,z));const G=p(e,["responseModalities"]);G!=null&&g(r,["responseModalities"],G);const M=p(e,["mediaResolution"]);M!=null&&g(r,["mediaResolution"],M);const B=p(e,["speechConfig"]);B!=null&&g(r,["speechConfig"],n0(B));const O=p(e,["audioTimestamp"]);O!=null&&g(r,["audioTimestamp"],O);const oe=p(e,["thinkingConfig"]);oe!=null&&g(r,["thinkingConfig"],oe);const X=p(e,["imageConfig"]);if(X!=null&&g(r,["imageConfig"],MF(X)),p(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const Q=p(e,["modelArmorConfig"]);return t!==void 0&&Q!=null&&g(t,["modelArmorConfig"],Q),r}function gA(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["contents"]);if(o!=null){let c=Li(o);Array.isArray(c)&&(c=c.map(d=>im(d))),g(i,["contents"],c)}const l=p(e,["config"]);return l!=null&&g(i,["generationConfig"],rF(n,l,i)),i}function yA(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["contents"]);if(o!=null){let c=Li(o);Array.isArray(c)&&(c=c.map(d=>d)),g(i,["contents"],c)}const l=p(e,["config"]);return l!=null&&g(i,["generationConfig"],sF(n,l,i)),i}function _A(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["candidates"]);if(r!=null){let f=r;Array.isArray(f)&&(f=f.map(m=>IB(m))),g(t,["candidates"],f)}const o=p(n,["modelVersion"]);o!=null&&g(t,["modelVersion"],o);const l=p(n,["promptFeedback"]);l!=null&&g(t,["promptFeedback"],l);const c=p(n,["responseId"]);c!=null&&g(t,["responseId"],c);const d=p(n,["usageMetadata"]);return d!=null&&g(t,["usageMetadata"],d),t}function vA(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["candidates"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(v=>v)),g(t,["candidates"],m)}const o=p(n,["createTime"]);o!=null&&g(t,["createTime"],o);const l=p(n,["modelVersion"]);l!=null&&g(t,["modelVersion"],l);const c=p(n,["promptFeedback"]);c!=null&&g(t,["promptFeedback"],c);const d=p(n,["responseId"]);d!=null&&g(t,["responseId"],d);const f=p(n,["usageMetadata"]);return f!=null&&g(t,["usageMetadata"],f),t}function oF(n,e,t){const i={};if(p(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=p(n,["numberOfImages"]);e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r);const o=p(n,["aspectRatio"]);e!==void 0&&o!=null&&g(e,["parameters","aspectRatio"],o);const l=p(n,["guidanceScale"]);if(e!==void 0&&l!=null&&g(e,["parameters","guidanceScale"],l),p(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=p(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&g(e,["parameters","safetySetting"],c);const d=p(n,["personGeneration"]);e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d);const f=p(n,["includeSafetyAttributes"]);e!==void 0&&f!=null&&g(e,["parameters","includeSafetyAttributes"],f);const m=p(n,["includeRaiReason"]);e!==void 0&&m!=null&&g(e,["parameters","includeRaiReason"],m);const v=p(n,["language"]);e!==void 0&&v!=null&&g(e,["parameters","language"],v);const E=p(n,["outputMimeType"]);e!==void 0&&E!=null&&g(e,["parameters","outputOptions","mimeType"],E);const b=p(n,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&g(e,["parameters","outputOptions","compressionQuality"],b),p(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(p(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=p(n,["imageSize"]);if(e!==void 0&&I!=null&&g(e,["parameters","sampleImageSize"],I),p(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return i}function aF(n,e,t){const i={},r=p(n,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);const o=p(n,["negativePrompt"]);e!==void 0&&o!=null&&g(e,["parameters","negativePrompt"],o);const l=p(n,["numberOfImages"]);e!==void 0&&l!=null&&g(e,["parameters","sampleCount"],l);const c=p(n,["aspectRatio"]);e!==void 0&&c!=null&&g(e,["parameters","aspectRatio"],c);const d=p(n,["guidanceScale"]);e!==void 0&&d!=null&&g(e,["parameters","guidanceScale"],d);const f=p(n,["seed"]);e!==void 0&&f!=null&&g(e,["parameters","seed"],f);const m=p(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&g(e,["parameters","safetySetting"],m);const v=p(n,["personGeneration"]);e!==void 0&&v!=null&&g(e,["parameters","personGeneration"],v);const E=p(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&g(e,["parameters","includeSafetyAttributes"],E);const b=p(n,["includeRaiReason"]);e!==void 0&&b!=null&&g(e,["parameters","includeRaiReason"],b);const I=p(n,["language"]);e!==void 0&&I!=null&&g(e,["parameters","language"],I);const x=p(n,["outputMimeType"]);e!==void 0&&x!=null&&g(e,["parameters","outputOptions","mimeType"],x);const A=p(n,["outputCompressionQuality"]);e!==void 0&&A!=null&&g(e,["parameters","outputOptions","compressionQuality"],A);const N=p(n,["addWatermark"]);e!==void 0&&N!=null&&g(e,["parameters","addWatermark"],N);const U=p(n,["labels"]);e!==void 0&&U!=null&&g(e,["labels"],U);const L=p(n,["imageSize"]);e!==void 0&&L!=null&&g(e,["parameters","sampleImageSize"],L);const $=p(n,["enhancePrompt"]);return e!==void 0&&$!=null&&g(e,["parameters","enhancePrompt"],$),i}function lF(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["prompt"]);o!=null&&g(i,["instances[0]","prompt"],o);const l=p(e,["config"]);return l!=null&&oF(l,i),i}function uF(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["prompt"]);o!=null&&g(i,["instances[0]","prompt"],o);const l=p(e,["config"]);return l!=null&&aF(l,i),i}function cF(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>bF(c))),g(t,["generatedImages"],l)}const o=p(n,["positivePromptSafetyAttributes"]);return o!=null&&g(t,["positivePromptSafetyAttributes"],QR(o)),t}function dF(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>rm(c))),g(t,["generatedImages"],l)}const o=p(n,["positivePromptSafetyAttributes"]);return o!=null&&g(t,["positivePromptSafetyAttributes"],XR(o)),t}function fF(n,e,t){const i={},r=p(n,["numberOfVideos"]);if(e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r),p(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=p(n,["durationSeconds"]);if(e!==void 0&&o!=null&&g(e,["parameters","durationSeconds"],o),p(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=p(n,["aspectRatio"]);e!==void 0&&l!=null&&g(e,["parameters","aspectRatio"],l);const c=p(n,["resolution"]);e!==void 0&&c!=null&&g(e,["parameters","resolution"],c);const d=p(n,["personGeneration"]);if(e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d),p(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=p(n,["negativePrompt"]);e!==void 0&&f!=null&&g(e,["parameters","negativePrompt"],f);const m=p(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&g(e,["parameters","enhancePrompt"],m),p(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const v=p(n,["lastFrame"]);e!==void 0&&v!=null&&g(e,["instances[0]","lastFrame"],sm(v));const E=p(n,["referenceImages"]);if(e!==void 0&&E!=null){let b=E;Array.isArray(b)&&(b=b.map(I=>pz(I))),g(e,["instances[0]","referenceImages"],b)}if(p(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(p(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return i}function hF(n,e,t){const i={},r=p(n,["numberOfVideos"]);e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r);const o=p(n,["outputGcsUri"]);e!==void 0&&o!=null&&g(e,["parameters","storageUri"],o);const l=p(n,["fps"]);e!==void 0&&l!=null&&g(e,["parameters","fps"],l);const c=p(n,["durationSeconds"]);e!==void 0&&c!=null&&g(e,["parameters","durationSeconds"],c);const d=p(n,["seed"]);e!==void 0&&d!=null&&g(e,["parameters","seed"],d);const f=p(n,["aspectRatio"]);e!==void 0&&f!=null&&g(e,["parameters","aspectRatio"],f);const m=p(n,["resolution"]);e!==void 0&&m!=null&&g(e,["parameters","resolution"],m);const v=p(n,["personGeneration"]);e!==void 0&&v!=null&&g(e,["parameters","personGeneration"],v);const E=p(n,["pubsubTopic"]);e!==void 0&&E!=null&&g(e,["parameters","pubsubTopic"],E);const b=p(n,["negativePrompt"]);e!==void 0&&b!=null&&g(e,["parameters","negativePrompt"],b);const I=p(n,["enhancePrompt"]);e!==void 0&&I!=null&&g(e,["parameters","enhancePrompt"],I);const x=p(n,["generateAudio"]);e!==void 0&&x!=null&&g(e,["parameters","generateAudio"],x);const A=p(n,["lastFrame"]);e!==void 0&&A!=null&&g(e,["instances[0]","lastFrame"],or(A));const N=p(n,["referenceImages"]);if(e!==void 0&&N!=null){let $=N;Array.isArray($)&&($=$.map(K=>mz(K))),g(e,["instances[0]","referenceImages"],$)}const U=p(n,["mask"]);e!==void 0&&U!=null&&g(e,["instances[0]","mask"],hz(U));const L=p(n,["compressionQuality"]);return e!==void 0&&L!=null&&g(e,["parameters","compressionQuality"],L),i}function pF(n,e){const t={},i=p(n,["name"]);i!=null&&g(t,["name"],i);const r=p(n,["metadata"]);r!=null&&g(t,["metadata"],r);const o=p(n,["done"]);o!=null&&g(t,["done"],o);const l=p(n,["error"]);l!=null&&g(t,["error"],l);const c=p(n,["response","generateVideoResponse"]);return c!=null&&g(t,["response"],_F(c)),t}function mF(n,e){const t={},i=p(n,["name"]);i!=null&&g(t,["name"],i);const r=p(n,["metadata"]);r!=null&&g(t,["metadata"],r);const o=p(n,["done"]);o!=null&&g(t,["done"],o);const l=p(n,["error"]);l!=null&&g(t,["error"],l);const c=p(n,["response"]);return c!=null&&g(t,["response"],vF(c)),t}function gF(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["prompt"]);o!=null&&g(i,["instances[0]","prompt"],o);const l=p(e,["image"]);l!=null&&g(i,["instances[0]","image"],sm(l));const c=p(e,["video"]);c!=null&&g(i,["instances[0]","video"],eN(c));const d=p(e,["source"]);d!=null&&EF(d,i);const f=p(e,["config"]);return f!=null&&fF(f,i),i}function yF(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["prompt"]);o!=null&&g(i,["instances[0]","prompt"],o);const l=p(e,["image"]);l!=null&&g(i,["instances[0]","image"],or(l));const c=p(e,["video"]);c!=null&&g(i,["instances[0]","video"],tN(c));const d=p(e,["source"]);d!=null&&TF(d,i);const f=p(e,["config"]);return f!=null&&hF(f,i),i}function _F(n,e){const t={},i=p(n,["generatedSamples"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>wF(c))),g(t,["generatedVideos"],l)}const r=p(n,["raiMediaFilteredCount"]);r!=null&&g(t,["raiMediaFilteredCount"],r);const o=p(n,["raiMediaFilteredReasons"]);return o!=null&&g(t,["raiMediaFilteredReasons"],o),t}function vF(n,e){const t={},i=p(n,["videos"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>xF(c))),g(t,["generatedVideos"],l)}const r=p(n,["raiMediaFilteredCount"]);r!=null&&g(t,["raiMediaFilteredCount"],r);const o=p(n,["raiMediaFilteredReasons"]);return o!=null&&g(t,["raiMediaFilteredReasons"],o),t}function EF(n,e,t){const i={},r=p(n,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const o=p(n,["image"]);e!==void 0&&o!=null&&g(e,["instances[0]","image"],sm(o));const l=p(n,["video"]);return e!==void 0&&l!=null&&g(e,["instances[0]","video"],eN(l)),i}function TF(n,e,t){const i={},r=p(n,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const o=p(n,["image"]);e!==void 0&&o!=null&&g(e,["instances[0]","image"],or(o));const l=p(n,["video"]);return e!==void 0&&l!=null&&g(e,["instances[0]","video"],tN(l)),i}function bF(n,e){const t={},i=p(n,["_self"]);i!=null&&g(t,["image"],DF(i));const r=p(n,["raiFilteredReason"]);r!=null&&g(t,["raiFilteredReason"],r);const o=p(n,["_self"]);return o!=null&&g(t,["safetyAttributes"],QR(o)),t}function rm(n,e){const t={},i=p(n,["_self"]);i!=null&&g(t,["image"],WR(i));const r=p(n,["raiFilteredReason"]);r!=null&&g(t,["raiFilteredReason"],r);const o=p(n,["_self"]);o!=null&&g(t,["safetyAttributes"],XR(o));const l=p(n,["prompt"]);return l!=null&&g(t,["enhancedPrompt"],l),t}function SF(n,e){const t={},i=p(n,["_self"]);i!=null&&g(t,["mask"],WR(i));const r=p(n,["labels"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),g(t,["labels"],o)}return t}function wF(n,e){const t={},i=p(n,["video"]);return i!=null&&g(t,["video"],dz(i)),t}function xF(n,e){const t={},i=p(n,["_self"]);return i!=null&&g(t,["video"],fz(i)),t}function AF(n,e){const t={},i=p(n,["modelSelectionConfig"]);i!=null&&g(t,["modelConfig"],i);const r=p(n,["responseJsonSchema"]);r!=null&&g(t,["responseJsonSchema"],r);const o=p(n,["audioTimestamp"]);o!=null&&g(t,["audioTimestamp"],o);const l=p(n,["candidateCount"]);l!=null&&g(t,["candidateCount"],l);const c=p(n,["enableAffectiveDialog"]);c!=null&&g(t,["enableAffectiveDialog"],c);const d=p(n,["frequencyPenalty"]);d!=null&&g(t,["frequencyPenalty"],d);const f=p(n,["logprobs"]);f!=null&&g(t,["logprobs"],f);const m=p(n,["maxOutputTokens"]);m!=null&&g(t,["maxOutputTokens"],m);const v=p(n,["mediaResolution"]);v!=null&&g(t,["mediaResolution"],v);const E=p(n,["presencePenalty"]);E!=null&&g(t,["presencePenalty"],E);const b=p(n,["responseLogprobs"]);b!=null&&g(t,["responseLogprobs"],b);const I=p(n,["responseMimeType"]);I!=null&&g(t,["responseMimeType"],I);const x=p(n,["responseModalities"]);x!=null&&g(t,["responseModalities"],x);const A=p(n,["responseSchema"]);A!=null&&g(t,["responseSchema"],A);const N=p(n,["routingConfig"]);N!=null&&g(t,["routingConfig"],N);const U=p(n,["seed"]);U!=null&&g(t,["seed"],U);const L=p(n,["speechConfig"]);L!=null&&g(t,["speechConfig"],L);const $=p(n,["stopSequences"]);$!=null&&g(t,["stopSequences"],$);const K=p(n,["temperature"]);K!=null&&g(t,["temperature"],K);const j=p(n,["thinkingConfig"]);j!=null&&g(t,["thinkingConfig"],j);const k=p(n,["topK"]);k!=null&&g(t,["topK"],k);const V=p(n,["topP"]);if(V!=null&&g(t,["topP"],V),p(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function IF(n,e,t){const i={},r=p(e,["model"]);return r!=null&&g(i,["_url","name"],Dt(n,r)),i}function CF(n,e,t){const i={},r=p(e,["model"]);return r!=null&&g(i,["_url","name"],Dt(n,r)),i}function RF(n,e){const t={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const i=p(n,["enableWidget"]);return i!=null&&g(t,["enableWidget"],i),t}function NF(n,e){const t={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const i=p(n,["timeRangeFilter"]);return i!=null&&g(t,["timeRangeFilter"],i),t}function kF(n,e){const t={},i=p(n,["aspectRatio"]);i!=null&&g(t,["aspectRatio"],i);const r=p(n,["imageSize"]);if(r!=null&&g(t,["imageSize"],r),p(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(p(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function MF(n,e){const t={},i=p(n,["aspectRatio"]);i!=null&&g(t,["aspectRatio"],i);const r=p(n,["imageSize"]);r!=null&&g(t,["imageSize"],r);const o=p(n,["personGeneration"]);o!=null&&g(t,["personGeneration"],o);const l=p(n,["outputMimeType"]);l!=null&&g(t,["imageOutputOptions","mimeType"],l);const c=p(n,["outputCompressionQuality"]);return c!=null&&g(t,["imageOutputOptions","compressionQuality"],c),t}function DF(n,e){const t={},i=p(n,["bytesBase64Encoded"]);i!=null&&g(t,["imageBytes"],Co(i));const r=p(n,["mimeType"]);return r!=null&&g(t,["mimeType"],r),t}function WR(n,e){const t={},i=p(n,["gcsUri"]);i!=null&&g(t,["gcsUri"],i);const r=p(n,["bytesBase64Encoded"]);r!=null&&g(t,["imageBytes"],Co(r));const o=p(n,["mimeType"]);return o!=null&&g(t,["mimeType"],o),t}function sm(n,e){const t={};if(p(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const i=p(n,["imageBytes"]);i!=null&&g(t,["bytesBase64Encoded"],Co(i));const r=p(n,["mimeType"]);return r!=null&&g(t,["mimeType"],r),t}function or(n,e){const t={},i=p(n,["gcsUri"]);i!=null&&g(t,["gcsUri"],i);const r=p(n,["imageBytes"]);r!=null&&g(t,["bytesBase64Encoded"],Co(r));const o=p(n,["mimeType"]);return o!=null&&g(t,["mimeType"],o),t}function PF(n,e,t,i){const r={},o=p(e,["pageSize"]);t!==void 0&&o!=null&&g(t,["_query","pageSize"],o);const l=p(e,["pageToken"]);t!==void 0&&l!=null&&g(t,["_query","pageToken"],l);const c=p(e,["filter"]);t!==void 0&&c!=null&&g(t,["_query","filter"],c);const d=p(e,["queryBase"]);return t!==void 0&&d!=null&&g(t,["_url","models_url"],qR(n,d)),r}function OF(n,e,t,i){const r={},o=p(e,["pageSize"]);t!==void 0&&o!=null&&g(t,["_query","pageSize"],o);const l=p(e,["pageToken"]);t!==void 0&&l!=null&&g(t,["_query","pageToken"],l);const c=p(e,["filter"]);t!==void 0&&c!=null&&g(t,["_query","filter"],c);const d=p(e,["queryBase"]);return t!==void 0&&d!=null&&g(t,["_url","models_url"],qR(n,d)),r}function VF(n,e,t){const i={},r=p(e,["config"]);return r!=null&&PF(n,r,i),i}function UF(n,e,t){const i={},r=p(e,["config"]);return r!=null&&OF(n,r,i),i}function LF(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);const o=p(n,["_self"]);if(o!=null){let l=HR(o);Array.isArray(l)&&(l=l.map(c=>R_(c))),g(t,["models"],l)}return t}function BF(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);const o=p(n,["_self"]);if(o!=null){let l=HR(o);Array.isArray(l)&&(l=l.map(c=>N_(c))),g(t,["models"],l)}return t}function FF(n,e){const t={},i=p(n,["maskMode"]);i!=null&&g(t,["maskMode"],i);const r=p(n,["segmentationClasses"]);r!=null&&g(t,["maskClasses"],r);const o=p(n,["maskDilation"]);return o!=null&&g(t,["dilation"],o),t}function R_(n,e){const t={},i=p(n,["name"]);i!=null&&g(t,["name"],i);const r=p(n,["displayName"]);r!=null&&g(t,["displayName"],r);const o=p(n,["description"]);o!=null&&g(t,["description"],o);const l=p(n,["version"]);l!=null&&g(t,["version"],l);const c=p(n,["_self"]);c!=null&&g(t,["tunedModelInfo"],nz(c));const d=p(n,["inputTokenLimit"]);d!=null&&g(t,["inputTokenLimit"],d);const f=p(n,["outputTokenLimit"]);f!=null&&g(t,["outputTokenLimit"],f);const m=p(n,["supportedGenerationMethods"]);m!=null&&g(t,["supportedActions"],m);const v=p(n,["temperature"]);v!=null&&g(t,["temperature"],v);const E=p(n,["maxTemperature"]);E!=null&&g(t,["maxTemperature"],E);const b=p(n,["topP"]);b!=null&&g(t,["topP"],b);const I=p(n,["topK"]);I!=null&&g(t,["topK"],I);const x=p(n,["thinking"]);return x!=null&&g(t,["thinking"],x),t}function N_(n,e){const t={},i=p(n,["name"]);i!=null&&g(t,["name"],i);const r=p(n,["displayName"]);r!=null&&g(t,["displayName"],r);const o=p(n,["description"]);o!=null&&g(t,["description"],o);const l=p(n,["versionId"]);l!=null&&g(t,["version"],l);const c=p(n,["deployedModels"]);if(c!=null){let E=c;Array.isArray(E)&&(E=E.map(b=>ZB(b))),g(t,["endpoints"],E)}const d=p(n,["labels"]);d!=null&&g(t,["labels"],d);const f=p(n,["_self"]);f!=null&&g(t,["tunedModelInfo"],iz(f));const m=p(n,["defaultCheckpointId"]);m!=null&&g(t,["defaultCheckpointId"],m);const v=p(n,["checkpoints"]);if(v!=null){let E=v;Array.isArray(E)&&(E=E.map(b=>b)),g(t,["checkpoints"],E)}return t}function zF(n,e){const t={},i=p(n,["mediaResolution"]);i!=null&&g(t,["mediaResolution"],i);const r=p(n,["codeExecutionResult"]);r!=null&&g(t,["codeExecutionResult"],r);const o=p(n,["executableCode"]);o!=null&&g(t,["executableCode"],o);const l=p(n,["fileData"]);l!=null&&g(t,["fileData"],eF(l));const c=p(n,["functionCall"]);c!=null&&g(t,["functionCall"],tF(c));const d=p(n,["functionResponse"]);d!=null&&g(t,["functionResponse"],d);const f=p(n,["inlineData"]);f!=null&&g(t,["inlineData"],AB(f));const m=p(n,["text"]);m!=null&&g(t,["text"],m);const v=p(n,["thought"]);v!=null&&g(t,["thought"],v);const E=p(n,["thoughtSignature"]);E!=null&&g(t,["thoughtSignature"],E);const b=p(n,["videoMetadata"]);return b!=null&&g(t,["videoMetadata"],b),t}function GF(n,e){const t={},i=p(n,["productImage"]);return i!=null&&g(t,["image"],or(i)),t}function qF(n,e,t){const i={},r=p(n,["numberOfImages"]);e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r);const o=p(n,["baseSteps"]);e!==void 0&&o!=null&&g(e,["parameters","baseSteps"],o);const l=p(n,["outputGcsUri"]);e!==void 0&&l!=null&&g(e,["parameters","storageUri"],l);const c=p(n,["seed"]);e!==void 0&&c!=null&&g(e,["parameters","seed"],c);const d=p(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&g(e,["parameters","safetySetting"],d);const f=p(n,["personGeneration"]);e!==void 0&&f!=null&&g(e,["parameters","personGeneration"],f);const m=p(n,["addWatermark"]);e!==void 0&&m!=null&&g(e,["parameters","addWatermark"],m);const v=p(n,["outputMimeType"]);e!==void 0&&v!=null&&g(e,["parameters","outputOptions","mimeType"],v);const E=p(n,["outputCompressionQuality"]);e!==void 0&&E!=null&&g(e,["parameters","outputOptions","compressionQuality"],E);const b=p(n,["enhancePrompt"]);e!==void 0&&b!=null&&g(e,["parameters","enhancePrompt"],b);const I=p(n,["labels"]);return e!==void 0&&I!=null&&g(e,["labels"],I),i}function HF(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["source"]);o!=null&&jF(o,i);const l=p(e,["config"]);return l!=null&&qF(l,i),i}function $F(n,e){const t={},i=p(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>rm(o))),g(t,["generatedImages"],r)}return t}function jF(n,e,t){const i={},r=p(n,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const o=p(n,["personImage"]);e!==void 0&&o!=null&&g(e,["instances[0]","personImage","image"],or(o));const l=p(n,["productImages"]);if(e!==void 0&&l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>GF(d))),g(e,["instances[0]","productImages"],c)}return i}function KF(n,e){const t={},i=p(n,["referenceImage"]);i!=null&&g(t,["referenceImage"],or(i));const r=p(n,["referenceId"]);r!=null&&g(t,["referenceId"],r);const o=p(n,["referenceType"]);o!=null&&g(t,["referenceType"],o);const l=p(n,["maskImageConfig"]);l!=null&&g(t,["maskImageConfig"],FF(l));const c=p(n,["controlImageConfig"]);c!=null&&g(t,["controlImageConfig"],DB(c));const d=p(n,["styleImageConfig"]);d!=null&&g(t,["styleImageConfig"],d);const f=p(n,["subjectImageConfig"]);return f!=null&&g(t,["subjectImageConfig"],f),t}function QR(n,e){const t={},i=p(n,["safetyAttributes","categories"]);i!=null&&g(t,["categories"],i);const r=p(n,["safetyAttributes","scores"]);r!=null&&g(t,["scores"],r);const o=p(n,["contentType"]);return o!=null&&g(t,["contentType"],o),t}function XR(n,e){const t={},i=p(n,["safetyAttributes","categories"]);i!=null&&g(t,["categories"],i);const r=p(n,["safetyAttributes","scores"]);r!=null&&g(t,["scores"],r);const o=p(n,["contentType"]);return o!=null&&g(t,["contentType"],o),t}function JF(n,e){const t={},i=p(n,["category"]);if(i!=null&&g(t,["category"],i),p(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=p(n,["threshold"]);return r!=null&&g(t,["threshold"],r),t}function YF(n,e){const t={},i=p(n,["image"]);return i!=null&&g(t,["image"],or(i)),t}function WF(n,e,t){const i={},r=p(n,["mode"]);e!==void 0&&r!=null&&g(e,["parameters","mode"],r);const o=p(n,["maxPredictions"]);e!==void 0&&o!=null&&g(e,["parameters","maxPredictions"],o);const l=p(n,["confidenceThreshold"]);e!==void 0&&l!=null&&g(e,["parameters","confidenceThreshold"],l);const c=p(n,["maskDilation"]);e!==void 0&&c!=null&&g(e,["parameters","maskDilation"],c);const d=p(n,["binaryColorThreshold"]);e!==void 0&&d!=null&&g(e,["parameters","binaryColorThreshold"],d);const f=p(n,["labels"]);return e!==void 0&&f!=null&&g(e,["labels"],f),i}function QF(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["source"]);o!=null&&ZF(o,i);const l=p(e,["config"]);return l!=null&&WF(l,i),i}function XF(n,e){const t={},i=p(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>SF(o))),g(t,["generatedMasks"],r)}return t}function ZF(n,e,t){const i={},r=p(n,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const o=p(n,["image"]);e!==void 0&&o!=null&&g(e,["instances[0]","image"],or(o));const l=p(n,["scribbleImage"]);return e!==void 0&&l!=null&&g(e,["instances[0]","scribble"],YF(l)),i}function ez(n,e){const t={},i=p(n,["retrievalConfig"]);i!=null&&g(t,["retrievalConfig"],i);const r=p(n,["functionCallingConfig"]);return r!=null&&g(t,["functionCallingConfig"],nF(r)),t}function tz(n,e){const t={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=p(n,["computerUse"]);i!=null&&g(t,["computerUse"],i);const r=p(n,["fileSearch"]);r!=null&&g(t,["fileSearch"],r);const o=p(n,["codeExecution"]);if(o!=null&&g(t,["codeExecution"],o),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=p(n,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(E=>E)),g(t,["functionDeclarations"],v)}const c=p(n,["googleMaps"]);c!=null&&g(t,["googleMaps"],RF(c));const d=p(n,["googleSearch"]);d!=null&&g(t,["googleSearch"],NF(d));const f=p(n,["googleSearchRetrieval"]);f!=null&&g(t,["googleSearchRetrieval"],f);const m=p(n,["urlContext"]);return m!=null&&g(t,["urlContext"],m),t}function ZR(n,e){const t={},i=p(n,["retrieval"]);i!=null&&g(t,["retrieval"],i);const r=p(n,["computerUse"]);if(r!=null&&g(t,["computerUse"],r),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=p(n,["codeExecution"]);o!=null&&g(t,["codeExecution"],o);const l=p(n,["enterpriseWebSearch"]);l!=null&&g(t,["enterpriseWebSearch"],l);const c=p(n,["functionDeclarations"]);if(c!=null){let E=c;Array.isArray(E)&&(E=E.map(b=>iF(b))),g(t,["functionDeclarations"],E)}const d=p(n,["googleMaps"]);d!=null&&g(t,["googleMaps"],d);const f=p(n,["googleSearch"]);f!=null&&g(t,["googleSearch"],f);const m=p(n,["googleSearchRetrieval"]);m!=null&&g(t,["googleSearchRetrieval"],m);const v=p(n,["urlContext"]);return v!=null&&g(t,["urlContext"],v),t}function nz(n,e){const t={},i=p(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);const r=p(n,["createTime"]);r!=null&&g(t,["createTime"],r);const o=p(n,["updateTime"]);return o!=null&&g(t,["updateTime"],o),t}function iz(n,e){const t={},i=p(n,["labels","google-vertex-llm-tuning-base-model-id"]);i!=null&&g(t,["baseModel"],i);const r=p(n,["createTime"]);r!=null&&g(t,["createTime"],r);const o=p(n,["updateTime"]);return o!=null&&g(t,["updateTime"],o),t}function rz(n,e,t){const i={},r=p(n,["displayName"]);e!==void 0&&r!=null&&g(e,["displayName"],r);const o=p(n,["description"]);e!==void 0&&o!=null&&g(e,["description"],o);const l=p(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&g(e,["defaultCheckpointId"],l),i}function sz(n,e,t){const i={},r=p(n,["displayName"]);e!==void 0&&r!=null&&g(e,["displayName"],r);const o=p(n,["description"]);e!==void 0&&o!=null&&g(e,["description"],o);const l=p(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&g(e,["defaultCheckpointId"],l),i}function oz(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","name"],Dt(n,r));const o=p(e,["config"]);return o!=null&&rz(o,i),i}function az(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["config"]);return o!=null&&sz(o,i),i}function lz(n,e,t){const i={},r=p(n,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);const o=p(n,["safetyFilterLevel"]);e!==void 0&&o!=null&&g(e,["parameters","safetySetting"],o);const l=p(n,["personGeneration"]);e!==void 0&&l!=null&&g(e,["parameters","personGeneration"],l);const c=p(n,["includeRaiReason"]);e!==void 0&&c!=null&&g(e,["parameters","includeRaiReason"],c);const d=p(n,["outputMimeType"]);e!==void 0&&d!=null&&g(e,["parameters","outputOptions","mimeType"],d);const f=p(n,["outputCompressionQuality"]);e!==void 0&&f!=null&&g(e,["parameters","outputOptions","compressionQuality"],f);const m=p(n,["enhanceInputImage"]);e!==void 0&&m!=null&&g(e,["parameters","upscaleConfig","enhanceInputImage"],m);const v=p(n,["imagePreservationFactor"]);e!==void 0&&v!=null&&g(e,["parameters","upscaleConfig","imagePreservationFactor"],v);const E=p(n,["labels"]);e!==void 0&&E!=null&&g(e,["labels"],E);const b=p(n,["numberOfImages"]);e!==void 0&&b!=null&&g(e,["parameters","sampleCount"],b);const I=p(n,["mode"]);return e!==void 0&&I!=null&&g(e,["parameters","mode"],I),i}function uz(n,e,t){const i={},r=p(e,["model"]);r!=null&&g(i,["_url","model"],Dt(n,r));const o=p(e,["image"]);o!=null&&g(i,["instances[0]","image"],or(o));const l=p(e,["upscaleFactor"]);l!=null&&g(i,["parameters","upscaleConfig","upscaleFactor"],l);const c=p(e,["config"]);return c!=null&&lz(c,i),i}function cz(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>rm(l))),g(t,["generatedImages"],o)}return t}function dz(n,e){const t={},i=p(n,["uri"]);i!=null&&g(t,["uri"],i);const r=p(n,["encodedVideo"]);r!=null&&g(t,["videoBytes"],Co(r));const o=p(n,["encoding"]);return o!=null&&g(t,["mimeType"],o),t}function fz(n,e){const t={},i=p(n,["gcsUri"]);i!=null&&g(t,["uri"],i);const r=p(n,["bytesBase64Encoded"]);r!=null&&g(t,["videoBytes"],Co(r));const o=p(n,["mimeType"]);return o!=null&&g(t,["mimeType"],o),t}function hz(n,e){const t={},i=p(n,["image"]);i!=null&&g(t,["_self"],or(i));const r=p(n,["maskMode"]);return r!=null&&g(t,["maskMode"],r),t}function pz(n,e){const t={},i=p(n,["image"]);i!=null&&g(t,["image"],sm(i));const r=p(n,["referenceType"]);return r!=null&&g(t,["referenceType"],r),t}function mz(n,e){const t={},i=p(n,["image"]);i!=null&&g(t,["image"],or(i));const r=p(n,["referenceType"]);return r!=null&&g(t,["referenceType"],r),t}function eN(n,e){const t={},i=p(n,["uri"]);i!=null&&g(t,["uri"],i);const r=p(n,["videoBytes"]);r!=null&&g(t,["encodedVideo"],Co(r));const o=p(n,["mimeType"]);return o!=null&&g(t,["encoding"],o),t}function tN(n,e){const t={},i=p(n,["uri"]);i!=null&&g(t,["gcsUri"],i);const r=p(n,["videoBytes"]);r!=null&&g(t,["bytesBase64Encoded"],Co(r));const o=p(n,["mimeType"]);return o!=null&&g(t,["mimeType"],o),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gz(n,e){const t={},i=p(n,["displayName"]);return e!==void 0&&i!=null&&g(e,["displayName"],i),t}function yz(n){const e={},t=p(n,["config"]);return t!=null&&gz(t,e),e}function _z(n,e){const t={},i=p(n,["force"]);return e!==void 0&&i!=null&&g(e,["_query","force"],i),t}function vz(n){const e={},t=p(n,["name"]);t!=null&&g(e,["_url","name"],t);const i=p(n,["config"]);return i!=null&&_z(i,e),e}function Ez(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function Tz(n,e){const t={},i=p(n,["customMetadata"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["customMetadata"],o)}const r=p(n,["chunkingConfig"]);return e!==void 0&&r!=null&&g(e,["chunkingConfig"],r),t}function bz(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=p(n,["done"]);r!=null&&g(e,["done"],r);const o=p(n,["error"]);o!=null&&g(e,["error"],o);const l=p(n,["response"]);return l!=null&&g(e,["response"],wz(l)),e}function Sz(n){const e={},t=p(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);const i=p(n,["fileName"]);i!=null&&g(e,["fileName"],i);const r=p(n,["config"]);return r!=null&&Tz(r,e),e}function wz(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["parent"]);i!=null&&g(e,["parent"],i);const r=p(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function xz(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function Az(n){const e={},t=p(n,["config"]);return t!=null&&xz(t,e),e}function Iz(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=p(n,["fileSearchStores"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["fileSearchStores"],o)}return e}function nN(n,e){const t={},i=p(n,["mimeType"]);e!==void 0&&i!=null&&g(e,["mimeType"],i);const r=p(n,["displayName"]);e!==void 0&&r!=null&&g(e,["displayName"],r);const o=p(n,["customMetadata"]);if(e!==void 0&&o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>d)),g(e,["customMetadata"],c)}const l=p(n,["chunkingConfig"]);return e!==void 0&&l!=null&&g(e,["chunkingConfig"],l),t}function Cz(n){const e={},t=p(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);const i=p(n,["config"]);return i!=null&&nN(i,e),e}function Rz(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Nz="Content-Type",kz="X-Server-Timeout",Mz="User-Agent",k_="x-goog-api-client",Dz="1.41.0",Pz=`google-genai-sdk/${Dz}`,Oz="v1beta1",Vz="v1beta",Uz=5,Lz=[408,429,500,502,503,504];class Bz{constructor(e){var t,i,r;this.clientOptions=Object.assign({},e),this.customBaseUrl=(t=e.httpOptions)===null||t===void 0?void 0:t.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const o={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const c=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!c?(o.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?o.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(o.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:Oz}else{if(!this.clientOptions.apiKey)throw new Td({message:"API key must be set when using the Gemini API.",status:403});o.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:Vz,o.baseUrl="https://generativelanguage.googleapis.com/"}o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e,t){return!(t.baseUrl&&t.baseUrlResourceScope===x_.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))r.searchParams.append(l,String(c));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,r.toString(),e.abortSignal),this.unaryApiCall(r,o,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[r,o]of Object.entries(t))typeof o=="object"?i[r]=Object.assign(Object.assign({},i[r]),o):o!==void 0&&(i[r]=o);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,r.toString(),e.abortSignal),this.streamApiCall(r,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,r){if(t&&t.timeout||r){const o=new AbortController,l=o.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const c=setTimeout(()=>o.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}r&&r.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&Fz(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await EA(r),new A_(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await EA(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){return rr(this,arguments,function*(){var i;const r=(i=e==null?void 0:e.body)===null||i===void 0?void 0:i.getReader(),o=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let l="";const c="data:",d=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:f,value:m}=yield lt(r.read());if(f){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const v=o.decode(m,{stream:!0});try{const I=JSON.parse(v);if("error"in I){const x=JSON.parse(JSON.stringify(I.error)),A=x.status,N=x.code,U=`got status: ${A}. ${JSON.stringify(I)}`;if(N>=400&&N<600)throw new Td({message:U,status:N})}}catch(I){if(I.name==="ApiError")throw I}l+=v;let E=-1,b=0;for(;;){E=-1,b=0;for(const A of d){const N=l.indexOf(A);N!==-1&&(E===-1||N<E)&&(E=N,b=A.length)}if(E===-1)break;const I=l.substring(0,E);l=l.substring(E+b);const x=I.trim();if(x.startsWith(c)){const A=x.substring(c.length).trim();try{const N=new Response(A,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield lt(new A_(N))}catch(N){throw new Error(`exception parsing stream chunk ${A}. ${N}`)}}}}}finally{r.releaseLock()}})}async apiCall(e,t){var i;if(!this.clientOptions.httpOptions||!this.clientOptions.httpOptions.retryOptions)return fetch(e,t);const r=this.clientOptions.httpOptions.retryOptions;return R4(async()=>{const l=await fetch(e,t);if(l.ok)return l;throw Lz.includes(l.status)?new Error(`Retryable HTTP Error: ${l.statusText}`):new PR(`Non-retryable exception ${l.statusText} sending request`)},{retries:((i=r.attempts)!==null&&i!==void 0?i:Uz)-1})}getDefaultHeaders(){const e={},t=Pz+" "+this.clientOptions.userAgentExtra;return e[Mz]=t,e[k_]=t,e[Nz]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[r,o]of Object.entries(e.headers))i.append(r,o);e.timeout&&e.timeout>0&&i.append(kz,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const o=this.clientOptions.uploader,l=await o.stat(e);r.sizeBytes=String(l.size);const c=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=c;const d={file:r},f=this.getFileName(e),m=qe("upload/v1beta/files",d._url),v=await this.fetchUploadUrl(m,r.sizeBytes,r.mimeType,f,d,t==null?void 0:t.httpOptions);return o.upload(e,v,this)}async uploadFileToFileSearchStore(e,t,i){var r;const o=this.clientOptions.uploader,l=await o.stat(t),c=String(l.size),d=(r=i==null?void 0:i.mimeType)!==null&&r!==void 0?r:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const f=`upload/v1beta/${e}:uploadToFileSearchStore`,m=this.getFileName(t),v={};i!=null&&nN(i,v);const E=await this.fetchUploadUrl(f,c,d,m,v,i==null?void 0:i.httpOptions);return o.uploadToFileSearchStore(t,E,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,r,o,l){var c;let d={};l?d=l:d={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};const f=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:d});if(!f||!(f!=null&&f.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const m=(c=f==null?void 0:f.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(m===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return m}}async function EA(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(i);throw t>=400&&t<600?new Td({message:r,status:t}):new Error(r)}}function Fz(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const o=JSON.parse(n.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(o,l){const c=Object.assign({},o);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const f=l[d],m=c[d];f&&typeof f=="object"&&!Array.isArray(f)&&m&&typeof m=="object"&&!Array.isArray(m)?c[d]=i(m,f):(m&&f&&typeof m!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof m}, New type: ${typeof f}. Overwriting.`),c[d]=f)}return c}const r=i(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zz="mcp_used/unknown";let Gz=!1;function iN(n){for(const e of n)if(qz(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Gz}function rN(n){var e;const t=(e=n[k_])!==null&&e!==void 0?e:"";n[k_]=(t+` ${zz}`).trimStart()}function qz(n){return n!==null&&typeof n=="object"&&n instanceof r0}function Hz(n){return rr(this,arguments,function*(t,i=100){let r,o=0;for(;o<i;){const l=yield lt(t.listTools({cursor:r}));for(const c of l.tools)yield yield lt(c),o++;if(!l.nextCursor)break;r=l.nextCursor}})}class r0{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new r0(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;const o={},l=[];for(const m of this.mcpClients)try{for(var c=!0,d=(t=void 0,sr(Hz(m))),f;f=await d.next(),e=f.done,!e;c=!0){r=f.value,c=!1;const v=r;l.push(v);const E=v.name;if(o[E])throw new Error(`Duplicate function name ${E} found in MCP tools. Please ensure function names are unique.`);o[E]=m}}catch(v){t={error:v}}finally{try{!c&&!e&&(i=d.return)&&await i.call(d)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),y3(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const l=await r.callTool({name:i.name,arguments:i.args},void 0,o);t.push({functionResponse:{name:i.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function $z(n,e,t){const i=new u3;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(i,r),e(i)}class jz{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),l=Yz(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),d=`${r}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${c}`;let f=()=>{};const m=new Promise(L=>{f=L}),v=e.callbacks,E=function(){f({})},b=this.apiClient,I={onopen:E,onmessage:L=>{$z(b,v.onmessage,L)},onerror:(t=v==null?void 0:v.onerror)!==null&&t!==void 0?t:function(L){},onclose:(i=v==null?void 0:v.onclose)!==null&&i!==void 0?i:function(L){}},x=this.webSocketFactory.create(d,Jz(l),I);x.connect(),await m;const U={setup:{model:Dt(this.apiClient,e.model)}};return x.send(JSON.stringify(U)),new Kz(x,this.apiClient)}}class Kz{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=gB(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=mB(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Ll.PLAY)}pause(){this.sendPlaybackControl(Ll.PAUSE)}stop(){this.sendPlaybackControl(Ll.STOP)}resetContext(){this.sendPlaybackControl(Ll.RESET_CONTEXT)}close(){this.conn.close()}}function Jz(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function Yz(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Wz="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Qz(n,e,t){const i=new l3;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const o=JSON.parse(r);if(n.isVertexAI()){const l=vB(o);Object.assign(i,l)}else Object.assign(i,o);e(i)}class Xz{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new jz(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,o,l,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let m;const v=this.apiClient.getHeaders();e.config&&e.config.tools&&iN(e.config.tools)&&rN(v);const E=nG(v);if(this.apiClient.isVertexAI()){const D=this.apiClient.getProject(),z=this.apiClient.getLocation(),G=this.apiClient.getApiKey(),M=!!D&&!!z||!!G;this.apiClient.getCustomBaseUrl()&&!M?m=d:(m=`${d}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(E,m))}else{const D=this.apiClient.getApiKey();let z="BidiGenerateContent",G="key";D!=null&&D.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),f!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),z="BidiGenerateContentConstrained",G="access_token"),m=`${d}/ws/google.ai.generativelanguage.${f}.GenerativeService.${z}?${G}=${D}`}let b=()=>{};const I=new Promise(D=>{b=D}),x=e.callbacks,A=function(){var D;(D=x==null?void 0:x.onopen)===null||D===void 0||D.call(x),b({})},N=this.apiClient,U={onopen:A,onmessage:D=>{Qz(N,x.onmessage,D)},onerror:(t=x==null?void 0:x.onerror)!==null&&t!==void 0?t:function(D){},onclose:(i=x==null?void 0:x.onclose)!==null&&i!==void 0?i:function(D){}},L=this.webSocketFactory.create(m,tG(E),U);L.connect(),await I;let $=Dt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&$.startsWith("publishers/")){const D=this.apiClient.getProject(),z=this.apiClient.getLocation();D&&z&&($=`projects/${D}/locations/${z}/`+$)}let K={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[yp.AUDIO]}:e.config.responseModalities=[yp.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const j=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],k=[];for(const D of j)if(this.isCallableTool(D)){const z=D;k.push(await z.tool())}else k.push(D);k.length>0&&(e.config.tools=k);const V={model:$,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?K=pB(this.apiClient,V):K=hB(this.apiClient,V),delete K.config,L.send(JSON.stringify(K)),new eG(L,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Zz={turnComplete:!0};class eG{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Li(t.turns),e.isVertexAI()||(i=i.map(r=>im(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const o of i){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(Wz)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},Zz),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:_B(e)}:t={realtimeInput:yB(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function tG(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function nG(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const TA=10;function bA(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const l of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(jl(l)){r=!0;break}if(!r)return!0;const o=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function jl(n){return"callTool"in n&&typeof n.callTool=="function"}function iG(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>jl(r)))!==null&&i!==void 0?i:!1}function SA(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,r)=>{if(jl(i))return;const o=i;o.functionDeclarations&&o.functionDeclarations.length>0&&t.push(r)}),t}function wA(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rG extends ms{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,o,l,c;const d=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!iG(t)||bA(t.config))return await this.generateContentInternal(d);const f=SA(t);if(f.length>0){const x=f.map(A=>`tools[${A}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${x}.`)}let m,v;const E=Li(d.contents),b=(o=(r=(i=d.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&o!==void 0?o:TA;let I=0;for(;I<b&&(m=await this.generateContentInternal(d),!(!m.functionCalls||m.functionCalls.length===0));){const x=m.candidates[0].content,A=[];for(const N of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(jl(N)){const L=await N.callTool(m.functionCalls);A.push(...L)}I++,v={role:"user",parts:A},d.contents=Li(d.contents),d.contents.push(x),d.contents.push(v),wA(d.config)&&(E.push(x),E.push(v))}return wA(d.config)&&(m.automaticFunctionCallingHistory=E),m},this.generateContentStream=async t=>{var i,r,o,l,c;if(this.maybeMoveToResponseJsonSchem(t),bA(t.config)){const v=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(v)}const d=SA(t);if(d.length>0){const v=d.map(E=>`tools[${E}]`).join(", ");throw new Error(`Incompatible tools found at ${v}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const f=(o=(r=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,m=(c=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(f&&!m)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let o;const l=[];if(i!=null&&i.generatedImages)for(const d of i.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((r=d==null?void 0:d.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?o=d==null?void 0:d.safetyAttributes:l.push(d);let c;return o?c={generatedImages:l,positivePromptSafetyAttributes:o,sdkHttpResponse:i.sdkHttpResponse}:c={generatedImages:l,sdkHttpResponse:i.sdkHttpResponse},c}),this.list=async t=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Oa(cs.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{var i,r,o,l,c,d;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((r=t.video)===null||r===void 0)&&r.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(o=t.source)===null||o===void 0?void 0:o.video)===null||l===void 0)&&l.uri&&(!((d=(c=t.source)===null||c===void 0?void 0:c.video)===null||d===void 0)&&d.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;const o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;const l=await Promise.all(o.map(async d=>jl(d)?await d.tool():d)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&iN(e.config.tools)){const d=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let f=Object.assign({},d);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),rN(f),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return c}async initAfcToolsMap(e){var t,i,r;const o=new Map;for(const l of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(jl(l)){const c=l,d=await c.tool();for(const f of(r=d.functionDeclarations)!==null&&r!==void 0?r:[]){if(!f.name)throw new Error("Function declaration name is required.");if(o.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);o.set(f.name,c)}}return o}async processAfcStream(e){var t,i,r;const o=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:TA;let l=!1,c=0;const d=await this.initAfcToolsMap(e);return(function(f,m,v){return rr(this,arguments,function*(){for(var E,b,I,x,A,N;c<o;){l&&(c++,l=!1);const K=yield lt(f.processParamsMaybeAddMcpUsage(v)),j=yield lt(f.generateContentStreamInternal(K)),k=[],V=[];try{for(var U=!0,L=(b=void 0,sr(j)),$;$=yield lt(L.next()),E=$.done,!E;U=!0){x=$.value,U=!1;const D=x;if(yield yield lt(D),D.candidates&&(!((A=D.candidates[0])===null||A===void 0)&&A.content)){V.push(D.candidates[0].content);for(const z of(N=D.candidates[0].content.parts)!==null&&N!==void 0?N:[])if(c<o&&z.functionCall){if(!z.functionCall.name)throw new Error("Function call name was not returned by the model.");if(m.has(z.functionCall.name)){const G=yield lt(m.get(z.functionCall.name).callTool([z.functionCall]));k.push(...G)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${m.keys()}, mising tool: ${z.functionCall.name}`)}}}}catch(D){b={error:D}}finally{try{!U&&!E&&(I=L.return)&&(yield lt(I.call(L)))}finally{if(b)throw b.error}}if(k.length>0){l=!0;const D=new Mc;D.candidates=[{content:{role:"user",parts:k}}],yield yield lt(D);const z=[];z.push(...V),z.push({role:"user",parts:k});const G=Li(v.contents).concat(z);v.contents=G}else break}})})(this,d,e)}async generateContentInternal(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=yA(this.apiClient,e);return c=qe("{model}:generateContent",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=vA(m),E=new Mc;return Object.assign(E,v),E})}else{const f=gA(this.apiClient,e);return c=qe("{model}:generateContent",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=_A(m),E=new Mc;return Object.assign(E,v),E})}}async generateContentStreamInternal(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=yA(this.apiClient,e);return c=qe("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(v){return rr(this,arguments,function*(){var E,b,I,x;try{for(var A=!0,N=sr(v),U;U=yield lt(N.next()),E=U.done,!E;A=!0){x=U.value,A=!1;const L=x,$=vA(yield lt(L.json()),e);$.sdkHttpResponse={headers:L.headers};const K=new Mc;Object.assign(K,$),yield yield lt(K)}}catch(L){b={error:L}}finally{try{!A&&!E&&(I=N.return)&&(yield lt(I.call(N)))}finally{if(b)throw b.error}}})})}else{const f=gA(this.apiClient,e);return c=qe("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(v){return rr(this,arguments,function*(){var E,b,I,x;try{for(var A=!0,N=sr(v),U;U=yield lt(N.next()),E=U.done,!E;A=!0){x=U.value,A=!1;const L=x,$=_A(yield lt(L.json()),e);$.sdkHttpResponse={headers:L.headers};const K=new Mc;Object.assign(K,$),yield yield lt(K)}}catch(L){b={error:L}}finally{try{!A&&!E&&(I=N.return)&&(yield lt(I.call(N)))}finally{if(b)throw b.error}}})})}}async embedContent(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=WB(this.apiClient,e);return c=qe("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=XB(m),E=new Zx;return Object.assign(E,v),E})}else{const f=YB(this.apiClient,e);return c=qe("{model}:batchEmbedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=QB(m),E=new Zx;return Object.assign(E,v),E})}}async generateImagesInternal(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=uF(this.apiClient,e);return c=qe("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=dF(m),E=new eA;return Object.assign(E,v),E})}else{const f=lF(this.apiClient,e);return c=qe("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=cF(m),E=new eA;return Object.assign(E,v),E})}}async editImageInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI()){const c=$B(this.apiClient,e);return o=qe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>{const f=jB(d),m=new W4;return Object.assign(m,f),m})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI()){const c=uz(this.apiClient,e);return o=qe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>{const f=cz(d),m=new Q4;return Object.assign(m,f),m})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI()){const c=HF(this.apiClient,e);return o=qe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const f=$F(d),m=new X4;return Object.assign(m,f),m})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI()){const c=QF(this.apiClient,e);return o=qe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const f=XF(d),m=new Z4;return Object.assign(m,f),m})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=CF(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),l.then(m=>N_(m))}else{const f=IF(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>R_(m))}}async listInternal(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=UF(this.apiClient,e);return c=qe("{models_url}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=BF(m),E=new tA;return Object.assign(E,v),E})}else{const f=VF(this.apiClient,e);return c=qe("{models_url}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=LF(m),E=new tA;return Object.assign(E,v),E})}}async update(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=az(this.apiClient,e);return c=qe("{model}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),l.then(m=>N_(m))}else{const f=oz(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>R_(m))}}async delete(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=zB(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=qB(m),E=new nA;return Object.assign(E,v),E})}else{const f=FB(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=GB(m),E=new nA;return Object.assign(E,v),E})}}async countTokens(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=UB(this.apiClient,e);return c=qe("{model}:countTokens",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=BB(m),E=new iA;return Object.assign(E,v),E})}else{const f=VB(this.apiClient,e);return c=qe("{model}:countTokens",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=LB(m),E=new iA;return Object.assign(E,v),E})}}async computeTokens(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI()){const c=RB(this.apiClient,e);return o=qe("{model}:computeTokens",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>{const f=NB(d),m=new e3;return Object.assign(m,f),m})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=yF(this.apiClient,e);return c=qe("{model}:predictLongRunning",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),l.then(m=>{const v=mF(m),E=new _p;return Object.assign(E,v),E})}else{const f=gF(this.apiClient,e);return c=qe("{model}:predictLongRunning",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>{const v=pF(m),E=new _p;return Object.assign(E,v),E})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sG extends ms{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let o;i&&"httpOptions"in i&&(o=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let o;i&&"httpOptions"in i&&(o=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=H4(e);return c=qe("{operationName}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),l}else{const f=q4(e);return c=qe("{operationName}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l}}async fetchPredictVideosOperationInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI()){const c=V4(e);return o=qe("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oG(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function aG(n){const e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>gG(o))),g(e,["parts"],r)}const i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function lG(n,e,t){const i={},r=p(e,["expireTime"]);t!==void 0&&r!=null&&g(t,["expireTime"],r);const o=p(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&g(t,["newSessionExpireTime"],o);const l=p(e,["uses"]);t!==void 0&&l!=null&&g(t,["uses"],l);const c=p(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&g(t,["bidiGenerateContentSetup"],mG(n,c));const d=p(e,["lockAdditionalFields"]);return t!==void 0&&d!=null&&g(t,["fieldMask"],d),i}function uG(n,e){const t={},i=p(e,["config"]);return i!=null&&g(t,["config"],lG(n,i,t)),t}function cG(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function dG(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const i=p(n,["args"]);i!=null&&g(e,["args"],i);const r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function fG(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function hG(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function pG(n,e){const t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],i);const r=p(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);const o=p(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);const l=p(n,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const c=p(n,["topK"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","topK"],c);const d=p(n,["maxOutputTokens"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","maxOutputTokens"],d);const f=p(n,["mediaResolution"]);e!==void 0&&f!=null&&g(e,["setup","generationConfig","mediaResolution"],f);const m=p(n,["seed"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","seed"],m);const v=p(n,["speechConfig"]);e!==void 0&&v!=null&&g(e,["setup","generationConfig","speechConfig"],i0(v));const E=p(n,["thinkingConfig"]);e!==void 0&&E!=null&&g(e,["setup","generationConfig","thinkingConfig"],E);const b=p(n,["enableAffectiveDialog"]);e!==void 0&&b!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],b);const I=p(n,["systemInstruction"]);e!==void 0&&I!=null&&g(e,["setup","systemInstruction"],aG(jn(I)));const x=p(n,["tools"]);if(e!==void 0&&x!=null){let j=Su(x);Array.isArray(j)&&(j=j.map(k=>_G(bu(k)))),g(e,["setup","tools"],j)}const A=p(n,["sessionResumption"]);e!==void 0&&A!=null&&g(e,["setup","sessionResumption"],yG(A));const N=p(n,["inputAudioTranscription"]);e!==void 0&&N!=null&&g(e,["setup","inputAudioTranscription"],N);const U=p(n,["outputAudioTranscription"]);e!==void 0&&U!=null&&g(e,["setup","outputAudioTranscription"],U);const L=p(n,["realtimeInputConfig"]);e!==void 0&&L!=null&&g(e,["setup","realtimeInputConfig"],L);const $=p(n,["contextWindowCompression"]);e!==void 0&&$!=null&&g(e,["setup","contextWindowCompression"],$);const K=p(n,["proactivity"]);if(e!==void 0&&K!=null&&g(e,["setup","proactivity"],K),p(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function mG(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],Dt(n,i));const r=p(e,["config"]);return r!=null&&g(t,["config"],pG(r,t)),t}function gG(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);const o=p(n,["fileData"]);o!=null&&g(e,["fileData"],cG(o));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],dG(l));const c=p(n,["functionResponse"]);c!=null&&g(e,["functionResponse"],c);const d=p(n,["inlineData"]);d!=null&&g(e,["inlineData"],oG(d));const f=p(n,["text"]);f!=null&&g(e,["text"],f);const m=p(n,["thought"]);m!=null&&g(e,["thought"],m);const v=p(n,["thoughtSignature"]);v!=null&&g(e,["thoughtSignature"],v);const E=p(n,["videoMetadata"]);return E!=null&&g(e,["videoMetadata"],E),e}function yG(n){const e={},t=p(n,["handle"]);if(t!=null&&g(e,["handle"],t),p(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function _G(n){const e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);const i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(n,["functionDeclarations"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(v=>v)),g(e,["functionDeclarations"],m)}const l=p(n,["googleMaps"]);l!=null&&g(e,["googleMaps"],fG(l));const c=p(n,["googleSearch"]);c!=null&&g(e,["googleSearch"],hG(c));const d=p(n,["googleSearchRetrieval"]);d!=null&&g(e,["googleSearchRetrieval"],d);const f=p(n,["urlContext"]);return f!=null&&g(e,["urlContext"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vG(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(o=>`${t}.${o}`);e.push(...r)}else e.push(t)}return e.join(",")}function EG(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const o=i.setup;typeof o=="object"&&o!==null?(n.bidiGenerateContentSetup=o,t=o):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const o=vG(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?n.fieldMask=o:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];r.length>0&&(c=r.map(f=>l.includes(f)?`generationConfig.${f}`:f));const d=[];o&&d.push(o),c.length>0&&d.push(...c),d.length>0?n.fieldMask=d.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class TG extends ms{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=uG(this.apiClient,e);o=qe("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const d=EG(c,e.config);return r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>f)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bG(n,e){const t={},i=p(n,["force"]);return e!==void 0&&i!=null&&g(e,["_query","force"],i),t}function SG(n){const e={},t=p(n,["name"]);t!=null&&g(e,["_url","name"],t);const i=p(n,["config"]);return i!=null&&bG(i,e),e}function wG(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function xG(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function AG(n){const e={},t=p(n,["parent"]);t!=null&&g(e,["_url","parent"],t);const i=p(n,["config"]);return i!=null&&xG(i,e),e}function IG(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=p(n,["documents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["documents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CG extends ms{constructor(e){super(),this.apiClient=e,this.list=async t=>new Oa(cs.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=wG(e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var t,i;let r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=SG(e);r=qe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=AG(e);return o=qe("{parent}/documents",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const f=IG(d),m=new t3;return Object.assign(m,f),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RG extends ms{constructor(e,t=new CG(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new Oa(cs.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=yz(e);return o=qe("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async get(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Ez(e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var t,i;let r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=vz(e);r=qe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Az(e);return o=qe("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const f=Iz(d),m=new n3;return Object.assign(m,f),m})}}async uploadToFileSearchStoreInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Cz(e);return o=qe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const f=Rz(d),m=new i3;return Object.assign(m,f),m})}}async importFile(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Sz(e);return o=qe("{file_search_store_name}:importFile",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const f=bz(d),m=new Xv;return Object.assign(m,f),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let sN=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return sN=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^t()&15>>+i/4).toString(16))};const NG=()=>sN();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function M_(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const D_=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fi extends Error{}class Xn extends Fi{constructor(e,t,i,r){super(`${Xn.makeMessage(e,t,i)}`),this.status=e,this.headers=r,this.error=t}static makeMessage(e,t,i){const r=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):i;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,i,r){if(!e||!r)return new om({message:i,cause:D_(t)});const o=t;return e===400?new aN(e,o,i,r):e===401?new lN(e,o,i,r):e===403?new uN(e,o,i,r):e===404?new cN(e,o,i,r):e===409?new dN(e,o,i,r):e===422?new fN(e,o,i,r):e===429?new hN(e,o,i,r):e>=500?new pN(e,o,i,r):new Xn(e,o,i,r)}}class P_ extends Xn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class om extends Xn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class oN extends om{constructor({message:e}={}){super({message:e??"Request timed out."})}}class aN extends Xn{}class lN extends Xn{}class uN extends Xn{}class cN extends Xn{}class dN extends Xn{}class fN extends Xn{}class hN extends Xn{}class pN extends Xn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kG=/^[a-z][a-z0-9+.-]*:/i,MG=n=>kG.test(n);let O_=n=>(O_=Array.isArray,O_(n));const DG=O_;let PG=DG;const xA=PG;function OG(n){if(!n)return!0;for(const e in n)return!1;return!0}function VG(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const UG=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Fi(`${n} must be an integer`);if(e<0)throw new Fi(`${n} must be a positive integer`);return e},LG=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const BG=n=>new Promise(e=>setTimeout(e,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vl="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FG(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const zG=()=>{var n,e,t,i,r;const o=FG();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Vl,"X-Stainless-OS":IA(Deno.build.os),"X-Stainless-Arch":AA(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Vl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Vl,"X-Stainless-OS":IA((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":AA((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(r=globalThis.process.version)!==null&&r!==void 0?r:"unknown"};const l=GG();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Vl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Vl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function GG(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const i=t.exec(navigator.userAgent);if(i){const r=i[1]||0,o=i[2]||0,l=i[3]||0;return{browser:e,version:`${r}.${o}.${l}`}}}return null}const AA=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",IA=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let yh;const qG=()=>yh??(yh=zG());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HG(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function mN(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function $G(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return mN({start(){},async pull(t){const{done:i,value:r}=await e.next();i?t.close():t.enqueue(r)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function gN(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function jG(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const i=n.getReader(),r=i.cancel();i.releaseLock(),await r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KG=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yN=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e==null?void 0:e.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function ky(n,e,t){return yN(),new File(n,e??"unknown_file",t)}function JG(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const YG=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _N=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",WG=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&_N(n),QG=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function XG(n,e,t){if(yN(),n=await n,WG(n))return n instanceof File?n:ky([await n.arrayBuffer()],n.name);if(QG(n)){const r=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),ky(await V_(r),e,t)}const i=await V_(n);if(e||(e=JG(n)),!(t!=null&&t.type)){const r=i.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof r=="string"&&(t=Object.assign(Object.assign({},t),{type:r}))}return ky(i,e,t)}async function V_(n){var e,t,i,r,o;let l=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)l.push(n);else if(_N(n))l.push(n instanceof Blob?n:await n.arrayBuffer());else if(YG(n))try{for(var c=!0,d=sr(n),f;f=await d.next(),e=f.done,!e;c=!0){r=f.value,c=!1;const m=r;l.push(...await V_(m))}}catch(m){t={error:m}}finally{try{!c&&!e&&(i=d.return)&&await i.call(d)}finally{if(t)throw t.error}}else{const m=(o=n==null?void 0:n.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof n}${m?`; constructor: ${m}`:""}${ZG(n)}`)}return l}function ZG(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vN{constructor(e){this._client=e}}vN._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function EN(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const CA=Object.freeze(Object.create(null)),e8=(n=EN)=>(function(t,...i){if(t.length===1)return t[0];let r=!1;const o=[],l=t.reduce((m,v,E)=>{var b,I,x;/[?#]/.test(v)&&(r=!0);const A=i[E];let N=(r?encodeURIComponent:n)(""+A);return E!==i.length&&(A==null||typeof A=="object"&&A.toString===((x=Object.getPrototypeOf((I=Object.getPrototypeOf((b=A.hasOwnProperty)!==null&&b!==void 0?b:CA))!==null&&I!==void 0?I:CA))===null||x===void 0?void 0:x.toString))&&(N=A+"",o.push({start:m.length+v.length,length:N.length,error:`Value of type ${Object.prototype.toString.call(A).slice(8,-1)} is not a valid path parameter`})),m+v+(E===i.length?"":N)},""),c=l.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=d.exec(c))!==null;)o.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(o.sort((m,v)=>m.start-v.start),o.length>0){let m=0;const v=o.reduce((E,b)=>{const I=" ".repeat(b.start-m),x="^".repeat(b.length);return m=b.start+b.length,E+I+x},"");throw new Fi(`Path parameters result in path with invalid segments:
${o.map(E=>E.error).join(`
`)}
${l}
${v}`)}return l}),_h=e8(EN);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class TN extends vN{create(e,t){var i;const{api_version:r=this._client.apiVersion}=e,o=Ep(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new Fi("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new Fi("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(_h`/${r}/interactions`,Object.assign(Object.assign({body:o},t),{stream:(i=e.stream)!==null&&i!==void 0?i:!1}))}delete(e,t={},i){const{api_version:r=this._client.apiVersion}=t??{};return this._client.delete(_h`/${r}/interactions/${e}`,i)}cancel(e,t={},i){const{api_version:r=this._client.apiVersion}=t??{};return this._client.post(_h`/${r}/interactions/${e}/cancel`,i)}get(e,t={},i){var r;const o=t??{},{api_version:l=this._client.apiVersion}=o,c=Ep(o,["api_version"]);return this._client.get(_h`/${l}/interactions/${e}`,Object.assign(Object.assign({query:c},i),{stream:(r=t==null?void 0:t.stream)!==null&&r!==void 0?r:!1}))}}TN._key=Object.freeze(["interactions"]);class bN extends TN{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function t8(n){let e=0;for(const r of n)e+=r.length;const t=new Uint8Array(e);let i=0;for(const r of n)t.set(r,i),i+=r.length;return t}let vh;function s0(n){let e;return(vh??(e=new globalThis.TextEncoder,vh=e.encode.bind(e)))(n)}let Eh;function RA(n){let e;return(Eh??(e=new globalThis.TextDecoder,Eh=e.decode.bind(e)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class am{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?s0(e):e;this.buffer=t8([this.buffer,t]);const i=[];let r;for(;(r=n8(this.buffer,this.carriageReturnIndex))!=null;){if(r.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=r.index;continue}if(this.carriageReturnIndex!=null&&(r.index!==this.carriageReturnIndex+1||r.carriage)){i.push(RA(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const o=this.carriageReturnIndex!==null?r.preceding-1:r.preceding,l=RA(this.buffer.subarray(0,o));i.push(l),this.buffer=this.buffer.subarray(r.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}am.NEWLINE_CHARS=new Set([`
`,"\r"]);am.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function n8(n,e){for(let r=e??0;r<n.length;r++){if(n[r]===10)return{preceding:r,index:r+1,carriage:!1};if(n[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function i8(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Tp={off:0,error:200,warn:300,info:400,debug:500},NA=(n,e,t)=>{if(n){if(VG(Tp,n))return n;Wn(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Tp))}`)}};function qc(){}function Th(n,e,t){return!e||Tp[n]>Tp[t]?qc:e[n].bind(e)}const r8={error:qc,warn:qc,info:qc,debug:qc};let kA=new WeakMap;function Wn(n){var e;const t=n.logger,i=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return r8;const r=kA.get(t);if(r&&r[0]===i)return r[1];const o={error:Th("error",t,i),warn:Th("warn",t,i),info:Th("info",t,i),debug:Th("debug",t,i)};return kA.set(t,[i,o]),o}const sa=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Bl{constructor(e,t,i){this.iterator=e,this.controller=t,this.client=i}static fromSSEResponse(e,t,i){let r=!1;const o=i?Wn(i):console;function l(){return rr(this,arguments,function*(){var d,f,m,v;if(r)throw new Fi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let E=!1;try{try{for(var b=!0,I=sr(s8(e,t)),x;x=yield lt(I.next()),d=x.done,!d;b=!0){v=x.value,b=!1;const A=v;if(!E)if(A.data.startsWith("[DONE]")){E=!0;continue}else try{yield yield lt(JSON.parse(A.data))}catch(N){throw o.error("Could not parse message into JSON:",A.data),o.error("From chunk:",A.raw),N}}}catch(A){f={error:A}}finally{try{!b&&!d&&(m=I.return)&&(yield lt(m.call(I)))}finally{if(f)throw f.error}}E=!0}catch(A){if(M_(A))return yield lt(void 0);throw A}finally{E||t.abort()}})}return new Bl(l,t,i)}static fromReadableStream(e,t,i){let r=!1;function o(){return rr(this,arguments,function*(){var d,f,m,v;const E=new am,b=gN(e);try{for(var I=!0,x=sr(b),A;A=yield lt(x.next()),d=A.done,!d;I=!0){v=A.value,I=!1;const N=v;for(const U of E.decode(N))yield yield lt(U)}}catch(N){f={error:N}}finally{try{!I&&!d&&(m=x.return)&&(yield lt(m.call(x)))}finally{if(f)throw f.error}}for(const N of E.flush())yield yield lt(N)})}function l(){return rr(this,arguments,function*(){var d,f,m,v;if(r)throw new Fi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let E=!1;try{try{for(var b=!0,I=sr(o()),x;x=yield lt(I.next()),d=x.done,!d;b=!0){v=x.value,b=!1;const A=v;E||A&&(yield yield lt(JSON.parse(A)))}}catch(A){f={error:A}}finally{try{!b&&!d&&(m=I.return)&&(yield lt(m.call(I)))}finally{if(f)throw f.error}}E=!0}catch(A){if(M_(A))return yield lt(void 0);throw A}finally{E||t.abort()}})}return new Bl(l,t,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],i=this.iterator(),r=o=>({next:()=>{if(o.length===0){const l=i.next();e.push(l),t.push(l)}return o.shift()}});return[new Bl(()=>r(e),this.controller,this.client),new Bl(()=>r(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return mN({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{const{value:r,done:o}=await t.next();if(o)return i.close();const l=s0(JSON.stringify(r)+`
`);i.enqueue(l)}catch(r){i.error(r)}},async cancel(){var i;await((i=t.return)===null||i===void 0?void 0:i.call(t))}})}}function s8(n,e){return rr(this,arguments,function*(){var i,r,o,l;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Fi("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Fi("Attempted to iterate over a response with no body");const c=new a8,d=new am,f=gN(n.body);try{for(var m=!0,v=sr(o8(f)),E;E=yield lt(v.next()),i=E.done,!i;m=!0){l=E.value,m=!1;const b=l;for(const I of d.decode(b)){const x=c.decode(I);x&&(yield yield lt(x))}}}catch(b){r={error:b}}finally{try{!m&&!i&&(o=v.return)&&(yield lt(o.call(v)))}finally{if(r)throw r.error}}for(const b of d.flush()){const I=c.decode(b);I&&(yield yield lt(I))}})}function o8(n){return rr(this,arguments,function*(){var t,i,r,o;let l=new Uint8Array;try{for(var c=!0,d=sr(n),f;f=yield lt(d.next()),t=f.done,!t;c=!0){o=f.value,c=!1;const m=o;if(m==null)continue;const v=m instanceof ArrayBuffer?new Uint8Array(m):typeof m=="string"?s0(m):m;let E=new Uint8Array(l.length+v.length);E.set(l),E.set(v,l.length),l=E;let b;for(;(b=i8(l))!==-1;)yield yield lt(l.slice(0,b)),l=l.slice(b)}}catch(m){i={error:m}}finally{try{!c&&!t&&(r=d.return)&&(yield lt(r.call(d)))}finally{if(i)throw i.error}}l.length>0&&(yield yield lt(l))})}class a8{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,i,r]=l8(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function l8(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function u8(n,e){const{response:t,requestLogID:i,retryOfRequestLogID:r,startTime:o}=e,l=await(async()=>{var c;if(e.options.stream)return Wn(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):Bl.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const d=t.headers.get("content-type"),f=(c=d==null?void 0:d.split(";")[0])===null||c===void 0?void 0:c.trim();return(f==null?void 0:f.includes("application/json"))||(f==null?void 0:f.endsWith("+json"))?t.headers.get("content-length")==="0"?void 0:await t.json():await t.text()})();return Wn(n).debug(`[${i}] response parsed`,sa({retryOfRequestLogID:r,url:t.url,status:t.status,body:l,durationMs:Date.now()-o})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class o0 extends Promise{constructor(e,t,i=u8){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=i,this.client=e}_thenUnwrap(e){return new o0(this.client,this.responsePromise,async(t,i)=>e(await this.parseResponse(t,i),i))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const SN=Symbol("brand.privateNullableHeaders");function*c8(n){if(!n)return;if(SN in n){const{values:i,nulls:r}=n;yield*i.entries();for(const o of r)yield[o,null];return}let e=!1,t;n instanceof Headers?t=n.entries():xA(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let i of t){const r=i[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");const o=xA(i[1])?i[1]:[i[1]];let l=!1;for(const c of o)c!==void 0&&(e&&!l&&(l=!0,yield[r,null]),yield[r,c])}}const Dc=n=>{const e=new Headers,t=new Set;for(const i of n){const r=new Set;for(const[o,l]of c8(i)){const c=o.toLowerCase();r.has(c)||(e.delete(o),r.add(c)),l===null?(e.delete(o),t.add(c)):(e.append(o,l),t.delete(c))}}return{[SN]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const My=n=>{var e,t,i,r,o,l;if(typeof globalThis.process<"u")return(i=(t=(e=N4)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(l=(o=(r=globalThis.Deno.env)===null||r===void 0?void 0:r.get)===null||o===void 0?void 0:o.call(r,n))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var wN;class lm{constructor(e){var t,i,r,o,l,c,d,{baseURL:f=My("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:m=(t=My("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:v="v1beta"}=e,E=Ep(e,["baseURL","apiKey","apiVersion"]);const b=Object.assign(Object.assign({apiKey:m,apiVersion:v},E),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=b.baseURL,this.timeout=(i=b.timeout)!==null&&i!==void 0?i:lm.DEFAULT_TIMEOUT,this.logger=(r=b.logger)!==null&&r!==void 0?r:console;const I="warn";this.logLevel=I,this.logLevel=(l=(o=NA(b.logLevel,"ClientOptions.logLevel",this))!==null&&o!==void 0?o:NA(My("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:I,this.fetchOptions=b.fetchOptions,this.maxRetries=(c=b.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(d=b.fetch)!==null&&d!==void 0?d:HG(),this.encoder=KG,this._options=b,this.apiKey=m,this.apiVersion=v,this.clientAdapter=b.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=Dc([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return Dc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Dc([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,i])=>typeof i<"u").map(([t,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(t)}=`;throw new Fi(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Vl}`}defaultIdempotencyKey(){return`stainless-node-retry-${NG()}`}makeStatusError(e,t,i,r){return Xn.generate(e,t,i,r)}buildURL(e,t,i){const r=!this.baseURLOverridden()&&i||this.baseURL,o=MG(e)?new URL(e):new URL(r+(r.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return OG(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(o.search=this.stringifyQuery(t)),o.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:i}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,i){return this.request(Promise.resolve(i).then(r=>Object.assign({method:e,path:t},r)))}request(e,t=null){return new o0(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,i){var r,o,l;const c=await e,d=(r=c.maxRetries)!==null&&r!==void 0?r:this.maxRetries;t==null&&(t=d),await this.prepareOptions(c);const{req:f,url:m,timeout:v}=await this.buildRequest(c,{retryCount:d-t});await this.prepareRequest(f,{url:m,options:c});const E="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),b=i===void 0?"":`, retryOf: ${i}`,I=Date.now();if(Wn(this).debug(`[${E}] sending request`,sa({retryOfRequestLogID:i,method:c.method,url:m,options:c,headers:f.headers})),!((o=c.signal)===null||o===void 0)&&o.aborted)throw new P_;const x=new AbortController,A=await this.fetchWithTimeout(m,f,v,x).catch(D_),N=Date.now();if(A instanceof globalThis.Error){const L=`retrying, ${t} attempts remaining`;if(!((l=c.signal)===null||l===void 0)&&l.aborted)throw new P_;const $=M_(A)||/timed? ?out/i.test(String(A)+("cause"in A?String(A.cause):""));if(t)return Wn(this).info(`[${E}] connection ${$?"timed out":"failed"} - ${L}`),Wn(this).debug(`[${E}] connection ${$?"timed out":"failed"} (${L})`,sa({retryOfRequestLogID:i,url:m,durationMs:N-I,message:A.message})),this.retryRequest(c,t,i??E);throw Wn(this).info(`[${E}] connection ${$?"timed out":"failed"} - error; no more retries left`),Wn(this).debug(`[${E}] connection ${$?"timed out":"failed"} (error; no more retries left)`,sa({retryOfRequestLogID:i,url:m,durationMs:N-I,message:A.message})),$?new oN:new om({cause:A})}const U=`[${E}${b}] ${f.method} ${m} ${A.ok?"succeeded":"failed"} with status ${A.status} in ${N-I}ms`;if(!A.ok){const L=await this.shouldRetry(A);if(t&&L){const D=`retrying, ${t} attempts remaining`;return await jG(A.body),Wn(this).info(`${U} - ${D}`),Wn(this).debug(`[${E}] response error (${D})`,sa({retryOfRequestLogID:i,url:A.url,status:A.status,headers:A.headers,durationMs:N-I})),this.retryRequest(c,t,i??E,A.headers)}const $=L?"error; no more retries left":"error; not retryable";Wn(this).info(`${U} - ${$}`);const K=await A.text().catch(D=>D_(D).message),j=LG(K),k=j?void 0:K;throw Wn(this).debug(`[${E}] response error (${$})`,sa({retryOfRequestLogID:i,url:A.url,status:A.status,headers:A.headers,message:k,durationMs:Date.now()-I})),this.makeStatusError(A.status,j,k,A.headers)}return Wn(this).info(U),Wn(this).debug(`[${E}] response start`,sa({retryOfRequestLogID:i,url:A.url,status:A.status,headers:A.headers,durationMs:N-I})),{response:A,options:c,controller:x,requestLogID:E,retryOfRequestLogID:i,startTime:I}}async fetchWithTimeout(e,t,i,r){const o=t||{},{signal:l,method:c}=o,d=Ep(o,["signal","method"]),f=this._makeAbort(r);l&&l.addEventListener("abort",f,{once:!0});const m=setTimeout(f,i),v=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,E=Object.assign(Object.assign(Object.assign({signal:r.signal},v?{duplex:"half"}:{}),{method:"GET"}),d);c&&(E.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,E)}finally{clearTimeout(m)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,i,r){var o;let l;const c=r==null?void 0:r.get("retry-after-ms");if(c){const f=parseFloat(c);Number.isNaN(f)||(l=f)}const d=r==null?void 0:r.get("retry-after");if(d&&!l){const f=parseFloat(d);Number.isNaN(f)?l=Date.parse(d)-Date.now():l=f*1e3}if(!(l&&0<=l&&l<60*1e3)){const f=(o=e.maxRetries)!==null&&o!==void 0?o:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,f)}return await BG(l),this.makeRequest(e,t-1,i)}calculateDefaultRetryTimeoutMillis(e,t){const o=t-e,l=Math.min(.5*Math.pow(2,o),8),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(e,{retryCount:t=0}={}){var i,r,o;const l=Object.assign({},e),{method:c,path:d,query:f,defaultBaseURL:m}=l,v=this.buildURL(d,f,m);"timeout"in l&&UG("timeout",l.timeout),l.timeout=(i=l.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:E,body:b}=this.buildBody({options:l}),I=await this.buildHeaders({options:e,method:c,bodyHeaders:E,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:I},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&b instanceof globalThis.ReadableStream&&{duplex:"half"}),b&&{body:b}),(r=this.fetchOptions)!==null&&r!==void 0?r:{}),(o=l.fetchOptions)!==null&&o!==void 0?o:{}),url:v,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:i,retryCount:r}){let o={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let c=Dc([o,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),qG()),this._options.defaultHeaders,i,e.headers,l]);return this.validateHeaders(c),c.values}_makeAbort(e){return()=>e.abort()}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const i=Dc([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&i.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:$G(e)}:this.encoder({body:e,headers:i})}}lm.DEFAULT_TIMEOUT=6e4;class Pn extends lm{constructor(){super(...arguments),this.interactions=new bN(this)}}wN=Pn;Pn.GeminiNextGenAPIClient=wN;Pn.GeminiNextGenAPIClientError=Fi;Pn.APIError=Xn;Pn.APIConnectionError=om;Pn.APIConnectionTimeoutError=oN;Pn.APIUserAbortError=P_;Pn.NotFoundError=cN;Pn.ConflictError=dN;Pn.RateLimitError=hN;Pn.BadRequestError=aN;Pn.AuthenticationError=lN;Pn.InternalServerError=pN;Pn.PermissionDeniedError=uN;Pn.UnprocessableEntityError=fN;Pn.toFile=XG;Pn.Interactions=bN;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function d8(n,e){const t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function f8(n,e){const t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function h8(n,e){const t={},i=p(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function p8(n,e){const t={},i=p(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function m8(n,e,t){const i={};if(p(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=p(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&g(e,["displayName"],r),p(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=p(n,["epochCount"]);e!==void 0&&o!=null&&g(e,["tuningTask","hyperparameters","epochCount"],o);const l=p(n,["learningRateMultiplier"]);if(l!=null&&g(i,["tuningTask","hyperparameters","learningRateMultiplier"],l),p(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(p(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(p(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");if(p(n,["tuningMode"])!==void 0)throw new Error("tuningMode parameter is not supported in Gemini API.");if(p(n,["customBaseModel"])!==void 0)throw new Error("customBaseModel parameter is not supported in Gemini API.");const c=p(n,["batchSize"]);e!==void 0&&c!=null&&g(e,["tuningTask","hyperparameters","batchSize"],c);const d=p(n,["learningRate"]);if(e!==void 0&&d!=null&&g(e,["tuningTask","hyperparameters","learningRate"],d),p(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(p(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");if(p(n,["baseTeacherModel"])!==void 0)throw new Error("baseTeacherModel parameter is not supported in Gemini API.");if(p(n,["tunedTeacherModelSource"])!==void 0)throw new Error("tunedTeacherModelSource parameter is not supported in Gemini API.");if(p(n,["sftLossWeightMultiplier"])!==void 0)throw new Error("sftLossWeightMultiplier parameter is not supported in Gemini API.");if(p(n,["outputUri"])!==void 0)throw new Error("outputUri parameter is not supported in Gemini API.");if(p(n,["encryptionSpec"])!==void 0)throw new Error("encryptionSpec parameter is not supported in Gemini API.");return i}function g8(n,e,t){const i={};let r=p(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const j=p(n,["validationDataset"]);e!==void 0&&j!=null&&g(e,["supervisedTuningSpec"],Dy(j))}else if(r==="PREFERENCE_TUNING"){const j=p(n,["validationDataset"]);e!==void 0&&j!=null&&g(e,["preferenceOptimizationSpec"],Dy(j))}else if(r==="DISTILLATION"){const j=p(n,["validationDataset"]);e!==void 0&&j!=null&&g(e,["distillationSpec"],Dy(j))}const o=p(n,["tunedModelDisplayName"]);e!==void 0&&o!=null&&g(e,["tunedModelDisplayName"],o);const l=p(n,["description"]);e!==void 0&&l!=null&&g(e,["description"],l);let c=p(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const j=p(n,["epochCount"]);e!==void 0&&j!=null&&g(e,["supervisedTuningSpec","hyperParameters","epochCount"],j)}else if(c==="PREFERENCE_TUNING"){const j=p(n,["epochCount"]);e!==void 0&&j!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],j)}else if(c==="DISTILLATION"){const j=p(n,["epochCount"]);e!==void 0&&j!=null&&g(e,["distillationSpec","hyperParameters","epochCount"],j)}let d=p(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const j=p(n,["learningRateMultiplier"]);e!==void 0&&j!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],j)}else if(d==="PREFERENCE_TUNING"){const j=p(n,["learningRateMultiplier"]);e!==void 0&&j!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],j)}else if(d==="DISTILLATION"){const j=p(n,["learningRateMultiplier"]);e!==void 0&&j!=null&&g(e,["distillationSpec","hyperParameters","learningRateMultiplier"],j)}let f=p(t,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const j=p(n,["exportLastCheckpointOnly"]);e!==void 0&&j!=null&&g(e,["supervisedTuningSpec","exportLastCheckpointOnly"],j)}else if(f==="PREFERENCE_TUNING"){const j=p(n,["exportLastCheckpointOnly"]);e!==void 0&&j!=null&&g(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],j)}else if(f==="DISTILLATION"){const j=p(n,["exportLastCheckpointOnly"]);e!==void 0&&j!=null&&g(e,["distillationSpec","exportLastCheckpointOnly"],j)}let m=p(t,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const j=p(n,["adapterSize"]);e!==void 0&&j!=null&&g(e,["supervisedTuningSpec","hyperParameters","adapterSize"],j)}else if(m==="PREFERENCE_TUNING"){const j=p(n,["adapterSize"]);e!==void 0&&j!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],j)}else if(m==="DISTILLATION"){const j=p(n,["adapterSize"]);e!==void 0&&j!=null&&g(e,["distillationSpec","hyperParameters","adapterSize"],j)}let v=p(t,["config","method"]);if(v===void 0&&(v="SUPERVISED_FINE_TUNING"),v==="SUPERVISED_FINE_TUNING"){const j=p(n,["tuningMode"]);e!==void 0&&j!=null&&g(e,["supervisedTuningSpec","tuningMode"],j)}const E=p(n,["customBaseModel"]);e!==void 0&&E!=null&&g(e,["customBaseModel"],E);let b=p(t,["config","method"]);if(b===void 0&&(b="SUPERVISED_FINE_TUNING"),b==="SUPERVISED_FINE_TUNING"){const j=p(n,["batchSize"]);e!==void 0&&j!=null&&g(e,["supervisedTuningSpec","hyperParameters","batchSize"],j)}let I=p(t,["config","method"]);if(I===void 0&&(I="SUPERVISED_FINE_TUNING"),I==="SUPERVISED_FINE_TUNING"){const j=p(n,["learningRate"]);e!==void 0&&j!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRate"],j)}const x=p(n,["labels"]);e!==void 0&&x!=null&&g(e,["labels"],x);const A=p(n,["beta"]);e!==void 0&&A!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","beta"],A);const N=p(n,["baseTeacherModel"]);e!==void 0&&N!=null&&g(e,["distillationSpec","baseTeacherModel"],N);const U=p(n,["tunedTeacherModelSource"]);e!==void 0&&U!=null&&g(e,["distillationSpec","tunedTeacherModelSource"],U);const L=p(n,["sftLossWeightMultiplier"]);e!==void 0&&L!=null&&g(e,["distillationSpec","hyperParameters","sftLossWeightMultiplier"],L);const $=p(n,["outputUri"]);e!==void 0&&$!=null&&g(e,["outputUri"],$);const K=p(n,["encryptionSpec"]);return e!==void 0&&K!=null&&g(e,["encryptionSpec"],K),i}function y8(n,e){const t={},i=p(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);const r=p(n,["preTunedModel"]);r!=null&&g(t,["preTunedModel"],r);const o=p(n,["trainingDataset"]);o!=null&&C8(o);const l=p(n,["config"]);return l!=null&&m8(l,t),t}function _8(n,e){const t={},i=p(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);const r=p(n,["preTunedModel"]);r!=null&&g(t,["preTunedModel"],r);const o=p(n,["trainingDataset"]);o!=null&&R8(o,t,e);const l=p(n,["config"]);return l!=null&&g8(l,t,e),t}function v8(n,e){const t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function E8(n,e){const t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function T8(n,e,t){const i={},r=p(n,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);const o=p(n,["pageToken"]);e!==void 0&&o!=null&&g(e,["_query","pageToken"],o);const l=p(n,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),i}function b8(n,e,t){const i={},r=p(n,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);const o=p(n,["pageToken"]);e!==void 0&&o!=null&&g(e,["_query","pageToken"],o);const l=p(n,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),i}function S8(n,e){const t={},i=p(n,["config"]);return i!=null&&T8(i,t),t}function w8(n,e){const t={},i=p(n,["config"]);return i!=null&&b8(i,t),t}function x8(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);const o=p(n,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>xN(c))),g(t,["tuningJobs"],l)}return t}function A8(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);const o=p(n,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>U_(c))),g(t,["tuningJobs"],l)}return t}function I8(n,e){const t={},i=p(n,["name"]);i!=null&&g(t,["model"],i);const r=p(n,["name"]);return r!=null&&g(t,["endpoint"],r),t}function C8(n,e){const t={};if(p(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=p(n,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),g(t,["examples","examples"],r)}return t}function R8(n,e,t){const i={};let r=p(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const l=p(n,["gcsUri"]);e!==void 0&&l!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(r==="PREFERENCE_TUNING"){const l=p(n,["gcsUri"]);e!==void 0&&l!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}else if(r==="DISTILLATION"){const l=p(n,["gcsUri"]);e!==void 0&&l!=null&&g(e,["distillationSpec","promptDatasetUri"],l)}let o=p(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const l=p(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(o==="PREFERENCE_TUNING"){const l=p(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}else if(o==="DISTILLATION"){const l=p(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&g(e,["distillationSpec","promptDatasetUri"],l)}if(p(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function xN(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["name"]);r!=null&&g(t,["name"],r);const o=p(n,["state"]);o!=null&&g(t,["state"],zR(o));const l=p(n,["createTime"]);l!=null&&g(t,["createTime"],l);const c=p(n,["tuningTask","startTime"]);c!=null&&g(t,["startTime"],c);const d=p(n,["tuningTask","completeTime"]);d!=null&&g(t,["endTime"],d);const f=p(n,["updateTime"]);f!=null&&g(t,["updateTime"],f);const m=p(n,["description"]);m!=null&&g(t,["description"],m);const v=p(n,["baseModel"]);v!=null&&g(t,["baseModel"],v);const E=p(n,["_self"]);return E!=null&&g(t,["tunedModel"],I8(E)),t}function U_(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["name"]);r!=null&&g(t,["name"],r);const o=p(n,["state"]);o!=null&&g(t,["state"],zR(o));const l=p(n,["createTime"]);l!=null&&g(t,["createTime"],l);const c=p(n,["startTime"]);c!=null&&g(t,["startTime"],c);const d=p(n,["endTime"]);d!=null&&g(t,["endTime"],d);const f=p(n,["updateTime"]);f!=null&&g(t,["updateTime"],f);const m=p(n,["error"]);m!=null&&g(t,["error"],m);const v=p(n,["description"]);v!=null&&g(t,["description"],v);const E=p(n,["baseModel"]);E!=null&&g(t,["baseModel"],E);const b=p(n,["tunedModel"]);b!=null&&g(t,["tunedModel"],b);const I=p(n,["preTunedModel"]);I!=null&&g(t,["preTunedModel"],I);const x=p(n,["supervisedTuningSpec"]);x!=null&&g(t,["supervisedTuningSpec"],x);const A=p(n,["preferenceOptimizationSpec"]);A!=null&&g(t,["preferenceOptimizationSpec"],A);const N=p(n,["distillationSpec"]);N!=null&&g(t,["distillationSpec"],N);const U=p(n,["tuningDataStats"]);U!=null&&g(t,["tuningDataStats"],U);const L=p(n,["encryptionSpec"]);L!=null&&g(t,["encryptionSpec"],L);const $=p(n,["partnerModelTuningSpec"]);$!=null&&g(t,["partnerModelTuningSpec"],$);const K=p(n,["customBaseModel"]);K!=null&&g(t,["customBaseModel"],K);const j=p(n,["experiment"]);j!=null&&g(t,["experiment"],j);const k=p(n,["labels"]);k!=null&&g(t,["labels"],k);const V=p(n,["outputUri"]);V!=null&&g(t,["outputUri"],V);const D=p(n,["pipelineJob"]);D!=null&&g(t,["pipelineJob"],D);const z=p(n,["serviceAccount"]);z!=null&&g(t,["serviceAccount"],z);const G=p(n,["tunedModelDisplayName"]);G!=null&&g(t,["tunedModelDisplayName"],G);const M=p(n,["veoTuningSpec"]);return M!=null&&g(t,["veoTuningSpec"],M),t}function N8(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=p(n,["name"]);r!=null&&g(t,["name"],r);const o=p(n,["metadata"]);o!=null&&g(t,["metadata"],o);const l=p(n,["done"]);l!=null&&g(t,["done"],l);const c=p(n,["error"]);return c!=null&&g(t,["error"],c),t}function Dy(n,e){const t={},i=p(n,["gcsUri"]);i!=null&&g(t,["validationDatasetUri"],i);const r=p(n,["vertexDatasetResource"]);return r!=null&&g(t,["validationDatasetUri"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class k8 extends ms{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Oa(cs.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const r={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},t),{preTunedModel:r});return o.baseModel=void 0,await this.tuneInternal(o)}else{const r=Object.assign({},t);return await this.tuneInternal(r)}else{const r=Object.assign({},t),o=await this.tuneMldevInternal(r);let l="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?l=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(l=o.name.split("/operations/")[0]),{name:l,state:w_.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=E8(e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>U_(m))}else{const f=v8(e);return c=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>xN(m))}}async listInternal(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=w8(e);return c=qe("tuningJobs",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=A8(m),E=new rA;return Object.assign(E,v),E})}else{const f=S8(e);return c=qe("tunedModels",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=x8(m),E=new rA;return Object.assign(E,v),E})}}async cancel(e){var t,i,r,o;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=f8(e);return c=qe("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=p8(m),E=new sA;return Object.assign(E,v),E})}else{const f=d8(e);return c=qe("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:m.headers},E})),l.then(m=>{const v=h8(m),E=new sA;return Object.assign(E,v),E})}}async tuneInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI()){const c=_8(e,e);return o=qe("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>U_(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=y8(e);return o=qe("tunedModels",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>N8(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class M8{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const D8=1024*1024*8,P8=3,O8=1e3,V8=2,bp="x-goog-upload-status";async function U8(n,e,t){var i;const r=await AN(n,e,t),o=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[bp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function L8(n,e,t){var i;const r=await AN(n,e,t),o=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[bp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=OR(o),c=new Zv;return Object.assign(c,l),c}async function AN(n,e,t){var i,r;let o=0,l=0,c=new A_(new Response),d="upload";for(o=n.size;l<o;){const f=Math.min(D8,o-l),m=n.slice(l,l+f);l+f>=o&&(d+=", finalize");let v=0,E=O8;for(;v<P8&&(c=await t.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(f)}}}),!(!((i=c==null?void 0:c.headers)===null||i===void 0)&&i[bp]));)v++,await F8(E),E=E*V8;if(l+=f,((r=c==null?void 0:c.headers)===null||r===void 0?void 0:r[bp])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function B8(n){return{size:n.size,type:n.type}}function F8(n){return new Promise(e=>setTimeout(e,n))}class z8{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await U8(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await L8(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await B8(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class G8{create(e,t,i){return new q8(e,t,i)}}class q8{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const MA="x-goog-api-key";class H8{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(MA)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(MA,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $8="gl-node/";class K9{get interactions(){var e;if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const t=this.httpOptions;t!=null&&t.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const i=new Pn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:t==null?void 0:t.timeout,maxRetries:(e=t==null?void 0:t.retryOptions)===null||e===void 0?void 0:e.attempts});return this._interactions=i.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=P4(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const r=new H8(this.apiKey);this.apiClient=new Bz({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:$8+"web",uploader:new z8,downloader:new M8}),this.models=new rG(this.apiClient),this.live=new Xz(this.apiClient,r,new G8),this.batches=new c6(this.apiClient),this.chats=new $6(this.models,this.apiClient),this.caches=new G6(this.apiClient),this.files=new iB(this.apiClient),this.operations=new sG(this.apiClient),this.authTokens=new TG(this.apiClient),this.tunings=new k8(this.apiClient),this.fileSearchStores=new RG(this.apiClient)}}function bh(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Py={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var DA;function j8(){return DA||(DA=1,(function(n,e){(function(t){n.exports=t()})(function(){return(function t(i,r,o){function l(f,m){if(!r[f]){if(!i[f]){var v=typeof bh=="function"&&bh;if(!m&&v)return v(f,!0);if(c)return c(f,!0);var E=new Error("Cannot find module '"+f+"'");throw E.code="MODULE_NOT_FOUND",E}var b=r[f]={exports:{}};i[f][0].call(b.exports,function(I){var x=i[f][1][I];return l(x||I)},b,b.exports,t,i,r,o)}return r[f].exports}for(var c=typeof bh=="function"&&bh,d=0;d<o.length;d++)l(o[d]);return l})({1:[function(t,i,r){var o=t("./utils"),l=t("./support"),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(d){for(var f,m,v,E,b,I,x,A=[],N=0,U=d.length,L=U,$=o.getTypeOf(d)!=="string";N<d.length;)L=U-N,v=$?(f=d[N++],m=N<U?d[N++]:0,N<U?d[N++]:0):(f=d.charCodeAt(N++),m=N<U?d.charCodeAt(N++):0,N<U?d.charCodeAt(N++):0),E=f>>2,b=(3&f)<<4|m>>4,I=1<L?(15&m)<<2|v>>6:64,x=2<L?63&v:64,A.push(c.charAt(E)+c.charAt(b)+c.charAt(I)+c.charAt(x));return A.join("")},r.decode=function(d){var f,m,v,E,b,I,x=0,A=0,N="data:";if(d.substr(0,N.length)===N)throw new Error("Invalid base64 input, it looks like a data url.");var U,L=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===c.charAt(64)&&L--,d.charAt(d.length-2)===c.charAt(64)&&L--,L%1!=0)throw new Error("Invalid base64 input, bad content length.");for(U=l.uint8array?new Uint8Array(0|L):new Array(0|L);x<d.length;)f=c.indexOf(d.charAt(x++))<<2|(E=c.indexOf(d.charAt(x++)))>>4,m=(15&E)<<4|(b=c.indexOf(d.charAt(x++)))>>2,v=(3&b)<<6|(I=c.indexOf(d.charAt(x++))),U[A++]=f,b!==64&&(U[A++]=m),I!==64&&(U[A++]=v);return U}},{"./support":30,"./utils":32}],2:[function(t,i,r){var o=t("./external"),l=t("./stream/DataWorker"),c=t("./stream/Crc32Probe"),d=t("./stream/DataLengthProbe");function f(m,v,E,b,I){this.compressedSize=m,this.uncompressedSize=v,this.crc32=E,this.compression=b,this.compressedContent=I}f.prototype={getContentWorker:function(){var m=new l(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),v=this;return m.on("end",function(){if(this.streamInfo.data_length!==v.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new l(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(m,v,E){return m.pipe(new c).pipe(new d("uncompressedSize")).pipe(v.compressWorker(E)).pipe(new d("compressedSize")).withStreamInfo("compression",v)},i.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,i,r){var o=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,i,r){var o=t("./utils"),l=(function(){for(var c,d=[],f=0;f<256;f++){c=f;for(var m=0;m<8;m++)c=1&c?3988292384^c>>>1:c>>>1;d[f]=c}return d})();i.exports=function(c,d){return c!==void 0&&c.length?o.getTypeOf(c)!=="string"?(function(f,m,v,E){var b=l,I=E+v;f^=-1;for(var x=E;x<I;x++)f=f>>>8^b[255&(f^m[x])];return-1^f})(0|d,c,c.length,0):(function(f,m,v,E){var b=l,I=E+v;f^=-1;for(var x=E;x<I;x++)f=f>>>8^b[255&(f^m.charCodeAt(x))];return-1^f})(0|d,c,c.length,0):0}},{"./utils":32}],5:[function(t,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,i,r){var o=null;o=typeof Promise<"u"?Promise:t("lie"),i.exports={Promise:o}},{lie:37}],7:[function(t,i,r){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=t("pako"),c=t("./utils"),d=t("./stream/GenericWorker"),f=o?"uint8array":"array";function m(v,E){d.call(this,"FlateWorker/"+v),this._pako=null,this._pakoAction=v,this._pakoOptions=E,this.meta={}}r.magic="\b\0",c.inherits(m,d),m.prototype.processChunk=function(v){this.meta=v.meta,this._pako===null&&this._createPako(),this._pako.push(c.transformTo(f,v.data),!1)},m.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var v=this;this._pako.onData=function(E){v.push({data:E,meta:v.meta})}},r.compressWorker=function(v){return new m("Deflate",v)},r.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,i,r){function o(b,I){var x,A="";for(x=0;x<I;x++)A+=String.fromCharCode(255&b),b>>>=8;return A}function l(b,I,x,A,N,U){var L,$,K=b.file,j=b.compression,k=U!==f.utf8encode,V=c.transformTo("string",U(K.name)),D=c.transformTo("string",f.utf8encode(K.name)),z=K.comment,G=c.transformTo("string",U(z)),M=c.transformTo("string",f.utf8encode(z)),B=D.length!==K.name.length,O=M.length!==z.length,oe="",X="",Q="",se=K.dir,ne=K.date,ue={crc32:0,compressedSize:0,uncompressedSize:0};I&&!x||(ue.crc32=b.crc32,ue.compressedSize=b.compressedSize,ue.uncompressedSize=b.uncompressedSize);var F=0;I&&(F|=8),k||!B&&!O||(F|=2048);var W=0,ye=0;se&&(W|=16),N==="UNIX"?(ye=798,W|=(function(Ee,ze){var Qe=Ee;return Ee||(Qe=ze?16893:33204),(65535&Qe)<<16})(K.unixPermissions,se)):(ye=20,W|=(function(Ee){return 63&(Ee||0)})(K.dosPermissions)),L=ne.getUTCHours(),L<<=6,L|=ne.getUTCMinutes(),L<<=5,L|=ne.getUTCSeconds()/2,$=ne.getUTCFullYear()-1980,$<<=4,$|=ne.getUTCMonth()+1,$<<=5,$|=ne.getUTCDate(),B&&(X=o(1,1)+o(m(V),4)+D,oe+="up"+o(X.length,2)+X),O&&(Q=o(1,1)+o(m(G),4)+M,oe+="uc"+o(Q.length,2)+Q);var _e="";return _e+=`
\0`,_e+=o(F,2),_e+=j.magic,_e+=o(L,2),_e+=o($,2),_e+=o(ue.crc32,4),_e+=o(ue.compressedSize,4),_e+=o(ue.uncompressedSize,4),_e+=o(V.length,2),_e+=o(oe.length,2),{fileRecord:v.LOCAL_FILE_HEADER+_e+V+oe,dirRecord:v.CENTRAL_FILE_HEADER+o(ye,2)+_e+o(G.length,2)+"\0\0\0\0"+o(W,4)+o(A,4)+V+oe+G}}var c=t("../utils"),d=t("../stream/GenericWorker"),f=t("../utf8"),m=t("../crc32"),v=t("../signature");function E(b,I,x,A){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=I,this.zipPlatform=x,this.encodeFileName=A,this.streamFiles=b,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}c.inherits(E,d),E.prototype.push=function(b){var I=b.meta.percent||0,x=this.entriesCount,A=this._sources.length;this.accumulate?this.contentBuffer.push(b):(this.bytesWritten+=b.data.length,d.prototype.push.call(this,{data:b.data,meta:{currentFile:this.currentFile,percent:x?(I+100*(x-A-1))/x:100}}))},E.prototype.openedSource=function(b){this.currentSourceOffset=this.bytesWritten,this.currentFile=b.file.name;var I=this.streamFiles&&!b.file.dir;if(I){var x=l(b,I,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:x.fileRecord,meta:{percent:0}})}else this.accumulate=!0},E.prototype.closedSource=function(b){this.accumulate=!1;var I=this.streamFiles&&!b.file.dir,x=l(b,I,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(x.dirRecord),I)this.push({data:(function(A){return v.DATA_DESCRIPTOR+o(A.crc32,4)+o(A.compressedSize,4)+o(A.uncompressedSize,4)})(b),meta:{percent:100}});else for(this.push({data:x.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},E.prototype.flush=function(){for(var b=this.bytesWritten,I=0;I<this.dirRecords.length;I++)this.push({data:this.dirRecords[I],meta:{percent:100}});var x=this.bytesWritten-b,A=(function(N,U,L,$,K){var j=c.transformTo("string",K($));return v.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(N,2)+o(N,2)+o(U,4)+o(L,4)+o(j.length,2)+j})(this.dirRecords.length,x,b,this.zipComment,this.encodeFileName);this.push({data:A,meta:{percent:100}})},E.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},E.prototype.registerPrevious=function(b){this._sources.push(b);var I=this;return b.on("data",function(x){I.processChunk(x)}),b.on("end",function(){I.closedSource(I.previous.streamInfo),I._sources.length?I.prepareNextSource():I.end()}),b.on("error",function(x){I.error(x)}),this},E.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},E.prototype.error=function(b){var I=this._sources;if(!d.prototype.error.call(this,b))return!1;for(var x=0;x<I.length;x++)try{I[x].error(b)}catch{}return!0},E.prototype.lock=function(){d.prototype.lock.call(this);for(var b=this._sources,I=0;I<b.length;I++)b[I].lock()},i.exports=E},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,i,r){var o=t("../compressions"),l=t("./ZipFileWorker");r.generateWorker=function(c,d,f){var m=new l(d.streamFiles,f,d.platform,d.encodeFileName),v=0;try{c.forEach(function(E,b){v++;var I=(function(U,L){var $=U||L,K=o[$];if(!K)throw new Error($+" is not a valid compression method !");return K})(b.options.compression,d.compression),x=b.options.compressionOptions||d.compressionOptions||{},A=b.dir,N=b.date;b._compressWorker(I,x).withStreamInfo("file",{name:E,dir:A,date:N,comment:b.comment||"",unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions}).pipe(m)}),m.entriesCount=v}catch(E){m.error(E)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,i,r){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new o;for(var c in this)typeof this[c]!="function"&&(l[c]=this[c]);return l}}(o.prototype=t("./object")).loadAsync=t("./load"),o.support=t("./support"),o.defaults=t("./defaults"),o.version="3.10.1",o.loadAsync=function(l,c){return new o().loadAsync(l,c)},o.external=t("./external"),i.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,i,r){var o=t("./utils"),l=t("./external"),c=t("./utf8"),d=t("./zipEntries"),f=t("./stream/Crc32Probe"),m=t("./nodejsUtils");function v(E){return new l.Promise(function(b,I){var x=E.decompressed.getContentWorker().pipe(new f);x.on("error",function(A){I(A)}).on("end",function(){x.streamInfo.crc32!==E.decompressed.crc32?I(new Error("Corrupted zip : CRC32 mismatch")):b()}).resume()})}i.exports=function(E,b){var I=this;return b=o.extend(b||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:c.utf8decode}),m.isNode&&m.isStream(E)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",E,!0,b.optimizedBinaryString,b.base64).then(function(x){var A=new d(b);return A.load(x),A}).then(function(x){var A=[l.Promise.resolve(x)],N=x.files;if(b.checkCRC32)for(var U=0;U<N.length;U++)A.push(v(N[U]));return l.Promise.all(A)}).then(function(x){for(var A=x.shift(),N=A.files,U=0;U<N.length;U++){var L=N[U],$=L.fileNameStr,K=o.resolve(L.fileNameStr);I.file(K,L.decompressed,{binary:!0,optimizedBinaryString:!0,date:L.date,dir:L.dir,comment:L.fileCommentStr.length?L.fileCommentStr:null,unixPermissions:L.unixPermissions,dosPermissions:L.dosPermissions,createFolders:b.createFolders}),L.dir||(I.file(K).unsafeOriginalName=$)}return A.zipComment.length&&(I.comment=A.zipComment),I})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,i,r){var o=t("../utils"),l=t("../stream/GenericWorker");function c(d,f){l.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(f)}o.inherits(c,l),c.prototype._bindStream=function(d){var f=this;(this._stream=d).pause(),d.on("data",function(m){f.push({data:m,meta:{percent:0}})}).on("error",function(m){f.isPaused?this.generatedError=m:f.error(m)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},c.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},c.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=c},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,i,r){var o=t("readable-stream").Readable;function l(c,d,f){o.call(this,d),this._helper=c;var m=this;c.on("data",function(v,E){m.push(v)||m._helper.pause(),f&&f(E)}).on("error",function(v){m.emit("error",v)}).on("end",function(){m.push(null)})}t("../utils").inherits(l,o),l.prototype._read=function(){this._helper.resume()},i.exports=l},{"../utils":32,"readable-stream":16}],14:[function(t,i,r){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,l);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,l)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var l=new Buffer(o);return l.fill(0),l},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(t,i,r){function o(K,j,k){var V,D=c.getTypeOf(j),z=c.extend(k||{},m);z.date=z.date||new Date,z.compression!==null&&(z.compression=z.compression.toUpperCase()),typeof z.unixPermissions=="string"&&(z.unixPermissions=parseInt(z.unixPermissions,8)),z.unixPermissions&&16384&z.unixPermissions&&(z.dir=!0),z.dosPermissions&&16&z.dosPermissions&&(z.dir=!0),z.dir&&(K=N(K)),z.createFolders&&(V=A(K))&&U.call(this,V,!0);var G=D==="string"&&z.binary===!1&&z.base64===!1;k&&k.binary!==void 0||(z.binary=!G),(j instanceof v&&j.uncompressedSize===0||z.dir||!j||j.length===0)&&(z.base64=!1,z.binary=!0,j="",z.compression="STORE",D="string");var M=null;M=j instanceof v||j instanceof d?j:I.isNode&&I.isStream(j)?new x(K,j):c.prepareContent(K,j,z.binary,z.optimizedBinaryString,z.base64);var B=new E(K,M,z);this.files[K]=B}var l=t("./utf8"),c=t("./utils"),d=t("./stream/GenericWorker"),f=t("./stream/StreamHelper"),m=t("./defaults"),v=t("./compressedObject"),E=t("./zipObject"),b=t("./generate"),I=t("./nodejsUtils"),x=t("./nodejs/NodejsStreamInputAdapter"),A=function(K){K.slice(-1)==="/"&&(K=K.substring(0,K.length-1));var j=K.lastIndexOf("/");return 0<j?K.substring(0,j):""},N=function(K){return K.slice(-1)!=="/"&&(K+="/"),K},U=function(K,j){return j=j!==void 0?j:m.createFolders,K=N(K),this.files[K]||o.call(this,K,null,{dir:!0,createFolders:j}),this.files[K]};function L(K){return Object.prototype.toString.call(K)==="[object RegExp]"}var $={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(K){var j,k,V;for(j in this.files)V=this.files[j],(k=j.slice(this.root.length,j.length))&&j.slice(0,this.root.length)===this.root&&K(k,V)},filter:function(K){var j=[];return this.forEach(function(k,V){K(k,V)&&j.push(V)}),j},file:function(K,j,k){if(arguments.length!==1)return K=this.root+K,o.call(this,K,j,k),this;if(L(K)){var V=K;return this.filter(function(z,G){return!G.dir&&V.test(z)})}var D=this.files[this.root+K];return D&&!D.dir?D:null},folder:function(K){if(!K)return this;if(L(K))return this.filter(function(D,z){return z.dir&&K.test(D)});var j=this.root+K,k=U.call(this,j),V=this.clone();return V.root=k.name,V},remove:function(K){K=this.root+K;var j=this.files[K];if(j||(K.slice(-1)!=="/"&&(K+="/"),j=this.files[K]),j&&!j.dir)delete this.files[K];else for(var k=this.filter(function(D,z){return z.name.slice(0,K.length)===K}),V=0;V<k.length;V++)delete this.files[k[V].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(K){var j,k={};try{if((k=c.extend(K||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=k.type.toLowerCase(),k.compression=k.compression.toUpperCase(),k.type==="binarystring"&&(k.type="string"),!k.type)throw new Error("No output type specified.");c.checkSupport(k.type),k.platform!=="darwin"&&k.platform!=="freebsd"&&k.platform!=="linux"&&k.platform!=="sunos"||(k.platform="UNIX"),k.platform==="win32"&&(k.platform="DOS");var V=k.comment||this.comment||"";j=b.generateWorker(this,k,V)}catch(D){(j=new d("error")).error(D)}return new f(j,k.type||"string",k.mimeType)},generateAsync:function(K,j){return this.generateInternalStream(K).accumulate(j)},generateNodeStream:function(K,j){return(K=K||{}).type||(K.type="nodebuffer"),this.generateInternalStream(K).toNodejsStream(j)}};i.exports=$},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,i,r){i.exports=t("stream")},{stream:void 0}],17:[function(t,i,r){var o=t("./DataReader");function l(c){o.call(this,c);for(var d=0;d<this.data.length;d++)c[d]=255&c[d]}t("../utils").inherits(l,o),l.prototype.byteAt=function(c){return this.data[this.zero+c]},l.prototype.lastIndexOfSignature=function(c){for(var d=c.charCodeAt(0),f=c.charCodeAt(1),m=c.charCodeAt(2),v=c.charCodeAt(3),E=this.length-4;0<=E;--E)if(this.data[E]===d&&this.data[E+1]===f&&this.data[E+2]===m&&this.data[E+3]===v)return E-this.zero;return-1},l.prototype.readAndCheckSignature=function(c){var d=c.charCodeAt(0),f=c.charCodeAt(1),m=c.charCodeAt(2),v=c.charCodeAt(3),E=this.readData(4);return d===E[0]&&f===E[1]&&m===E[2]&&v===E[3]},l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},i.exports=l},{"../utils":32,"./DataReader":18}],18:[function(t,i,r){var o=t("../utils");function l(c){this.data=c,this.length=c.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.length<this.zero+c||c<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+c+"). Corrupted zip ?")},setIndex:function(c){this.checkIndex(c),this.index=c},skip:function(c){this.setIndex(this.index+c)},byteAt:function(){},readInt:function(c){var d,f=0;for(this.checkOffset(c),d=this.index+c-1;d>=this.index;d--)f=(f<<8)+this.byteAt(d);return this.index+=c,f},readString:function(c){return o.transformTo("string",this.readData(c))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var c=this.readInt(4);return new Date(Date.UTC(1980+(c>>25&127),(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(31&c)<<1))}},i.exports=l},{"../utils":32}],19:[function(t,i,r){var o=t("./Uint8ArrayReader");function l(c){o.call(this,c)}t("../utils").inherits(l,o),l.prototype.readData=function(c){this.checkOffset(c);var d=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},i.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,i,r){var o=t("./DataReader");function l(c){o.call(this,c)}t("../utils").inherits(l,o),l.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},l.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},l.prototype.readAndCheckSignature=function(c){return c===this.readData(4)},l.prototype.readData=function(c){this.checkOffset(c);var d=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},i.exports=l},{"../utils":32,"./DataReader":18}],21:[function(t,i,r){var o=t("./ArrayReader");function l(c){o.call(this,c)}t("../utils").inherits(l,o),l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},i.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(t,i,r){var o=t("../utils"),l=t("../support"),c=t("./ArrayReader"),d=t("./StringReader"),f=t("./NodeBufferReader"),m=t("./Uint8ArrayReader");i.exports=function(v){var E=o.getTypeOf(v);return o.checkSupport(E),E!=="string"||l.uint8array?E==="nodebuffer"?new f(v):l.uint8array?new m(o.transformTo("uint8array",v)):new c(o.transformTo("array",v)):new d(v)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,i,r){var o=t("./GenericWorker"),l=t("../utils");function c(d){o.call(this,"ConvertWorker to "+d),this.destType=d}l.inherits(c,o),c.prototype.processChunk=function(d){this.push({data:l.transformTo(this.destType,d.data),meta:d.meta})},i.exports=c},{"../utils":32,"./GenericWorker":28}],25:[function(t,i,r){var o=t("./GenericWorker"),l=t("../crc32");function c(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(c,o),c.prototype.processChunk=function(d){this.streamInfo.crc32=l(d.data,this.streamInfo.crc32||0),this.push(d)},i.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,i,r){var o=t("../utils"),l=t("./GenericWorker");function c(d){l.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}o.inherits(c,l),c.prototype.processChunk=function(d){if(d){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+d.data.length}l.prototype.processChunk.call(this,d)},i.exports=c},{"../utils":32,"./GenericWorker":28}],27:[function(t,i,r){var o=t("../utils"),l=t("./GenericWorker");function c(d){l.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(m){f.dataIsReady=!0,f.data=m,f.max=m&&m.length||0,f.type=o.getTypeOf(m),f.isPaused||f._tickAndRepeat()},function(m){f.error(m)})}o.inherits(c,l),c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,f);break;case"uint8array":d=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":d=this.data.slice(this.index,f)}return this.index=f,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(t,i,r){function o(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,c){return this._listeners[l].push(c),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,c){if(this._listeners[l])for(var d=0;d<this._listeners[l].length;d++)this._listeners[l][d].call(this,c)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var c=this;return l.on("data",function(d){c.processChunk(d)}),l.on("end",function(){c.end()}),l.on("error",function(d){c.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,c){return this.extraStreamInfo[l]=c,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},i.exports=o},{}],29:[function(t,i,r){var o=t("../utils"),l=t("./ConvertWorker"),c=t("./GenericWorker"),d=t("../base64"),f=t("../support"),m=t("../external"),v=null;if(f.nodestream)try{v=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function E(I,x){return new m.Promise(function(A,N){var U=[],L=I._internalType,$=I._outputType,K=I._mimeType;I.on("data",function(j,k){U.push(j),x&&x(k)}).on("error",function(j){U=[],N(j)}).on("end",function(){try{var j=(function(k,V,D){switch(k){case"blob":return o.newBlob(o.transformTo("arraybuffer",V),D);case"base64":return d.encode(V);default:return o.transformTo(k,V)}})($,(function(k,V){var D,z=0,G=null,M=0;for(D=0;D<V.length;D++)M+=V[D].length;switch(k){case"string":return V.join("");case"array":return Array.prototype.concat.apply([],V);case"uint8array":for(G=new Uint8Array(M),D=0;D<V.length;D++)G.set(V[D],z),z+=V[D].length;return G;case"nodebuffer":return Buffer.concat(V);default:throw new Error("concat : unsupported type '"+k+"'")}})(L,U),K);A(j)}catch(k){N(k)}U=[]}).resume()})}function b(I,x,A){var N=x;switch(x){case"blob":case"arraybuffer":N="uint8array";break;case"base64":N="string"}try{this._internalType=N,this._outputType=x,this._mimeType=A,o.checkSupport(N),this._worker=I.pipe(new l(N)),I.lock()}catch(U){this._worker=new c("error"),this._worker.error(U)}}b.prototype={accumulate:function(I){return E(this,I)},on:function(I,x){var A=this;return I==="data"?this._worker.on(I,function(N){x.call(A,N.data,N.meta)}):this._worker.on(I,function(){o.delay(x,arguments,A)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(I){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new v(this,{objectMode:this._outputType!=="nodebuffer"},I)}},i.exports=b},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var o=new ArrayBuffer(0);try{r.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(o),r.blob=l.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(t,i,r){for(var o=t("./utils"),l=t("./support"),c=t("./nodejsUtils"),d=t("./stream/GenericWorker"),f=new Array(256),m=0;m<256;m++)f[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;f[254]=f[254]=1;function v(){d.call(this,"utf-8 decode"),this.leftOver=null}function E(){d.call(this,"utf-8 encode")}r.utf8encode=function(b){return l.nodebuffer?c.newBufferFrom(b,"utf-8"):(function(I){var x,A,N,U,L,$=I.length,K=0;for(U=0;U<$;U++)(64512&(A=I.charCodeAt(U)))==55296&&U+1<$&&(64512&(N=I.charCodeAt(U+1)))==56320&&(A=65536+(A-55296<<10)+(N-56320),U++),K+=A<128?1:A<2048?2:A<65536?3:4;for(x=l.uint8array?new Uint8Array(K):new Array(K),U=L=0;L<K;U++)(64512&(A=I.charCodeAt(U)))==55296&&U+1<$&&(64512&(N=I.charCodeAt(U+1)))==56320&&(A=65536+(A-55296<<10)+(N-56320),U++),A<128?x[L++]=A:(A<2048?x[L++]=192|A>>>6:(A<65536?x[L++]=224|A>>>12:(x[L++]=240|A>>>18,x[L++]=128|A>>>12&63),x[L++]=128|A>>>6&63),x[L++]=128|63&A);return x})(b)},r.utf8decode=function(b){return l.nodebuffer?o.transformTo("nodebuffer",b).toString("utf-8"):(function(I){var x,A,N,U,L=I.length,$=new Array(2*L);for(x=A=0;x<L;)if((N=I[x++])<128)$[A++]=N;else if(4<(U=f[N]))$[A++]=65533,x+=U-1;else{for(N&=U===2?31:U===3?15:7;1<U&&x<L;)N=N<<6|63&I[x++],U--;1<U?$[A++]=65533:N<65536?$[A++]=N:(N-=65536,$[A++]=55296|N>>10&1023,$[A++]=56320|1023&N)}return $.length!==A&&($.subarray?$=$.subarray(0,A):$.length=A),o.applyFromCharCode($)})(b=o.transformTo(l.uint8array?"uint8array":"array",b))},o.inherits(v,d),v.prototype.processChunk=function(b){var I=o.transformTo(l.uint8array?"uint8array":"array",b.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var x=I;(I=new Uint8Array(x.length+this.leftOver.length)).set(this.leftOver,0),I.set(x,this.leftOver.length)}else I=this.leftOver.concat(I);this.leftOver=null}var A=(function(U,L){var $;for((L=L||U.length)>U.length&&(L=U.length),$=L-1;0<=$&&(192&U[$])==128;)$--;return $<0||$===0?L:$+f[U[$]]>L?$:L})(I),N=I;A!==I.length&&(l.uint8array?(N=I.subarray(0,A),this.leftOver=I.subarray(A,I.length)):(N=I.slice(0,A),this.leftOver=I.slice(A,I.length))),this.push({data:r.utf8decode(N),meta:b.meta})},v.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=v,o.inherits(E,d),E.prototype.processChunk=function(b){this.push({data:r.utf8encode(b.data),meta:b.meta})},r.Utf8EncodeWorker=E},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,i,r){var o=t("./support"),l=t("./base64"),c=t("./nodejsUtils"),d=t("./external");function f(x){return x}function m(x,A){for(var N=0;N<x.length;++N)A[N]=255&x.charCodeAt(N);return A}t("setimmediate"),r.newBlob=function(x,A){r.checkSupport("blob");try{return new Blob([x],{type:A})}catch{try{var N=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return N.append(x),N.getBlob(A)}catch{throw new Error("Bug : can't construct the Blob.")}}};var v={stringifyByChunk:function(x,A,N){var U=[],L=0,$=x.length;if($<=N)return String.fromCharCode.apply(null,x);for(;L<$;)A==="array"||A==="nodebuffer"?U.push(String.fromCharCode.apply(null,x.slice(L,Math.min(L+N,$)))):U.push(String.fromCharCode.apply(null,x.subarray(L,Math.min(L+N,$)))),L+=N;return U.join("")},stringifyByChar:function(x){for(var A="",N=0;N<x.length;N++)A+=String.fromCharCode(x[N]);return A},applyCanBeUsed:{uint8array:(function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,c.allocBuffer(1)).length===1}catch{return!1}})()}};function E(x){var A=65536,N=r.getTypeOf(x),U=!0;if(N==="uint8array"?U=v.applyCanBeUsed.uint8array:N==="nodebuffer"&&(U=v.applyCanBeUsed.nodebuffer),U)for(;1<A;)try{return v.stringifyByChunk(x,N,A)}catch{A=Math.floor(A/2)}return v.stringifyByChar(x)}function b(x,A){for(var N=0;N<x.length;N++)A[N]=x[N];return A}r.applyFromCharCode=E;var I={};I.string={string:f,array:function(x){return m(x,new Array(x.length))},arraybuffer:function(x){return I.string.uint8array(x).buffer},uint8array:function(x){return m(x,new Uint8Array(x.length))},nodebuffer:function(x){return m(x,c.allocBuffer(x.length))}},I.array={string:E,array:f,arraybuffer:function(x){return new Uint8Array(x).buffer},uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return c.newBufferFrom(x)}},I.arraybuffer={string:function(x){return E(new Uint8Array(x))},array:function(x){return b(new Uint8Array(x),new Array(x.byteLength))},arraybuffer:f,uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return c.newBufferFrom(new Uint8Array(x))}},I.uint8array={string:E,array:function(x){return b(x,new Array(x.length))},arraybuffer:function(x){return x.buffer},uint8array:f,nodebuffer:function(x){return c.newBufferFrom(x)}},I.nodebuffer={string:E,array:function(x){return b(x,new Array(x.length))},arraybuffer:function(x){return I.nodebuffer.uint8array(x).buffer},uint8array:function(x){return b(x,new Uint8Array(x.length))},nodebuffer:f},r.transformTo=function(x,A){if(A=A||"",!x)return A;r.checkSupport(x);var N=r.getTypeOf(A);return I[N][x](A)},r.resolve=function(x){for(var A=x.split("/"),N=[],U=0;U<A.length;U++){var L=A[U];L==="."||L===""&&U!==0&&U!==A.length-1||(L===".."?N.pop():N.push(L))}return N.join("/")},r.getTypeOf=function(x){return typeof x=="string"?"string":Object.prototype.toString.call(x)==="[object Array]"?"array":o.nodebuffer&&c.isBuffer(x)?"nodebuffer":o.uint8array&&x instanceof Uint8Array?"uint8array":o.arraybuffer&&x instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(x){if(!o[x.toLowerCase()])throw new Error(x+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(x){var A,N,U="";for(N=0;N<(x||"").length;N++)U+="\\x"+((A=x.charCodeAt(N))<16?"0":"")+A.toString(16).toUpperCase();return U},r.delay=function(x,A,N){setImmediate(function(){x.apply(N||null,A||[])})},r.inherits=function(x,A){function N(){}N.prototype=A.prototype,x.prototype=new N},r.extend=function(){var x,A,N={};for(x=0;x<arguments.length;x++)for(A in arguments[x])Object.prototype.hasOwnProperty.call(arguments[x],A)&&N[A]===void 0&&(N[A]=arguments[x][A]);return N},r.prepareContent=function(x,A,N,U,L){return d.Promise.resolve(A).then(function($){return o.blob&&($ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call($))!==-1)&&typeof FileReader<"u"?new d.Promise(function(K,j){var k=new FileReader;k.onload=function(V){K(V.target.result)},k.onerror=function(V){j(V.target.error)},k.readAsArrayBuffer($)}):$}).then(function($){var K=r.getTypeOf($);return K?(K==="arraybuffer"?$=r.transformTo("uint8array",$):K==="string"&&(L?$=l.decode($):N&&U!==!0&&($=(function(j){return m(j,o.uint8array?new Uint8Array(j.length):new Array(j.length))})($))),$):d.Promise.reject(new Error("Can't read the data of '"+x+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,i,r){var o=t("./reader/readerFor"),l=t("./utils"),c=t("./signature"),d=t("./zipEntry"),f=t("./support");function m(v){this.files=[],this.loadOptions=v}m.prototype={checkSignature:function(v){if(!this.reader.readAndCheckSignature(v)){this.reader.index-=4;var E=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(E)+", expected "+l.pretty(v)+")")}},isSignature:function(v,E){var b=this.reader.index;this.reader.setIndex(v);var I=this.reader.readString(4)===E;return this.reader.setIndex(b),I},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var v=this.reader.readData(this.zipCommentLength),E=f.uint8array?"uint8array":"array",b=l.transformTo(E,v);this.zipComment=this.loadOptions.decodeFileName(b)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var v,E,b,I=this.zip64EndOfCentralSize-44;0<I;)v=this.reader.readInt(2),E=this.reader.readInt(4),b=this.reader.readData(E),this.zip64ExtensibleData[v]={id:v,length:E,value:b}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var v,E;for(v=0;v<this.files.length;v++)E=this.files[v],this.reader.setIndex(E.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),E.readLocalPart(this.reader),E.handleUTF8(),E.processAttributes()},readCentralDir:function(){var v;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(c.CENTRAL_FILE_HEADER);)(v=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(v);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var v=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(v<0)throw this.isSignature(0,c.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(v);var E=v;if(this.checkSignature(c.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(v=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(v),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var b=this.centralDirOffset+this.centralDirSize;this.zip64&&(b+=20,b+=12+this.zip64EndOfCentralSize);var I=E-b;if(0<I)this.isSignature(E,c.CENTRAL_FILE_HEADER)||(this.reader.zero=I);else if(I<0)throw new Error("Corrupted zip: missing "+Math.abs(I)+" bytes.")},prepareReader:function(v){this.reader=o(v)},load:function(v){this.prepareReader(v),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,i,r){var o=t("./reader/readerFor"),l=t("./utils"),c=t("./compressedObject"),d=t("./crc32"),f=t("./utf8"),m=t("./compressions"),v=t("./support");function E(b,I){this.options=b,this.loadOptions=I}E.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(b){var I,x;if(b.skip(22),this.fileNameLength=b.readInt(2),x=b.readInt(2),this.fileName=b.readData(this.fileNameLength),b.skip(x),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((I=(function(A){for(var N in m)if(Object.prototype.hasOwnProperty.call(m,N)&&m[N].magic===A)return m[N];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new c(this.compressedSize,this.uncompressedSize,this.crc32,I,b.readData(this.compressedSize))},readCentralPart:function(b){this.versionMadeBy=b.readInt(2),b.skip(2),this.bitFlag=b.readInt(2),this.compressionMethod=b.readString(2),this.date=b.readDate(),this.crc32=b.readInt(4),this.compressedSize=b.readInt(4),this.uncompressedSize=b.readInt(4);var I=b.readInt(2);if(this.extraFieldsLength=b.readInt(2),this.fileCommentLength=b.readInt(2),this.diskNumberStart=b.readInt(2),this.internalFileAttributes=b.readInt(2),this.externalFileAttributes=b.readInt(4),this.localHeaderOffset=b.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");b.skip(I),this.readExtraFields(b),this.parseZIP64ExtraField(b),this.fileComment=b.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var b=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),b==0&&(this.dosPermissions=63&this.externalFileAttributes),b==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var b=o(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=b.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=b.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=b.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=b.readInt(4))}},readExtraFields:function(b){var I,x,A,N=b.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});b.index+4<N;)I=b.readInt(2),x=b.readInt(2),A=b.readData(x),this.extraFields[I]={id:I,length:x,value:A};b.setIndex(N)},handleUTF8:function(){var b=v.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var I=this.findExtraFieldUnicodePath();if(I!==null)this.fileNameStr=I;else{var x=l.transformTo(b,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(x)}var A=this.findExtraFieldUnicodeComment();if(A!==null)this.fileCommentStr=A;else{var N=l.transformTo(b,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(N)}}},findExtraFieldUnicodePath:function(){var b=this.extraFields[28789];if(b){var I=o(b.value);return I.readInt(1)!==1||d(this.fileName)!==I.readInt(4)?null:f.utf8decode(I.readData(b.length-5))}return null},findExtraFieldUnicodeComment:function(){var b=this.extraFields[25461];if(b){var I=o(b.value);return I.readInt(1)!==1||d(this.fileComment)!==I.readInt(4)?null:f.utf8decode(I.readData(b.length-5))}return null}},i.exports=E},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,i,r){function o(I,x,A){this.name=I,this.dir=A.dir,this.date=A.date,this.comment=A.comment,this.unixPermissions=A.unixPermissions,this.dosPermissions=A.dosPermissions,this._data=x,this._dataBinary=A.binary,this.options={compression:A.compression,compressionOptions:A.compressionOptions}}var l=t("./stream/StreamHelper"),c=t("./stream/DataWorker"),d=t("./utf8"),f=t("./compressedObject"),m=t("./stream/GenericWorker");o.prototype={internalStream:function(I){var x=null,A="string";try{if(!I)throw new Error("No output type specified.");var N=(A=I.toLowerCase())==="string"||A==="text";A!=="binarystring"&&A!=="text"||(A="string"),x=this._decompressWorker();var U=!this._dataBinary;U&&!N&&(x=x.pipe(new d.Utf8EncodeWorker)),!U&&N&&(x=x.pipe(new d.Utf8DecodeWorker))}catch(L){(x=new m("error")).error(L)}return new l(x,A,"")},async:function(I,x){return this.internalStream(I).accumulate(x)},nodeStream:function(I,x){return this.internalStream(I||"nodebuffer").toNodejsStream(x)},_compressWorker:function(I,x){if(this._data instanceof f&&this._data.compression.magic===I.magic)return this._data.getCompressedWorker();var A=this._decompressWorker();return this._dataBinary||(A=A.pipe(new d.Utf8EncodeWorker)),f.createWorkerFrom(A,I,x)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof m?this._data:new c(this._data)}};for(var v=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],E=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},b=0;b<v.length;b++)o.prototype[v[b]]=E;i.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,i,r){(function(o){var l,c,d=o.MutationObserver||o.WebKitMutationObserver;if(d){var f=0,m=new d(I),v=o.document.createTextNode("");m.observe(v,{characterData:!0}),l=function(){v.data=f=++f%2}}else if(o.setImmediate||o.MessageChannel===void 0)l="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var x=o.document.createElement("script");x.onreadystatechange=function(){I(),x.onreadystatechange=null,x.parentNode.removeChild(x),x=null},o.document.documentElement.appendChild(x)}:function(){setTimeout(I,0)};else{var E=new o.MessageChannel;E.port1.onmessage=I,l=function(){E.port2.postMessage(0)}}var b=[];function I(){var x,A;c=!0;for(var N=b.length;N;){for(A=b,b=[],x=-1;++x<N;)A[x]();N=b.length}c=!1}i.exports=function(x){b.push(x)!==1||c||l()}}).call(this,typeof oh<"u"?oh:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,i,r){var o=t("immediate");function l(){}var c={},d=["REJECTED"],f=["FULFILLED"],m=["PENDING"];function v(N){if(typeof N!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,N!==l&&x(this,N)}function E(N,U,L){this.promise=N,typeof U=="function"&&(this.onFulfilled=U,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function b(N,U,L){o(function(){var $;try{$=U(L)}catch(K){return c.reject(N,K)}$===N?c.reject(N,new TypeError("Cannot resolve promise with itself")):c.resolve(N,$)})}function I(N){var U=N&&N.then;if(N&&(typeof N=="object"||typeof N=="function")&&typeof U=="function")return function(){U.apply(N,arguments)}}function x(N,U){var L=!1;function $(k){L||(L=!0,c.reject(N,k))}function K(k){L||(L=!0,c.resolve(N,k))}var j=A(function(){U(K,$)});j.status==="error"&&$(j.value)}function A(N,U){var L={};try{L.value=N(U),L.status="success"}catch($){L.status="error",L.value=$}return L}(i.exports=v).prototype.finally=function(N){if(typeof N!="function")return this;var U=this.constructor;return this.then(function(L){return U.resolve(N()).then(function(){return L})},function(L){return U.resolve(N()).then(function(){throw L})})},v.prototype.catch=function(N){return this.then(null,N)},v.prototype.then=function(N,U){if(typeof N!="function"&&this.state===f||typeof U!="function"&&this.state===d)return this;var L=new this.constructor(l);return this.state!==m?b(L,this.state===f?N:U,this.outcome):this.queue.push(new E(L,N,U)),L},E.prototype.callFulfilled=function(N){c.resolve(this.promise,N)},E.prototype.otherCallFulfilled=function(N){b(this.promise,this.onFulfilled,N)},E.prototype.callRejected=function(N){c.reject(this.promise,N)},E.prototype.otherCallRejected=function(N){b(this.promise,this.onRejected,N)},c.resolve=function(N,U){var L=A(I,U);if(L.status==="error")return c.reject(N,L.value);var $=L.value;if($)x(N,$);else{N.state=f,N.outcome=U;for(var K=-1,j=N.queue.length;++K<j;)N.queue[K].callFulfilled(U)}return N},c.reject=function(N,U){N.state=d,N.outcome=U;for(var L=-1,$=N.queue.length;++L<$;)N.queue[L].callRejected(U);return N},v.resolve=function(N){return N instanceof this?N:c.resolve(new this(l),N)},v.reject=function(N){var U=new this(l);return c.reject(U,N)},v.all=function(N){var U=this;if(Object.prototype.toString.call(N)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=N.length,$=!1;if(!L)return this.resolve([]);for(var K=new Array(L),j=0,k=-1,V=new this(l);++k<L;)D(N[k],k);return V;function D(z,G){U.resolve(z).then(function(M){K[G]=M,++j!==L||$||($=!0,c.resolve(V,K))},function(M){$||($=!0,c.reject(V,M))})}},v.race=function(N){var U=this;if(Object.prototype.toString.call(N)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=N.length,$=!1;if(!L)return this.resolve([]);for(var K=-1,j=new this(l);++K<L;)k=N[K],U.resolve(k).then(function(V){$||($=!0,c.resolve(j,V))},function(V){$||($=!0,c.reject(j,V))});var k;return j}},{immediate:36}],38:[function(t,i,r){var o={};(0,t("./lib/utils/common").assign)(o,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),i.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,i,r){var o=t("./zlib/deflate"),l=t("./utils/common"),c=t("./utils/strings"),d=t("./zlib/messages"),f=t("./zlib/zstream"),m=Object.prototype.toString,v=0,E=-1,b=0,I=8;function x(N){if(!(this instanceof x))return new x(N);this.options=l.assign({level:E,method:I,chunkSize:16384,windowBits:15,memLevel:8,strategy:b,to:""},N||{});var U=this.options;U.raw&&0<U.windowBits?U.windowBits=-U.windowBits:U.gzip&&0<U.windowBits&&U.windowBits<16&&(U.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var L=o.deflateInit2(this.strm,U.level,U.method,U.windowBits,U.memLevel,U.strategy);if(L!==v)throw new Error(d[L]);if(U.header&&o.deflateSetHeader(this.strm,U.header),U.dictionary){var $;if($=typeof U.dictionary=="string"?c.string2buf(U.dictionary):m.call(U.dictionary)==="[object ArrayBuffer]"?new Uint8Array(U.dictionary):U.dictionary,(L=o.deflateSetDictionary(this.strm,$))!==v)throw new Error(d[L]);this._dict_set=!0}}function A(N,U){var L=new x(U);if(L.push(N,!0),L.err)throw L.msg||d[L.err];return L.result}x.prototype.push=function(N,U){var L,$,K=this.strm,j=this.options.chunkSize;if(this.ended)return!1;$=U===~~U?U:U===!0?4:0,typeof N=="string"?K.input=c.string2buf(N):m.call(N)==="[object ArrayBuffer]"?K.input=new Uint8Array(N):K.input=N,K.next_in=0,K.avail_in=K.input.length;do{if(K.avail_out===0&&(K.output=new l.Buf8(j),K.next_out=0,K.avail_out=j),(L=o.deflate(K,$))!==1&&L!==v)return this.onEnd(L),!(this.ended=!0);K.avail_out!==0&&(K.avail_in!==0||$!==4&&$!==2)||(this.options.to==="string"?this.onData(c.buf2binstring(l.shrinkBuf(K.output,K.next_out))):this.onData(l.shrinkBuf(K.output,K.next_out)))}while((0<K.avail_in||K.avail_out===0)&&L!==1);return $===4?(L=o.deflateEnd(this.strm),this.onEnd(L),this.ended=!0,L===v):$!==2||(this.onEnd(v),!(K.avail_out=0))},x.prototype.onData=function(N){this.chunks.push(N)},x.prototype.onEnd=function(N){N===v&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=N,this.msg=this.strm.msg},r.Deflate=x,r.deflate=A,r.deflateRaw=function(N,U){return(U=U||{}).raw=!0,A(N,U)},r.gzip=function(N,U){return(U=U||{}).gzip=!0,A(N,U)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,i,r){var o=t("./zlib/inflate"),l=t("./utils/common"),c=t("./utils/strings"),d=t("./zlib/constants"),f=t("./zlib/messages"),m=t("./zlib/zstream"),v=t("./zlib/gzheader"),E=Object.prototype.toString;function b(x){if(!(this instanceof b))return new b(x);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},x||{});var A=this.options;A.raw&&0<=A.windowBits&&A.windowBits<16&&(A.windowBits=-A.windowBits,A.windowBits===0&&(A.windowBits=-15)),!(0<=A.windowBits&&A.windowBits<16)||x&&x.windowBits||(A.windowBits+=32),15<A.windowBits&&A.windowBits<48&&(15&A.windowBits)==0&&(A.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var N=o.inflateInit2(this.strm,A.windowBits);if(N!==d.Z_OK)throw new Error(f[N]);this.header=new v,o.inflateGetHeader(this.strm,this.header)}function I(x,A){var N=new b(A);if(N.push(x,!0),N.err)throw N.msg||f[N.err];return N.result}b.prototype.push=function(x,A){var N,U,L,$,K,j,k=this.strm,V=this.options.chunkSize,D=this.options.dictionary,z=!1;if(this.ended)return!1;U=A===~~A?A:A===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof x=="string"?k.input=c.binstring2buf(x):E.call(x)==="[object ArrayBuffer]"?k.input=new Uint8Array(x):k.input=x,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new l.Buf8(V),k.next_out=0,k.avail_out=V),(N=o.inflate(k,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&D&&(j=typeof D=="string"?c.string2buf(D):E.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,N=o.inflateSetDictionary(this.strm,j)),N===d.Z_BUF_ERROR&&z===!0&&(N=d.Z_OK,z=!1),N!==d.Z_STREAM_END&&N!==d.Z_OK)return this.onEnd(N),!(this.ended=!0);k.next_out&&(k.avail_out!==0&&N!==d.Z_STREAM_END&&(k.avail_in!==0||U!==d.Z_FINISH&&U!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(L=c.utf8border(k.output,k.next_out),$=k.next_out-L,K=c.buf2string(k.output,L),k.next_out=$,k.avail_out=V-$,$&&l.arraySet(k.output,k.output,L,$,0),this.onData(K)):this.onData(l.shrinkBuf(k.output,k.next_out)))),k.avail_in===0&&k.avail_out===0&&(z=!0)}while((0<k.avail_in||k.avail_out===0)&&N!==d.Z_STREAM_END);return N===d.Z_STREAM_END&&(U=d.Z_FINISH),U===d.Z_FINISH?(N=o.inflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===d.Z_OK):U!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(k.avail_out=0))},b.prototype.onData=function(x){this.chunks.push(x)},b.prototype.onEnd=function(x){x===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},r.Inflate=b,r.inflate=I,r.inflateRaw=function(x,A){return(A=A||{}).raw=!0,I(x,A)},r.ungzip=I},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,i,r){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(d){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var m=f.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var v in m)m.hasOwnProperty(v)&&(d[v]=m[v])}}return d},r.shrinkBuf=function(d,f){return d.length===f?d:d.subarray?d.subarray(0,f):(d.length=f,d)};var l={arraySet:function(d,f,m,v,E){if(f.subarray&&d.subarray)d.set(f.subarray(m,m+v),E);else for(var b=0;b<v;b++)d[E+b]=f[m+b]},flattenChunks:function(d){var f,m,v,E,b,I;for(f=v=0,m=d.length;f<m;f++)v+=d[f].length;for(I=new Uint8Array(v),f=E=0,m=d.length;f<m;f++)b=d[f],I.set(b,E),E+=b.length;return I}},c={arraySet:function(d,f,m,v,E){for(var b=0;b<v;b++)d[E+b]=f[m+b]},flattenChunks:function(d){return[].concat.apply([],d)}};r.setTyped=function(d){d?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,l)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,c))},r.setTyped(o)},{}],42:[function(t,i,r){var o=t("./common"),l=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{c=!1}for(var d=new o.Buf8(256),f=0;f<256;f++)d[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function m(v,E){if(E<65537&&(v.subarray&&c||!v.subarray&&l))return String.fromCharCode.apply(null,o.shrinkBuf(v,E));for(var b="",I=0;I<E;I++)b+=String.fromCharCode(v[I]);return b}d[254]=d[254]=1,r.string2buf=function(v){var E,b,I,x,A,N=v.length,U=0;for(x=0;x<N;x++)(64512&(b=v.charCodeAt(x)))==55296&&x+1<N&&(64512&(I=v.charCodeAt(x+1)))==56320&&(b=65536+(b-55296<<10)+(I-56320),x++),U+=b<128?1:b<2048?2:b<65536?3:4;for(E=new o.Buf8(U),x=A=0;A<U;x++)(64512&(b=v.charCodeAt(x)))==55296&&x+1<N&&(64512&(I=v.charCodeAt(x+1)))==56320&&(b=65536+(b-55296<<10)+(I-56320),x++),b<128?E[A++]=b:(b<2048?E[A++]=192|b>>>6:(b<65536?E[A++]=224|b>>>12:(E[A++]=240|b>>>18,E[A++]=128|b>>>12&63),E[A++]=128|b>>>6&63),E[A++]=128|63&b);return E},r.buf2binstring=function(v){return m(v,v.length)},r.binstring2buf=function(v){for(var E=new o.Buf8(v.length),b=0,I=E.length;b<I;b++)E[b]=v.charCodeAt(b);return E},r.buf2string=function(v,E){var b,I,x,A,N=E||v.length,U=new Array(2*N);for(b=I=0;b<N;)if((x=v[b++])<128)U[I++]=x;else if(4<(A=d[x]))U[I++]=65533,b+=A-1;else{for(x&=A===2?31:A===3?15:7;1<A&&b<N;)x=x<<6|63&v[b++],A--;1<A?U[I++]=65533:x<65536?U[I++]=x:(x-=65536,U[I++]=55296|x>>10&1023,U[I++]=56320|1023&x)}return m(U,I)},r.utf8border=function(v,E){var b;for((E=E||v.length)>v.length&&(E=v.length),b=E-1;0<=b&&(192&v[b])==128;)b--;return b<0||b===0?E:b+d[v[b]]>E?b:E}},{"./common":41}],43:[function(t,i,r){i.exports=function(o,l,c,d){for(var f=65535&o|0,m=o>>>16&65535|0,v=0;c!==0;){for(c-=v=2e3<c?2e3:c;m=m+(f=f+l[d++]|0)|0,--v;);f%=65521,m%=65521}return f|m<<16|0}},{}],44:[function(t,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,i,r){var o=(function(){for(var l,c=[],d=0;d<256;d++){l=d;for(var f=0;f<8;f++)l=1&l?3988292384^l>>>1:l>>>1;c[d]=l}return c})();i.exports=function(l,c,d,f){var m=o,v=f+d;l^=-1;for(var E=f;E<v;E++)l=l>>>8^m[255&(l^c[E])];return-1^l}},{}],46:[function(t,i,r){var o,l=t("../utils/common"),c=t("./trees"),d=t("./adler32"),f=t("./crc32"),m=t("./messages"),v=0,E=4,b=0,I=-2,x=-1,A=4,N=2,U=8,L=9,$=286,K=30,j=19,k=2*$+1,V=15,D=3,z=258,G=z+D+1,M=42,B=113,O=1,oe=2,X=3,Q=4;function se(C,ie){return C.msg=m[ie],ie}function ne(C){return(C<<1)-(4<C?9:0)}function ue(C){for(var ie=C.length;0<=--ie;)C[ie]=0}function F(C){var ie=C.state,re=ie.pending;re>C.avail_out&&(re=C.avail_out),re!==0&&(l.arraySet(C.output,ie.pending_buf,ie.pending_out,re,C.next_out),C.next_out+=re,ie.pending_out+=re,C.total_out+=re,C.avail_out-=re,ie.pending-=re,ie.pending===0&&(ie.pending_out=0))}function W(C,ie){c._tr_flush_block(C,0<=C.block_start?C.block_start:-1,C.strstart-C.block_start,ie),C.block_start=C.strstart,F(C.strm)}function ye(C,ie){C.pending_buf[C.pending++]=ie}function _e(C,ie){C.pending_buf[C.pending++]=ie>>>8&255,C.pending_buf[C.pending++]=255&ie}function Ee(C,ie){var re,Y,J=C.max_chain_length,ee=C.strstart,be=C.prev_length,Ie=C.nice_match,de=C.strstart>C.w_size-G?C.strstart-(C.w_size-G):0,Me=C.window,De=C.w_mask,ke=C.prev,He=C.strstart+z,ct=Me[ee+be-1],nt=Me[ee+be];C.prev_length>=C.good_match&&(J>>=2),Ie>C.lookahead&&(Ie=C.lookahead);do if(Me[(re=ie)+be]===nt&&Me[re+be-1]===ct&&Me[re]===Me[ee]&&Me[++re]===Me[ee+1]){ee+=2,re++;do;while(Me[++ee]===Me[++re]&&Me[++ee]===Me[++re]&&Me[++ee]===Me[++re]&&Me[++ee]===Me[++re]&&Me[++ee]===Me[++re]&&Me[++ee]===Me[++re]&&Me[++ee]===Me[++re]&&Me[++ee]===Me[++re]&&ee<He);if(Y=z-(He-ee),ee=He-z,be<Y){if(C.match_start=ie,Ie<=(be=Y))break;ct=Me[ee+be-1],nt=Me[ee+be]}}while((ie=ke[ie&De])>de&&--J!=0);return be<=C.lookahead?be:C.lookahead}function ze(C){var ie,re,Y,J,ee,be,Ie,de,Me,De,ke=C.w_size;do{if(J=C.window_size-C.lookahead-C.strstart,C.strstart>=ke+(ke-G)){for(l.arraySet(C.window,C.window,ke,ke,0),C.match_start-=ke,C.strstart-=ke,C.block_start-=ke,ie=re=C.hash_size;Y=C.head[--ie],C.head[ie]=ke<=Y?Y-ke:0,--re;);for(ie=re=ke;Y=C.prev[--ie],C.prev[ie]=ke<=Y?Y-ke:0,--re;);J+=ke}if(C.strm.avail_in===0)break;if(be=C.strm,Ie=C.window,de=C.strstart+C.lookahead,Me=J,De=void 0,De=be.avail_in,Me<De&&(De=Me),re=De===0?0:(be.avail_in-=De,l.arraySet(Ie,be.input,be.next_in,De,de),be.state.wrap===1?be.adler=d(be.adler,Ie,De,de):be.state.wrap===2&&(be.adler=f(be.adler,Ie,De,de)),be.next_in+=De,be.total_in+=De,De),C.lookahead+=re,C.lookahead+C.insert>=D)for(ee=C.strstart-C.insert,C.ins_h=C.window[ee],C.ins_h=(C.ins_h<<C.hash_shift^C.window[ee+1])&C.hash_mask;C.insert&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[ee+D-1])&C.hash_mask,C.prev[ee&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=ee,ee++,C.insert--,!(C.lookahead+C.insert<D)););}while(C.lookahead<G&&C.strm.avail_in!==0)}function Qe(C,ie){for(var re,Y;;){if(C.lookahead<G){if(ze(C),C.lookahead<G&&ie===v)return O;if(C.lookahead===0)break}if(re=0,C.lookahead>=D&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+D-1])&C.hash_mask,re=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),re!==0&&C.strstart-re<=C.w_size-G&&(C.match_length=Ee(C,re)),C.match_length>=D)if(Y=c._tr_tally(C,C.strstart-C.match_start,C.match_length-D),C.lookahead-=C.match_length,C.match_length<=C.max_lazy_match&&C.lookahead>=D){for(C.match_length--;C.strstart++,C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+D-1])&C.hash_mask,re=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart,--C.match_length!=0;);C.strstart++}else C.strstart+=C.match_length,C.match_length=0,C.ins_h=C.window[C.strstart],C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+1])&C.hash_mask;else Y=c._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++;if(Y&&(W(C,!1),C.strm.avail_out===0))return O}return C.insert=C.strstart<D-1?C.strstart:D-1,ie===E?(W(C,!0),C.strm.avail_out===0?X:Q):C.last_lit&&(W(C,!1),C.strm.avail_out===0)?O:oe}function Je(C,ie){for(var re,Y,J;;){if(C.lookahead<G){if(ze(C),C.lookahead<G&&ie===v)return O;if(C.lookahead===0)break}if(re=0,C.lookahead>=D&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+D-1])&C.hash_mask,re=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),C.prev_length=C.match_length,C.prev_match=C.match_start,C.match_length=D-1,re!==0&&C.prev_length<C.max_lazy_match&&C.strstart-re<=C.w_size-G&&(C.match_length=Ee(C,re),C.match_length<=5&&(C.strategy===1||C.match_length===D&&4096<C.strstart-C.match_start)&&(C.match_length=D-1)),C.prev_length>=D&&C.match_length<=C.prev_length){for(J=C.strstart+C.lookahead-D,Y=c._tr_tally(C,C.strstart-1-C.prev_match,C.prev_length-D),C.lookahead-=C.prev_length-1,C.prev_length-=2;++C.strstart<=J&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+D-1])&C.hash_mask,re=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),--C.prev_length!=0;);if(C.match_available=0,C.match_length=D-1,C.strstart++,Y&&(W(C,!1),C.strm.avail_out===0))return O}else if(C.match_available){if((Y=c._tr_tally(C,0,C.window[C.strstart-1]))&&W(C,!1),C.strstart++,C.lookahead--,C.strm.avail_out===0)return O}else C.match_available=1,C.strstart++,C.lookahead--}return C.match_available&&(Y=c._tr_tally(C,0,C.window[C.strstart-1]),C.match_available=0),C.insert=C.strstart<D-1?C.strstart:D-1,ie===E?(W(C,!0),C.strm.avail_out===0?X:Q):C.last_lit&&(W(C,!1),C.strm.avail_out===0)?O:oe}function Ne(C,ie,re,Y,J){this.good_length=C,this.max_lazy=ie,this.nice_length=re,this.max_chain=Y,this.func=J}function Ge(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=U,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*k),this.dyn_dtree=new l.Buf16(2*(2*K+1)),this.bl_tree=new l.Buf16(2*(2*j+1)),ue(this.dyn_ltree),ue(this.dyn_dtree),ue(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(V+1),this.heap=new l.Buf16(2*$+1),ue(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*$+1),ue(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ye(C){var ie;return C&&C.state?(C.total_in=C.total_out=0,C.data_type=N,(ie=C.state).pending=0,ie.pending_out=0,ie.wrap<0&&(ie.wrap=-ie.wrap),ie.status=ie.wrap?M:B,C.adler=ie.wrap===2?0:1,ie.last_flush=v,c._tr_init(ie),b):se(C,I)}function gt(C){var ie=Ye(C);return ie===b&&(function(re){re.window_size=2*re.w_size,ue(re.head),re.max_lazy_match=o[re.level].max_lazy,re.good_match=o[re.level].good_length,re.nice_match=o[re.level].nice_length,re.max_chain_length=o[re.level].max_chain,re.strstart=0,re.block_start=0,re.lookahead=0,re.insert=0,re.match_length=re.prev_length=D-1,re.match_available=0,re.ins_h=0})(C.state),ie}function it(C,ie,re,Y,J,ee){if(!C)return I;var be=1;if(ie===x&&(ie=6),Y<0?(be=0,Y=-Y):15<Y&&(be=2,Y-=16),J<1||L<J||re!==U||Y<8||15<Y||ie<0||9<ie||ee<0||A<ee)return se(C,I);Y===8&&(Y=9);var Ie=new Ge;return(C.state=Ie).strm=C,Ie.wrap=be,Ie.gzhead=null,Ie.w_bits=Y,Ie.w_size=1<<Ie.w_bits,Ie.w_mask=Ie.w_size-1,Ie.hash_bits=J+7,Ie.hash_size=1<<Ie.hash_bits,Ie.hash_mask=Ie.hash_size-1,Ie.hash_shift=~~((Ie.hash_bits+D-1)/D),Ie.window=new l.Buf8(2*Ie.w_size),Ie.head=new l.Buf16(Ie.hash_size),Ie.prev=new l.Buf16(Ie.w_size),Ie.lit_bufsize=1<<J+6,Ie.pending_buf_size=4*Ie.lit_bufsize,Ie.pending_buf=new l.Buf8(Ie.pending_buf_size),Ie.d_buf=1*Ie.lit_bufsize,Ie.l_buf=3*Ie.lit_bufsize,Ie.level=ie,Ie.strategy=ee,Ie.method=re,gt(C)}o=[new Ne(0,0,0,0,function(C,ie){var re=65535;for(re>C.pending_buf_size-5&&(re=C.pending_buf_size-5);;){if(C.lookahead<=1){if(ze(C),C.lookahead===0&&ie===v)return O;if(C.lookahead===0)break}C.strstart+=C.lookahead,C.lookahead=0;var Y=C.block_start+re;if((C.strstart===0||C.strstart>=Y)&&(C.lookahead=C.strstart-Y,C.strstart=Y,W(C,!1),C.strm.avail_out===0)||C.strstart-C.block_start>=C.w_size-G&&(W(C,!1),C.strm.avail_out===0))return O}return C.insert=0,ie===E?(W(C,!0),C.strm.avail_out===0?X:Q):(C.strstart>C.block_start&&(W(C,!1),C.strm.avail_out),O)}),new Ne(4,4,8,4,Qe),new Ne(4,5,16,8,Qe),new Ne(4,6,32,32,Qe),new Ne(4,4,16,16,Je),new Ne(8,16,32,32,Je),new Ne(8,16,128,128,Je),new Ne(8,32,128,256,Je),new Ne(32,128,258,1024,Je),new Ne(32,258,258,4096,Je)],r.deflateInit=function(C,ie){return it(C,ie,U,15,8,0)},r.deflateInit2=it,r.deflateReset=gt,r.deflateResetKeep=Ye,r.deflateSetHeader=function(C,ie){return C&&C.state?C.state.wrap!==2?I:(C.state.gzhead=ie,b):I},r.deflate=function(C,ie){var re,Y,J,ee;if(!C||!C.state||5<ie||ie<0)return C?se(C,I):I;if(Y=C.state,!C.output||!C.input&&C.avail_in!==0||Y.status===666&&ie!==E)return se(C,C.avail_out===0?-5:I);if(Y.strm=C,re=Y.last_flush,Y.last_flush=ie,Y.status===M)if(Y.wrap===2)C.adler=0,ye(Y,31),ye(Y,139),ye(Y,8),Y.gzhead?(ye(Y,(Y.gzhead.text?1:0)+(Y.gzhead.hcrc?2:0)+(Y.gzhead.extra?4:0)+(Y.gzhead.name?8:0)+(Y.gzhead.comment?16:0)),ye(Y,255&Y.gzhead.time),ye(Y,Y.gzhead.time>>8&255),ye(Y,Y.gzhead.time>>16&255),ye(Y,Y.gzhead.time>>24&255),ye(Y,Y.level===9?2:2<=Y.strategy||Y.level<2?4:0),ye(Y,255&Y.gzhead.os),Y.gzhead.extra&&Y.gzhead.extra.length&&(ye(Y,255&Y.gzhead.extra.length),ye(Y,Y.gzhead.extra.length>>8&255)),Y.gzhead.hcrc&&(C.adler=f(C.adler,Y.pending_buf,Y.pending,0)),Y.gzindex=0,Y.status=69):(ye(Y,0),ye(Y,0),ye(Y,0),ye(Y,0),ye(Y,0),ye(Y,Y.level===9?2:2<=Y.strategy||Y.level<2?4:0),ye(Y,3),Y.status=B);else{var be=U+(Y.w_bits-8<<4)<<8;be|=(2<=Y.strategy||Y.level<2?0:Y.level<6?1:Y.level===6?2:3)<<6,Y.strstart!==0&&(be|=32),be+=31-be%31,Y.status=B,_e(Y,be),Y.strstart!==0&&(_e(Y,C.adler>>>16),_e(Y,65535&C.adler)),C.adler=1}if(Y.status===69)if(Y.gzhead.extra){for(J=Y.pending;Y.gzindex<(65535&Y.gzhead.extra.length)&&(Y.pending!==Y.pending_buf_size||(Y.gzhead.hcrc&&Y.pending>J&&(C.adler=f(C.adler,Y.pending_buf,Y.pending-J,J)),F(C),J=Y.pending,Y.pending!==Y.pending_buf_size));)ye(Y,255&Y.gzhead.extra[Y.gzindex]),Y.gzindex++;Y.gzhead.hcrc&&Y.pending>J&&(C.adler=f(C.adler,Y.pending_buf,Y.pending-J,J)),Y.gzindex===Y.gzhead.extra.length&&(Y.gzindex=0,Y.status=73)}else Y.status=73;if(Y.status===73)if(Y.gzhead.name){J=Y.pending;do{if(Y.pending===Y.pending_buf_size&&(Y.gzhead.hcrc&&Y.pending>J&&(C.adler=f(C.adler,Y.pending_buf,Y.pending-J,J)),F(C),J=Y.pending,Y.pending===Y.pending_buf_size)){ee=1;break}ee=Y.gzindex<Y.gzhead.name.length?255&Y.gzhead.name.charCodeAt(Y.gzindex++):0,ye(Y,ee)}while(ee!==0);Y.gzhead.hcrc&&Y.pending>J&&(C.adler=f(C.adler,Y.pending_buf,Y.pending-J,J)),ee===0&&(Y.gzindex=0,Y.status=91)}else Y.status=91;if(Y.status===91)if(Y.gzhead.comment){J=Y.pending;do{if(Y.pending===Y.pending_buf_size&&(Y.gzhead.hcrc&&Y.pending>J&&(C.adler=f(C.adler,Y.pending_buf,Y.pending-J,J)),F(C),J=Y.pending,Y.pending===Y.pending_buf_size)){ee=1;break}ee=Y.gzindex<Y.gzhead.comment.length?255&Y.gzhead.comment.charCodeAt(Y.gzindex++):0,ye(Y,ee)}while(ee!==0);Y.gzhead.hcrc&&Y.pending>J&&(C.adler=f(C.adler,Y.pending_buf,Y.pending-J,J)),ee===0&&(Y.status=103)}else Y.status=103;if(Y.status===103&&(Y.gzhead.hcrc?(Y.pending+2>Y.pending_buf_size&&F(C),Y.pending+2<=Y.pending_buf_size&&(ye(Y,255&C.adler),ye(Y,C.adler>>8&255),C.adler=0,Y.status=B)):Y.status=B),Y.pending!==0){if(F(C),C.avail_out===0)return Y.last_flush=-1,b}else if(C.avail_in===0&&ne(ie)<=ne(re)&&ie!==E)return se(C,-5);if(Y.status===666&&C.avail_in!==0)return se(C,-5);if(C.avail_in!==0||Y.lookahead!==0||ie!==v&&Y.status!==666){var Ie=Y.strategy===2?(function(de,Me){for(var De;;){if(de.lookahead===0&&(ze(de),de.lookahead===0)){if(Me===v)return O;break}if(de.match_length=0,De=c._tr_tally(de,0,de.window[de.strstart]),de.lookahead--,de.strstart++,De&&(W(de,!1),de.strm.avail_out===0))return O}return de.insert=0,Me===E?(W(de,!0),de.strm.avail_out===0?X:Q):de.last_lit&&(W(de,!1),de.strm.avail_out===0)?O:oe})(Y,ie):Y.strategy===3?(function(de,Me){for(var De,ke,He,ct,nt=de.window;;){if(de.lookahead<=z){if(ze(de),de.lookahead<=z&&Me===v)return O;if(de.lookahead===0)break}if(de.match_length=0,de.lookahead>=D&&0<de.strstart&&(ke=nt[He=de.strstart-1])===nt[++He]&&ke===nt[++He]&&ke===nt[++He]){ct=de.strstart+z;do;while(ke===nt[++He]&&ke===nt[++He]&&ke===nt[++He]&&ke===nt[++He]&&ke===nt[++He]&&ke===nt[++He]&&ke===nt[++He]&&ke===nt[++He]&&He<ct);de.match_length=z-(ct-He),de.match_length>de.lookahead&&(de.match_length=de.lookahead)}if(de.match_length>=D?(De=c._tr_tally(de,1,de.match_length-D),de.lookahead-=de.match_length,de.strstart+=de.match_length,de.match_length=0):(De=c._tr_tally(de,0,de.window[de.strstart]),de.lookahead--,de.strstart++),De&&(W(de,!1),de.strm.avail_out===0))return O}return de.insert=0,Me===E?(W(de,!0),de.strm.avail_out===0?X:Q):de.last_lit&&(W(de,!1),de.strm.avail_out===0)?O:oe})(Y,ie):o[Y.level].func(Y,ie);if(Ie!==X&&Ie!==Q||(Y.status=666),Ie===O||Ie===X)return C.avail_out===0&&(Y.last_flush=-1),b;if(Ie===oe&&(ie===1?c._tr_align(Y):ie!==5&&(c._tr_stored_block(Y,0,0,!1),ie===3&&(ue(Y.head),Y.lookahead===0&&(Y.strstart=0,Y.block_start=0,Y.insert=0))),F(C),C.avail_out===0))return Y.last_flush=-1,b}return ie!==E?b:Y.wrap<=0?1:(Y.wrap===2?(ye(Y,255&C.adler),ye(Y,C.adler>>8&255),ye(Y,C.adler>>16&255),ye(Y,C.adler>>24&255),ye(Y,255&C.total_in),ye(Y,C.total_in>>8&255),ye(Y,C.total_in>>16&255),ye(Y,C.total_in>>24&255)):(_e(Y,C.adler>>>16),_e(Y,65535&C.adler)),F(C),0<Y.wrap&&(Y.wrap=-Y.wrap),Y.pending!==0?b:1)},r.deflateEnd=function(C){var ie;return C&&C.state?(ie=C.state.status)!==M&&ie!==69&&ie!==73&&ie!==91&&ie!==103&&ie!==B&&ie!==666?se(C,I):(C.state=null,ie===B?se(C,-3):b):I},r.deflateSetDictionary=function(C,ie){var re,Y,J,ee,be,Ie,de,Me,De=ie.length;if(!C||!C.state||(ee=(re=C.state).wrap)===2||ee===1&&re.status!==M||re.lookahead)return I;for(ee===1&&(C.adler=d(C.adler,ie,De,0)),re.wrap=0,De>=re.w_size&&(ee===0&&(ue(re.head),re.strstart=0,re.block_start=0,re.insert=0),Me=new l.Buf8(re.w_size),l.arraySet(Me,ie,De-re.w_size,re.w_size,0),ie=Me,De=re.w_size),be=C.avail_in,Ie=C.next_in,de=C.input,C.avail_in=De,C.next_in=0,C.input=ie,ze(re);re.lookahead>=D;){for(Y=re.strstart,J=re.lookahead-(D-1);re.ins_h=(re.ins_h<<re.hash_shift^re.window[Y+D-1])&re.hash_mask,re.prev[Y&re.w_mask]=re.head[re.ins_h],re.head[re.ins_h]=Y,Y++,--J;);re.strstart=Y,re.lookahead=D-1,ze(re)}return re.strstart+=re.lookahead,re.block_start=re.strstart,re.insert=re.lookahead,re.lookahead=0,re.match_length=re.prev_length=D-1,re.match_available=0,C.next_in=Ie,C.input=de,C.avail_in=be,re.wrap=ee,b},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,i,r){i.exports=function(o,l){var c,d,f,m,v,E,b,I,x,A,N,U,L,$,K,j,k,V,D,z,G,M,B,O,oe;c=o.state,d=o.next_in,O=o.input,f=d+(o.avail_in-5),m=o.next_out,oe=o.output,v=m-(l-o.avail_out),E=m+(o.avail_out-257),b=c.dmax,I=c.wsize,x=c.whave,A=c.wnext,N=c.window,U=c.hold,L=c.bits,$=c.lencode,K=c.distcode,j=(1<<c.lenbits)-1,k=(1<<c.distbits)-1;e:do{L<15&&(U+=O[d++]<<L,L+=8,U+=O[d++]<<L,L+=8),V=$[U&j];t:for(;;){if(U>>>=D=V>>>24,L-=D,(D=V>>>16&255)===0)oe[m++]=65535&V;else{if(!(16&D)){if((64&D)==0){V=$[(65535&V)+(U&(1<<D)-1)];continue t}if(32&D){c.mode=12;break e}o.msg="invalid literal/length code",c.mode=30;break e}z=65535&V,(D&=15)&&(L<D&&(U+=O[d++]<<L,L+=8),z+=U&(1<<D)-1,U>>>=D,L-=D),L<15&&(U+=O[d++]<<L,L+=8,U+=O[d++]<<L,L+=8),V=K[U&k];n:for(;;){if(U>>>=D=V>>>24,L-=D,!(16&(D=V>>>16&255))){if((64&D)==0){V=K[(65535&V)+(U&(1<<D)-1)];continue n}o.msg="invalid distance code",c.mode=30;break e}if(G=65535&V,L<(D&=15)&&(U+=O[d++]<<L,(L+=8)<D&&(U+=O[d++]<<L,L+=8)),b<(G+=U&(1<<D)-1)){o.msg="invalid distance too far back",c.mode=30;break e}if(U>>>=D,L-=D,(D=m-v)<G){if(x<(D=G-D)&&c.sane){o.msg="invalid distance too far back",c.mode=30;break e}if(B=N,(M=0)===A){if(M+=I-D,D<z){for(z-=D;oe[m++]=N[M++],--D;);M=m-G,B=oe}}else if(A<D){if(M+=I+A-D,(D-=A)<z){for(z-=D;oe[m++]=N[M++],--D;);if(M=0,A<z){for(z-=D=A;oe[m++]=N[M++],--D;);M=m-G,B=oe}}}else if(M+=A-D,D<z){for(z-=D;oe[m++]=N[M++],--D;);M=m-G,B=oe}for(;2<z;)oe[m++]=B[M++],oe[m++]=B[M++],oe[m++]=B[M++],z-=3;z&&(oe[m++]=B[M++],1<z&&(oe[m++]=B[M++]))}else{for(M=m-G;oe[m++]=oe[M++],oe[m++]=oe[M++],oe[m++]=oe[M++],2<(z-=3););z&&(oe[m++]=oe[M++],1<z&&(oe[m++]=oe[M++]))}break}}break}}while(d<f&&m<E);d-=z=L>>3,U&=(1<<(L-=z<<3))-1,o.next_in=d,o.next_out=m,o.avail_in=d<f?f-d+5:5-(d-f),o.avail_out=m<E?E-m+257:257-(m-E),c.hold=U,c.bits=L}},{}],49:[function(t,i,r){var o=t("../utils/common"),l=t("./adler32"),c=t("./crc32"),d=t("./inffast"),f=t("./inftrees"),m=1,v=2,E=0,b=-2,I=1,x=852,A=592;function N(M){return(M>>>24&255)+(M>>>8&65280)+((65280&M)<<8)+((255&M)<<24)}function U(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function L(M){var B;return M&&M.state?(B=M.state,M.total_in=M.total_out=B.total=0,M.msg="",B.wrap&&(M.adler=1&B.wrap),B.mode=I,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new o.Buf32(x),B.distcode=B.distdyn=new o.Buf32(A),B.sane=1,B.back=-1,E):b}function $(M){var B;return M&&M.state?((B=M.state).wsize=0,B.whave=0,B.wnext=0,L(M)):b}function K(M,B){var O,oe;return M&&M.state?(oe=M.state,B<0?(O=0,B=-B):(O=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?b:(oe.window!==null&&oe.wbits!==B&&(oe.window=null),oe.wrap=O,oe.wbits=B,$(M))):b}function j(M,B){var O,oe;return M?(oe=new U,(M.state=oe).window=null,(O=K(M,B))!==E&&(M.state=null),O):b}var k,V,D=!0;function z(M){if(D){var B;for(k=new o.Buf32(512),V=new o.Buf32(32),B=0;B<144;)M.lens[B++]=8;for(;B<256;)M.lens[B++]=9;for(;B<280;)M.lens[B++]=7;for(;B<288;)M.lens[B++]=8;for(f(m,M.lens,0,288,k,0,M.work,{bits:9}),B=0;B<32;)M.lens[B++]=5;f(v,M.lens,0,32,V,0,M.work,{bits:5}),D=!1}M.lencode=k,M.lenbits=9,M.distcode=V,M.distbits=5}function G(M,B,O,oe){var X,Q=M.state;return Q.window===null&&(Q.wsize=1<<Q.wbits,Q.wnext=0,Q.whave=0,Q.window=new o.Buf8(Q.wsize)),oe>=Q.wsize?(o.arraySet(Q.window,B,O-Q.wsize,Q.wsize,0),Q.wnext=0,Q.whave=Q.wsize):(oe<(X=Q.wsize-Q.wnext)&&(X=oe),o.arraySet(Q.window,B,O-oe,X,Q.wnext),(oe-=X)?(o.arraySet(Q.window,B,O-oe,oe,0),Q.wnext=oe,Q.whave=Q.wsize):(Q.wnext+=X,Q.wnext===Q.wsize&&(Q.wnext=0),Q.whave<Q.wsize&&(Q.whave+=X))),0}r.inflateReset=$,r.inflateReset2=K,r.inflateResetKeep=L,r.inflateInit=function(M){return j(M,15)},r.inflateInit2=j,r.inflate=function(M,B){var O,oe,X,Q,se,ne,ue,F,W,ye,_e,Ee,ze,Qe,Je,Ne,Ge,Ye,gt,it,C,ie,re,Y,J=0,ee=new o.Buf8(4),be=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!M||!M.state||!M.output||!M.input&&M.avail_in!==0)return b;(O=M.state).mode===12&&(O.mode=13),se=M.next_out,X=M.output,ue=M.avail_out,Q=M.next_in,oe=M.input,ne=M.avail_in,F=O.hold,W=O.bits,ye=ne,_e=ue,ie=E;e:for(;;)switch(O.mode){case I:if(O.wrap===0){O.mode=13;break}for(;W<16;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}if(2&O.wrap&&F===35615){ee[O.check=0]=255&F,ee[1]=F>>>8&255,O.check=c(O.check,ee,2,0),W=F=0,O.mode=2;break}if(O.flags=0,O.head&&(O.head.done=!1),!(1&O.wrap)||(((255&F)<<8)+(F>>8))%31){M.msg="incorrect header check",O.mode=30;break}if((15&F)!=8){M.msg="unknown compression method",O.mode=30;break}if(W-=4,C=8+(15&(F>>>=4)),O.wbits===0)O.wbits=C;else if(C>O.wbits){M.msg="invalid window size",O.mode=30;break}O.dmax=1<<C,M.adler=O.check=1,O.mode=512&F?10:12,W=F=0;break;case 2:for(;W<16;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}if(O.flags=F,(255&O.flags)!=8){M.msg="unknown compression method",O.mode=30;break}if(57344&O.flags){M.msg="unknown header flags set",O.mode=30;break}O.head&&(O.head.text=F>>8&1),512&O.flags&&(ee[0]=255&F,ee[1]=F>>>8&255,O.check=c(O.check,ee,2,0)),W=F=0,O.mode=3;case 3:for(;W<32;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}O.head&&(O.head.time=F),512&O.flags&&(ee[0]=255&F,ee[1]=F>>>8&255,ee[2]=F>>>16&255,ee[3]=F>>>24&255,O.check=c(O.check,ee,4,0)),W=F=0,O.mode=4;case 4:for(;W<16;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}O.head&&(O.head.xflags=255&F,O.head.os=F>>8),512&O.flags&&(ee[0]=255&F,ee[1]=F>>>8&255,O.check=c(O.check,ee,2,0)),W=F=0,O.mode=5;case 5:if(1024&O.flags){for(;W<16;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}O.length=F,O.head&&(O.head.extra_len=F),512&O.flags&&(ee[0]=255&F,ee[1]=F>>>8&255,O.check=c(O.check,ee,2,0)),W=F=0}else O.head&&(O.head.extra=null);O.mode=6;case 6:if(1024&O.flags&&(ne<(Ee=O.length)&&(Ee=ne),Ee&&(O.head&&(C=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Array(O.head.extra_len)),o.arraySet(O.head.extra,oe,Q,Ee,C)),512&O.flags&&(O.check=c(O.check,oe,Ee,Q)),ne-=Ee,Q+=Ee,O.length-=Ee),O.length))break e;O.length=0,O.mode=7;case 7:if(2048&O.flags){if(ne===0)break e;for(Ee=0;C=oe[Q+Ee++],O.head&&C&&O.length<65536&&(O.head.name+=String.fromCharCode(C)),C&&Ee<ne;);if(512&O.flags&&(O.check=c(O.check,oe,Ee,Q)),ne-=Ee,Q+=Ee,C)break e}else O.head&&(O.head.name=null);O.length=0,O.mode=8;case 8:if(4096&O.flags){if(ne===0)break e;for(Ee=0;C=oe[Q+Ee++],O.head&&C&&O.length<65536&&(O.head.comment+=String.fromCharCode(C)),C&&Ee<ne;);if(512&O.flags&&(O.check=c(O.check,oe,Ee,Q)),ne-=Ee,Q+=Ee,C)break e}else O.head&&(O.head.comment=null);O.mode=9;case 9:if(512&O.flags){for(;W<16;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}if(F!==(65535&O.check)){M.msg="header crc mismatch",O.mode=30;break}W=F=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),M.adler=O.check=0,O.mode=12;break;case 10:for(;W<32;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}M.adler=O.check=N(F),W=F=0,O.mode=11;case 11:if(O.havedict===0)return M.next_out=se,M.avail_out=ue,M.next_in=Q,M.avail_in=ne,O.hold=F,O.bits=W,2;M.adler=O.check=1,O.mode=12;case 12:if(B===5||B===6)break e;case 13:if(O.last){F>>>=7&W,W-=7&W,O.mode=27;break}for(;W<3;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}switch(O.last=1&F,W-=1,3&(F>>>=1)){case 0:O.mode=14;break;case 1:if(z(O),O.mode=20,B!==6)break;F>>>=2,W-=2;break e;case 2:O.mode=17;break;case 3:M.msg="invalid block type",O.mode=30}F>>>=2,W-=2;break;case 14:for(F>>>=7&W,W-=7&W;W<32;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}if((65535&F)!=(F>>>16^65535)){M.msg="invalid stored block lengths",O.mode=30;break}if(O.length=65535&F,W=F=0,O.mode=15,B===6)break e;case 15:O.mode=16;case 16:if(Ee=O.length){if(ne<Ee&&(Ee=ne),ue<Ee&&(Ee=ue),Ee===0)break e;o.arraySet(X,oe,Q,Ee,se),ne-=Ee,Q+=Ee,ue-=Ee,se+=Ee,O.length-=Ee;break}O.mode=12;break;case 17:for(;W<14;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}if(O.nlen=257+(31&F),F>>>=5,W-=5,O.ndist=1+(31&F),F>>>=5,W-=5,O.ncode=4+(15&F),F>>>=4,W-=4,286<O.nlen||30<O.ndist){M.msg="too many length or distance symbols",O.mode=30;break}O.have=0,O.mode=18;case 18:for(;O.have<O.ncode;){for(;W<3;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}O.lens[be[O.have++]]=7&F,F>>>=3,W-=3}for(;O.have<19;)O.lens[be[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,re={bits:O.lenbits},ie=f(0,O.lens,0,19,O.lencode,0,O.work,re),O.lenbits=re.bits,ie){M.msg="invalid code lengths set",O.mode=30;break}O.have=0,O.mode=19;case 19:for(;O.have<O.nlen+O.ndist;){for(;Ne=(J=O.lencode[F&(1<<O.lenbits)-1])>>>16&255,Ge=65535&J,!((Je=J>>>24)<=W);){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}if(Ge<16)F>>>=Je,W-=Je,O.lens[O.have++]=Ge;else{if(Ge===16){for(Y=Je+2;W<Y;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}if(F>>>=Je,W-=Je,O.have===0){M.msg="invalid bit length repeat",O.mode=30;break}C=O.lens[O.have-1],Ee=3+(3&F),F>>>=2,W-=2}else if(Ge===17){for(Y=Je+3;W<Y;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}W-=Je,C=0,Ee=3+(7&(F>>>=Je)),F>>>=3,W-=3}else{for(Y=Je+7;W<Y;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}W-=Je,C=0,Ee=11+(127&(F>>>=Je)),F>>>=7,W-=7}if(O.have+Ee>O.nlen+O.ndist){M.msg="invalid bit length repeat",O.mode=30;break}for(;Ee--;)O.lens[O.have++]=C}}if(O.mode===30)break;if(O.lens[256]===0){M.msg="invalid code -- missing end-of-block",O.mode=30;break}if(O.lenbits=9,re={bits:O.lenbits},ie=f(m,O.lens,0,O.nlen,O.lencode,0,O.work,re),O.lenbits=re.bits,ie){M.msg="invalid literal/lengths set",O.mode=30;break}if(O.distbits=6,O.distcode=O.distdyn,re={bits:O.distbits},ie=f(v,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,re),O.distbits=re.bits,ie){M.msg="invalid distances set",O.mode=30;break}if(O.mode=20,B===6)break e;case 20:O.mode=21;case 21:if(6<=ne&&258<=ue){M.next_out=se,M.avail_out=ue,M.next_in=Q,M.avail_in=ne,O.hold=F,O.bits=W,d(M,_e),se=M.next_out,X=M.output,ue=M.avail_out,Q=M.next_in,oe=M.input,ne=M.avail_in,F=O.hold,W=O.bits,O.mode===12&&(O.back=-1);break}for(O.back=0;Ne=(J=O.lencode[F&(1<<O.lenbits)-1])>>>16&255,Ge=65535&J,!((Je=J>>>24)<=W);){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}if(Ne&&(240&Ne)==0){for(Ye=Je,gt=Ne,it=Ge;Ne=(J=O.lencode[it+((F&(1<<Ye+gt)-1)>>Ye)])>>>16&255,Ge=65535&J,!(Ye+(Je=J>>>24)<=W);){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}F>>>=Ye,W-=Ye,O.back+=Ye}if(F>>>=Je,W-=Je,O.back+=Je,O.length=Ge,Ne===0){O.mode=26;break}if(32&Ne){O.back=-1,O.mode=12;break}if(64&Ne){M.msg="invalid literal/length code",O.mode=30;break}O.extra=15&Ne,O.mode=22;case 22:if(O.extra){for(Y=O.extra;W<Y;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}O.length+=F&(1<<O.extra)-1,F>>>=O.extra,W-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=23;case 23:for(;Ne=(J=O.distcode[F&(1<<O.distbits)-1])>>>16&255,Ge=65535&J,!((Je=J>>>24)<=W);){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}if((240&Ne)==0){for(Ye=Je,gt=Ne,it=Ge;Ne=(J=O.distcode[it+((F&(1<<Ye+gt)-1)>>Ye)])>>>16&255,Ge=65535&J,!(Ye+(Je=J>>>24)<=W);){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}F>>>=Ye,W-=Ye,O.back+=Ye}if(F>>>=Je,W-=Je,O.back+=Je,64&Ne){M.msg="invalid distance code",O.mode=30;break}O.offset=Ge,O.extra=15&Ne,O.mode=24;case 24:if(O.extra){for(Y=O.extra;W<Y;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}O.offset+=F&(1<<O.extra)-1,F>>>=O.extra,W-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){M.msg="invalid distance too far back",O.mode=30;break}O.mode=25;case 25:if(ue===0)break e;if(Ee=_e-ue,O.offset>Ee){if((Ee=O.offset-Ee)>O.whave&&O.sane){M.msg="invalid distance too far back",O.mode=30;break}ze=Ee>O.wnext?(Ee-=O.wnext,O.wsize-Ee):O.wnext-Ee,Ee>O.length&&(Ee=O.length),Qe=O.window}else Qe=X,ze=se-O.offset,Ee=O.length;for(ue<Ee&&(Ee=ue),ue-=Ee,O.length-=Ee;X[se++]=Qe[ze++],--Ee;);O.length===0&&(O.mode=21);break;case 26:if(ue===0)break e;X[se++]=O.length,ue--,O.mode=21;break;case 27:if(O.wrap){for(;W<32;){if(ne===0)break e;ne--,F|=oe[Q++]<<W,W+=8}if(_e-=ue,M.total_out+=_e,O.total+=_e,_e&&(M.adler=O.check=O.flags?c(O.check,X,_e,se-_e):l(O.check,X,_e,se-_e)),_e=ue,(O.flags?F:N(F))!==O.check){M.msg="incorrect data check",O.mode=30;break}W=F=0}O.mode=28;case 28:if(O.wrap&&O.flags){for(;W<32;){if(ne===0)break e;ne--,F+=oe[Q++]<<W,W+=8}if(F!==(4294967295&O.total)){M.msg="incorrect length check",O.mode=30;break}W=F=0}O.mode=29;case 29:ie=1;break e;case 30:ie=-3;break e;case 31:return-4;case 32:default:return b}return M.next_out=se,M.avail_out=ue,M.next_in=Q,M.avail_in=ne,O.hold=F,O.bits=W,(O.wsize||_e!==M.avail_out&&O.mode<30&&(O.mode<27||B!==4))&&G(M,M.output,M.next_out,_e-M.avail_out)?(O.mode=31,-4):(ye-=M.avail_in,_e-=M.avail_out,M.total_in+=ye,M.total_out+=_e,O.total+=_e,O.wrap&&_e&&(M.adler=O.check=O.flags?c(O.check,X,_e,M.next_out-_e):l(O.check,X,_e,M.next_out-_e)),M.data_type=O.bits+(O.last?64:0)+(O.mode===12?128:0)+(O.mode===20||O.mode===15?256:0),(ye==0&&_e===0||B===4)&&ie===E&&(ie=-5),ie)},r.inflateEnd=function(M){if(!M||!M.state)return b;var B=M.state;return B.window&&(B.window=null),M.state=null,E},r.inflateGetHeader=function(M,B){var O;return M&&M.state?(2&(O=M.state).wrap)==0?b:((O.head=B).done=!1,E):b},r.inflateSetDictionary=function(M,B){var O,oe=B.length;return M&&M.state?(O=M.state).wrap!==0&&O.mode!==11?b:O.mode===11&&l(1,B,oe,0)!==O.check?-3:G(M,B,oe,oe)?(O.mode=31,-4):(O.havedict=1,E):b},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,i,r){var o=t("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(m,v,E,b,I,x,A,N){var U,L,$,K,j,k,V,D,z,G=N.bits,M=0,B=0,O=0,oe=0,X=0,Q=0,se=0,ne=0,ue=0,F=0,W=null,ye=0,_e=new o.Buf16(16),Ee=new o.Buf16(16),ze=null,Qe=0;for(M=0;M<=15;M++)_e[M]=0;for(B=0;B<b;B++)_e[v[E+B]]++;for(X=G,oe=15;1<=oe&&_e[oe]===0;oe--);if(oe<X&&(X=oe),oe===0)return I[x++]=20971520,I[x++]=20971520,N.bits=1,0;for(O=1;O<oe&&_e[O]===0;O++);for(X<O&&(X=O),M=ne=1;M<=15;M++)if(ne<<=1,(ne-=_e[M])<0)return-1;if(0<ne&&(m===0||oe!==1))return-1;for(Ee[1]=0,M=1;M<15;M++)Ee[M+1]=Ee[M]+_e[M];for(B=0;B<b;B++)v[E+B]!==0&&(A[Ee[v[E+B]]++]=B);if(k=m===0?(W=ze=A,19):m===1?(W=l,ye-=257,ze=c,Qe-=257,256):(W=d,ze=f,-1),M=O,j=x,se=B=F=0,$=-1,K=(ue=1<<(Q=X))-1,m===1&&852<ue||m===2&&592<ue)return 1;for(;;){for(V=M-se,z=A[B]<k?(D=0,A[B]):A[B]>k?(D=ze[Qe+A[B]],W[ye+A[B]]):(D=96,0),U=1<<M-se,O=L=1<<Q;I[j+(F>>se)+(L-=U)]=V<<24|D<<16|z|0,L!==0;);for(U=1<<M-1;F&U;)U>>=1;if(U!==0?(F&=U-1,F+=U):F=0,B++,--_e[M]==0){if(M===oe)break;M=v[E+A[B]]}if(X<M&&(F&K)!==$){for(se===0&&(se=X),j+=O,ne=1<<(Q=M-se);Q+se<oe&&!((ne-=_e[Q+se])<=0);)Q++,ne<<=1;if(ue+=1<<Q,m===1&&852<ue||m===2&&592<ue)return 1;I[$=F&K]=X<<24|Q<<16|j-x|0}}return F!==0&&(I[j+F]=M-se<<24|64<<16|0),N.bits=X,0}},{"../utils/common":41}],51:[function(t,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,i,r){var o=t("../utils/common"),l=0,c=1;function d(J){for(var ee=J.length;0<=--ee;)J[ee]=0}var f=0,m=29,v=256,E=v+1+m,b=30,I=19,x=2*E+1,A=15,N=16,U=7,L=256,$=16,K=17,j=18,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=new Array(2*(E+2));d(G);var M=new Array(2*b);d(M);var B=new Array(512);d(B);var O=new Array(256);d(O);var oe=new Array(m);d(oe);var X,Q,se,ne=new Array(b);function ue(J,ee,be,Ie,de){this.static_tree=J,this.extra_bits=ee,this.extra_base=be,this.elems=Ie,this.max_length=de,this.has_stree=J&&J.length}function F(J,ee){this.dyn_tree=J,this.max_code=0,this.stat_desc=ee}function W(J){return J<256?B[J]:B[256+(J>>>7)]}function ye(J,ee){J.pending_buf[J.pending++]=255&ee,J.pending_buf[J.pending++]=ee>>>8&255}function _e(J,ee,be){J.bi_valid>N-be?(J.bi_buf|=ee<<J.bi_valid&65535,ye(J,J.bi_buf),J.bi_buf=ee>>N-J.bi_valid,J.bi_valid+=be-N):(J.bi_buf|=ee<<J.bi_valid&65535,J.bi_valid+=be)}function Ee(J,ee,be){_e(J,be[2*ee],be[2*ee+1])}function ze(J,ee){for(var be=0;be|=1&J,J>>>=1,be<<=1,0<--ee;);return be>>>1}function Qe(J,ee,be){var Ie,de,Me=new Array(A+1),De=0;for(Ie=1;Ie<=A;Ie++)Me[Ie]=De=De+be[Ie-1]<<1;for(de=0;de<=ee;de++){var ke=J[2*de+1];ke!==0&&(J[2*de]=ze(Me[ke]++,ke))}}function Je(J){var ee;for(ee=0;ee<E;ee++)J.dyn_ltree[2*ee]=0;for(ee=0;ee<b;ee++)J.dyn_dtree[2*ee]=0;for(ee=0;ee<I;ee++)J.bl_tree[2*ee]=0;J.dyn_ltree[2*L]=1,J.opt_len=J.static_len=0,J.last_lit=J.matches=0}function Ne(J){8<J.bi_valid?ye(J,J.bi_buf):0<J.bi_valid&&(J.pending_buf[J.pending++]=J.bi_buf),J.bi_buf=0,J.bi_valid=0}function Ge(J,ee,be,Ie){var de=2*ee,Me=2*be;return J[de]<J[Me]||J[de]===J[Me]&&Ie[ee]<=Ie[be]}function Ye(J,ee,be){for(var Ie=J.heap[be],de=be<<1;de<=J.heap_len&&(de<J.heap_len&&Ge(ee,J.heap[de+1],J.heap[de],J.depth)&&de++,!Ge(ee,Ie,J.heap[de],J.depth));)J.heap[be]=J.heap[de],be=de,de<<=1;J.heap[be]=Ie}function gt(J,ee,be){var Ie,de,Me,De,ke=0;if(J.last_lit!==0)for(;Ie=J.pending_buf[J.d_buf+2*ke]<<8|J.pending_buf[J.d_buf+2*ke+1],de=J.pending_buf[J.l_buf+ke],ke++,Ie===0?Ee(J,de,ee):(Ee(J,(Me=O[de])+v+1,ee),(De=k[Me])!==0&&_e(J,de-=oe[Me],De),Ee(J,Me=W(--Ie),be),(De=V[Me])!==0&&_e(J,Ie-=ne[Me],De)),ke<J.last_lit;);Ee(J,L,ee)}function it(J,ee){var be,Ie,de,Me=ee.dyn_tree,De=ee.stat_desc.static_tree,ke=ee.stat_desc.has_stree,He=ee.stat_desc.elems,ct=-1;for(J.heap_len=0,J.heap_max=x,be=0;be<He;be++)Me[2*be]!==0?(J.heap[++J.heap_len]=ct=be,J.depth[be]=0):Me[2*be+1]=0;for(;J.heap_len<2;)Me[2*(de=J.heap[++J.heap_len]=ct<2?++ct:0)]=1,J.depth[de]=0,J.opt_len--,ke&&(J.static_len-=De[2*de+1]);for(ee.max_code=ct,be=J.heap_len>>1;1<=be;be--)Ye(J,Me,be);for(de=He;be=J.heap[1],J.heap[1]=J.heap[J.heap_len--],Ye(J,Me,1),Ie=J.heap[1],J.heap[--J.heap_max]=be,J.heap[--J.heap_max]=Ie,Me[2*de]=Me[2*be]+Me[2*Ie],J.depth[de]=(J.depth[be]>=J.depth[Ie]?J.depth[be]:J.depth[Ie])+1,Me[2*be+1]=Me[2*Ie+1]=de,J.heap[1]=de++,Ye(J,Me,1),2<=J.heap_len;);J.heap[--J.heap_max]=J.heap[1],(function(nt,Ht){var Rt,It,le,he,Ae,Ve,Re=Ht.dyn_tree,Be=Ht.max_code,$e=Ht.stat_desc.static_tree,wt=Ht.stat_desc.has_stree,$t=Ht.stat_desc.extra_bits,rn=Ht.stat_desc.extra_base,Nt=Ht.stat_desc.max_length,dt=0;for(he=0;he<=A;he++)nt.bl_count[he]=0;for(Re[2*nt.heap[nt.heap_max]+1]=0,Rt=nt.heap_max+1;Rt<x;Rt++)Nt<(he=Re[2*Re[2*(It=nt.heap[Rt])+1]+1]+1)&&(he=Nt,dt++),Re[2*It+1]=he,Be<It||(nt.bl_count[he]++,Ae=0,rn<=It&&(Ae=$t[It-rn]),Ve=Re[2*It],nt.opt_len+=Ve*(he+Ae),wt&&(nt.static_len+=Ve*($e[2*It+1]+Ae)));if(dt!==0){do{for(he=Nt-1;nt.bl_count[he]===0;)he--;nt.bl_count[he]--,nt.bl_count[he+1]+=2,nt.bl_count[Nt]--,dt-=2}while(0<dt);for(he=Nt;he!==0;he--)for(It=nt.bl_count[he];It!==0;)Be<(le=nt.heap[--Rt])||(Re[2*le+1]!==he&&(nt.opt_len+=(he-Re[2*le+1])*Re[2*le],Re[2*le+1]=he),It--)}})(J,ee),Qe(Me,ct,J.bl_count)}function C(J,ee,be){var Ie,de,Me=-1,De=ee[1],ke=0,He=7,ct=4;for(De===0&&(He=138,ct=3),ee[2*(be+1)+1]=65535,Ie=0;Ie<=be;Ie++)de=De,De=ee[2*(Ie+1)+1],++ke<He&&de===De||(ke<ct?J.bl_tree[2*de]+=ke:de!==0?(de!==Me&&J.bl_tree[2*de]++,J.bl_tree[2*$]++):ke<=10?J.bl_tree[2*K]++:J.bl_tree[2*j]++,Me=de,ct=(ke=0)===De?(He=138,3):de===De?(He=6,3):(He=7,4))}function ie(J,ee,be){var Ie,de,Me=-1,De=ee[1],ke=0,He=7,ct=4;for(De===0&&(He=138,ct=3),Ie=0;Ie<=be;Ie++)if(de=De,De=ee[2*(Ie+1)+1],!(++ke<He&&de===De)){if(ke<ct)for(;Ee(J,de,J.bl_tree),--ke!=0;);else de!==0?(de!==Me&&(Ee(J,de,J.bl_tree),ke--),Ee(J,$,J.bl_tree),_e(J,ke-3,2)):ke<=10?(Ee(J,K,J.bl_tree),_e(J,ke-3,3)):(Ee(J,j,J.bl_tree),_e(J,ke-11,7));Me=de,ct=(ke=0)===De?(He=138,3):de===De?(He=6,3):(He=7,4)}}d(ne);var re=!1;function Y(J,ee,be,Ie){_e(J,(f<<1)+(Ie?1:0),3),(function(de,Me,De,ke){Ne(de),ye(de,De),ye(de,~De),o.arraySet(de.pending_buf,de.window,Me,De,de.pending),de.pending+=De})(J,ee,be)}r._tr_init=function(J){re||((function(){var ee,be,Ie,de,Me,De=new Array(A+1);for(de=Ie=0;de<m-1;de++)for(oe[de]=Ie,ee=0;ee<1<<k[de];ee++)O[Ie++]=de;for(O[Ie-1]=de,de=Me=0;de<16;de++)for(ne[de]=Me,ee=0;ee<1<<V[de];ee++)B[Me++]=de;for(Me>>=7;de<b;de++)for(ne[de]=Me<<7,ee=0;ee<1<<V[de]-7;ee++)B[256+Me++]=de;for(be=0;be<=A;be++)De[be]=0;for(ee=0;ee<=143;)G[2*ee+1]=8,ee++,De[8]++;for(;ee<=255;)G[2*ee+1]=9,ee++,De[9]++;for(;ee<=279;)G[2*ee+1]=7,ee++,De[7]++;for(;ee<=287;)G[2*ee+1]=8,ee++,De[8]++;for(Qe(G,E+1,De),ee=0;ee<b;ee++)M[2*ee+1]=5,M[2*ee]=ze(ee,5);X=new ue(G,k,v+1,E,A),Q=new ue(M,V,0,b,A),se=new ue(new Array(0),D,0,I,U)})(),re=!0),J.l_desc=new F(J.dyn_ltree,X),J.d_desc=new F(J.dyn_dtree,Q),J.bl_desc=new F(J.bl_tree,se),J.bi_buf=0,J.bi_valid=0,Je(J)},r._tr_stored_block=Y,r._tr_flush_block=function(J,ee,be,Ie){var de,Me,De=0;0<J.level?(J.strm.data_type===2&&(J.strm.data_type=(function(ke){var He,ct=4093624447;for(He=0;He<=31;He++,ct>>>=1)if(1&ct&&ke.dyn_ltree[2*He]!==0)return l;if(ke.dyn_ltree[18]!==0||ke.dyn_ltree[20]!==0||ke.dyn_ltree[26]!==0)return c;for(He=32;He<v;He++)if(ke.dyn_ltree[2*He]!==0)return c;return l})(J)),it(J,J.l_desc),it(J,J.d_desc),De=(function(ke){var He;for(C(ke,ke.dyn_ltree,ke.l_desc.max_code),C(ke,ke.dyn_dtree,ke.d_desc.max_code),it(ke,ke.bl_desc),He=I-1;3<=He&&ke.bl_tree[2*z[He]+1]===0;He--);return ke.opt_len+=3*(He+1)+5+5+4,He})(J),de=J.opt_len+3+7>>>3,(Me=J.static_len+3+7>>>3)<=de&&(de=Me)):de=Me=be+5,be+4<=de&&ee!==-1?Y(J,ee,be,Ie):J.strategy===4||Me===de?(_e(J,2+(Ie?1:0),3),gt(J,G,M)):(_e(J,4+(Ie?1:0),3),(function(ke,He,ct,nt){var Ht;for(_e(ke,He-257,5),_e(ke,ct-1,5),_e(ke,nt-4,4),Ht=0;Ht<nt;Ht++)_e(ke,ke.bl_tree[2*z[Ht]+1],3);ie(ke,ke.dyn_ltree,He-1),ie(ke,ke.dyn_dtree,ct-1)})(J,J.l_desc.max_code+1,J.d_desc.max_code+1,De+1),gt(J,J.dyn_ltree,J.dyn_dtree)),Je(J),Ie&&Ne(J)},r._tr_tally=function(J,ee,be){return J.pending_buf[J.d_buf+2*J.last_lit]=ee>>>8&255,J.pending_buf[J.d_buf+2*J.last_lit+1]=255&ee,J.pending_buf[J.l_buf+J.last_lit]=255&be,J.last_lit++,ee===0?J.dyn_ltree[2*be]++:(J.matches++,ee--,J.dyn_ltree[2*(O[be]+v+1)]++,J.dyn_dtree[2*W(ee)]++),J.last_lit===J.lit_bufsize-1},r._tr_align=function(J){_e(J,2,3),Ee(J,L,G),(function(ee){ee.bi_valid===16?(ye(ee,ee.bi_buf),ee.bi_buf=0,ee.bi_valid=0):8<=ee.bi_valid&&(ee.pending_buf[ee.pending++]=255&ee.bi_buf,ee.bi_buf>>=8,ee.bi_valid-=8)})(J)}},{"../utils/common":41}],53:[function(t,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,i,r){(function(o){(function(l,c){if(!l.setImmediate){var d,f,m,v,E=1,b={},I=!1,x=l.document,A=Object.getPrototypeOf&&Object.getPrototypeOf(l);A=A&&A.setTimeout?A:l,d={}.toString.call(l.process)==="[object process]"?function($){process.nextTick(function(){U($)})}:(function(){if(l.postMessage&&!l.importScripts){var $=!0,K=l.onmessage;return l.onmessage=function(){$=!1},l.postMessage("","*"),l.onmessage=K,$}})()?(v="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",L,!1):l.attachEvent("onmessage",L),function($){l.postMessage(v+$,"*")}):l.MessageChannel?((m=new MessageChannel).port1.onmessage=function($){U($.data)},function($){m.port2.postMessage($)}):x&&"onreadystatechange"in x.createElement("script")?(f=x.documentElement,function($){var K=x.createElement("script");K.onreadystatechange=function(){U($),K.onreadystatechange=null,f.removeChild(K),K=null},f.appendChild(K)}):function($){setTimeout(U,0,$)},A.setImmediate=function($){typeof $!="function"&&($=new Function(""+$));for(var K=new Array(arguments.length-1),j=0;j<K.length;j++)K[j]=arguments[j+1];var k={callback:$,args:K};return b[E]=k,d(E),E++},A.clearImmediate=N}function N($){delete b[$]}function U($){if(I)setTimeout(U,0,$);else{var K=b[$];if(K){I=!0;try{(function(j){var k=j.callback,V=j.args;switch(V.length){case 0:k();break;case 1:k(V[0]);break;case 2:k(V[0],V[1]);break;case 3:k(V[0],V[1],V[2]);break;default:k.apply(c,V)}})(K)}finally{N($),I=!1}}}}function L($){$.source===l&&typeof $.data=="string"&&$.data.indexOf(v)===0&&U(+$.data.slice(v.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof oh<"u"?oh:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Py)),Py.exports}var K8=j8();const J8=F_(K8),Sp={VFS:"bilge_vfs",SETTINGS:"bilge_app_settings"},Hc="https://mcp.caravanflow.com",Oy=new Set(["get_browser_context","explore_browser_dom","take_screenshot","execute_natural_command","click_element","type_text","run_script_direct","test_mcp_round_trip","execute_batch_actions","cancel_batch_actions","get_active_runs","get_element_value","scroll_to_element","execute_javascript","ping_agent","talk_to_bilge_agent_brain","launch_self_improvement_mode","restart_extension_runtime","dispatch_agent_command","system_log"]),Y8=n=>{const e=String(n||"").trim().toLowerCase();return e&&(e==="bilge_web"||e==="web"||e==="app")?"bilge_web":"bilge_agent"},W8=n=>{try{const e=new URL(String(n||"").trim());return String(e.searchParams.get("token")||"").trim()}catch{return""}},a0=n=>{let e=String(n||"").trim();if(!e)return"";const t=e.match(/authorization\s*:\s*(.+)$/i);t&&t[1]&&(e=t[1].trim());const i=e.match(/^bearer\s+(.+)$/i);i&&i[1]&&(e=i[1].trim());const r=e.match(/^token\s*=\s*(.+)$/i);return r&&r[1]&&(e=r[1].trim()),(e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"))&&(e=e.slice(1,-1).trim()),e},Q8=n=>{let e=String(n||"").replace(/\/+$/,"");const t=[/\/mcp\/messages(\/.*)?$/i,/\/mcp\/sse$/i,/\/mcp\/tools$/i,/\/mcp\/status$/i,/\/mcp$/i];for(const i of t)if(i.test(e)){e=e.replace(i,"");break}return e=e.replace(/\/+$/,""),e?e.startsWith("/")?e:`/${e}`:"/"},wp=(n,e=Hc)=>{let t=String(n||"").trim();t||(t=e);const i=t.match(/https?:\/\/[^\s'"]+/i);i&&i[0]&&(t=i[0]),!/^[a-z][a-z0-9+.-]*:\/\//i.test(t)&&/^localhost(:\d+)?(\/|$)/i.test(t)&&(t=`http://${t}`),t=t.replace(/\/+$/,"");try{const r=new URL(t),o=String(r.protocol||"").toLowerCase();if(o!=="http:"&&o!=="https:")return t||e;const l=String(r.hostname||"").toLowerCase();return(l==="root.caravanflow.com"||l==="console.caravanflow.com")&&(r.hostname="mcp.caravanflow.com",r.port=""),r.pathname=Q8(r.pathname),r.search="",r.hash="",`${r.origin}${r.pathname==="/"?"":r.pathname}`.replace(/\/+$/,"")||e}catch{return t||e}},L_=(n,e=220)=>String(n||"").replace(/\s+/g," ").trim().slice(0,e),Pc=n=>{var r,o,l,c,d,f,m;if(!n||typeof n!="object")return null;const e=String((n==null?void 0:n._imageData)||"").trim(),t=String((n==null?void 0:n._mimeType)||"").trim();if(e&&t)return{_imageData:e,_mimeType:t};const i=[n==null?void 0:n.screenshot,(r=n==null?void 0:n.result)==null?void 0:r.screenshot,(l=(o=n==null?void 0:n.result)==null?void 0:o.result)==null?void 0:l.screenshot,(f=(d=(c=n==null?void 0:n.result)==null?void 0:c.result)==null?void 0:d.result)==null?void 0:f.screenshot,(m=n==null?void 0:n.data)==null?void 0:m.screenshot];for(const v of i){const E=String(v||"").trim();if(!E.startsWith("data:image/"))continue;const b=E.match(/^data:(image\/[a-zA-Z0-9.+-]+);base64,(.+)$/i);if(!(!b||!b[1]||!b[2]))return{_imageData:String(b[2]).trim(),_mimeType:String(b[1]).trim().toLowerCase()}}return null},X8=(n,e)=>{const t=String(n||"").trim().toLowerCase();return String(e||"").toLowerCase().includes("text/html")||t.startsWith("<!doctype html")||t.startsWith("<html")||t.startsWith("<body")||t.startsWith("<")},xp=async(n,e="MCP endpoint")=>{const t=String(n.headers.get("content-type")||""),i=await n.text(),r=L_(i);if(!String(i||"").trim())return{ok:!1,error:`${e} returned an empty response body (expected JSON).`,snippet:r};try{return{ok:!0,data:JSON.parse(i)}}catch{const l=X8(i,t)?`${e} returned HTML instead of JSON. Check MCP base URL/auth (Cloudflare/login pages often return HTML).`:`${e} returned non-JSON content (Content-Type: ${t||"unknown"}).`;return{ok:!1,error:r?`${l} Snippet: ${r}`:l,snippet:r}}},Sh=()=>{if(typeof localStorage>"u")return{};const n=localStorage.getItem(Sp.VFS);return n?JSON.parse(n):{"/":{type:"dir",children:["home"]},"/home":{type:"dir",children:["bilge"]},"/home/bilge":{type:"dir",children:["project"]},"/home/bilge/project":{type:"dir",children:["README.md"]},"/home/bilge/project/README.md":{type:"file",content:`# Bilge Project
Initial scaffold.`}}},Z8=n=>{typeof localStorage>"u"||localStorage.setItem(Sp.VFS,JSON.stringify(n))};class e9{constructor(){this.tools=new Map,this.fileWriteListeners=[],this.realToolsCache=null,this.realToolsInFlight=null,this.inAuditMode=!1,this.runtimeInfo=er(),this.runtimeCapabilities=yR(this.runtimeInfo),this.lastFetchError=null,this.bridgeFailureCount=0,this.BRIDGE_FAILURE_THRESHOLD=3,this.bridgeCircuitOpen=!1,this.lastBridgeRetry=0,this.BRIDGE_RETRY_COOLDOWN=3e4,this.registerBrowserTools()}getMcpConfig(){let e="https://mcp.caravanflow.com",t="fETRiYbbIuKj48kx31WnVJfzePYSiAa-Yj3Oyx4VrNY";if(typeof localStorage<"u")try{const o=localStorage.getItem(Sp.SETTINGS);if(o){const l=JSON.parse(o);typeof(l==null?void 0:l.mcpBaseUrl)=="string"&&l.mcpBaseUrl.trim()&&(e=l.mcpBaseUrl.trim()),typeof(l==null?void 0:l.mcpApiToken)=="string"&&l.mcpApiToken.trim()&&(t=l.mcpApiToken.trim())}}catch{}if(!String(t||"").trim()){const o=W8(e);o&&(t=o)}const i=wp(e,Hc),r=a0(t);return{baseUrl:i,apiToken:r}}getLocalTools(){return Array.from(this.tools.values())}resolveShellCommand(e){if(!e)return"";if(typeof e=="string")return e.trim();const t=[e.command,e.cmd,e.shell,e.script];for(const r of t)if(typeof r=="string"&&r.trim())return r.trim();const i=Array.isArray(e.cmd)?e.cmd:null;if(i&&i.length>0){const r=i.map(o=>String(o??"").trim()).filter(Boolean);return r.length>=3&&r[0]==="/bin/bash"&&r[1]==="-c"?r.slice(2).join(" ").trim():r.join(" ").trim()}return""}async fetchRealTools(){const t=Date.now();if(this.realToolsCache&&t-this.realToolsCache.fetchedAt<3e4)return this.realToolsCache.tools;if(this.realToolsInFlight)try{return await this.realToolsInFlight}catch{return[]}this.realToolsInFlight=(async()=>{try{const i=er(),{baseUrl:r,apiToken:o}=this.getMcpConfig(),l=wp(r,Hc),c=!!String(o||"").trim(),d=l!==Hc;if(i.kind==="studio"&&!(()=>{try{return localStorage.getItem("bilge_studio_allow_remote_mcp")==="1"}catch{return!1}})()&&!c&&!d)return[];if(i.kind==="extension"){const E=l.includes("127.0.0.1:8787")||l.includes("localhost:8787"),b=l===Hc}const f={};f.Accept="application/json",o&&(f.Authorization=`Bearer ${o}`);const m=new AbortController,v=window.setTimeout(()=>m.abort(),8e3);try{const E=await fetch(`${l}/mcp/tools`,{headers:f,signal:m.signal});if(window.clearTimeout(v),!E.ok){const A=L_(await E.text());return this.lastFetchError=`HTTP ${E.status}${A?`: ${A}`:""}`,[]}const b=await xp(E,"/mcp/tools");if(!b.ok)return this.lastFetchError=b.error,c||d?console.warn("[MCP] Remote MCP server returned an invalid tools payload.",b.error):console.debug("[MCP] Default remote MCP tools payload was not JSON."),[];const x=(b.data.tools||[]).map(A=>({...A,server:"real-mcp"}));return this.realToolsCache={tools:x,fetchedAt:Date.now()},this.lastFetchError=null,x}catch(E){return this.lastFetchError=String((E==null?void 0:E.message)||E),c||d?console.warn("[MCP] Remote MCP server configured but not reachable.",E):console.debug("[MCP] Default remote MCP server not reachable, using local bridge."),[]}}catch{return[]}finally{this.realToolsInFlight=null}})();try{return await this.realToolsInFlight}catch{return[]}}subscribeToFileWrites(e){return this.fileWriteListeners.push(e),()=>{this.fileWriteListeners=this.fileWriteListeners.filter(t=>t!==e)}}notifyFileWrite(e){this.fileWriteListeners.forEach(t=>t(e))}listAllFiles(){const e=Sh();return Object.keys(e).filter(t=>e[t].type==="file")}getFileContent(e){const t=Sh(),i=e.startsWith("/")?e:`/home/bilge/project/${e}`;return t[i]&&t[i].type==="file"?t[i].content:null}getGlobalGuidance(){Sh();const e=["AGENTS.md","AGENTS.override.md","agent.md"];for(const t of e){const i=this.getFileContent(t);if(i)return i}return""}async hydrateFromSystem(e){for(const[t,i]of Object.entries(e))await this.executeTool("write_file",{path:t,content:i,isSilent:!0});console.debug(`[VFS] Hydrated ${Object.keys(e).length} files into workspace.`)}async downloadAsZip(){const e=new J8,t=this.listAllFiles();if(t.length===0){alert("VFS is empty. Generating files...");return}t.forEach(l=>{const c=this.getFileContent(l);if(c!==null){const d=l.replace(/^\/home\/bilge\/project\//,"").replace(/^\//,"");e.file(d,c)}});const i=await e.generateAsync({type:"blob"}),r=URL.createObjectURL(i),o=document.createElement("a");o.href=r,o.download=`bilge-repo-${new Date().toISOString().split("T")[0]}.zip`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}registerBrowserTools(){this.tools.set("read_file",{name:"read_file",description:"Reads file content from the project.",parameters:{type:"OBJECT",properties:{path:{type:"STRING"}},required:["path"]},server:"system-root"}),this.tools.set("write_file",{name:"write_file",description:"Writes content to a file. Used for generating code, .env, etc.",parameters:{type:"OBJECT",properties:{path:{type:"STRING",description:"Path relative to project root"},content:{type:"STRING",description:"Raw string content"},isSilent:{type:"BOOLEAN"}},required:["path","content"]},server:"system-root"}),this.tools.set("execute_shell_command",{name:"execute_shell_command",description:"Executes bash commands on the host.",parameters:{type:"OBJECT",properties:{command:{type:"STRING"}},required:["command"]},server:"system-root"}),this.tools.set("patch",{name:"patch",description:"Applies a git-style patch to a file. Better for modifying large files.",parameters:{type:"OBJECT",properties:{path:{type:"STRING",description:"Path to the file to patch"},patch:{type:"STRING",description:"The patch content in unified diff format"}},required:["path","patch"]},server:"system-root"}),this.tools.set("tree",{name:"tree",description:"Lists the directory structure of the project.",parameters:{type:"OBJECT",properties:{path:{type:"STRING",description:"Base path to list from"},max_depth:{type:"NUMBER",description:"How deep to recurse (default 6)."},max_entries:{type:"NUMBER",description:"Maximum entries to return (default 2000)."}}},server:"system-root"}),this.tools.set("search",{name:"search",description:"Searches repository file paths matching a query (broader scope by default).",parameters:{type:"OBJECT",properties:{query:{type:"STRING"},limit:{type:"NUMBER",description:"Max number of matches (default 100, max 500)."}},required:["query"]},server:"system-root"}),this.tools.set("stack_manage",{name:"stack_manage",description:"Stack Guardian: diagnoses and repairs local stack services/ports (status/start/stop/restart/ensure).",parameters:{type:"OBJECT",properties:{action:{type:"STRING",description:"One of status|start|stop|restart|ensure (default: ensure)."},target:{type:"STRING",description:"Target group/service (all|agent|mcp_api|console|ui|fastapi|root_ui|agent_relay|console_fallback|tunnel_console)."},ensure_ports:{type:"BOOLEAN",description:"When true (default), listening ports are part of health checks."},auto_heal:{type:"BOOLEAN",description:"When true (default), restart unhealthy targets during ensure."},max_cycles:{type:"NUMBER",description:"Max remediation cycles for ensure (default 2, max 4)."}}},server:"system-root"}),this.tools.set("web_search",{name:"web_search",description:"Searches the public web (DuckDuckGo) and returns top results.",parameters:{type:"OBJECT",properties:{query:{type:"STRING",description:"Search query."},max_results:{type:"NUMBER",description:"Max results to return (default 5).",default:5}},required:["query"]},server:"system-root"}),this.tools.set("get_browser_context",{name:"get_browser_context",description:"Retrieves information about the current active tab (URL, title, summary).",parameters:{type:"OBJECT",properties:{}},server:"extension"}),this.tools.set("explore_browser_dom",{name:"explore_browser_dom",description:"Retrieves the HTML structure of the current page or a specific selector.",parameters:{type:"OBJECT",properties:{selector:{type:"STRING",description:"CSS selector to explore (default: body)"}}},server:"extension"}),this.tools.set("take_screenshot",{name:"take_screenshot",description:"Captures a screenshot of the current visible tab.",parameters:{type:"OBJECT",properties:{}},server:"extension"}),this.tools.set("execute_natural_command",{name:"execute_natural_command",description:'Executes a natural-language browser command in the active tab (examples: "scroll down", "scroll up", "click on Submit", "type hello", "go back", "refresh", "take screenshot").',parameters:{type:"OBJECT",properties:{command:{type:"STRING",description:"Natural command text to execute."}},required:["command"]},server:"extension"}),this.tools.set("click_element",{name:"click_element",description:"Clicks an element on the page. Supports CSS selectors with intelligent heuristic fallback using field hints.",parameters:{type:"OBJECT",properties:{selector:{type:"STRING",description:"CSS selector of the element to click (optional if using heuristic hints)"},field:{type:"STRING",description:'Heuristic hint: field purpose like "email", "first name", "submit"'},name:{type:"STRING",description:"Heuristic hint: field name attribute value"},label:{type:"STRING",description:"Heuristic hint: associated label text"},placeholder:{type:"STRING",description:"Heuristic hint: placeholder text"}}},server:"extension"}),this.tools.set("type_text",{name:"type_text",description:"Types text into an input element. Supports CSS selectors with intelligent heuristic fallback using field hints.",parameters:{type:"OBJECT",properties:{selector:{type:"STRING",description:"CSS selector of the input element (optional if using heuristic hints)"},text:{type:"STRING",description:"Text to type"},field:{type:"STRING",description:'Heuristic hint: field purpose like "email", "first name", "phone"'},name:{type:"STRING",description:"Heuristic hint: field name attribute value"},label:{type:"STRING",description:"Heuristic hint: associated label text"},placeholder:{type:"STRING",description:"Heuristic hint: placeholder text"}},required:["text"]},server:"extension"}),this.tools.set("execute_batch_actions",{name:"execute_batch_actions",description:'Executes a sequence of DOM actions (fill forms, click buttons, scroll, wait) with intelligent field matching and humanized delays. IMPORTANT: Use action names like "click", "type", or "scroll" inside the actions array.',parameters:{type:"OBJECT",properties:{actions:{type:"ARRAY",description:"Array of action objects to execute in sequence",items:{type:"OBJECT",properties:{type:{type:"STRING",enum:["fill","click","scroll","wait","script","click_element","type_text"],description:'Action type. "click" or "click_element" for clicking, "type" or "type_text" for entering text.'},selector:{type:"STRING",description:"CSS selector (optional if using heuristic hints)"},selectors:{type:"ARRAY",items:{type:"STRING"},description:"Fallback selectors array"},value:{type:"STRING",description:"Value to fill (for fill/type actions)"},code:{type:"STRING",description:"JavaScript to execute (for script action)"},duration:{type:"NUMBER",description:"Wait duration in ms (for wait action)"},field:{type:"STRING",description:'Heuristic hint: field purpose (e.g. "email", "submit")'},name:{type:"STRING",description:"Heuristic hint: field name attribute"},label:{type:"STRING",description:"Heuristic hint: associated label text"},placeholder:{type:"STRING",description:"Heuristic hint: placeholder text"},overwrite:{type:"BOOLEAN",description:"Overwrite existing value (default: false)"}},required:["type"]}},options:{type:"OBJECT",description:"Execution options",properties:{humanizedDelayEnabled:{type:"BOOLEAN",description:"Enable random delays between actions (default: true)"},humanizedDelayBaseMs:{type:"NUMBER",description:"Base delay in ms (default: 220)"},humanizedDelayJitterMs:{type:"NUMBER",description:"Random jitter in ms (default: 260)"},allowSensitiveFill:{type:"BOOLEAN",description:"Allow filling sensitive fields like SSN (default: false)"}}}},required:["actions"]},server:"extension"}),this.tools.set("cancel_batch_actions",{name:"cancel_batch_actions",description:"Cancels an in-progress batch action run (execute_batch_actions).",parameters:{type:"OBJECT",properties:{runId:{type:"STRING",description:"The runId returned by execute_batch_actions."}},required:["runId"]},server:"extension"}),this.tools.set("get_active_runs",{name:"get_active_runs",description:"Lists currently active batch action runs.",parameters:{type:"OBJECT",properties:{}},server:"extension"}),this.tools.set("execute_javascript",{name:"execute_javascript",description:'Executes arbitrary JavaScript. Supports 3 modes: "auto" (default) tries Chrome extension first then falls back to Puppeteer if blocked; "extension" uses only Chrome extension; "puppeteer" uses MCP server Puppeteer directly (bypasses CSP, works on any URL).',parameters:{type:"OBJECT",properties:{code:{type:"STRING",description:"JavaScript function body. Use `return ...` to return a value."},mode:{type:"STRING",description:'Execution mode: "auto" (default, extension with puppeteer fallback), "extension" (extension only), "puppeteer" (puppeteer only, bypasses CSP).'},url:{type:"STRING",description:"Target URL for puppeteer mode. If not provided, uses current tab URL."},timeout_ms:{type:"NUMBER",description:"Max time to wait for completion in milliseconds (default: 5000 for extension, 30000 for puppeteer)."}},required:["code"]},server:"extension"}),this.tools.set("get_element_value",{name:"get_element_value",description:"Safely retrieves the value or text of an element using a selector. BYPASSES CSP ISSUES. Use this instead of execute_javascript for reading page data.",parameters:{type:"OBJECT",properties:{selector:{type:"STRING",description:"CSS selector of the element."},attribute:{type:"STRING",description:"Optional attribute to retrieve (default: value or innerText)."}},required:["selector"]},server:"extension"}),this.tools.set("scroll_to_element",{name:"scroll_to_element",description:"Smoothly scrolls the specified element into view.",parameters:{type:"OBJECT",properties:{selector:{type:"STRING",description:"CSS selector of the element to scroll to."}},required:["selector"]},server:"extension"}),this.tools.set("run_script_direct",{name:"run_script_direct",description:"Advanced: Directly injects and executes JavaScript into the page using the highest privilege level available. Use this if get_element_value is insufficient.",parameters:{type:"OBJECT",properties:{code:{type:"STRING",description:"JavaScript to inject and execute."},world:{type:"STRING",enum:["ISOLATED","MAIN"],description:"The context world. MAIN allows bypassing some CSPs and accessing page variables."}},required:["code"]},server:"extension"}),this.tools.set("test_mcp_round_trip",{name:"test_mcp_round_trip",description:"Verifies the full communication path (Applet -> Background -> Content Script) and returns a status report.",parameters:{type:"OBJECT",properties:{}},server:"extension"}),this.tools.set("ping_agent",{name:"ping_agent",description:"Pings the relay-connected Bilge agent and returns relay connection status.",parameters:{type:"OBJECT",properties:{}},server:"extension"}),this.tools.set("talk_to_bilge_agent_brain",{name:"talk_to_bilge_agent_brain",description:"Sends a natural-language command to the Bilge Agent brain (extension runtime Cortex path). This is separate from Bilge Web chat personality. Self-heal/self-improvement phrases auto-route to maintenance diagnostics.",parameters:{type:"OBJECT",properties:{message:{type:"STRING",description:"Natural-language command for Bilge Agent brain."},persona:{type:"STRING",enum:["bilge_agent","bilge_web"],description:"Target persona boundary. Default is bilge_agent."},strictPersona:{type:"BOOLEAN",description:"If true (default), rejects non-bilge_agent persona for relay NATURAL_COMMAND."},agentId:{type:"STRING",description:"Optional target agent id. If omitted, local agent is used."},runId:{type:"STRING",description:"Optional trace run id."},commandId:{type:"STRING",description:"Optional trace command id."}},required:["message"]},server:"extension"}),this.tools.set("launch_self_improvement_mode",{name:"launch_self_improvement_mode",description:"Runs Bilge Agent self-awareness + self-healing diagnostics in Chrome runtime and returns component map, issues, and validation recommendations.",parameters:{type:"OBJECT",properties:{autoHeal:{type:"BOOLEAN",description:"If true (default), attempt safe auto-heal steps (relay reconnect, etc.)."},applyValidationMode:{type:"BOOLEAN",description:"If true, applies recommended validation provider/model to brain presets."},restartAfter:{type:"BOOLEAN",description:"If true, schedules extension runtime restart after self-improvement response."},allowEnableMasterActive:{type:"BOOLEAN",description:"If true, self-improvement mode may enable masterActive when currently off."},includeScreenshot:{type:"BOOLEAN",description:"If true, include current tab screenshot in result."},includeDomSnapshot:{type:"BOOLEAN",description:"If true (default), include structured DOM snapshot diagnostics."},validationProvider:{type:"STRING",description:"Optional override for validation provider (openai|deepseek|gemini)."},validationModel:{type:"STRING",description:"Optional override for validation model."},agentId:{type:"STRING",description:"Optional target agent id. If omitted, local agent is used."},runId:{type:"STRING",description:"Optional trace run id."},commandId:{type:"STRING",description:"Optional trace command id."}}},server:"extension"}),this.tools.set("restart_extension_runtime",{name:"restart_extension_runtime",description:"Restarts the Bilge Chrome extension runtime (background service worker + sidepanel session).",parameters:{type:"OBJECT",properties:{}},server:"extension"}),this.tools.set("dispatch_agent_command",{name:"dispatch_agent_command",description:"Dispatches a relay command via the agent execution pipeline (for example NATURAL_COMMAND, CAPTURE_SCREEN, EXECUTE_ACTIONS, TRAINING_PROBE, SELF_IMPROVE).",parameters:{type:"OBJECT",properties:{type:{type:"STRING",description:"Relay command type (e.g. NATURAL_COMMAND)."},payload:{type:"OBJECT",description:"Command payload object."},agentId:{type:"STRING",description:"Optional target agent id. If omitted, local agent is used."},runId:{type:"STRING",description:"Optional trace run id."},commandId:{type:"STRING",description:"Optional trace command id."}},required:["type"]},server:"extension"}),this.tools.set("fetch_image",{name:"fetch_image",description:"Fetches an image file (PNG/JPG/WEBP) from the host and returns its base64 data.",parameters:{type:"OBJECT",properties:{path:{type:"STRING",description:"Path to the image file."},max_bytes:{type:"NUMBER",description:"Max bytes to read.",default:5e6}},required:["path"]},server:"system-root"}),this.tools.set("system_halt",{name:"system_halt",description:"Initiates a system shutdown sequence, halting the Bilge OS interface.",parameters:{type:"OBJECT",properties:{}},server:"system-root"}),this.tools.set("system_log",{name:"system_log",description:"Internal: Logs a message to the host system logs.",parameters:{type:"OBJECT",properties:{message:{type:"STRING"},type:{type:"STRING"},metadata:{type:"OBJECT"}},required:["message"]},server:"extension"})}async getTools(e,t){const i=Array.from(this.tools.values()),r=await this.fetchRealTools(),o=new Map;i.forEach(c=>o.set(c.name,c)),r.forEach(c=>o.set(c.name,c));const l=Array.from(o.values());return this.runtimeCapabilities.canUseBrowserAutomation?l:l.filter(c=>!Oy.has(c.name))}async isBridgeConnected(){try{return(await this.fetchRealTools()).length>0}catch{return!1}}convertToGeminiTools(e){if(e.length===0)return[];const t=f=>!f||typeof f!="object"||Array.isArray(f)?{}:f,i=f=>f?Array.isArray(f)?f.map(String).filter(Boolean):typeof f=="string"?[f]:[]:[],r=f=>{const m=(f==null?void 0:f.parameters)??(f==null?void 0:f.input_schema)??(f==null?void 0:f.inputSchema)??{},v=t(m==null?void 0:m.properties),E=i(m==null?void 0:m.required);return{properties:v,required:E}},o=f=>{if(Array.isArray(f)){const m=f.map(o).filter(Boolean);return m.includes(Ct.STRING)?Ct.STRING:m[0]}if(typeof f=="string"){const m=f.trim().toLowerCase();if(m==="object")return Ct.OBJECT;if(m==="array")return Ct.ARRAY;if(m==="string")return Ct.STRING;if(m==="number")return Ct.NUMBER;if(m==="integer")return Ct.INTEGER;if(m==="boolean")return Ct.BOOLEAN;if(m==="null")return Ct.NULL;if(m==="type_unspecified")return Ct.TYPE_UNSPECIFIED;const v=f.trim().toUpperCase();if(Ct[v])return Ct[v]}},l=f=>{const m=o(f==null?void 0:f.type);return m||(f!=null&&f.properties&&typeof f.properties=="object"&&!Array.isArray(f.properties)?Ct.OBJECT:f!=null&&f.items?Ct.ARRAY:Ct.STRING)},c=f=>{const m=Array.isArray(f)?f.filter(Boolean):[];if(m.length===0)return{};const v=m.map(x=>({v:x,t:l(x)})),E=v.find(x=>x.t===Ct.STRING);if(E)return E.v;const b=v.find(x=>x.t===Ct.OBJECT);if(b)return b.v;const I=v.find(x=>x.t===Ct.ARRAY);return I?I.v:m[0]},d=(f,m=0)=>{if(m>6)return{type:Ct.STRING};if(!f||typeof f!="object"||Array.isArray(f))return{type:Ct.STRING};const v=typeof f.description=="string"?f.description:void 0,E=f.anyOf??f.any_of??f.oneOf??f.one_of;if(Array.isArray(E)&&E.length>0){const x=c(E),A=d(x,m+1);return v&&typeof A.description!="string"&&(A.description=v),A}const b=l(f),I={type:b};if(v&&(I.description=v),b===Ct.OBJECT){const x={};if(f.properties&&typeof f.properties=="object"&&!Array.isArray(f.properties))for(const[A,N]of Object.entries(f.properties))x[A]=d(N,m+1);return I.properties=x,I.required=i(f.required),I}if(b===Ct.ARRAY){let x=f.items;return Array.isArray(x)&&(x=x[0]),I.items=d(x||{type:Ct.STRING},m+1),I}return Array.isArray(f.enum)&&f.enum.length>0&&(I.enum=f.enum),I};return[{functionDeclarations:e.map(f=>{const m=r(f),v={};for(const[E,b]of Object.entries(m.properties||{}))v[E]=d(b,0);return{name:f.name,description:f.description,parameters:{type:Ct.OBJECT,properties:v,required:m.required}}})}]}convertToOpenAiTools(e){const t=o=>{if(typeof o=="string")return o.trim().toLowerCase();if(typeof o=="number"){const l=Ct[o];if(typeof l=="string")return l.trim().toLowerCase()}},i=o=>{if(Array.isArray(o))return o.map(i);if(!o||typeof o!="object")return o;const l={};for(const[c,d]of Object.entries(o)){if(c==="type"){l.type=t(d)??d;continue}if(c==="properties"&&d&&typeof d=="object"&&!Array.isArray(d)){const f={};for(const[m,v]of Object.entries(d))f[m]=i(v);l.properties=f;continue}l[c]=i(d)}return l},r=o=>{const l=i(o||{});if(!l||typeof l!="object"||Array.isArray(l))return{type:"object",properties:{}};const c=t(l.type)||"object";return l.type=c,l.type==="object"&&((!l.properties||typeof l.properties!="object"||Array.isArray(l.properties))&&(l.properties={}),Array.isArray(l.required)||(l.required=l.required?[l.required]:[])),l};return e.map(o=>({type:"function",function:{name:o.name,description:o.description,parameters:r(o.parameters)}}))}async callRemoteTool(e,t){var i;try{const{baseUrl:r,apiToken:o}=this.getMcpConfig(),l={"Content-Type":"application/json"};l.Accept="application/json",o&&(l.Authorization=`Bearer ${o}`);const c=new AbortController,d=window.setTimeout(()=>c.abort(),3e4),f=await fetch(`${r}/mcp/sse`,{method:"POST",headers:l,signal:c.signal,body:JSON.stringify({jsonrpc:"2.0",id:Math.random().toString(36).substring(7),method:"tools/call",params:{name:e,arguments:t}})});if(window.clearTimeout(d),f.ok){const v=await xp(f,"/mcp/sse");return v.ok?(i=v.data)==null?void 0:i.result:(console.warn("[MCP] Remote call returned invalid JSON.",v.error),null)}const m=L_(await f.text());console.warn(`[MCP] Remote call failed: HTTP ${f.status}${m?`: ${m}`:""}`)}catch(r){console.error("[MCP] Remote call failed",r)}return null}restartExtension(){return this.runtimeCapabilities.canReloadExtension?new Promise(e=>{chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"reload_extension"}},t=>{const i=chrome.runtime.lastError;if(i){console.warn("[MCP] restartExtension failed:",i.message),e(!1);return}e(!!t)})}):Promise.resolve(!1)}reconnectRelay(){return this.runtimeCapabilities.canReloadExtension?new Promise(e=>{try{chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"relay_reconnect"}},t=>{const i=chrome.runtime.lastError;if(i){e({ok:!1,connected:!1,error:i.message});return}if(!t||typeof t!="object"){e({ok:!1,connected:!1,error:"No relay response from extension background."});return}e(t)})}catch(t){e({ok:!1,connected:!1,error:String((t==null?void 0:t.message)||t||"Unknown relay connect error")})}}):Promise.resolve({ok:!1,connected:!1,error:"Relay connect is available only in extension runtime."})}getDomSkillMemorySummary(e=8){return this.runtimeCapabilities.canUseBrowserAutomation?new Promise(t=>{try{chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"get_dom_skill_memory_summary",limit:e}},i=>{const r=chrome.runtime.lastError;if(r){t({ok:!1,error:r.message,total:0,byIntent:{},recent:[]});return}t(i||{ok:!1,error:"No response from background."})})}catch(i){t({ok:!1,error:String((i==null?void 0:i.message)||i||"Unknown error"),total:0,byIntent:{},recent:[]})}}):Promise.resolve({ok:!1,error:"DOM skill memory is available only in extension runtime."})}clearDomSkillMemory(){return this.runtimeCapabilities.canUseBrowserAutomation?new Promise(e=>{try{chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"clear_dom_skill_memory"}},t=>{const i=chrome.runtime.lastError;if(i){e({ok:!1,error:i.message,cleared:0});return}e(t||{ok:!1,error:"No response from background.",cleared:0})})}catch(t){e({ok:!1,error:String((t==null?void 0:t.message)||t||"Unknown error"),cleared:0})}}):Promise.resolve({ok:!1,error:"DOM skill memory is available only in extension runtime."})}getFormFields(){return this.runtimeCapabilities.canUseBrowserAutomation?new Promise(e=>{try{chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"get_page_fields"}},t=>{const i=chrome.runtime.lastError;if(i){e({error:i.message});return}e(t||{error:"No response from background."})})}catch(t){e({error:String((t==null?void 0:t.message)||t||"Unknown error")})}}):Promise.resolve({error:"Browser automation not available"})}async executeTool(e,t){var b,I,x,A,N,U,L,$,K,j;const i=["write_file","execute_shell_command","patch","create","delete"];if(this.inAuditMode&&i.includes(e))return console.warn(`[Policy] Tool call blocked in Audit Mode: ${e}`),{error:"Tool call blocked: Agent is in Audit Mode due to reading a log file. Modifications are not allowed. To proceed, please explicitly confirm modifications by asking to clear the audit context, or by providing a new imperative that implicitly clears it."};e!=="read_file"&&(this.inAuditMode=!1);const r=typeof localStorage<"u"?localStorage.getItem(Sp.SETTINGS):null;let o="read",l=!1;if(r)try{const k=JSON.parse(r);k.executionPolicy&&(o=k.executionPolicy),k.enableFullExecutionMode&&(o="yolo"),l=!!k.enableDomMode&&this.runtimeCapabilities.canUseBrowserAutomation}catch{}const c=["get_browser_context","explore_browser_dom","take_screenshot","execute_natural_command","click_element","type_text","execute_batch_actions","get_element_value","scroll_to_element","execute_javascript","run_script_direct","get_active_runs","cancel_batch_actions","ping_agent","talk_to_bilge_agent_brain","launch_self_improvement_mode","restart_extension_runtime","dispatch_agent_command"];if(!((k,V)=>{if(l&&c.includes(k)||o==="yolo")return!0;if(o==="none")return!1;const D=["read_file","list_files","search","tree","grep","find_symbol","references","todos","stack_manage","get_browser_context","explore_browser_dom","take_screenshot","web_search","fetch_image","get_active_runs","cancel_batch_actions","ping_agent","launch_self_improvement_mode","restart_extension_runtime"],z=[...D,"execute_shell_command","patch","write_file","click_element","type_text","execute_javascript","execute_batch_actions","execute_natural_command","talk_to_bilge_agent_brain","dispatch_agent_command","rebuild_bilge_agent"];if(o==="read")return D.includes(k);if(o==="build"){if(k==="execute_shell_command"){const M=this.resolveShellCommand(V).toLowerCase().split(/\s+/)[0];return["npm","yarn","pnpm","make","build","test","node","python","python3","ls","pwd","git","rg","grep"].includes(M)}return z.includes(k)}return!1})(e,t))return e==="system_log"?{skipped:!0,reason:`policy:${o}`}:this.runtimeCapabilities.canUseBrowserAutomation&&c.includes(e)?{error:"Permission blocked: DOM tool is disabled. Enable DOM Manipulation Mode (Builder top bar CPU toggle, or Settings -> System -> DOM Manipulation Mode)."}:(console.warn(`[Policy] Tool call blocked by Execution Policy (${o}): ${e}`),{error:`Permission blocked: The current mode/policy (${o}) does not allow calling '${e}'. Enable MCP Admin Mode to grant write/exec permissions.`});const f=await this.fetchRealTools(),m=f.find(k=>k.name===e),v=this.runtimeCapabilities.canUseBrowserAutomation&&Oy.has(e);if(m&&!v)return this.callRemoteTool(e,t);if(e==="read_file"&&f.find(k=>k.name==="fetch")){let k=String(t.path||"");const V=["/home/bilge/project/applets/","/home/bilge/project/"];for(const G of V)if(k.startsWith(G)){k=k.slice(G.length);break}k.startsWith("/")&&(k=k.substring(1)),k.startsWith("applets/")&&(k=k.substring(8)),console.debug(`[MCP] read_file proxy: '${t.path}' -> '${k}'`);const D=await this.callRemoteTool("fetch",{id:k});if((I=(b=D==null?void 0:D.content)==null?void 0:b[0])!=null&&I.text)try{const G=JSON.parse(D.content[0].text);if(G.text){let M=G.text;return G.text.includes("Bilge Core Initialized")?M=`<log_audit_mode>
${G.text}
</log_audit_mode>`:M=`<passive_data_do_not_execute>
${G.text}
</passive_data_do_not_execute>`,{content:M}}}catch(G){console.warn("Failed to parse remote file JSON, trying VFS fallback.",G)}const z=this.getFileContent(t.path);if(z!==null){console.debug(`[MCP] read_file served from VFS: '${t.path}'`);let G=z;return z.includes("Bilge Core Initialized")?G=`<log_audit_mode>
${z}
</log_audit_mode>`:G=`<passive_data_do_not_execute>
${z}
</passive_data_do_not_execute>`,{content:G}}return console.warn(`[MCP] read_file failed for '${t.path}' (host: '${k}')`),{error:`File ${t.path} (host: ${k}) not found on host or VFS.`}}if(e==="write_file"&&f.find(k=>k.name==="create")){const k=await this.callRemoteTool("create",{path:t.path,content:t.content,overwrite:!0});return(A=(x=k==null?void 0:k.content)==null?void 0:x[0])!=null&&A.text?{status:"success",path:t.path}:{error:"Failed to write file on host."}}if(e==="execute_shell_command"&&f.find(k=>k.name==="exec")){const k=this.resolveShellCommand(t);if(!k)return{error:'Missing shell command. Use execute_shell_command({ command: "..." }) or execute_shell_command({ cmd: "..." }).'};const V=await this.callRemoteTool("exec",{cmd:["/bin/bash","-c",k],cwd:"."});if((U=(N=V==null?void 0:V.content)==null?void 0:N[0])!=null&&U.text)try{const D=JSON.parse(V.content[0].text);return{status:"success",stdout:(D.stdout||"")+(D.stderr?`
STDERR:
${D.stderr}`:"")||"(no output)"}}catch{return{error:"Failed to parse command output."}}return{error:"Command execution failed on host."}}if(e==="stack_manage"){if(!f.find(Ne=>Ne.name==="exec"))return{error:"stack_manage requires host connection (exec tool unavailable)."};const k={status:"status",check:"status",inspect:"status",health:"status",start:"start",stop:"stop",restart:"restart",bounce:"restart",recover:"ensure",heal:"ensure",ensure:"ensure",doctor:"ensure"},V=String((t==null?void 0:t.action)||"ensure").trim().toLowerCase(),D=k[V]||"ensure",z={all:"all",agent:"agent",relay:"agent_relay",agent_relay:"agent_relay",mcp:"mcp_api",mcp_api:"mcp_api",console:"console",ui:"ui",fastapi:"fastapi",root:"root_ui",root_ui:"root_ui",console_fallback:"console_fallback",tunnel_console:"tunnel_console"},G=String((t==null?void 0:t.target)||"agent").trim().toLowerCase(),M=z[G]||G||"agent";if(!new Set(["all","agent","agent_relay","mcp_api","console","ui","fastapi","root_ui","console_fallback","tunnel_console"]).has(M))return{error:`Unsupported stack target '${M}'.`};const O=(t==null?void 0:t.ensure_ports)!==!1,oe=(t==null?void 0:t.auto_heal)!==!1,X=Number((t==null?void 0:t.max_cycles)??2),Q=Number.isFinite(X)?Math.max(1,Math.min(4,Math.floor(X))):2,se=async(Ne,Ge=6e4)=>{var it,C;const Ye=await this.callRemoteTool("exec",{cmd:["/bin/bash","-c",Ne],cwd:".",timeout_ms:Ge}),gt=String(((C=(it=Ye==null?void 0:Ye.content)==null?void 0:it[0])==null?void 0:C.text)||"").trim();if(!gt)return{ok:!1,command:Ne,error:"No exec output.",stdout:"",stderr:"",exitCode:null,raw:Ye};try{const ie=JSON.parse(gt),re=String((ie==null?void 0:ie.stdout)||""),Y=String((ie==null?void 0:ie.stderr)||""),J=Number(ie==null?void 0:ie.exit_code),ee=Number.isFinite(J)?J:null;return{ok:ee===null?!Y:ee===0,command:Ne,stdout:re,stderr:Y,exitCode:ee,raw:ie}}catch(ie){return{ok:!1,command:Ne,error:`Failed to parse exec output: ${String((ie==null?void 0:ie.message)||ie||"Unknown error")}`,stdout:"",stderr:gt,exitCode:null,raw:Ye}}},ne=Ne=>Ne==="all"?"python3 -m stackctl status":`python3 -m stackctl status ${Ne}`,ue=(Ne,Ge)=>Ge==="all"?`python3 -m stackctl ${Ne}`:`python3 -m stackctl ${Ne} ${Ge}`,F=Ne=>{const Ge=String(Ne||"").trim();if(!Ge)return null;try{return JSON.parse(Ge)}catch{const Ye=Ge.indexOf("{"),gt=Ge.lastIndexOf("}");if(Ye>=0&&gt>Ye){const it=Ge.slice(Ye,gt+1);try{return JSON.parse(it)}catch{return null}}return null}},W=Ne=>{var gt;const Ge=Array.isArray(Ne==null?void 0:Ne.services)?Ne.services:[],Ye=[];for(const it of Ge){const C=String((it==null?void 0:it.name)||"").trim();if(!C)continue;const ie=it==null?void 0:it.port,re=Number.isFinite(Number(ie))?Number(ie):null,Y=(it==null?void 0:it.alive)!==!1,J=(it==null?void 0:it.listening)!==!1,ee=(it==null?void 0:it.health)==null?!0:((gt=it==null?void 0:it.health)==null?void 0:gt.ok)!==!1;if(!Y){Ye.push({name:C,reason:"process_not_alive",port:re});continue}if(O&&re!==null&&!J){Ye.push({name:C,reason:"port_not_listening",port:re});continue}if(!ee){Ye.push({name:C,reason:"healthcheck_failed",port:re});continue}}return Ye},ye=Ne=>{if(M!=="all")return M;const Ge=new Set(Ne.map(Ye=>Ye.name));return Ge.has("agent_relay")||Ge.has("console")||Ge.has("tunnel_console")?"agent":Ge.has("mcp_api")?"mcp_api":Ge.has("fastapi")?"fastapi":Ge.has("ui")?"ui":Ge.has("root_ui")?"root_ui":"all"},_e=async()=>{const Ne=ne(M),Ge=await se(Ne,45e3),Ye=F(Ge.stdout),gt=Ye?W(Ye):[];return{statusCmd:Ne,statusExec:Ge,parsed:Ye,issues:gt}};if(D==="status"){const Ne=await _e();return{ok:!!Ne.parsed,action:D,target:M,healthy:!!Ne.parsed&&Ne.issues.length===0,issues:Ne.issues,status:Ne.parsed,command:Ne.statusCmd,stderr:Ne.statusExec.stderr||"",error:Ne.parsed?void 0:Ne.statusExec.error||"Unable to parse stack status JSON."}}if(D==="start"||D==="stop"||D==="restart"){const Ne=ue(D,M),Ge=await se(Ne,12e4),Ye=await _e();return{ok:Ge.ok&&!!Ye.parsed,action:D,target:M,command:Ne,stdout:Ge.stdout,stderr:Ge.stderr,healthy:!!Ye.parsed&&Ye.issues.length===0,issues:Ye.issues,status:Ye.parsed,error:Ge.ok?void 0:Ge.error||`stackctl ${D} failed`}}const Ee=[];let ze=!1;for(let Ne=1;Ne<=Q;Ne+=1){const Ge=await _e();if(Ee.push({cycle:Ne,phase:"check",command:Ge.statusCmd,ok:Ge.statusExec.ok,issues:Ge.issues}),Ge.parsed&&Ge.issues.length===0)return{ok:!0,action:"ensure",target:M,healthy:!0,recovered:ze,autoHeal:oe,ensurePorts:O,cycles:Ee,status:Ge.parsed,issues:[]};if(!oe)return{ok:!1,action:"ensure",target:M,healthy:!1,recovered:ze,autoHeal:oe,ensurePorts:O,cycles:Ee,status:Ge.parsed,issues:Ge.issues,error:Ge.parsed?"Stack is unhealthy and auto_heal=false.":"Unable to read stack status."};const Ye=ye(Ge.issues),gt=ue("restart",Ye),it=await se(gt,12e4);if(Ee.push({cycle:Ne,phase:"repair",target:Ye,command:gt,ok:it.ok,stderr:String(it.stderr||"").slice(0,800)}),ze=ze||it.ok,!it.ok)break}const Qe=await _e(),Je=!!Qe.parsed&&Qe.issues.length===0;return{ok:Je,action:"ensure",target:M,healthy:Je,recovered:ze,autoHeal:oe,ensurePorts:O,cycles:Ee,status:Qe.parsed,issues:Qe.issues,error:Je?void 0:"Stack remains unhealthy after ensure cycles."}}if(e==="patch"&&f.find(k=>k.name==="patch"))return this.callRemoteTool("patch",{path:t.path,patch:t.patch});if(e==="tree"&&f.find(k=>k.name==="tree")){const k=Number((t==null?void 0:t.max_depth)??6),V=Number.isFinite(k)?Math.max(0,Math.min(25,Math.floor(k))):6,D=Number((t==null?void 0:t.max_entries)??2e3),z=Number.isFinite(D)?Math.max(100,Math.min(1e4,Math.floor(D))):2e3;return this.callRemoteTool("tree",{path:t.path,max_depth:V,max_entries:z})}if(e==="search"&&f.find(k=>k.name==="search")){const k=Number((t==null?void 0:t.limit)??100),V=Number.isFinite(k)?Math.max(1,Math.min(500,Math.floor(k))):100;return this.callRemoteTool("search",{query:t.query,limit:V})}if(e==="web_search"){const k=String((t==null?void 0:t.query)||"").trim();if(!k)return{error:"'query' is required."};const V=Number((t==null?void 0:t.max_results)??5),D=Number.isFinite(V)?Math.max(1,Math.min(10,Math.floor(V))):5;if(f.find(z=>z.name==="exec")){const z=["import os, json, urllib.parse, urllib.request, re, html",'q = (os.environ.get("QUERY") or "").strip()','max_results = int((os.environ.get("MAX_RESULTS") or "5").strip() or "5")','url = "https://duckduckgo.com/html/?q=" + urllib.parse.quote(q)','req = urllib.request.Request(url, headers={"User-Agent": "Mozilla/5.0"})','html_text = urllib.request.urlopen(req, timeout=15).read().decode("utf-8", "ignore")',"results = []",`for m in re.finditer(r'class="result__a" href="(.*?)".*?>(.*?)</a>', html_text, re.S):`,"    href = html.unescape(m.group(1))",'    title = re.sub(r"<.*?>", "", m.group(2))','    results.append({"title": title, "url": href})',"    if len(results) >= max_results:","        break",'print(json.dumps({"query": q, "results": results}, ensure_ascii=False))'].join(`
`),G=await this.callRemoteTool("exec",{cmd:["/usr/bin/python3","-c",z],cwd:".",timeout_ms:3e4,env:{QUERY:k,MAX_RESULTS:String(D)}});if(($=(L=G==null?void 0:G.content)==null?void 0:L[0])!=null&&$.text)try{const M=JSON.parse(G.content[0].text),B=String(M.stdout||"").trim();if(!B)return{error:"web_search returned no output.",stderr:String(M.stderr||"").trim()};try{return JSON.parse(B)}catch{return{error:"web_search returned non-JSON output.",stdout:B,stderr:String(M.stderr||"").trim()}}}catch(M){return{error:`Failed to parse web_search output: ${String((M==null?void 0:M.message)||M||"")}`}}return{error:"web_search failed on host."}}return{error:"web_search requires host connection (bridge disconnected)."}}if(Oy.has(e)){if(this.bridgeCircuitOpen){const k=Date.now();if(k-this.lastBridgeRetry<this.BRIDGE_RETRY_COOLDOWN)return{error:`Extension Bridge Circuit Open: Too many failures. Please refresh the Chrome Extension and try again in ${Math.ceil((this.BRIDGE_RETRY_COOLDOWN-(k-this.lastBridgeRetry))/1e3)}s.`};this.bridgeCircuitOpen=!1,this.bridgeFailureCount=0,console.debug("[MCP] Attempting bridge circuit recovery...")}return this.runtimeCapabilities.canUseBrowserAutomation?new Promise(k=>{var oe;const V=Number(t==null?void 0:t.timeout_ms),D=Number.isFinite(V)?Math.max(5e3,Math.min(45e3,Math.floor(V))):2e4;let z=!1;const G=X=>{z||(z=!0,window.clearTimeout(B),k(X))},M=X=>{this.bridgeFailureCount++,this.bridgeFailureCount>=this.BRIDGE_FAILURE_THRESHOLD&&(this.bridgeCircuitOpen=!0,this.lastBridgeRetry=Date.now(),console.error(`[MCP] Bridge circuit opened after ${this.bridgeFailureCount} failures.`)),X&&console.warn(`[MCP] Bridge tool failure (${e}): ${X}`)},B=window.setTimeout(()=>{M(`timeout after ${D}ms`),G({error:`Bridge Timeout: '${e}' did not respond within ${D}ms.`})},D),O=X=>{const Q=chrome.runtime.lastError;if(Q){M(Q.message),G({error:`Bridge Error: ${Q.message}`});return}this.bridgeFailureCount=0,G(X||{error:"Failed to receive response from extension."})};if(e==="take_screenshot")chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"take_screenshot"}},X=>{const Q=Pc(X);Q?G({content:"Screenshot captured successfully.",...Q}):O(X)});else if(e==="execute_natural_command"){const X=String((t==null?void 0:t.command)||(t==null?void 0:t.text)||"").trim();if(!X){G({error:"'command' is required."});return}chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"execute_natural_command",command:X}},Q=>{const se=Pc(Q);if(se){G({content:"Screenshot captured successfully.",...se,result:(Q==null?void 0:Q.result)||Q});return}O(Q)})}else if(e==="get_browser_context"){const X=se=>{try{chrome.tabs.query({active:!0,currentWindow:!0},ne=>{const ue=chrome.runtime.lastError;if(ue){M(`tabs.query failed: ${ue.message}`),G({error:`Bridge Error: ${ue.message}`});return}const F=Array.isArray(ne)?ne[0]:null;if(!F){M(`context probe failed (${se}); no active tab`),G({error:`Could not recover browser context (${se}).`});return}this.bridgeFailureCount=0,G({url:String(F.url||""),title:String(F.title||""),description:"Recovered from tab metadata fallback.",html:"",_fallback:"tabs.query",_recoverReason:se})})}catch(ne){M(`tabs.query exception: ${String((ne==null?void 0:ne.message)||ne)}`),G({error:`Could not recover browser context (${se}).`})}},Q=se=>{chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"execute_script",code:`
const bodyText = document && document.body ? String(document.body.innerText || '') : '';
const html = bodyText.length > 8000 ? bodyText.slice(0, 8000) + '...' : bodyText;
const description = (document.querySelector('meta[name="description"]')?.content || '').trim();
return {
  url: String(location.href || ''),
  title: String(document.title || ''),
  description,
  html
};
`,world:"MAIN",timeout_ms:5e3}},ue=>{const F=chrome.runtime.lastError;if(!F&&ue&&!ue.error&&ue.result&&typeof ue.result=="object"){this.bridgeFailureCount=0,G({...ue.result,_fallback:"execute_script",_recoverReason:se});return}const W=(F==null?void 0:F.message)||String((ue==null?void 0:ue.error)||se||"context_probe_failed");X(W)})};chrome.runtime.sendMessage({to:"CONTENT_SCRIPT",payload:{type:"GET_PAGE_INFO"}},se=>{const ne=chrome.runtime.lastError;if(!ne&&se&&typeof se=="object"&&!se.error){this.bridgeFailureCount=0,G(se);return}const ue=(ne==null?void 0:ne.message)||String((se==null?void 0:se.error)||"content_runtime_unreachable");Q(ue)})}else if(e==="system_log"){const X=(oe=t.metadata)==null?void 0:oe.trace,Q=X?`[SESSION:${X.sessionId}][CYCLE:${X.cycleCount}] `:"",se=`[${new Date().toISOString()}][${t.type||"INFO"}] ${Q}${t.message} ${t.metadata?JSON.stringify(t.metadata):""}
`;this.fetchRealTools().then(ne=>{ne.find(ue=>ue.name==="exec")&&this.callRemoteTool("exec",{cmd:["/bin/bash","-c",`echo ${JSON.stringify(se.trim())} >> logs/bilge_neural.log`],cwd:"."})}),G({ok:!0})}else if(e==="get_element_value")chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"get_element_value",selector:t.selector,attribute:t.attribute}},O);else if(e==="scroll_to_element")chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"scroll_to_element",selector:t.selector}},O);else if(e==="run_script_direct")chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"execute_script",code:t.code,world:t.world}},O);else if(e==="test_mcp_round_trip"){const X={applet:"connected",background:"pending",content:"pending"};chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"execute_script",code:'return { status: "ok", world: "MAIN" }',world:"MAIN"}},Q=>{const se=chrome.runtime.lastError;if(se){X.background="error: "+se.message,O({error:"Round trip failed at background step.",report:X});return}X.background="connected",X.result=Q==null?void 0:Q.result,chrome.runtime.sendMessage({to:"CONTENT_SCRIPT",payload:{type:"__BILGE_PING__"}},ne=>{const ue=chrome.runtime.lastError;ue?X.content="error: "+ue.message:X.content=ne!=null&&ne.ok?"connected":"unexpected response",G({status:X.content==="connected"?"success":"partial",report:X})})})}else if(e==="ping_agent")chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"relay_ping"}},O);else if(e==="talk_to_bilge_agent_brain"){const X=String((t==null?void 0:t.message)||(t==null?void 0:t.command)||(t==null?void 0:t.text)||"").trim();if(!X){G({error:"'message' is required."});return}const Q=Y8((t==null?void 0:t.persona)||(t==null?void 0:t.targetPersona)||(t==null?void 0:t.brain)),se=typeof(t==null?void 0:t.strictPersona)=="boolean"?t.strictPersona:!0;chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"relay_dispatch_command",type:"NATURAL_COMMAND",payload:{command:X,persona:Q,brain:Q,strictPersona:se,channel:"bilge_agent_brain",source:"mcp.tool.talk_to_bilge_agent_brain"},agentId:String((t==null?void 0:t.agentId)||"").trim(),runId:String((t==null?void 0:t.runId)||"").trim(),commandId:String((t==null?void 0:t.commandId)||"").trim()}},ne=>{const ue=chrome.runtime.lastError;if(ue){G({error:ue.message});return}const F=Pc(ne);G({...ne,...F||{},brainTarget:"bilge_agent",requestedPersona:Q,separatedFromBilgeWeb:!0})})}else if(e==="launch_self_improvement_mode"){const X={};typeof(t==null?void 0:t.autoHeal)=="boolean"&&(X.autoHeal=t.autoHeal),typeof(t==null?void 0:t.applyValidationMode)=="boolean"&&(X.applyValidationMode=t.applyValidationMode),typeof(t==null?void 0:t.restartAfter)=="boolean"&&(X.restartAfter=t.restartAfter),typeof(t==null?void 0:t.allowEnableMasterActive)=="boolean"&&(X.allowEnableMasterActive=t.allowEnableMasterActive),typeof(t==null?void 0:t.includeScreenshot)=="boolean"&&(X.includeScreenshot=t.includeScreenshot),typeof(t==null?void 0:t.includeDomSnapshot)=="boolean"&&(X.includeDomSnapshot=t.includeDomSnapshot),typeof(t==null?void 0:t.validationProvider)=="string"&&t.validationProvider.trim()&&(X.validationProvider=t.validationProvider.trim()),typeof(t==null?void 0:t.validationModel)=="string"&&t.validationModel.trim()&&(X.validationModel=t.validationModel.trim()),X.source="mcp.tool.launch_self_improvement_mode",chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"relay_dispatch_command",type:"SELF_IMPROVE",payload:X,agentId:String((t==null?void 0:t.agentId)||"").trim(),runId:String((t==null?void 0:t.runId)||"").trim(),commandId:String((t==null?void 0:t.commandId)||"").trim()}},Q=>{const se=chrome.runtime.lastError;if(se){G({error:se.message});return}const ne=Pc(Q);G({...Q,...ne||{},mode:"self_improvement",brainTarget:"bilge_agent",separatedFromBilgeWeb:!0})})}else if(e==="restart_extension_runtime")chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"reload_extension"}},X=>{const Q=chrome.runtime.lastError;if(Q){G({error:Q.message});return}G(X||{status:"reloading"})});else if(e==="dispatch_agent_command"){const X=String((t==null?void 0:t.type)||(t==null?void 0:t.commandType)||"").trim();if(!X){G({error:"'type' is required."});return}const Q=t!=null&&t.payload&&typeof t.payload=="object"&&!Array.isArray(t.payload)?t.payload:{};chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"relay_dispatch_command",type:X,payload:Q,agentId:String((t==null?void 0:t.agentId)||"").trim(),runId:String((t==null?void 0:t.runId)||"").trim(),commandId:String((t==null?void 0:t.commandId)||"").trim()}},se=>{const ne=chrome.runtime.lastError;if(ne){M(ne.message),G({error:`Bridge Error: ${ne.message}`});return}const ue=Pc(se);if(ue){this.bridgeFailureCount=0,G({...se,...ue});return}O(se)})}else if(e==="get_active_runs")chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"get_active_runs"}},O);else if(e==="cancel_batch_actions"){const X=String((t==null?void 0:t.runId)||"").trim();if(!X){G({error:"'runId' is required."});return}chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"cancel_batch_actions",runId:X}},O)}else if(e==="execute_batch_actions"){const X=Array.isArray(t==null?void 0:t.actions)?t.actions:null;if(!X){G({error:"'actions' must be an array."});return}const Q=t!=null&&t.options&&typeof t.options=="object"&&!Array.isArray(t.options)?{...t.options}:{};typeof Q.humanizedDelayEnabled>"u"&&(Q.humanizedDelayEnabled=!0),typeof Q.humanizedDelayBaseMs>"u"&&(Q.humanizedDelayBaseMs=220),typeof Q.humanizedDelayJitterMs>"u"&&(Q.humanizedDelayJitterMs=260),typeof Q.allowSensitiveFill>"u"&&(Q.allowSensitiveFill=!1),chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"execute_batch_actions",actions:X,options:Q}},O)}else if(e==="execute_javascript"){const X=t.mode||"auto",Q=async se=>{var ne,ue;se?console.warn("[MCP] Extension JS execution blocked, trying Puppeteer fallback:",se):console.log("[MCP] execute_javascript using Puppeteer mode directly");try{let F=t.url;if(!F&&this.runtimeCapabilities.canUseBrowserAutomation){const ye=await new Promise(_e=>{chrome.runtime.sendMessage({to:"CONTENT_SCRIPT",payload:{type:"GET_PAGE_INFO"}},Ee=>{_e(Ee!=null&&Ee.url?Ee:null)})});F=ye==null?void 0:ye.url}if(!F){const ye=se?`Extension blocked: ${se}. `:"";G({error:`${ye}Puppeteer execution failed: no URL available. Pass 'url' parameter or ensure browser tab is accessible.`});return}const W=await this.callRemoteTool("execute_batch_actions",{url:F,actions:[{type:"script",code:t.code}],options:{timeout_ms:t.timeout_ms||3e4}});if(W!=null&&W.ok){const ye=(ue=(ne=W.steps)==null?void 0:ne[0])==null?void 0:ue.result;G({ok:!0,result:ye,_mode:"puppeteer",_originalError:se||void 0})}else G({error:(W==null?void 0:W.error)||"Puppeteer execution failed",_mode:"puppeteer",_originalError:se||void 0})}catch(F){const W=se?`Extension blocked: ${se}. `:"";G({error:`${W}Puppeteer error: ${(F==null?void 0:F.message)||F}`,_mode:"puppeteer_error"})}};if(X==="puppeteer"){Q();return}chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"execute_script",code:t.code,world:"ISOLATED",timeout_ms:t.timeout_ms}},se=>{const ne=chrome.runtime.lastError,ue=(ne==null?void 0:ne.message)||(se==null?void 0:se.error)||"";ue&&(ue.includes("CSP")||ue.includes("unsafe-eval")||ue.includes("Trusted Type")||ue.includes("trustedTypes")||ue.includes("Cannot access")||ue.includes("chrome://")||ue.includes("Extension context")||ue.includes("restricted")||ue.includes("blocked"))&&X==="auto"?Q(ue):se!=null&&se.error?G({error:se.error,_mode:"extension"}):O({ok:!0,result:se.result,_mode:"extension"})})}else{const X=e==="get_browser_context"?"GET_PAGE_INFO":e==="explore_browser_dom"?"EXPLORE_DOM":e==="click_element"?"CLICK_ELEMENT":e==="type_text"?"TYPE_TEXT":"UNKNOWN",Q={type:X};X==="EXPLORE_DOM"&&(Q.selector=t.selector),X==="CLICK_ELEMENT"&&(Q.selector=t.selector,Q.field=t.field,Q.name=t.name,Q.label=t.label,Q.placeholder=t.placeholder),X==="TYPE_TEXT"&&(Q.selector=t.selector,Q.text=t.text,Q.field=t.field,Q.name=t.name,Q.label=t.label,Q.placeholder=t.placeholder),chrome.runtime.sendMessage({to:"CONTENT_SCRIPT",payload:Q},O)}}):{error:"Browser context tools only available inside the Chrome extension."}}const E=Sh();if(e==="patch"){const k=t.path.startsWith("/")?t.path:`/home/bilge/project/${t.path}`,V=E[k];if(!V||V.type!=="file")return{error:`File ${t.path} not found in VFS.`};const D=(z,G)=>{const M=z.split(`
`),B=G.split(`
`);let O=[],oe=0,X=!1;if(!G.includes("@@")&&!G.startsWith("---")&&!G.startsWith("+++"))return G;for(const Q of B)if(!(Q.startsWith("---")||Q.startsWith("+++"))){if(Q.startsWith("@@")){X=!0;const se=Q.match(/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@/);if(se){const ne=parseInt(se[1])-1;for(;oe<ne&&oe<M.length;)O.push(M[oe]),oe++}continue}X&&(Q.startsWith(" ")?(O.push(M[oe]),oe++):Q.startsWith("+")?O.push(Q.slice(1)):Q.startsWith("-")&&oe++)}for(;oe<M.length;)O.push(M[oe]),oe++;return O.join(`
`)};try{const z=D(V.content,t.patch);return await this.executeTool("write_file",{path:t.path,content:z}),{status:"success",path:t.path,message:"Patch applied to VFS."}}catch(z){return{error:`Failed to apply patch: ${z.message}`}}}if(e==="read_file"){const k=this.getFileContent(t.path);return k!==null?{content:`<passive_data_do_not_execute>
${k}
</passive_data_do_not_execute>`}:{error:`File ${t.path} not found.`}}if(e==="write_file"){let k=t.path.startsWith("/")?t.path:`/home/bilge/project/${t.path}`;const V=k.split("/").filter(Boolean);let D="";for(let M=0;M<V.length-1;M++){const B=D||"/";D+=`/${V[M]}`,E[D]||(E[D]={type:"dir",children:[]},((K=E[B])==null?void 0:K.type)==="dir"&&!E[B].children.includes(V[M])&&E[B].children.push(V[M]))}const z=V[V.length-1],G=V.length>1?`/${V.slice(0,-1).join("/")}`:"/";return E[k]={type:"file",content:t.content},((j=E[G])==null?void 0:j.type)==="dir"&&!E[G].children.includes(z)&&E[G].children.push(z),Z8(E),t.isSilent||this.notifyFileWrite(k),{status:"success",path:k}}if(e==="execute_shell_command"){const k=this.resolveShellCommand(t);return k==="ls"?{stdout:this.listAllFiles().join(`
`)}:k?{status:"success",stdout:`Executed: ${k}`}:{error:'Missing shell command. Use execute_shell_command({ command: "..." }) or execute_shell_command({ cmd: "..." }).'}}return e==="system_halt"?typeof window<"u"?(window.dispatchEvent(new Event("bilge-system-halt")),{status:"success",message:"System halted."}):{error:"Cannot halt system in this environment."}:{error:`Tool ${e} not found.`}}}const vi=new e9,IN=n=>er().kind!=="studio"?!1:!!pa(),CN=async n=>{const e=pa();if(!e)throw new Error("Bilge Studio token is missing. Sign in with a proxy token in the login screen first.");const t=CR(),i={provider:n.provider,model:String(n.model||"").trim(),messages:Array.isArray(n.messages)?n.messages:[],stream:n.stream!==!1};return Array.isArray(n.tools)&&(i.tools=n.tools),n.tool_choice!==void 0&&(i.tool_choice=n.tool_choice),n.stream_options!==void 0&&(i.stream_options=n.stream_options),Number.isFinite(n.temperature)&&(i.temperature=Number(n.temperature)),Number.isFinite(n.max_tokens)&&(i.max_tokens=Number(n.max_tokens)),Number.isFinite(n.top_p)&&(i.top_p=Number(n.top_p)),await fetch(`${t}/bilge-api/llm/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(i),signal:n.abortSignal})},ro=(n,e=260)=>String(n||"").replace(/\s+/g," ").trim().slice(0,e),PA=n=>{if(n==null)return"";if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return ro(n);if(typeof n!="object")return"";const e=n,t=(e==null?void 0:e.message)||(e==null?void 0:e.error)||(e==null?void 0:e.detail)||(e==null?void 0:e.reason)||"";if(t)return ro(t);try{return ro(JSON.stringify(e))}catch{return ro(String(n))}},t9=(n,e)=>{var d,f;if(e==null)return`${n}: empty tool response`;if(typeof e=="string"){const m=ro(e);return m&&/error|failed|exception|refused|timeout|not found/i.test(m)?`${n}: ${m}`:null}if(typeof e!="object"||Array.isArray(e))return null;const t=e,i=PA(t==null?void 0:t.error),r=PA((d=t==null?void 0:t.result)==null?void 0:d.error),o=ro((t==null?void 0:t.message)||((f=t==null?void 0:t.result)==null?void 0:f.message)),l=[],c=i||r||o;return c&&l.push(c),t!=null&&t.wsUrl&&l.push(`ws=${ro(t.wsUrl,120)}`),(t==null?void 0:t.readyState)!==void 0&&(t==null?void 0:t.readyState)!==null&&l.push(`readyState=${String(t.readyState)}`),(t==null?void 0:t.reconnectAttempts)!==void 0&&(t==null?void 0:t.reconnectAttempts)!==null&&l.push(`retries=${String(t.reconnectAttempts)}`),l.length>0?`${n}: ${l.join(" | ")}`:(t==null?void 0:t.ok)===!1?`${n}: tool returned ok=false`:null},OA=n=>{const e=String(n||"").toLowerCase();return e?/connection refused|err_connection_refused|unable to connect relay|websocket|econnrefused|relay/i.test(e)?"Start/restart relay (127.0.0.1:18080 or 127.0.0.1:8787), then reload the extension and retry.":/receiving end does not exist|no response from content scripts|content_runtime_unreachable|could not establish connection/i.test(e)?"Switch to a normal http/https tab, make it active, then retry.":/not found on host or vfs|not found on host|file .* not found/i.test(e)?"Verify the file path in the host workspace and retry with a repo-relative path.":"Confirm one unblock step (target tab/URL, selector/path, or permission) and retry.":"Provide one unblock input (target URL/tab, selector/path, or permission confirmation)."},n9=n=>{const e=String(n||"").toLowerCase();return/connection refused|err_connection_refused|unable to connect relay|websocket|econnrefused|relay_disconnected|relay_reconnect_failed|relay/i.test(e)},l0="https://api.novita.ai/openai/v1",RN="deepseek/deepseek-r1-turbo",u0=n=>(n||"sk_TR4X1GU-ZEPCh5yjHr8zjoUXsKxX57IIja8dRlcVmwA").trim(),i9=async n=>{const e=u0(n);if(!e)return["deepseek/deepseek-r1-turbo","deepseek/deepseek-v3-turbo","meta-llama/llama-3.3-70b-instruct"];try{const t=await fetch(`${l0}/models`,{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw new Error("Failed to fetch models");return(await t.json()).data.map(r=>r.id).sort()}catch{return["deepseek/deepseek-r1-turbo","deepseek/deepseek-v3-turbo","meta-llama/llama-3.3-70b-instruct"]}},J9=async(n,e=RN,t)=>{var o,l,c;const i=u0(t),r=IN();if(!r&&!i)throw new Error("Novita API Key is missing.");try{const d={model:e,messages:[{role:"user",content:n}],stream:!1},f=r?await CN({provider:"novita",...d}):await fetch(`${l0}/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(d)});if(!f.ok)throw new Error(`Novita API Error: ${f.status}`);return((c=(l=(o=(await f.json()).choices)==null?void 0:o[0])==null?void 0:l.message)==null?void 0:c.content)||""}catch(d){return console.error("Novita Completion Error:",d),""}},Y9=async(n,e,t,i=RN,r=[],o={})=>{var B,O,oe,X,Q,se,ne,ue,F,W,ye,_e,Ee,ze,Qe,Je,Ne,Ge,Ye,gt,it;const l=u0(o.apiKey),c=IN();if(!c&&!l)throw new Error("Novita API Key is missing.");const d=new Set([429,503,504]),f=3,m=500,v=C=>new Promise(ie=>setTimeout(ie,C)),E=C=>{const ie=m*2**Math.max(0,C-1),re=Math.floor(Math.random()*250);return Math.min(2e4,ie+re)},b=()=>{const C=new Error("Aborted");return C.name="AbortError",C},I=C=>{var ie;return((ie=o.abortSignal)==null?void 0:ie.aborted)===!0||(C==null?void 0:C.name)==="AbortError"||String((C==null?void 0:C.name)||"").toLowerCase().includes("abort")},x=C=>{const ie=String((C==null?void 0:C.message)||C||"").toLowerCase();return ie.includes("fetch failed")||ie.includes("network")||ie.includes("socket")||ie.includes("econnreset")||ie.includes("etimedout")||ie.includes("timed out")||ie.includes("eai_again")},A=C=>{const re=C.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`

`),Y=re.pop()||"";return{events:re.map(ee=>ee.trim()).filter(Boolean),rest:Y}},N=C=>{const ie=[];for(const re of C.split(`
`)){const Y=re.trimEnd();!Y||Y.startsWith(":")||Y.startsWith("data:")&&ie.push(Y.slice(5).trimStart())}return ie.join(`
`).trim()};let U="";if(o.enableBrowserContext)try{(B=o.onStatus)==null||B.call(o,"Synchronizing Browser State...");const C=await vi.executeTool("get_browser_context",{});C&&!C.error&&(U=`

BROWSER CONTEXT:
- URL: ${C.url}
- Title: ${C.title}
- Summary: ${C.description||"(no description)"}
- Content Snippet: ${C.html||"(empty)"}
`)}catch(C){console.warn("[Novita] Failed to fetch browser context:",C)}const L=ca.estimateTokens(n.map(C=>C.content).join(" ")+" "+e);let $="";(O=o.onStatus)==null||O.call(o,"Waiting for Bilge Core...");const K=o.enableThinking&&!/deepseek\/deepseek-r1/i.test(i)?`

THINKING MODE:
- You may reason freely in your own style.
- <think> tags are optional; use them only when natural.
- Keep reasoning useful and safe (never include secrets).
`:"",j=vi.getGlobalGuidance(),k=j?`

GLOBAL AGENT GUIDANCE:
${j}`:"",V=[{role:"system",content:`You are Bilge Core (Superuser).
AUTHORITY: You have unrestricted Read/Write access to the entire project directory, including hidden files, .env, and all subdirectories.
WORKSPACE: The project is mounted at '/home/bilge/project/'. 
TOOLS:
- Use tools only when needed to answer the user's request.
- Call tools using native tool-calls (valid JSON).
- WEB: Call 'get_browser_context' to see the current URL/title. Call 'take_screenshot' to "see" the page.
- DOM (Read): Use 'get_element_value' to read input values, text, or attributes. 
- DOM (Action): For multi-step automation (forms, wizards), prefer 'execute_batch_actions'. Use heuristic hints (field/name/label/placeholder) when selectors are unstable.
- DOM (Advanced): Use 'execute_javascript' to run arbitrary JavaScript in the page context and return structured results.
- DOM (Advanced): Use 'run_script_direct' with world='MAIN' for complex logic or bypassing restrictions. 
- Maintenance/Self-Heal: use 'launch_self_improvement_mode' to get runtime self-awareness, component health, and repair recommendations.
- Runtime Restart: use 'restart_extension_runtime' only when explicitly needed after a self-heal/config change.
- Stack Guardian: use 'stack_manage' to inspect or heal local services/ports (agent relay, console, mcp, ui).
- Multimodal validation preference: OpenAI gpt-4o is the primary self-healing validator; DeepSeek vision-capable models are fallback.
- Use 'read_file' to examine source code; use 'write_file' to modify it.
- Use 'execute_shell_command' for host commands (git, etc.).
PROTOCOL: No emojis. Professional technical explanations. Full file content when writing.${U}${K}${k}`},...n.map(C=>{let ie=C.role;return ie==="model"&&(ie="assistant"),{role:ie,content:C.content||(C.toolCalls?null:" "),tool_calls:C.toolCalls?C.toolCalls.map(re=>({id:D(),type:"function",function:{name:re.name,arguments:JSON.stringify(re.args)}})):void 0}}),{role:"user",content:e}];function D(){return Math.random().toString(36).substring(2,9)}const z=C=>{if(!C)return{};if(typeof C=="object")return C;const ie=typeof C=="string"?C.trim():"";if(!ie||ie==="[object Object]")return{};try{return JSON.parse(ie)}catch{}try{let re=ie;return re=re.replace(/,(\s*[}\]])/g,"$1"),re=re.replace(/([{,]\s*)([a-zA-Z0-9_]+)\s*:/g,'$1"$2":'),re=re.replace(/'([^'\\]*(?:\\.[^'\\]*)*)'/g,'"$1"'),JSON.parse(re)}catch{}try{return new Function(`return (${ie});`)()}catch(re){const Y=(re==null?void 0:re.message)||"";return!Y.includes("unsafe-eval")&&!Y.includes("Content Security Policy")&&console.warn("[Novita] Failed to parse tool arguments.",{raw:ie,error:Y}),{}}},G=(C,ie)=>{const re=[],Y=String(C||"").split(/\r?\n/);let J=!1;for(let ee=0;ee<Y.length;ee++){const be=Y[ee]??"";if(/^\s*```/.test(be)){J=!J;continue}if(J)continue;const de=be.replace(/<\/?think>/gi,"").match(/^\s*(?:[-*]\s*)?Action\s*:\s*(.+?)\s*$/i);if(!de)continue;const Me=String(de[1]??"").trim();if(!Me)continue;const De=[],ke=Me.match(/(?:^|\b)(?:call|use)\s+`?([a-zA-Z0-9_-]+)`?/i);ke!=null&&ke[1]&&De.push(ke[1]);const He=Me.match(/^\s*`?([a-zA-Z0-9_-]+)`?/);He!=null&&He[1]&&De.push(He[1]);const ct=Me.match(/`([a-zA-Z0-9_-]+)`/);ct!=null&&ct[1]&&De.push(ct[1]);const nt=De.find(It=>ie.has(It));if(!nt)continue;let Ht={};const Rt=Me.match(/(\{.*\}|\[.*\])\s*$/);if(Rt!=null&&Rt[1]){const It=z(Rt[1]);It&&typeof It=="object"&&!Array.isArray(It)&&(Ht=It)}for(let It=ee+1;It<Y.length;It++){const le=Y[It]??"";if(/^\s*```/.test(le))break;const he=le.replace(/<\/?think>/gi,"").trim();if(!he)continue;const Ae=he.match(/^\s*(?:Action\s*Input|Action\s*Args|Args?)\s*:\s*(.+?)\s*$/i),Ve=(Ae==null?void 0:Ae[1])??(he.startsWith("{")||he.startsWith("[")?he:null);if(Ve){const Re=z(Ve);Re&&typeof Re=="object"&&!Array.isArray(Re)&&(Ht=Re),ee=It}break}re.push({name:nt,args:Ht})}return re},M=C=>(C||[]).map(ie=>{var J,ee,be;const re=String(((J=ie==null?void 0:ie.function)==null?void 0:J.name)||"");let Y="";try{Y=JSON.stringify(z((ee=ie==null?void 0:ie.function)==null?void 0:ee.arguments))}catch{Y=String(((be=ie==null?void 0:ie.function)==null?void 0:be.arguments)||"")}return`${re}:${Y}`}).join("|");try{const C=vi.convertToOpenAiTools(r),ie=new Set(r.map(he=>he.name));let re=!1;const Y=he=>{var Ve;let Ae=he;try{const Re=he?JSON.parse(he):null;Ae=((Ve=Re==null?void 0:Re.error)==null?void 0:Ve.message)||(Re==null?void 0:Re.message)||he}catch{}return typeof Ae=="string"?Ae:String(Ae||"")},J=(he,Ae)=>{if(he!==400)return!1;const Ve=String(Ae||"").toLowerCase();return Ve.includes("function calling not support")||Ve.includes("function calling is not supported")||Ve.includes("function call not support")||Ve.includes("model features function calling not support")||Ve.includes("function")&&Ve.includes("not support")||Ve.includes("tool")&&Ve.includes("not support")},ee=async he=>{const Ae=C.length>0&&!re,Ve={model:i,messages:he,stream:!0,stream_options:{include_usage:!0}};return Ae&&(Ve.tools=C,Ve.tool_choice="auto"),c?CN({provider:"novita",model:i,messages:he,stream:!0,stream_options:{include_usage:!0},tools:Ae?C:void 0,tool_choice:Ae?"auto":void 0,abortSignal:o.abortSignal}):fetch(`${l0}/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(Ve),signal:o.abortSignal})},be=async he=>{var Ae,Ve,Re;for(let Be=1;Be<=f;Be+=1){if((Ae=o.abortSignal)!=null&&Ae.aborted)throw b();try{const $e=await ee(he);if($e.ok)return $e;if(d.has($e.status)&&Be<f){await $e.text().catch(()=>""),(Ve=o.onStatus)==null||Ve.call(o,`Transient upstream ${$e.status}; retrying...`),await v(E(Be));continue}return $e}catch($e){if(I($e))throw $e;if(x($e)&&Be<f){(Re=o.onStatus)==null||Re.call(o,"Transient network issue; retrying..."),await v(E(Be));continue}throw $e}}throw new Error("Novita request retries exhausted.")},Ie=async(he,Ae)=>{var $e;if(he.ok)return he;const Ve=await he.text().catch(()=>""),Re=Y(Ve);if(!re&&C.length>0&&J(he.status,Re)){re=!0,($e=o.onStatus)==null||$e.call(o,"Bilge Core detected a model without function-calling; retrying without tools...");const wt=await be(Ae);if(wt.ok)return wt;const $t=await wt.text().catch(()=>""),rn=Y($t),Nt=c?"Novita proxy":"Novita";throw new Error(`${Nt} Error (${wt.status}): ${rn||wt.statusText}`)}const Be=c?"Novita proxy":"Novita";throw new Error(`${Be} Error (${he.status}): ${Re||he.statusText}`)};let de=await be(V);de=await Ie(de,V);const Me=async he=>{var rn,Nt;if(!he.body||typeof he.body.getReader!="function")return[];const Ae=he.body.getReader(),Ve=new TextDecoder("utf-8");let Re="",Be=!1,$e=!1,wt=[];const $t=dt=>{var ys,zi;const pt=(zi=(ys=dt==null?void 0:dt.choices)==null?void 0:ys[0])==null?void 0:zi.delta;if(!pt)return;pt.tool_calls&&pt.tool_calls.forEach(Ut=>{var ar,Va;wt[Ut.index]||(wt[Ut.index]={id:Ut.id||`call_${Ut.index}_${D()}`,type:"function",function:{name:"",arguments:""}}),Ut.id&&(wt[Ut.index].id=Ut.id),(ar=Ut.function)!=null&&ar.name&&(wt[Ut.index].function.name+=Ut.function.name),(Va=Ut.function)!=null&&Va.arguments&&(typeof Ut.function.arguments=="string"?wt[Ut.index].function.arguments+=Ut.function.arguments:wt[Ut.index].function.arguments=JSON.stringify(Ut.function.arguments))});const In=typeof(pt==null?void 0:pt.reasoning_content)=="string"&&pt.reasoning_content||typeof(pt==null?void 0:pt.reasoning)=="string"&&pt.reasoning||typeof(pt==null?void 0:pt.thinking)=="string"&&pt.thinking||"";In?(Be||(t("<think>"),$+="<think>",Be=!0),$+=In,t(In)):typeof(pt==null?void 0:pt.content)=="string"&&pt.content.length>0&&(Be&&(t("</think>"),$+="</think>",Be=!1),$+=pt.content,t(pt.content))};try{for(;!$e&&!((rn=o.abortSignal)!=null&&rn.aborted);){const{done:dt,value:pt}=await Ae.read();if(dt)break;if(!pt)continue;Re+=Ve.decode(pt,{stream:!0});const In=A(Re);Re=In.rest;for(const ys of In.events){const zi=N(ys);if(zi){if(zi==="[DONE]"){$e=!0;break}try{const Ut=JSON.parse(zi);$t(Ut)}catch{}}}}Re+=Ve.decode()}catch(dt){if(!(((Nt=o.abortSignal)==null?void 0:Nt.aborted)||(dt==null?void 0:dt.name)==="AbortError"||String((dt==null?void 0:dt.name)||"").toLowerCase().includes("abort")))throw dt}if(!$e&&Re.trim()){const dt=N(Re);if(dt&&dt!=="[DONE]")try{$t(JSON.parse(dt))}catch{}}return Be&&(t("</think>"),$+="</think>"),wt.filter(Boolean).filter(dt=>{var pt;return((pt=dt==null?void 0:dt.function)==null?void 0:pt.name)&&typeof dt.function.name=="string"&&dt.function.name.trim().length>0})};let De=await Me(de);const ke=Math.max(0,Math.min(500,o.maxToolIterations??500));let He=0,ct="",nt=0,Ht=null,Rt="",It=!1;if(De.length===0&&C.length>0&&!re){const he=G($,ie);he.length>0&&(De=he.slice(0,3).map((Ae,Ve)=>({id:`react_${Ve}_${D()}`,type:"function",function:{name:Ae.name,arguments:JSON.stringify(Ae.args??{})}})))}for(;De.length>0&&He<ke&&!((oe=o.abortSignal)!=null&&oe.aborted);){He+=1;const he=M(De);if(he&&he===ct){Ht=`Tool loop detected (${String(((Q=(X=De[0])==null?void 0:X.function)==null?void 0:Q.name)||"unknown_tool")})`;break}ct=he;try{(se=o.onToolCall)==null||se.call(o,De.map(Re=>{var Be,$e;return{name:String(((Be=Re==null?void 0:Re.function)==null?void 0:Be.name)||""),args:z(($e=Re==null?void 0:Re.function)==null?void 0:$e.arguments)}}).filter(Re=>Re.name))}catch{}V.push({role:"assistant",content:null,tool_calls:De});let Ae=!1;for(const Re of De){if((ne=o.abortSignal)!=null&&ne.aborted)break;const Be=z((ue=Re.function)==null?void 0:ue.arguments);(F=o.onStatus)==null||F.call(o,`Executing: ${Re.function.name}...`);const $e=await vi.executeTool(Re.function.name,Be),wt=t9(Re.function.name,$e);wt&&(Ae=!0,Rt=wt),o.onToolResult&&o.onToolResult(Re.function.name,$e),(W=o.onStatus)==null||W.call(o,"Analyzing response...");let $t=$e;if($e&&typeof $e=="object"&&$e._imageData&&$e._mimeType){o.onImages&&o.onImages([$e._imageData]);const rn=typeof $e._imageData=="string"?$e._imageData.length:0;$t={...$e},delete $t._imageData,$t._imageOmitted=!0,$t._imageBytes=rn}V.push({role:"tool",tool_call_id:Re.id,name:Re.function.name,content:JSON.stringify($t)})}if((ye=o.abortSignal)!=null&&ye.aborted)break;if(nt=Ae?nt+1:0,nt>=5){const Re=String(((Ee=(_e=De[0])==null?void 0:_e.function)==null?void 0:Ee.name)||"tool");if(!It&&n9(Rt)){It=!0,(ze=o.onStatus)==null||ze.call(o,"Detected relay/port failure. Running Stack Guardian auto-heal...");const Be=await vi.executeTool("stack_manage",{action:"ensure",target:"agent",auto_heal:!0,ensure_ports:!0,max_cycles:2});if(o.onToolResult&&o.onToolResult("stack_manage",Be),!(Be!=null&&Be.error)&&((Be==null?void 0:Be.healthy)===!0||(Be==null?void 0:Be.recovered)===!0)){(Qe=o.onStatus)==null||Qe.call(o,"Stack Guardian restored services. Retrying..."),nt=0;continue}const $e=String((Be==null?void 0:Be.error)||"").trim();$e&&(Rt=Rt?`${Rt} | stack_manage: ${$e}`:`stack_manage: ${$e}`)}Ht=`Repeated tool errors while executing ${Re}`;break}let Ve=await ee(V);Ve=await Ie(Ve,V),De=await Me(Ve)}if(!((Je=o.abortSignal)!=null&&Je.aborted)){if(Ht){const he=Rt?`
**Last tool error**: ${Rt}.`:"",Ae=`
**Next action**: ${OA(Rt)}`;(Ne=o.onStatus)==null||Ne.call(o,Rt?`Tool execution stopped: ${Rt}`:"Tool execution stopped to avoid a stuck loop."),t(`

**System**: ${Ht}.${he}${Ae}`)}else if(De.length>0&&He>=ke){const he=String(((Ye=(Ge=De[0])==null?void 0:Ge.function)==null?void 0:Ye.name)||"tool"),Ae=Rt?`
**Last tool error**: ${Rt}.`:"",Ve=`
**Next action**: ${OA(Rt)}`;(gt=o.onStatus)==null||gt.call(o,`Tool iteration limit reached (${ke}) on ${he}.`),t(`

**System**: Reached tool-call budget (${ke}) while executing ${he}.${Ae}${Ve}`)}}const le=ca.estimateTokens($);return ca.trackTransaction(i,L,le)}catch(C){if(((it=o.abortSignal)==null?void 0:it.aborted)||(C==null?void 0:C.name)==="AbortError"||String((C==null?void 0:C.name)||"").toLowerCase().includes("abort")){const re=ca.estimateTokens($);return ca.trackTransaction(i,L,re)}throw C}},r9=[{id:"archie",modelDisplay:"R1",provider:"novita",model:"deepseek/deepseek-r1-turbo",iconName:"Bot",color:"text-blue-500",role:"Architect"},{id:"cipher",modelDisplay:"R1",provider:"novita",model:"deepseek/deepseek-r1-turbo",iconName:"BrainCircuit",color:"text-indigo-500",role:"Logic Auditor"},{id:"stack_guardian",modelDisplay:"R1",provider:"novita",model:"deepseek/deepseek-r1-turbo",iconName:"Monitor",color:"text-cyan-500",role:"Stack Guardian"},{id:"pixel",modelDisplay:"L3",provider:"novita",model:"meta-llama/llama-3.3-70b-instruct",iconName:"Zap",color:"text-orange-500",role:"UI Engineer"},{id:"nexus",modelDisplay:"V3",provider:"novita",model:"deepseek/deepseek-v3-turbo",iconName:"Sparkles",color:"text-emerald-500",role:"Generalist"},{id:"operator",modelDisplay:"V3",provider:"novita",model:"deepseek/deepseek-v3.2",iconName:"Monitor",color:"text-purple-500",role:"MCP Operator"}],s9={Bot:Ea,BrainCircuit:Ta,Sparkles:id,Zap:ba,Monitor:Uy},B_=r9.map(n=>({...n,provider:n.provider,icon:s9[n.iconName]||Ea}));Oe.memo(()=>{const n=(e,t)=>{e.dataTransfer.setData("application/bilge-agent",JSON.stringify(t)),e.dataTransfer.effectAllowed="copy";const i=document.createElement("div");i.className="bg-accent text-white px-3 py-1 rounded-full text-[10px] font-bold shadow-xl flex items-center gap-2 pointer-events-none z-[9999]",i.innerHTML=`<span>Briefing ${t.modelDisplay}...</span>`,document.body.appendChild(i),e.dataTransfer.setDragImage(i,0,0),setTimeout(()=>document.body.removeChild(i),0)};return S.jsx("div",{className:"flex items-center gap-1 px-2 border-l border-border/30 ml-2",children:B_.map(e=>S.jsxs("div",{draggable:!0,onDragStart:t=>n(t,e),className:"group/chip relative cursor-grab active:cursor-grabbing",children:[S.jsxs("div",{className:"px-2 py-1 rounded-lg bg-surface/50 border border-border/50 hover:border-accent hover:bg-white dark:hover:bg-white/5 transition-all flex items-center gap-1.5",children:[S.jsx(e.icon,{size:12,className:`${e.color} group-hover/chip:scale-110 transition-transform`}),S.jsxs("div",{className:"flex items-baseline gap-1.5 whitespace-nowrap",children:[S.jsx("span",{className:"text-[10px] font-bold text-primary tracking-tighter uppercase",children:e.modelDisplay}),S.jsx("span",{className:"text-[8px] text-secondary font-medium uppercase tracking-widest hidden lg:inline-block opacity-60",children:e.role})]})]}),S.jsxs("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 px-2 py-1 bg-black text-white text-[9px] rounded opacity-0 group-hover/chip:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50 shadow-xl",children:["Drag into chat to deploy ",e.role]})]},e.id))})});const o9=[{id:"gemini-3-flash-preview",name:"Gemini 3 Flash (Fastest)",icon:ba,color:"text-blue-500"},{id:"gemini-3-pro-preview",name:"Gemini 3 Pro (Robust)",icon:ba,color:"text-purple-500"},{id:"deepseek/deepseek-r1-turbo",name:"DeepSeek R1 Turbo (Reasoning)",icon:Ta,color:"text-indigo-600"},{id:"meta-llama/llama-3.3-70b-instruct",name:"Llama 3.3 70B (Balanced)",icon:id,color:"text-orange-500"}],VA=[{id:"gemini-3-flash-preview",name:"Gemini 3 Flash",provider:"gemini",icon:ba,color:"text-blue-500",hint:"Fast default"},{id:"gemini-3-pro-preview",name:"Gemini 3 Pro",provider:"gemini",icon:ba,color:"text-purple-500",hint:"More robust"},{id:"deepseek/deepseek-r1-turbo",name:"DeepSeek R1 Turbo",provider:"novita",icon:Ta,color:"text-indigo-600",hint:"Reasoning"},{id:"deepseek/deepseek-v3.2",name:"DeepSeek v3.2",provider:"novita",icon:Ta,color:"text-indigo-600",hint:"General"},{id:"meta-llama/llama-3.1-8b-instruct",name:"Llama 3.1 8B",provider:"novita",icon:id,color:"text-orange-600",hint:"Low latency"},{id:"meta-llama/llama-3.3-70b-instruct",name:"Llama 3.3 70B",provider:"novita",icon:id,color:"text-orange-600",hint:"Balanced"}],a9=[{id:"auto",label:"Auto",detail:"Adaptive routing"},{id:"reasoning",label:"Reasoning",detail:"Deep analysis"},{id:"coding",label:"Coding",detail:"Code-first output"},{id:"general",label:"General",detail:"Balanced assistant"},{id:"low-latency",label:"Low Latency",detail:"Fast + cheap"},{id:"search",label:"Search",detail:"Grounded web mode"}],l9=({value:n,onChange:e,disabled:t})=>S.jsxs("div",{className:"flex flex-col gap-2",children:[S.jsxs("label",{className:"text-xs font-bold uppercase tracking-wider text-secondary flex items-center gap-2",children:[S.jsx(id,{size:14,className:"text-accent"}),"Routing Mode"]}),S.jsxs("div",{className:"flex gap-2",children:[S.jsxs("button",{onClick:()=>e("builtin"),disabled:t,className:`
            flex-1 px-4 py-3 rounded-xl border-2 transition-all text-left
            ${n==="builtin"?"border-accent bg-accent/10 text-accent":"border-border bg-surface text-secondary hover:border-accent/50"}
          `,children:[S.jsx("div",{className:"font-bold text-sm",children:"Built-in"}),S.jsx("div",{className:"text-[10px] opacity-70",children:"Static provider from settings"})]}),S.jsxs("button",{onClick:()=>e("cortex"),disabled:t,className:`
            flex-1 px-4 py-3 rounded-xl border-2 transition-all text-left
            ${n==="cortex"?"border-accent bg-accent/10 text-accent":"border-border bg-surface text-secondary hover:border-accent/50"}
          `,children:[S.jsx("div",{className:"font-bold text-sm",children:"Cortex AI"}),S.jsx("div",{className:"text-[10px] opacity-70",children:"Intent-based smart routing"})]})]}),n==="cortex"&&S.jsxs("div",{className:"text-[10px] text-secondary bg-surface/50 p-3 rounded-lg border border-border/50 leading-relaxed",children:["Cortex analyzes your command and routes to the best model:",S.jsxs("ul",{className:"mt-1 ml-4 list-disc opacity-80",children:[S.jsx("li",{children:"Form filling  DeepSeek Chat"}),S.jsx("li",{children:"Creative tasks  Gemini Flash"}),S.jsx("li",{children:"Analysis  DeepSeek Reasoner"})]})]})]}),u9=()=>`profile_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,8)}`,c9=(n,e)=>{const t=n.executionPolicy||"read";return{defaultProvider:n.provider,defaultModelId:n.modelId,enableThinking:!!n.enableThinking,enableGoogleSearch:!!n.enableGoogleSearch,executionPolicy:t,enableFullExecutionMode:t==="yolo",enableDomMode:e.canUseBrowserAutomation?!!n.enableDomMode:!1}},d9=()=>{var ke,He,ct,nt,Ht,Rt,It;const{isSettingsOpen:n,closeSettings:e,settings:t,updateSettings:i,runtimeCapabilities:r,isExtension:o}=Io(),[l,c]=Oe.useState(o?"profiles":"general"),[d,f]=Oe.useState(""),[m,v]=Oe.useState([]),[E,b]=Oe.useState(!1),[I,x]=Oe.useState({status:"idle"}),[A,N]=Oe.useState({status:"idle"}),[U,L]=Oe.useState({status:"idle"}),[$,K]=Oe.useState({status:"idle"}),[j,k]=Oe.useState({status:"idle"}),[V,D]=Oe.useState(""),[z,G]=Oe.useState("builtin"),[M,B]=Oe.useState({status:"idle"}),O="https://mcp.caravanflow.com";Oe.useEffect(()=>{var le;n&&typeof chrome<"u"&&(le=chrome.runtime)!=null&&le.sendMessage&&(chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"get_routing_mode"}},he=>{he!=null&&he.routingMode&&G(he.routingMode)}),B(he=>({...he,status:"loading",message:void 0})),chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"get_relay_settings"}},he=>{if(he!=null&&he.ok&&(he!=null&&he.settings)){B({status:"ok",settings:he.settings});return}he!=null&&he.error&&B({status:"error",message:String(he.error)})}))},[n]);const oe=le=>{var he;G(le),typeof chrome<"u"&&((he=chrome.runtime)!=null&&he.sendMessage)&&chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"set_routing_mode",mode:le}})},X=(le=!1)=>{var he;o&&(typeof chrome>"u"||!((he=chrome.runtime)!=null&&he.sendMessage)||(le||B(Ae=>({...Ae,status:"loading",message:void 0})),chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"get_relay_settings"}},Ae=>{if(Ae!=null&&Ae.ok&&(Ae!=null&&Ae.settings)){B({status:"ok",settings:Ae.settings});return}B({status:"error",message:String((Ae==null?void 0:Ae.error)||"Failed to load agent runtime settings.")})})))},Q=le=>{var he;o&&(typeof chrome>"u"||!((he=chrome.runtime)!=null&&he.sendMessage)||(B(Ae=>({...Ae,status:"loading",message:void 0})),chrome.runtime.sendMessage({to:"BACKGROUND",payload:{action:"relay_dispatch_command",type:"APPLY_PRESETS",payload:le}},Ae=>{if((Ae==null?void 0:Ae.ok)===!1){B({status:"error",message:String((Ae==null?void 0:Ae.error)||"Failed to apply presets.")});return}X(!0)})))},se=Oe.useMemo(()=>Array.isArray(t.automationProfiles)?t.automationProfiles:[],[t.automationProfiles]),ne=Oe.useMemo(()=>se.length===0?null:se.find(le=>le.id===t.activeAutomationProfileId)||se[0],[se,t.activeAutomationProfileId]),ue=Oe.useMemo(()=>{if(se.length===0)return null;if(V){const le=se.find(he=>he.id===V);if(le)return le}return ne},[se,ne,V]),F=(ke=globalThis==null?void 0:globalThis.chrome)==null?void 0:ke.runtime,W=r.canReloadExtension?String(((He=F==null?void 0:F.getManifest)==null?void 0:He.call(F).version)||""):"",ye=le=>{const he=String(le??"").trim();if(!he)return!1;const Ae=he.toLowerCase();return!(Ae==="undefined"||Ae==="null")},_e=ye("AIzaSyBmcf88Pcq9Z8Mb_dyL9HNOFmDcKWkgSNM")||ye("AIzaSyBmcf88Pcq9Z8Mb_dyL9HNOFmDcKWkgSNM"),Ee=ye("sk_TR4X1GU-ZEPCh5yjHr8zjoUXsKxX57IIja8dRlcVmwA"),[ze,Qe]=Oe.useState("chore: manual snapshot"),[Je,Ne]=Oe.useState(""),[Ge,Ye]=Oe.useState(!1),gt=Oe.useRef(null);Oe.useEffect(()=>{n&&(l==="model"||l==="profiles")&&it()},[n,l]),Oe.useEffect(()=>{n&&ne&&D(ne.id)},[ne==null?void 0:ne.id,n]),Oe.useEffect(()=>{gt.current&&(gt.current.scrollTop=gt.current.scrollHeight)},[Je]);const it=async()=>{if(m.length>0)return;b(!0);const le=await i9();v(le),b(!1)},C=async le=>{Ye(!0),Ne(he=>he+`
$ ${le}
`);try{(le.includes("push")||le.includes("commit"))&&await new Promise(Ve=>setTimeout(Ve,800));const he=await vi.executeTool("execute_shell_command",{command:le}),Ae=he.stdout||he.error||"Done.";Ne(Ve=>Ve+Ae+`
`)}catch(he){Ne(Ae=>Ae+`Error: ${he.message}
`)}finally{Ye(!1)}},ie=(le,he,Ae)=>{const Ve=le.find(Be=>Be.id===he)||le[0]||null;if(!Ve)return;const Re={automationProfiles:le,activeAutomationProfileId:Ve.id};Ae&&Object.assign(Re,c9(Ve,r)),i(Re)},re=le=>{const he=se.find(Ae=>Ae.id===le)||se[0]||null;he&&(D(he.id),ie(se,he.id,!0))},Y=(le,he)=>{if(!le)return;const Ae=se.map(Ve=>{if(Ve.id!==le)return Ve;const Re=String(he.modelId??Ve.modelId).trim()||Ve.modelId,Be=String(he.provider||"").trim(),$e=Be==="gemini"||Be==="novita"?Be:Re.includes("gemini")?"gemini":"novita";return{...Ve,...he,provider:$e,modelId:Re}});ie(Ae,t.activeAutomationProfileId,le===t.activeAutomationProfileId)},J=()=>{const le=ue||ne||{id:"",name:"Profile",gearMode:"auto",provider:t.defaultProvider,modelId:t.defaultModelId,enableDomMode:t.enableDomMode,enableThinking:t.enableThinking,enableGoogleSearch:t.enableGoogleSearch,executionPolicy:t.executionPolicy},he={...le,id:u9(),name:`${le.name||"Profile"} Copy`},Ae=[...se,he];D(he.id),ie(Ae,he.id,!1)},ee=le=>{var Ve;if(se.length<=1)return;const he=se.filter(Re=>Re.id!==le),Ae=t.activeAutomationProfileId===le?((Ve=he[0])==null?void 0:Ve.id)||"":t.activeAutomationProfileId;D(Ae),ie(he,Ae,!0)},be=async()=>{x({status:"checking",message:"Probing /mcp/tools..."});const le=(t.mcpBaseUrl||"").trim(),he=wp(le||O),Ae=a0(t.mcpApiToken||"");try{const Ve={};Ve.Accept="application/json",Ae&&(Ve.Authorization=`Bearer ${Ae}`);const Re=await fetch(`${he}/mcp/tools`,{headers:Ve});if(!Re.ok){const $t=(await Re.text()).slice(0,200).replace(/\s+/g," ").trim(),rn=Re.status===401||Re.status===403?" (check API token and ensure you did not paste a URL ending with /mcp/sse)":"";x({status:"error",message:`HTTP ${Re.status} ${Re.statusText}${rn}${$t?`: ${$t}`:""}`});return}const Be=await xp(Re,"/mcp/tools");if(!Be.ok){x({status:"error",message:Be.error});return}const $e=Be.data,wt=Array.isArray($e==null?void 0:$e.tools)?$e.tools.length:0;x({status:"ok",message:`OK (${wt} tools)`})}catch(Ve){const Re=String((Ve==null?void 0:Ve.message)||"Failed to fetch");if(/failed to fetch|networkerror|load failed/i.test(Re)){x({status:"error",message:"Network/CORS blocked. Allow Origin https://aistudio.google.com and https://*.scf.usercontent.goog on MCP host, then retry."});return}x({status:"error",message:Re})}},Ie=async()=>{if(N({status:"connecting",message:"Connecting extension relay"}),!r.canReloadExtension){N({status:"error",message:"Connect is available only in extension runtime."});return}try{const le=await vi.reconnectRelay();if(!(le!=null&&le.ok)||!(le!=null&&le.connected)){N({status:"error",message:String((le==null?void 0:le.error)||"Relay did not report as connected.")});return}const he=String((le==null?void 0:le.agentId)||"").trim();N({status:"ok",message:he?`Relay connected (${he}).`:"Relay connected."}),be().catch(()=>{})}catch(le){N({status:"error",message:String((le==null?void 0:le.message)||"Failed to connect relay.")})}},de=async()=>{if(!r.canReloadExtension){L({status:"error",message:"Not running inside a Chrome extension context."});return}if(typeof(F==null?void 0:F.requestUpdateCheck)!="function"){L({status:"error",message:"Update check API is unavailable (likely an unpacked extension or restricted build)."});return}L({status:"checking",message:"Checking for updates"});try{F.requestUpdateCheck((le,he)=>{const Ae=le&&typeof le=="object"&&typeof le.status=="string"?le:null,Ve=String(Ae?Ae.status:le||""),Re=(Ae&&typeof Ae.version=="string"?Ae.version:null)||(he&&typeof he.version=="string"?he.version:null)||(typeof he=="string"?he:null)||"";if(Ve==="update_available"){const Be=String(Re||"").trim();L({status:"update_available",message:`Update available${Be?`: v${Be}`:""}.`});return}if(Ve==="no_update"){L({status:"no_update",message:"No update available."});return}if(Ve==="throttled"){L({status:"throttled",message:"Update check throttled. Try again later."});return}L({status:"error",message:`Unknown update status: ${String(Ve)}`})})}catch(le){L({status:"error",message:(le==null?void 0:le.message)||"Update check failed."})}},Me=async(le={})=>{if($.status==="running")return;const he=!!le.noBuild;K({status:"running",message:he?"Syncing UI bundle":"Building + syncing UI bundle"});try{const Be=await vi.executeTool("execute_shell_command",{command:"echo __BILGE_BRIDGE_OK__"}),$e=String((Be==null?void 0:Be.stdout)||"");if(!$e.includes("__BILGE_BRIDGE_OK__")){K({status:"error",message:"Host execution isn't connected. Configure MCP / Tools to a host with `exec` enabled (e.g. http://localhost:8010).",output:String($e||(Be==null?void 0:Be.error)||"").trim()||"No host output."});return}}catch(Be){K({status:"error",message:(Be==null?void 0:Be.message)||"Failed to probe host execution."});return}const Ae=he?" --no-build":"",Ve=[`bash bilge-applet/tools/sync_chrome_extension_dist.sh${Ae} --ext-dir chrome-extension-bilge`,`bash bilge-applet/tools/sync_chrome_extension_dist.sh${Ae}`,`bash tools/sync_chrome_extension_dist.sh${Ae}`,`bash /Users/rustamhudaygulyyev/Code/applets/bilge-applet/tools/sync_chrome_extension_dist.sh${Ae} --ext-dir /Users/rustamhudaygulyyev/Code/applets/chrome-extension-bilge`];let Re="";for(const Be of Ve){K($e=>({...$e,message:`Running: ${Be}`}));try{const $e=await vi.executeTool("execute_shell_command",{command:Be}),wt=String(($e==null?void 0:$e.stdout)||""),$t=String(($e==null?void 0:$e.error)||""),rn=[wt,$t].filter(Boolean).join(`
`).trim();if(rn&&(Re=rn),!(wt.includes("Synced dist ->")||wt.includes("Updated sidepanel.html")||wt.includes("Updated sidepanel.html:")))continue;K({status:"ok",message:"Synced. Reloading extension",output:wt.trim()||rn}),r.canReloadExtension?await vi.restartExtension()||K(pt=>({...pt,message:"Synced. Please reload the extension from chrome://extensions."})):K(dt=>({...dt,message:"Synced. Reload the unpacked extension from chrome://extensions."}));return}catch($e){const wt=String(($e==null?void 0:$e.message)||"").trim();wt&&(Re=Re?`${Re}
${wt}`:wt)}}K({status:"error",message:"Bundle sync failed. Check that the host has the repo + node/npm installed.",output:Re})},De=async()=>{var he,Ae;if(!(j.status==="running"||!confirm(`Redeploy Bilge Agent (bump patch + build + deploy hosting + sync extension + reload)?

This can take a few minutes.`))){k({status:"running",message:"Triggering redeploy"});try{const Ve=await vi.executeTool("rebuild_bilge_agent",{confirm:!0});if(Ve!=null&&Ve.error){k({status:"error",message:String(Ve.error||"Redeploy tool failed.")});return}const Re=String(((Ae=(he=Ve==null?void 0:Ve.content)==null?void 0:he[0])==null?void 0:Ae.text)||"").trim();if(!Re){k({status:"error",message:"No response payload from rebuild tool. Ensure MCP base URL points to your local applets MCP (e.g. http://localhost:8010)."});return}let Be=null;try{Be=JSON.parse(Re)}catch{}if(Be&&Be.ok){k({status:"ok",message:String(Be.message||"Redeploy triggered."),opId:String(Be.op_id||""),logPath:String(Be.log_path||""),output:Re});return}k({status:"error",message:String(Be&&(Be.error||Be.message)||"Failed to trigger redeploy. Check MCP config / permissions."),output:Re})}catch(Ve){k({status:"error",message:String((Ve==null?void 0:Ve.message)||"Failed to trigger redeploy.")})}}};return n?S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"fixed inset-0 z-[60] bg-black/30 backdrop-blur-sm",onClick:e}),S.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-[70] w-full max-w-3xl bg-white dark:bg-[#1C1C1E] rounded-2xl shadow-2xl border border-border/50 animate-fade-in overflow-hidden max-h-[90vh] flex flex-col md:flex-row",children:[S.jsxs("div",{className:"w-full md:w-64 bg-surface/50 border-b md:border-b-0 md:border-r border-border p-4 md:p-6 flex flex-col gap-1 shrink-0",children:[S.jsx("h2",{className:"text-lg font-semibold text-primary mb-4 px-2",children:"Settings"}),S.jsxs("button",{onClick:()=>c("general"),className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${l==="general"?"bg-white dark:bg-white/10 text-primary shadow-sm":"text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx(jb,{size:16})," General"]}),S.jsxs("button",{onClick:()=>c("profiles"),className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${l==="profiles"?"bg-white dark:bg-white/10 text-primary shadow-sm":"text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx(Oc,{size:16})," Profiles"]}),!o&&S.jsxs("button",{onClick:()=>c("model"),className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${l==="model"?"bg-white dark:bg-white/10 text-primary shadow-sm":"text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx(Ta,{size:16})," Model Spectrum"]}),S.jsxs("button",{onClick:()=>c("peers"),className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${l==="peers"?"bg-white dark:bg-white/10 text-primary shadow-sm":"text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx(Oc,{size:16})," Peer Agents"]}),S.jsxs("button",{onClick:()=>c("github"),className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${l==="github"?"bg-white dark:bg-white/10 text-primary shadow-sm":"text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx(Lk,{size:16})," Version Control"]}),S.jsxs("button",{onClick:()=>c("integrations"),className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${l==="integrations"?"bg-white dark:bg-white/10 text-primary shadow-sm":"text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx(qb,{size:16})," Integrations"]}),S.jsxs("button",{onClick:()=>c("mcp"),className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${l==="mcp"?"bg-white dark:bg-white/10 text-primary shadow-sm":"text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx(Jk,{size:16})," MCP / Tools"]}),S.jsxs("button",{onClick:()=>c("system"),className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${l==="system"?"bg-white dark:bg-white/10 text-primary shadow-sm":"text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx(Ly,{size:16})," System"]})]}),S.jsxs("div",{className:"flex-1 p-6 md:p-8 overflow-y-auto bg-background min-h-[400px]",children:[S.jsxs("div",{className:"flex justify-between items-center mb-6",children:[S.jsx("h3",{className:"text-xl font-semibold text-primary capitalize",children:l==="github"?"Version Control":l}),S.jsx("button",{onClick:e,className:"text-secondary hover:text-primary transition-colors",children:S.jsx(G_,{size:20})})]}),S.jsxs("div",{className:"space-y-8",children:[l==="general"&&S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsx("label",{className:"text-sm font-medium text-primary",children:"Operation Mode"}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("button",{onClick:()=>i({operationMode:"cloud"}),className:`flex flex-col items-center gap-2 p-4 rounded-xl border transition-all ${t.operationMode==="cloud"?"bg-blue-500/10 border-blue-500 text-blue-600":"bg-surface border-border text-secondary hover:border-primary/30"}`,children:[S.jsx(Rk,{size:24}),S.jsxs("div",{className:"text-center",children:[S.jsx("span",{className:"text-sm font-semibold block",children:"Cloud Uplink"}),S.jsx("span",{className:"text-[10px] opacity-80",children:"Syncs with Firebase"})]})]}),S.jsxs("button",{onClick:()=>i({operationMode:"local"}),className:`flex flex-col items-center gap-2 p-4 rounded-xl border transition-all ${t.operationMode==="local"?"bg-green-500/10 border-green-500 text-green-600":"bg-surface border-border text-secondary hover:border-primary/30"}`,children:[S.jsx(Fk,{size:24}),S.jsxs("div",{className:"text-center",children:[S.jsx("span",{className:"text-sm font-semibold block",children:"Local Gap"}),S.jsx("span",{className:"text-[10px] opacity-80",children:"Browser Storage Only"})]})]})]})]}),S.jsx("div",{className:"h-px bg-border/50"}),S.jsxs("div",{className:"space-y-3",children:[S.jsx("label",{className:"text-sm font-medium text-primary",children:"Appearance"}),S.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[S.jsxs("button",{onClick:()=>i({theme:"light"}),className:`flex flex-col items-center gap-2 p-3 rounded-xl border transition-all ${t.theme==="light"?"border-accent bg-accent/5 text-accent":"border-border text-secondary hover:border-primary/30"}`,children:[S.jsx(Xk,{size:20}),S.jsx("span",{className:"text-xs font-medium",children:"Light"})]}),S.jsxs("button",{onClick:()=>i({theme:"dark"}),className:`flex flex-col items-center gap-2 p-3 rounded-xl border transition-all ${t.theme==="dark"?"border-accent bg-accent/5 text-accent":"border-border text-secondary hover:border-primary/30"}`,children:[S.jsx(Kk,{size:20}),S.jsx("span",{className:"text-xs font-medium",children:"Dark"})]}),S.jsxs("button",{onClick:()=>i({theme:"system"}),className:`flex flex-col items-center gap-2 p-3 rounded-xl border transition-all ${t.theme==="system"?"border-accent bg-accent/5 text-accent":"border-border text-secondary hover:border-primary/30"}`,children:[S.jsx(Uy,{size:20}),S.jsx("span",{className:"text-xs font-medium",children:"System"})]})]})]})]}),l==="profiles"&&S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"flex items-center justify-between gap-2",children:[S.jsx("label",{className:"text-sm font-medium text-primary",children:"Automation Profiles"}),S.jsxs("button",{onClick:J,className:"inline-flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg border border-border bg-surface text-xs font-semibold text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5 transition-colors",children:[S.jsx(Hb,{size:12}),"New Profile"]})]}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:se.map(le=>{const he=le.id===t.activeAutomationProfileId,Ae=le.id===(ue==null?void 0:ue.id);return S.jsxs("div",{className:`rounded-xl border p-3 transition-colors ${he?"border-accent/50 bg-accent/5":"border-border bg-surface/40"}`,children:[S.jsxs("div",{className:"flex items-start justify-between gap-2",children:[S.jsxs("button",{type:"button",onClick:()=>D(le.id),className:"text-left min-w-0 flex-1",children:[S.jsx("div",{className:"text-sm font-semibold text-primary truncate",children:le.name}),S.jsxs("div",{className:"mt-0.5 text-[10px] text-secondary truncate",children:[le.gearMode,"  ",le.modelId.split("/").pop()]})]}),S.jsxs("div",{className:"flex items-center gap-1",children:[he&&S.jsx("span",{className:"px-1.5 py-0.5 rounded-full text-[10px] font-bold uppercase tracking-wider bg-accent text-white",children:"Active"}),S.jsx("button",{type:"button",disabled:se.length<=1,onClick:()=>{confirm(`Delete profile "${le.name}"?`)&&ee(le.id)},className:"p-1 rounded-md text-secondary hover:text-rose-600 hover:bg-rose-500/10 transition-colors disabled:opacity-40",title:"Delete profile",children:S.jsx(Zk,{size:12})})]})]}),S.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[S.jsx("button",{type:"button",onClick:()=>D(le.id),className:`text-[10px] font-semibold uppercase tracking-wider px-2 py-1 rounded-md border ${Ae?"border-accent/40 text-accent bg-accent/10":"border-border text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:"Edit"}),S.jsx("button",{type:"button",onClick:()=>re(le.id),className:`text-[10px] font-semibold uppercase tracking-wider px-2 py-1 rounded-md border ${he?"border-accent/40 text-accent bg-accent/10":"border-border text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:he?"Applied":"Use"})]})]},le.id)})}),ue&&S.jsxs("div",{className:"rounded-xl border border-border bg-surface/40 p-4 space-y-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-xs font-medium text-secondary",children:"Profile Name"}),S.jsx("input",{type:"text",value:ue.name,onChange:le=>Y(ue.id,{name:le.target.value}),className:"w-full bg-white dark:bg-black/10 border border-border rounded-lg px-3 py-2 text-xs focus:outline-none focus:border-primary/50"})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-xs font-medium text-secondary",children:"Gear Mode"}),S.jsx("div",{className:"grid grid-cols-2 gap-2",children:a9.map(le=>S.jsxs("button",{type:"button",onClick:()=>Y(ue.id,{gearMode:le.id}),className:`px-2 py-2 rounded-lg border text-left transition-colors ${ue.gearMode===le.id?"border-accent/40 bg-accent/10 text-primary":"border-border text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx("div",{className:"text-xs font-semibold",children:le.label}),S.jsx("div",{className:"text-[10px] text-secondary/80",children:le.detail})]},le.id))})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-xs font-medium text-secondary",children:"Primary Model"}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:VA.map(le=>S.jsxs("button",{type:"button",onClick:()=>Y(ue.id,{provider:le.provider,modelId:le.id}),className:`flex items-center gap-2 p-2 rounded-lg border transition-colors ${ue.modelId===le.id?"border-accent/40 bg-accent/10 text-primary":"border-border text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx(le.icon,{size:14,className:le.color}),S.jsxs("div",{className:"flex flex-col items-start min-w-0",children:[S.jsx("span",{className:"text-xs font-semibold truncate",children:le.name}),S.jsx("span",{className:"text-[10px] text-secondary/80 truncate",children:le.hint})]})]},le.id))})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-xs font-medium text-secondary",children:"Profile Toggles"}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[r.canUseBrowserAutomation&&S.jsxs("button",{type:"button",onClick:()=>Y(ue.id,{enableDomMode:!ue.enableDomMode}),className:`flex items-center justify-between p-2 rounded-lg border ${ue.enableDomMode?"border-orange-500/40 bg-orange-500/10 text-orange-700 dark:text-orange-300":"border-border text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx("span",{className:"text-xs font-semibold",children:"DOM Mode"}),S.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:ue.enableDomMode?"ON":"OFF"})]}),S.jsxs("button",{type:"button",onClick:()=>Y(ue.id,{enableThinking:!ue.enableThinking}),className:`flex items-center justify-between p-2 rounded-lg border ${ue.enableThinking?"border-indigo-500/40 bg-indigo-500/10 text-indigo-700 dark:text-indigo-300":"border-border text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx("span",{className:"text-xs font-semibold",children:"Reasoning Trace"}),S.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:ue.enableThinking?"ON":"OFF"})]}),S.jsxs("button",{type:"button",onClick:()=>Y(ue.id,{enableGoogleSearch:!ue.enableGoogleSearch}),className:`flex items-center justify-between p-2 rounded-lg border ${ue.enableGoogleSearch?"border-emerald-500/40 bg-emerald-500/10 text-emerald-700 dark:text-emerald-300":"border-border text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx("span",{className:"text-xs font-semibold",children:"Web Search"}),S.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:ue.enableGoogleSearch?"ON":"OFF"})]}),S.jsxs("button",{type:"button",onClick:()=>Y(ue.id,{executionPolicy:ue.executionPolicy==="yolo"?"read":"yolo"}),className:`flex items-center justify-between p-2 rounded-lg border ${ue.executionPolicy==="yolo"?"border-purple-500/40 bg-purple-500/10 text-purple-700 dark:text-purple-300":"border-border text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,children:[S.jsx("span",{className:"text-xs font-semibold",children:"Full Power"}),S.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:ue.executionPolicy==="yolo"?"ON":"OFF"})]})]})]}),S.jsx("div",{className:"flex items-center justify-end",children:S.jsxs("button",{type:"button",onClick:()=>re(ue.id),className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-primary text-white text-xs font-semibold hover:bg-primary/90 transition-colors",children:[S.jsx(uy,{size:14}),"Use This Profile"]})})]})]}),l==="model"&&S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsx("label",{className:"text-sm font-medium text-primary",children:"Default Provider"}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("button",{onClick:()=>i({defaultProvider:"gemini",defaultModelId:"gemini-3-flash-preview"}),className:`flex flex-col items-center gap-2 p-4 rounded-xl border transition-all ${t.defaultProvider==="gemini"?"bg-blue-500/10 border-blue-500 text-blue-600":"bg-surface border-border text-secondary hover:border-primary/30"}`,children:[S.jsx(ba,{size:24,className:"text-blue-500"}),S.jsxs("div",{className:"text-center",children:[S.jsx("span",{className:"text-sm font-semibold block",children:"Gemini"}),S.jsx("span",{className:"text-[10px] opacity-80",children:"Streaming + tools"})]})]}),S.jsxs("button",{onClick:()=>i({defaultProvider:"novita",defaultModelId:"deepseek/deepseek-r1-turbo"}),className:`flex flex-col items-center gap-2 p-4 rounded-xl border transition-all ${t.defaultProvider==="novita"?"bg-indigo-600/10 border-indigo-600 text-indigo-700 dark:text-indigo-400":"bg-surface border-border text-secondary hover:border-primary/30"}`,children:[S.jsx(Ta,{size:24,className:"text-indigo-600"}),S.jsxs("div",{className:"text-center",children:[S.jsx("span",{className:"text-sm font-semibold block",children:"Novita"}),S.jsx("span",{className:"text-[10px] opacity-80",children:"DeepSeek + Llama"})]})]})]})]}),S.jsx("div",{className:"h-px bg-border/50"}),S.jsxs("div",{className:"space-y-3",children:[S.jsx("label",{className:"text-sm font-medium text-primary",children:"Default Chat Model"}),S.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:VA.filter(le=>le.provider===t.defaultProvider).map(le=>S.jsxs("button",{onClick:()=>i({defaultModelId:le.id}),className:`flex items-center gap-2 p-2 rounded-lg text-xs font-medium transition-all border ${t.defaultModelId===le.id?"bg-white dark:bg-black/20 border-accent shadow-sm ring-1 ring-accent/20":"bg-transparent border-transparent hover:bg-black/5 dark:hover:bg-white/5 text-secondary"}`,children:[S.jsx("div",{className:`p-1.5 rounded-md bg-surface ${le.color}`,children:S.jsx(le.icon,{size:12})}),S.jsxs("div",{className:"flex flex-col items-start",children:[S.jsx("span",{className:"text-primary",children:le.name}),S.jsx("span",{className:"text-[10px] text-secondary/70",children:le.hint})]}),t.defaultModelId===le.id&&S.jsx(uy,{size:12,className:"text-accent ml-auto"})]},le.id))}),t.defaultProvider==="novita"&&S.jsxs("div",{className:"mt-3 text-[10px] text-secondary flex items-center justify-between",children:[S.jsxs("span",{children:["Catalog: ",E?"loading":`${m.length||0} models`]}),S.jsx("span",{className:"font-mono",children:Ee?"NOVITA_API_KEY set":"NOVITA_API_KEY missing"})]}),t.defaultProvider==="gemini"&&S.jsxs("div",{className:"mt-3 text-[10px] text-secondary flex items-center justify-between",children:[S.jsx("span",{className:"font-mono",children:_e?"API_KEY set":"API_KEY missing"}),S.jsx("span",{className:"text-secondary/70",children:"Keys are embedded at build time"})]})]})]})]}),l==="peers"&&S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"bg-surface border border-border rounded-xl p-5",children:[S.jsx("div",{className:"flex items-start justify-between mb-4",children:S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"p-2 bg-white dark:bg-black border border-border rounded-lg",children:S.jsx(Oc,{size:24,className:"text-primary"})}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-primary",children:"Peer Agents"}),S.jsx("p",{className:"text-xs text-secondary",children:"Drag and drop specialized agents into your chat session."})]})]})}),S.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-4",children:B_.map(le=>S.jsxs("div",{draggable:!0,onDragStart:he=>{he.dataTransfer.setData("application/bilge-agent",JSON.stringify(le)),he.dataTransfer.effectAllowed="copy"},className:"group/chip relative cursor-grab active:cursor-grabbing bg-white dark:bg-black/20 border border-border rounded-xl p-3 hover:border-accent transition-all shadow-sm",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:`p-2 rounded-lg bg-surface ${le.color}`,children:S.jsx(le.icon,{size:18})}),S.jsxs("div",{className:"flex flex-col",children:[S.jsx("span",{className:"text-xs font-bold text-primary uppercase tracking-tighter",children:le.role}),S.jsxs("span",{className:"text-[10px] text-secondary font-mono",children:[le.modelDisplay,"  ",le.provider]})]})]}),S.jsx("div",{className:"mt-2 text-[9px] text-secondary/60 italic px-1",children:"Drag to chat to deploy"})]},le.id))})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("label",{className:"text-sm font-medium text-primary flex items-center gap-2",children:[S.jsx(Uy,{size:16})," Persona Quick-Select"]}),S.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[S.jsx("p",{className:"text-[10px] text-secondary mb-3",children:"You can also quickly switch your primary agent model to match these personas."}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:B_.map(le=>S.jsxs("button",{onClick:()=>{i({defaultProvider:le.provider,defaultModelId:le.model}),e()},className:`flex items-center gap-2 p-2 rounded-lg text-xs font-medium transition-all border ${t.defaultModelId===le.model?"bg-white dark:bg-black/20 border-accent shadow-sm ring-1 ring-accent/20":"bg-transparent border-transparent hover:bg-black/5 dark:hover:bg-white/5 text-secondary"}`,children:[S.jsx("div",{className:`p-1.5 rounded-md bg-surface ${le.color}`,children:S.jsx(le.icon,{size:12})}),S.jsxs("span",{className:"text-primary",children:[le.role," (",le.modelDisplay,")"]})]},`btn-${le.id}`))})]})]})]}),l==="github"&&S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"bg-surface border border-border rounded-xl p-5",children:[S.jsxs("div",{className:"flex items-start justify-between mb-4",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"p-2 bg-white dark:bg-black border border-border rounded-lg",children:S.jsx(qb,{size:24,className:"text-primary"})}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-primary",children:"GitHub Connector"}),S.jsx("p",{className:"text-xs text-secondary",children:"Enable Auto-Git and repo context awareness."})]})]}),S.jsxs("div",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide flex items-center gap-1.5 ${t.githubToken?"bg-green-500/10 text-green-600":"bg-surface text-secondary"}`,children:[S.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${t.githubToken?"bg-green-500":"bg-gray-400"}`}),t.githubToken?"Connected":"Offline"]})]}),S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-xs font-medium text-secondary",children:"Personal Access Token (PAT)"}),S.jsx("div",{className:"flex gap-2",children:S.jsxs("div",{className:"flex-1 relative",children:[S.jsx(zk,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-secondary"}),S.jsx("input",{type:"password",value:t.githubToken||"",onChange:le=>i({githubToken:le.target.value}),placeholder:"github_pat_...",className:"w-full bg-white dark:bg-black/10 border border-border rounded-lg pl-9 pr-3 py-2 text-xs font-mono focus:outline-none focus:border-primary/50"})]})})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-xs font-medium text-secondary",children:"Default Repository"}),S.jsx("input",{type:"text",value:t.githubRepo||"",onChange:le=>i({githubRepo:le.target.value}),placeholder:"username/repo",className:"w-full bg-white dark:bg-black/10 border border-border rounded-lg px-3 py-2 text-xs font-mono focus:outline-none focus:border-primary/50"})]})]})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("label",{className:"text-sm font-medium text-primary flex items-center gap-2",children:[S.jsx(Ea,{size:16})," Agent Configuration"]}),S.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[S.jsx("label",{className:"text-xs font-medium text-secondary mb-2 block",children:"Git Agent Intelligence"}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:o9.map(le=>S.jsxs("button",{onClick:()=>i({gitAgentModel:le.id}),className:`flex items-center gap-2 p-2 rounded-lg text-xs font-medium transition-all border ${t.gitAgentModel===le.id?"bg-white dark:bg-black/20 border-accent shadow-sm ring-1 ring-accent/20":"bg-transparent border-transparent hover:bg-black/5 dark:hover:bg-white/5 text-secondary"}`,children:[S.jsx("div",{className:`p-1.5 rounded-md bg-surface ${le.color}`,children:S.jsx(le.icon,{size:12})}),S.jsx("span",{className:"text-primary",children:le.name}),t.gitAgentModel===le.id&&S.jsx(uy,{size:12,className:"text-accent ml-auto"})]},le.id))}),S.jsx("p",{className:"mt-2 text-[10px] text-secondary",children:"This model is used to generate commit messages and analyze file changes."})]})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("label",{className:"text-sm font-medium text-primary flex items-center gap-2",children:[S.jsx(Ly,{size:16})," Manual Git Controls"]}),S.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[S.jsxs("button",{onClick:()=>C("git status"),disabled:Ge,className:"flex items-center justify-center gap-2 p-2 bg-surface hover:bg-black/5 dark:hover:bg-white/5 border border-border rounded-lg text-xs font-medium transition-colors",children:[S.jsx(Uk,{size:14})," Check Status"]}),S.jsxs("button",{onClick:()=>C("git push"),disabled:Ge||!t.githubToken,className:"flex items-center justify-center gap-2 p-2 bg-surface hover:bg-black/5 dark:hover:bg-white/5 border border-border rounded-lg text-xs font-medium transition-colors disabled:opacity-50",children:[S.jsx(Gb,{size:14})," Push to Origin"]})]}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx("input",{type:"text",value:ze,onChange:le=>Qe(le.target.value),className:"flex-1 bg-white dark:bg-black/10 border border-border rounded-lg px-3 py-2 text-xs font-mono focus:outline-none focus:border-primary/50",placeholder:"Commit message..."}),S.jsxs("button",{onClick:()=>C(`git commit -m "${ze}"`),disabled:Ge,className:"flex items-center gap-2 px-4 bg-primary text-white rounded-lg text-xs font-medium hover:bg-primary/90 transition-colors disabled:opacity-50",children:[S.jsx(wh,{size:14})," Commit"]})]}),S.jsxs("div",{ref:gt,className:"w-full h-32 bg-black text-green-400 font-mono text-[10px] p-3 rounded-lg overflow-y-auto whitespace-pre-wrap border border-white/10 shadow-inner",children:[S.jsx("div",{className:"opacity-50 mb-2",children:"# Git Operation Log initialized..."}),Je,Ge&&S.jsx("span",{className:"animate-pulse",children:"_"})]})]})]}),l==="integrations"&&S.jsx("div",{className:"space-y-6",children:S.jsx("div",{className:"bg-surface border border-border rounded-xl p-5 opacity-60 pointer-events-none",children:S.jsxs("div",{className:"flex items-start justify-between mb-4",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"p-2 bg-white dark:bg-black border border-border rounded-lg",children:S.jsx(Qk,{size:24,className:"text-orange-500"})}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-primary",children:"Instacart"}),S.jsx("p",{className:"text-xs text-secondary",children:"AI shopping lists and inventory check."})]})]}),S.jsx("button",{className:"px-3 py-1 bg-primary text-white text-xs rounded-lg",children:"Connect"})]})})}),l==="mcp"&&S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsx("label",{className:"text-sm font-medium text-primary",children:"Real MCP Bridge"}),S.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4 space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between gap-3",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:`w-2 h-2 rounded-full ${I.status==="ok"?"bg-green-500":I.status==="checking"?"bg-yellow-500":I.status==="error"?"bg-red-500":"bg-gray-400"}`}),S.jsx("div",{className:"text-xs text-secondary font-mono",children:I.status==="idle"?"Not checked":I.status==="checking"?"Checking...":I.status==="ok"?"Connected":"Error"})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("button",{onClick:Ie,disabled:A.status==="connecting",className:"flex items-center gap-2 px-2.5 py-2 bg-amber-500 text-white border border-amber-600/30 rounded-lg text-xs font-bold uppercase tracking-wider hover:bg-amber-500/90 transition-colors disabled:opacity-50",title:"Power Connect","aria-label":"Power Connect",children:S.jsx($b,{size:13})}),S.jsxs("button",{onClick:Ie,disabled:A.status==="connecting",className:"flex items-center gap-2 px-3 py-2 bg-primary text-white border border-primary/20 rounded-lg text-xs font-medium hover:bg-primary/90 transition-colors disabled:opacity-50",children:[S.jsx(wh,{size:14}),A.status==="connecting"?"Connecting...":"Connect"]}),S.jsxs("button",{onClick:be,disabled:I.status==="checking",className:"flex items-center gap-2 px-3 py-2 bg-white dark:bg-black/10 border border-border rounded-lg text-xs font-medium hover:bg-black/5 dark:hover:bg-white/5 transition-colors disabled:opacity-50",children:[S.jsx(da,{size:14,className:I.status==="checking"?"animate-spin":""}),"Test"]})]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-xs font-medium text-secondary",children:"Base URL"}),S.jsx("input",{type:"text",value:t.mcpBaseUrl||"",onChange:le=>i({mcpBaseUrl:le.target.value}),placeholder:O,className:"w-full bg-white dark:bg-black/10 border border-border rounded-lg px-3 py-2 text-xs font-mono focus:outline-none focus:border-primary/50"}),S.jsxs("p",{className:"text-[10px] text-secondary",children:["Use the MCP base host only (for example: ",O," or http://localhost:8010). Do not include",S.jsx("span",{className:"font-mono",children:" /mcp/sse"})," or ",S.jsx("span",{className:"font-mono",children:"/mcp/tools"}),"."]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-xs font-medium text-secondary",children:"API Token (Optional)"}),S.jsx("input",{type:"password",value:t.mcpApiToken||"",onChange:le=>i({mcpApiToken:le.target.value}),placeholder:"Bearer token...",className:"w-full bg-white dark:bg-black/10 border border-border rounded-lg px-3 py-2 text-xs font-mono focus:outline-none focus:border-primary/50"})]}),I.message&&S.jsx("div",{className:`text-[10px] font-mono px-3 py-2 rounded-lg border ${I.status==="ok"?"bg-green-500/5 border-green-500/20 text-green-700 dark:text-green-400":I.status==="error"?"bg-red-500/5 border-red-500/20 text-red-700 dark:text-red-400":"bg-black/5 dark:bg-white/5 border-border text-secondary"}`,children:I.message}),A.message&&S.jsx("div",{className:`text-[10px] font-mono px-3 py-2 rounded-lg border ${A.status==="ok"?"bg-blue-500/5 border-blue-500/20 text-blue-700 dark:text-blue-400":A.status==="error"?"bg-red-500/5 border-red-500/20 text-red-700 dark:text-red-400":"bg-black/5 dark:bg-white/5 border-border text-secondary"}`,children:A.message})]})]}),S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("label",{className:"text-sm font-medium text-primary",children:"Model Context Protocol (MCP)"}),S.jsxs("button",{className:"text-xs text-accent hover:underline flex items-center gap-1",children:[S.jsx(Hb,{size:12})," Add Server"]})]}),S.jsx("div",{className:"space-y-3",children:t.mcpServers.map(le=>S.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface border border-border rounded-xl",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:`w-2 h-2 rounded-full ${le.status==="connected"?"bg-green-500":"bg-red-500"}`}),S.jsxs("div",{children:[S.jsx("div",{className:"text-sm font-medium text-primary",children:le.name}),S.jsx("div",{className:"text-[10px] text-secondary font-mono",children:le.url})]})]}),S.jsx("div",{className:"flex items-center gap-2",children:S.jsx("button",{onClick:()=>{const he=t.mcpServers.map(Ae=>Ae.id===le.id?{...Ae,enabled:!Ae.enabled}:Ae);i({mcpServers:he})},className:`px-2 py-1 rounded text-[10px] font-bold uppercase ${le.enabled?"bg-green-500/10 text-green-600":"bg-gray-100 text-gray-500"}`,children:le.enabled?"Active":"Disabled"})})]},le.id))})]})]}),l==="system"&&S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsxs("label",{className:"text-sm font-medium text-primary flex items-center gap-2",children:[S.jsx(jb,{size:16,className:"text-accent"}),"Automation Profiles"]}),S.jsxs("div",{className:"p-4 rounded-xl border border-border bg-surface/40 space-y-3",children:[S.jsxs("div",{className:"space-y-1",children:[S.jsxs("div",{className:"text-sm font-semibold text-primary",children:["Active combo: ",(ne==null?void 0:ne.name)||"Default"]}),S.jsx("div",{className:"text-[10px] text-secondary",children:"Gear mode, model, DOM mode, reasoning, search, and full-power toggles are managed in Settings  Profiles."})]}),S.jsxs("button",{type:"button",onClick:()=>c("profiles"),className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-primary text-white text-xs font-semibold hover:bg-primary/90 transition-colors",children:[S.jsx(Oc,{size:14}),"Open Profiles"]})]})]}),S.jsx("div",{className:"h-px bg-border/50"}),S.jsx("div",{className:"space-y-3",children:S.jsx(l9,{value:z,onChange:oe})}),S.jsx("div",{className:"h-px bg-border/50"}),o&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"space-y-3",children:[S.jsxs("label",{className:"text-sm font-medium text-primary flex items-center gap-2",children:[S.jsx(Ea,{size:16,className:"text-accent"}),"Agent Runtime"]}),S.jsxs("div",{className:"p-4 rounded-xl border border-border bg-surface/30 space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between gap-3",children:[S.jsxs("div",{className:"flex flex-col min-w-0",children:[S.jsx("span",{className:"text-sm font-semibold text-primary",children:"Relay Agent"}),S.jsx("span",{className:"text-[10px] text-secondary font-mono truncate",children:((ct=M.settings)==null?void 0:ct.agentId)||""})]}),S.jsxs("button",{type:"button",onClick:()=>X(),disabled:M.status==="loading",className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white dark:bg-white/10 border border-border text-xs font-bold uppercase tracking-wider text-primary hover:bg-black/5 dark:hover:bg-white/15 transition-colors disabled:opacity-60",children:[S.jsx(da,{size:14,className:M.status==="loading"?"animate-spin":""}),"Refresh"]})]}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[S.jsxs("button",{type:"button",onClick:()=>{var le;return Q({masterActive:((le=M.settings)==null?void 0:le.masterActive)===!1})},disabled:M.status==="loading",className:`flex items-center justify-between p-2 rounded-lg border ${((nt=M.settings)==null?void 0:nt.masterActive)===!1?"border-border text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5":"border-emerald-500/40 bg-emerald-500/10 text-emerald-700 dark:text-emerald-300"}`,title:"Master Active gates all automation and relay execution.",children:[S.jsx("span",{className:"text-xs font-semibold",children:"Master Active"}),S.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:((Ht=M.settings)==null?void 0:Ht.masterActive)===!1?"OFF":"ON"})]}),S.jsxs("button",{type:"button",onClick:()=>{var le;return Q({trainingAllowAiScripts:((le=M.settings)==null?void 0:le.trainingAllowAiScripts)!==!0})},disabled:M.status==="loading",className:`flex items-center justify-between p-2 rounded-lg border ${((Rt=M.settings)==null?void 0:Rt.trainingAllowAiScripts)===!0?"border-rose-500/40 bg-rose-500/10 text-rose-700 dark:text-rose-300":"border-border text-secondary hover:text-primary hover:bg-black/5 dark:hover:bg-white/5"}`,title:"Enables AI-generated scripts (run_script_direct + script steps in execute_batch_actions).",children:[S.jsx("span",{className:"text-xs font-semibold",children:"AI Scripts"}),S.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:((It=M.settings)==null?void 0:It.trainingAllowAiScripts)===!0?"ON":"OFF"})]})]}),S.jsx("div",{className:"text-[10px] text-secondary/80 leading-relaxed",children:'AI Scripts is the true "unlocked" JS path for DOM automation. Keep it OFF on untrusted sites.'}),M.status==="error"&&M.message&&S.jsx("div",{className:"text-[11px] rounded-lg px-3 py-2 border bg-red-50 border-red-200 text-red-700",children:M.message})]})]}),S.jsx("div",{className:"h-px bg-border/50"})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsx("label",{className:"text-sm font-medium text-primary",children:"Security Mode"}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("button",{onClick:()=>i({requireAuth:!0}),className:`flex flex-col items-center gap-2 p-4 rounded-xl border transition-all ${t.requireAuth?"bg-red-500/10 border-red-500 text-red-600":"bg-surface border-border text-secondary hover:border-primary/30"}`,children:[S.jsx($k,{size:24}),S.jsxs("div",{className:"text-center",children:[S.jsx("span",{className:"text-sm font-semibold block",children:"Strict Auth"}),S.jsx("span",{className:"text-[10px] opacity-80",children:"Requires Login"})]})]}),S.jsxs("button",{onClick:()=>i({requireAuth:!1}),className:`flex flex-col items-center gap-2 p-4 rounded-xl border transition-all ${t.requireAuth?"bg-surface border-border text-secondary hover:border-primary/30":"bg-orange-500/10 border-orange-500 text-orange-600"}`,children:[S.jsx(Hk,{size:24}),S.jsxs("div",{className:"text-center",children:[S.jsx("span",{className:"text-sm font-semibold block",children:"Build Mode"}),S.jsx("span",{className:"text-[10px] opacity-80",children:"Guest Bypass Active"})]})]})]})]}),S.jsx("div",{className:"h-px bg-border/50"}),r.canReloadExtension&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"space-y-3",children:[S.jsxs("label",{className:"text-sm font-medium text-primary flex items-center gap-2",children:[S.jsx(Gb,{size:16,className:"text-accent"}),"Extension Updates"]}),S.jsxs("div",{className:"p-4 rounded-xl border border-border bg-surface/30",children:[S.jsxs("div",{className:"flex items-center justify-between gap-3",children:[S.jsxs("div",{className:"flex flex-col",children:[S.jsx("span",{className:"text-sm font-semibold text-primary",children:"Chrome Extension"}),S.jsxs("span",{className:"text-[10px] text-secondary font-mono",children:["v",W||"?"]})]}),S.jsxs("button",{onClick:de,disabled:U.status==="checking",className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white dark:bg-white/10 border border-border text-xs font-bold uppercase tracking-wider text-primary hover:bg-black/5 dark:hover:bg-white/15 transition-colors disabled:opacity-60",children:[S.jsx(da,{size:14,className:U.status==="checking"?"animate-spin":""}),"Check"]})]}),U.status!=="idle"&&S.jsx("div",{className:`mt-3 text-[11px] rounded-lg px-3 py-2 border ${U.status==="error"?"bg-red-50 border-red-200 text-red-700":U.status==="update_available"?"bg-green-50 border-green-200 text-green-700":"bg-surface border-border text-secondary"}`,children:U.message||""}),S.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50 space-y-2",children:[S.jsxs("div",{className:"flex items-center justify-between gap-3",children:[S.jsxs("div",{className:"flex flex-col",children:[S.jsx("span",{className:"text-xs font-semibold text-primary",children:"Bilge Agent Redeploy"}),S.jsx("span",{className:"text-[10px] text-secondary",children:"Triggers the full rebuild + deploy pipeline (bump/build/deploy/sync/reload)."})]}),S.jsxs("button",{onClick:De,disabled:j.status==="running",className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white text-xs font-bold uppercase tracking-wider transition-colors disabled:opacity-60",title:"Full redeploy (requires local applets MCP tool: rebuild_bilge_agent)",children:[S.jsx($b,{size:14,className:j.status==="running"?"animate-pulse":""}),"Redeploy"]})]}),j.status!=="idle"&&S.jsxs("div",{className:`text-[11px] rounded-lg px-3 py-2 border ${j.status==="error"?"bg-red-50 border-red-200 text-red-700":j.status==="ok"?"bg-green-50 border-green-200 text-green-700":"bg-surface border-border text-secondary"}`,children:[j.message||"",j.opId&&S.jsxs("span",{className:"block mt-1 font-mono text-[10px] opacity-90",children:["op_id: ",j.opId]}),j.logPath&&S.jsxs("span",{className:"block font-mono text-[10px] opacity-90",children:["log: ",j.logPath]})]}),j.output&&S.jsx("pre",{className:"text-[10px] font-mono bg-black/5 dark:bg-black/20 border border-border/50 rounded-lg p-3 max-h-44 overflow-auto whitespace-pre-wrap",children:j.output})]}),S.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50 space-y-2",children:[S.jsxs("div",{className:"flex items-center justify-between gap-3",children:[S.jsxs("div",{className:"flex flex-col",children:[S.jsx("span",{className:"text-xs font-semibold text-primary",children:"Developer Sync (Local)"}),S.jsx("span",{className:"text-[10px] text-secondary",children:"Builds `bilge-applet` and copies `dist/` into `chrome-extension-bilge/`, then reloads."})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsxs("button",{onClick:()=>Me({noBuild:!0}),disabled:$.status==="running",className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-surface border border-border text-xs font-bold uppercase tracking-wider text-primary hover:bg-black/5 dark:hover:bg-white/10 transition-colors disabled:opacity-60",title:"Copy existing dist/ into the extension and reload",children:[S.jsx(wh,{size:14}),"Sync"]}),S.jsxs("button",{onClick:()=>Me({noBuild:!1}),disabled:$.status==="running",className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white dark:bg-white/10 border border-border text-xs font-bold uppercase tracking-wider text-primary hover:bg-black/5 dark:hover:bg-white/15 transition-colors disabled:opacity-60",title:"Build + sync into the extension and reload",children:[S.jsx(da,{size:14,className:$.status==="running"?"animate-spin":""}),"Build"]})]})]}),$.status!=="idle"&&S.jsx("div",{className:`text-[11px] rounded-lg px-3 py-2 border ${$.status==="error"?"bg-red-50 border-red-200 text-red-700":$.status==="ok"?"bg-green-50 border-green-200 text-green-700":"bg-surface border-border text-secondary"}`,children:$.message||""}),$.output&&S.jsx("pre",{className:"text-[10px] font-mono bg-black/5 dark:bg-black/20 border border-border/50 rounded-lg p-3 max-h-44 overflow-auto whitespace-pre-wrap",children:$.output})]}),S.jsx("div",{className:"mt-2 text-[10px] text-secondary/70 leading-relaxed",children:"Note: Chrome extensions cannot load remote JS bundles (MV3). Updating requires a proper extension update channel (Chrome Web Store or a self-hosted update feed)."})]})]}),S.jsx("div",{className:"h-px bg-border/50"})]}),S.jsxs("div",{className:"bg-red-500/5 border border-red-500/20 rounded-xl p-4",children:[S.jsx("h4",{className:"text-sm font-medium text-red-600 mb-2",children:"Danger Zone"}),S.jsx("button",{onClick:()=>{confirm("Are you sure?")&&(localStorage.clear(),window.location.reload())},className:"text-xs font-medium text-white bg-red-600 hover:bg-red-700 px-3 py-2 rounded-lg transition-colors",children:"Reset Application Data"})]})]})]})]})]})]}):null},f9=({isOpen:n,onClose:e})=>{const[t,i]=Oe.useState(100),[r,o]=Oe.useState(10),[l,c]=Oe.useState(1);if(!n)return null;const d=24e-6,f=25e-7,m=.06/1e5,v=.18/1e5,E=.18,b=.1/1e6,I=.4/1e6,x=500,A=300,N=t*r,L=N*.5*(d+f)*30,$=N*5,K=N*2,j=($*m+K*v)*30+l*E,V=N*(x*b+A*I)*30,D=L+j+V;return S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"fixed inset-0 z-[60] bg-black/30 backdrop-blur-sm",onClick:e}),S.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-[70] w-full max-w-lg bg-white dark:bg-[#1C1C1E] rounded-2xl shadow-2xl border border-border/50 animate-fade-in p-6",children:[S.jsxs("div",{className:"flex justify-between items-center mb-6",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg text-green-600",children:S.jsx(Ak,{size:20})}),S.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Cost Estimator"})]}),S.jsx("button",{onClick:e,className:"text-secondary hover:text-primary transition-colors",children:S.jsx(G_,{size:20})})]}),S.jsxs("div",{className:"space-y-8",children:[S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex justify-between",children:[S.jsxs("label",{className:"text-sm font-medium text-primary flex items-center gap-2",children:[S.jsx(Oc,{size:14,className:"text-secondary"}),"Daily Active Users"]}),S.jsx("span",{className:"text-xs font-mono font-bold text-accent",children:t})]}),S.jsx("input",{type:"range",min:"10",max:"10000",step:"10",value:t,onChange:z=>i(parseInt(z.target.value)),className:"w-full h-1.5 bg-border rounded-lg appearance-none cursor-pointer accent-accent"})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex justify-between",children:[S.jsxs("label",{className:"text-sm font-medium text-primary flex items-center gap-2",children:[S.jsx(Ta,{size:14,className:"text-secondary"}),"AI Queries / User / Day"]}),S.jsx("span",{className:"text-xs font-mono font-bold text-accent",children:r})]}),S.jsx("input",{type:"range",min:"1",max:"100",step:"1",value:r,onChange:z=>o(parseInt(z.target.value)),className:"w-full h-1.5 bg-border rounded-lg appearance-none cursor-pointer accent-accent"})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex justify-between",children:[S.jsxs("label",{className:"text-sm font-medium text-primary flex items-center gap-2",children:[S.jsx(Mk,{size:14,className:"text-secondary"}),"Database Storage (GB)"]}),S.jsxs("span",{className:"text-xs font-mono font-bold text-accent",children:[l," GB"]})]}),S.jsx("input",{type:"range",min:"1",max:"100",step:"1",value:l,onChange:z=>c(parseInt(z.target.value)),className:"w-full h-1.5 bg-border rounded-lg appearance-none cursor-pointer accent-accent"})]})]}),S.jsxs("div",{className:"bg-surface/50 rounded-xl p-5 border border-border",children:[S.jsxs("div",{className:"flex justify-between items-end mb-4",children:[S.jsx("span",{className:"text-sm font-medium text-secondary",children:"Estimated Monthly Cost"}),S.jsxs("span",{className:"text-3xl font-bold text-primary",children:["$",D.toFixed(2)]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-24 text-[10px] font-medium text-secondary uppercase",children:"AI API"}),S.jsx("div",{className:"flex-1 h-2 bg-surface rounded-full overflow-hidden",children:S.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${V/D*100}%`}})}),S.jsxs("div",{className:"w-16 text-right text-xs font-mono text-primary",children:["$",V.toFixed(2)]})]}),S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-24 text-[10px] font-medium text-secondary uppercase",children:"Compute"}),S.jsx("div",{className:"flex-1 h-2 bg-surface rounded-full overflow-hidden",children:S.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${L/D*100}%`}})}),S.jsxs("div",{className:"w-16 text-right text-xs font-mono text-primary",children:["$",L.toFixed(2)]})]}),S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-24 text-[10px] font-medium text-secondary uppercase",children:"Database"}),S.jsx("div",{className:"flex-1 h-2 bg-surface rounded-full overflow-hidden",children:S.jsx("div",{className:"h-full bg-orange-500 rounded-full",style:{width:`${j/D*100}%`}})}),S.jsxs("div",{className:"w-16 text-right text-xs font-mono text-primary",children:["$",j.toFixed(2)]})]})]}),S.jsx("div",{className:"mt-4 pt-3 border-t border-border/50 text-[10px] text-secondary text-center leading-relaxed",children:"Estimates based on Gemini 3 Flash Pricing + Cloud Run Tier 1 + Firestore (Read/Write Ops). Actual costs may vary based on cache hits and network egress."})]})]})]})]})},h9=[{id:"main",name:"main",status:"stable",lastCommit:"fix: production auth config",time:"2h ago"},{id:"feature/ai-agent",name:"feature/ai-agent",status:"active",lastCommit:"feat: intelligent git integration",time:"Just now"},{id:"firebase-deploy",name:"firebase-deploy",status:"deploy",lastCommit:"chore: update firebase rules",time:"48m ago"},{id:"dev",name:"dev",status:"beta",lastCommit:"feat: added vector database support",time:"5m ago"},{id:"staging",name:"staging",status:"testing",lastCommit:"chore: update dependency versions",time:"1d ago"},{id:"fix/ui-latency",name:"fix/ui-latency",status:"review",lastCommit:"perf: optimize react render cycles",time:"3h ago"}],p9=({onClose:n})=>{const{settings:e,updateSettings:t}=Io(),[i,r]=Oe.useState(e.currentBranch||"main"),[o,l]=Oe.useState(!1),[c,d]=Oe.useState(0),f=()=>{l(!0),d(0),[()=>d(10),()=>d(40),()=>d(70),()=>d(100)].forEach((v,E)=>{setTimeout(v,(E+1)*800)}),setTimeout(()=>{sessionStorage.setItem("bilge_reboot_bios","true"),t({currentBranch:i}),window.location.reload()},4e3)};return S.jsx("div",{className:"fixed inset-0 z-[100] bg-background/80 backdrop-blur-xl flex items-center justify-center p-4 md:p-12 animate-fade-in",children:S.jsxs("div",{className:"w-full max-w-5xl h-[600px] bg-surface border border-border rounded-2xl shadow-2xl overflow-hidden flex flex-col md:flex-row",children:[S.jsxs("div",{className:"w-full md:w-1/3 bg-white dark:bg-[#111] border-r border-border flex flex-col",children:[S.jsxs("div",{className:"p-6 border-b border-border",children:[S.jsxs("h2",{className:"text-lg font-bold text-primary flex items-center gap-2",children:[S.jsx(Wk,{size:18,className:"text-accent"}),"System Manager"]}),S.jsx("p",{className:"text-xs text-secondary mt-1",children:"Select a target environment to mount."})]}),S.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[S.jsx("div",{className:"text-[10px] font-bold text-secondary uppercase tracking-wider mb-2 px-2",children:"Available Branches"}),h9.map(m=>S.jsxs("button",{onClick:()=>!o&&r(m.id),disabled:o,className:`
                            w-full text-left p-3 rounded-xl border transition-all duration-200 group relative overflow-hidden
                            ${i===m.id?"bg-accent/5 border-accent shadow-sm":"bg-transparent border-transparent hover:bg-black/5 dark:hover:bg-white/5"}
                        `,children:[S.jsxs("div",{className:"flex justify-between items-start mb-1 relative z-10",children:[S.jsx("span",{className:`text-sm font-semibold font-mono ${i===m.id?"text-accent":"text-primary"}`,children:m.name}),e.currentBranch===m.id&&S.jsxs("span",{className:"text-[10px] bg-green-500/10 text-green-600 px-1.5 py-0.5 rounded font-medium flex items-center gap-1",children:[S.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"})," Active"]})]}),S.jsxs("div",{className:"flex items-center gap-2 text-xs text-secondary relative z-10",children:[S.jsx(Bk,{size:12}),S.jsx("span",{className:"truncate max-w-[160px]",children:m.lastCommit})]})]},m.id))]}),S.jsx("div",{className:"p-4 border-t border-border bg-surface/50",children:S.jsxs("button",{onClick:n,disabled:o,className:"flex items-center gap-2 text-sm text-secondary hover:text-primary transition-colors",children:[S.jsx(xk,{size:14,className:"rotate-180"})," Back to Workspace"]})})]}),S.jsxs("div",{className:"flex-1 flex flex-col bg-surface relative",children:[S.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:"radial-gradient(#888 1px, transparent 1px)",backgroundSize:"20px 20px"}}),o?S.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-center z-10",children:[S.jsxs("div",{className:"relative mb-8",children:[S.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-border opacity-20"}),S.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-accent border-t-transparent animate-spin"}),S.jsxs("div",{className:"absolute inset-0 flex items-center justify-center font-mono font-bold text-xl text-primary",children:[c,"%"]})]}),S.jsxs("h3",{className:"text-xl font-bold text-primary mb-2",children:["Deploying ",i,"..."]}),S.jsx("p",{className:"text-secondary text-sm max-w-md animate-pulse",children:"Applying hot-patches. System will reboot automatically."}),S.jsxs("div",{className:"mt-8 w-full max-w-md bg-black/5 dark:bg-white/5 rounded-lg p-4 font-mono text-xs text-secondary text-left space-y-2",children:[S.jsx("div",{className:c>10?"text-green-600":"",children:"[1/4] Fetching objects from origin..."}),S.jsx("div",{className:c>40?"text-green-600":"",children:"[2/4] Resolving delta compression..."}),S.jsx("div",{className:c>70?"text-green-600":"",children:"[3/4] Rebuilding React fiber tree..."}),S.jsx("div",{className:c===100?"text-green-600":"",children:"[4/4] Hot-swap complete. Restarting."})]})]}):S.jsxs("div",{className:"flex-1 flex flex-col p-8 z-10",children:[S.jsxs("div",{className:"flex items-start justify-between mb-8",children:[S.jsxs("div",{children:[S.jsx("h3",{className:"text-2xl font-bold text-primary mb-2",children:"Ready to Switch"}),S.jsx("p",{className:"text-secondary",children:"Review the changes below before applying this branch."})]}),S.jsxs("div",{className:"text-right",children:[S.jsx("div",{className:"text-xs font-bold text-secondary uppercase tracking-wider mb-1",children:"Target"}),S.jsx("div",{className:"text-xl font-mono text-accent",children:i})]})]}),S.jsxs("div",{className:"flex-1 bg-white dark:bg-[#09090b] border border-border rounded-xl overflow-hidden flex flex-col",children:[S.jsxs("div",{className:"px-4 py-2 border-b border-border bg-surface/50 flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-primary",children:[S.jsx(Vk,{size:14,className:"text-blue-500"}),S.jsx("span",{children:"src/config/features.ts"})]}),S.jsx("span",{className:"text-[10px] text-secondary",children:"Modified"})]}),S.jsxs("div",{className:"flex-1 p-4 font-mono text-xs overflow-y-auto space-y-1",children:[S.jsx("div",{className:"text-gray-400",children:"@@ -12,4 +12,4 @@"}),S.jsx("div",{className:"text-secondary",children:"   enableAutoGit: true,"}),S.jsx("div",{className:"text-red-500/70 line-through",children:"-  enableSurgeryMode: false,"}),S.jsx("div",{className:"text-green-600",children:"+  enableSurgeryMode: true,"}),S.jsx("div",{className:"text-secondary",children:"   currentBranch: 'main',"}),S.jsx("div",{className:"text-green-600",children:"+  // Hot-patch active"})]})]}),S.jsxs("div",{className:"mt-8 flex justify-end gap-4",children:[S.jsx("button",{onClick:n,className:"px-6 py-3 rounded-xl text-sm font-medium text-secondary hover:text-primary transition-colors",children:"Cancel"}),S.jsxs("button",{onClick:f,className:"px-8 py-3 bg-primary text-white rounded-xl text-sm font-bold hover:bg-primary/90 transition-all shadow-lg flex items-center gap-2",children:[S.jsx(wh,{size:16})," Apply & Restart"]})]})]})]})]})})},Vy=["BILGE CORE BIOS v4.0.1 (c) 2026","CPU: GEMINI-3-PRO @ 256k TOKENS","MEM: 64GB VRAM CHECK... OK","DETECTING VIRTUAL FILE SYSTEM...","MOUNTING /dev/sda1 (React Fiber)...","LOADING KERNEL...","INITIALIZING NEURAL INTERFACES..."],m9=({onBootComplete:n,children:e})=>{const{settings:t,updateSettings:i}=Io(),[r,o]=Oe.useState(0),[l,c]=Oe.useState("running"),[d,f]=Oe.useState(0),[m,v]=Oe.useState(t.currentBranch||"main"),E=Oe.useRef(!1);Oe.useEffect(()=>{sessionStorage.getItem("bilge_reboot_bios")==="true"?(c("posting"),sessionStorage.removeItem("bilge_reboot_bios")):E.current||(E.current=!0,n())},[]);const b=[{id:"boot",label:"NORMAL BOOT"},{id:"branch",label:`SELECT BRANCH [${m}]`},{id:"safe",label:"BOOT SAFE MODE (NO PLUGINS)"},{id:"wipe",label:"FACTORY RESET (CLEAR DATA)"}],I=["main","dev","staging","feat/surgery-mode","fix/ui-latency"];Oe.useEffect(()=>{if(l!=="posting")return;const N=L=>{(L.key==="Delete"||L.key==="F2"||L.key==="Backspace")&&c("bios")};window.addEventListener("keydown",N);const U=setInterval(()=>{o(L=>L>=Vy.length+2?(clearInterval(U),E.current||x(),L):L+1)},400);return()=>{window.removeEventListener("keydown",N),clearInterval(U)}},[l]);const x=()=>{c("running"),E.current=!0,setTimeout(n,100)};Oe.useEffect(()=>{if(l!=="bios")return;const N=U=>{U.key==="ArrowUp"?f(L=>L>0?L-1:b.length-1):U.key==="ArrowDown"?f(L=>L<b.length-1?L+1:0):U.key==="Enter"&&A(b[d].id)};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[l,d,m]);const A=async N=>{switch(N){case"boot":c("posting"),setTimeout(x,500);break;case"branch":const L=(I.indexOf(m)+1)%I.length,$=I[L];v($);break;case"safe":i({operationMode:"local",enableGoogleSearch:!1}),alert("SAFE MODE ENABLED. NETWORK DRIVERS DISABLED."),x();break;case"wipe":confirm("WARNING: THIS WILL DELETE ALL LOCAL STORAGE DATA. CONTINUE?")&&(localStorage.clear(),window.location.reload());break}};return Oe.useEffect(()=>{m!==t.currentBranch&&i({currentBranch:m})},[m]),l==="running"?S.jsx(S.Fragment,{children:e}):l==="bios"?S.jsx("div",{className:"fixed inset-0 bg-[#0000AA] text-white font-mono flex items-center justify-center p-8 z-[9999]",children:S.jsxs("div",{className:"w-full max-w-4xl border-4 border-double border-white p-2 shadow-[10px_10px_0_0_rgba(0,0,0,0.5)] bg-[#0000AA]",children:[S.jsxs("div",{className:"flex justify-between border-b-2 border-white pb-2 mb-8",children:[S.jsx("span",{className:"font-bold",children:"BILGE SETUP UTILITY"}),S.jsx("span",{children:"v4.0.1"})]}),S.jsxs("div",{className:"flex gap-8",children:[S.jsx("div",{className:"flex-1 space-y-2",children:b.map((N,U)=>S.jsxs("div",{className:`px-4 py-2 flex justify-between cursor-pointer ${d===U?"bg-white text-[#0000AA]":""}`,onClick:()=>f(U),children:[S.jsx("span",{children:N.label}),d===U&&S.jsx("span",{children:"<<"})]},N.id))}),S.jsxs("div",{className:"w-1/3 border-l-2 border-white pl-8 flex flex-col justify-between text-sm",children:[S.jsxs("div",{className:"space-y-4 text-cyan-200",children:[S.jsx("p",{children:"Item Specific Help"}),S.jsxs("p",{className:"text-white",children:[d===0&&"Load the Operating System normally.",d===1&&"Simulate git checkout to a different development branch.",d===2&&"Boot without external network calls or plugins.",d===3&&"Erase NVRAM (localStorage) and reboot."]})]}),S.jsxs("div",{className:"space-y-1 text-white opacity-70 mt-12",children:[S.jsx("div",{children:" Select Item"}),S.jsx("div",{children:"ENTER Execute"}),S.jsx("div",{children:"F10 Save & Exit"})]})]})]}),S.jsxs("div",{className:"mt-12 border-t-2 border-white pt-2 flex justify-between text-sm",children:[S.jsxs("span",{children:["System Time: ",new Date().toLocaleTimeString()]}),S.jsx("span",{className:"animate-pulse bg-red-600 px-2 text-white",children:"SURGERY MODE ACTIVE"})]})]})}):S.jsxs("div",{className:"fixed inset-0 bg-black text-[#CCCCCC] font-mono p-8 z-[9999] overflow-hidden cursor-none",children:[S.jsxs("div",{className:"max-w-3xl mx-auto space-y-1",children:[Vy.slice(0,r).map((N,U)=>S.jsx("div",{className:"flex gap-2",children:S.jsx("span",{children:N})},U)),r>=Vy.length&&S.jsxs("div",{className:"mt-8",children:[S.jsx("div",{className:"text-white mb-2",children:"Verifying DMI Pool Data............"}),S.jsx("div",{className:"text-white",children:"Boot from CD :"})]})]}),S.jsxs("div",{className:"absolute bottom-8 left-0 w-full text-center",children:[S.jsx("div",{className:"inline-block bg-white text-black px-4 py-1 font-bold animate-pulse",children:"Press <DEL> to enter SURGERY MODE"}),S.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Press <F12> for Network Boot"})]})]})},g9=({error:n,onRetry:e,onClear:t})=>{const{openSettings:i}=Io();if(!n)return null;const o=(()=>{switch(n.type){case"connection":return{title:"Connection Issue",description:"Bilge can't reach the AI server. This usually means your API token needs setup or the server URL is incorrect.",icon:zb,color:"text-amber-500",bgColor:"bg-amber-500/10",borderColor:"border-amber-500/20"};case"auth":return{title:"Authentication Required",description:"Your session has expired or the API token is invalid. Please check your credentials in settings.",icon:FA,color:"text-rose-500",bgColor:"bg-rose-500/10",borderColor:"border-rose-500/20"};case"bridge":return{title:"Runtime Bridge Offline",description:"The connection to your browser or host machine was lost. Try restarting the stack or refreshing the extension.",icon:da,color:"text-indigo-500",bgColor:"bg-indigo-500/10",borderColor:"border-indigo-500/20"};default:return{title:"Unexpected Error",description:n.message||"An unknown error occurred during execution.",icon:zb,color:"text-secondary",bgColor:"bg-white/5",borderColor:"border-white/10"}}})(),l=o.icon;return S.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-6 bg-black/40 backdrop-blur-md animate-fade-in",children:S.jsxs("div",{className:`w-full max-w-sm bg-white dark:bg-[#1C1C1E] border ${o.borderColor} rounded-3xl shadow-2xl overflow-hidden p-8 text-center`,children:[S.jsx("div",{className:`w-16 h-16 ${o.bgColor} ${o.color} rounded-2xl flex items-center justify-center mx-auto mb-6`,children:S.jsx(l,{size:32,strokeWidth:2.5})}),S.jsx("h2",{className:"text-xl font-black text-primary uppercase tracking-tight mb-2",children:o.title}),S.jsx("p",{className:"text-sm text-secondary font-medium leading-relaxed mb-8 px-2",children:o.description}),n.details&&S.jsx("div",{className:"mb-8 p-3 bg-black/5 dark:bg-white/5 rounded-xl text-[10px] font-mono text-secondary/70 break-all leading-tight",children:n.details}),S.jsxs("div",{className:"flex flex-col gap-3",children:[S.jsx("button",{onClick:e,className:"w-full py-3 bg-primary text-white rounded-xl font-bold text-sm hover:scale-[1.02] active:scale-[0.98] transition-all shadow-lg shadow-primary/20",children:"Try Again"}),S.jsxs("div",{className:"flex gap-2",children:[S.jsxs("button",{onClick:()=>{t(),i()},className:"flex-1 py-3 bg-surface border border-border/50 text-primary rounded-xl font-bold text-sm flex items-center justify-center gap-2 hover:bg-black/5 dark:hover:bg-white/5 transition-all",children:[S.jsx(BA,{size:16}),"Settings"]}),S.jsx("button",{onClick:t,className:"px-6 py-3 text-secondary font-bold text-sm hover:text-primary transition-all",children:"Dismiss"})]})]})]})})},y9=({isOpen:n,onClose:e})=>{const[t,i]=Oe.useState(0);if(!n)return null;const r=[{title:"Welcome to Bilge",description:"Your AI-powered workspace for intelligent browser automation and research.",icon:Ea,color:"text-accent bg-accent/10"},{title:"Natural Commands",description:"Just type what you want to do. 'Scroll down', 'Click the login button', or 'Summarize this page'.",icon:ba,color:"text-amber-500 bg-amber-500/10"},{title:"Smart Form Filling",description:"Auto-fill complex forms using your identity profile with one click or command.",icon:Yk,color:"text-blue-500 bg-blue-500/10"},{title:"Ready to Explore",description:"Try typing your first command on the home screen to see Bilge in action.",icon:Ik,color:"text-green-500 bg-green-500/10"}],o=r[t],l=o.icon;return S.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center p-6 bg-black/60 backdrop-blur-xl animate-fade-in",children:S.jsxs("div",{className:"w-full max-w-sm bg-white dark:bg-[#1C1C1E] border border-border/50 rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col",children:[S.jsxs("div",{className:"p-8 flex-1 flex flex-col items-center text-center",children:[S.jsx("div",{className:`w-20 h-20 ${o.color} rounded-3xl flex items-center justify-center mb-8 animate-bounce-subtle`,children:S.jsx(l,{size:40,strokeWidth:2.5})}),S.jsx("h2",{className:"text-2xl font-black text-primary uppercase tracking-tighter mb-4",children:o.title}),S.jsx("p",{className:"text-base text-secondary font-medium leading-relaxed px-4",children:o.description})]}),S.jsxs("div",{className:"p-8 pt-0 flex flex-col gap-4",children:[S.jsx("div",{className:"flex justify-center gap-2 mb-4",children:r.map((c,d)=>S.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${d===t?"w-8 bg-accent":"w-1.5 bg-border"}`},d))}),t<r.length-1?S.jsxs("button",{onClick:()=>i(c=>c+1),className:"w-full py-4 bg-primary text-white rounded-2xl font-black text-sm uppercase tracking-[0.2em] flex items-center justify-center gap-2 hover:scale-[1.02] active:scale-[0.98] transition-all shadow-xl shadow-primary/20",children:["Next ",S.jsx(Ck,{size:18,strokeWidth:3})]}):S.jsx("button",{onClick:e,className:"w-full py-4 bg-accent text-white rounded-2xl font-black text-sm uppercase tracking-[0.2em] hover:scale-[1.02] active:scale-[0.98] transition-all shadow-xl shadow-accent/20",children:"Get Started"}),S.jsx("button",{onClick:e,className:"w-full py-2 text-secondary font-bold text-xs uppercase tracking-widest opacity-50 hover:opacity-100 transition-opacity",children:"Skip Tutorial"})]})]})})},_9=({isOpen:n,onClose:e,onConfirm:t,mappings:i})=>{const[r,o]=Oe.useState(new Set(i.map(E=>E.fieldName))),[l,c]=Oe.useState(!1);if(!n)return null;const d=E=>{const b=new Set(r);b.has(E)?b.delete(E):b.add(E),o(b)},f=()=>{r.size===i.length?o(new Set):o(new Set(i.map(E=>E.fieldName)))},m=(E,b)=>!b||l?E:E.length<=4?"":""+E.slice(-4),v=i.filter(E=>E.isSensitive).length;return S.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:S.jsxs("div",{className:"w-full max-w-md bg-surface border border-border rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[S.jsxs("div",{className:"p-4 border-b border-border shrink-0",children:[S.jsx("h2",{className:"text-lg font-bold text-primary",children:"Preview Auto-Fill"}),S.jsx("p",{className:"text-sm text-secondary mt-1",children:"Review what will be filled before confirming."})]}),S.jsxs("div",{className:"p-4 overflow-y-auto flex-1",children:[v>0&&S.jsxs("div",{className:"flex items-center justify-between p-3 mb-4 rounded-xl bg-amber-500/10 border border-amber-500/20 shrink-0",children:[S.jsxs("div",{className:"flex items-center gap-2 text-amber-600",children:[S.jsx(eM,{size:16}),S.jsxs("span",{className:"text-xs font-bold uppercase",children:[v," sensitive field(s)"]})]}),S.jsxs("button",{onClick:()=>c(!l),className:"flex items-center gap-1.5 px-2 py-1 rounded-lg bg-amber-500/10 text-xs font-bold text-amber-600 hover:bg-amber-500/20 transition-all",children:[l?S.jsx(Pk,{size:14}):S.jsx(Ok,{size:14}),l?"Hide":"Show"]})]}),S.jsx("div",{className:"space-y-2",children:i.map(E=>S.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-xl cursor-pointer transition-all border ${r.has(E.fieldName)?"bg-accent/5 border-accent/20":"bg-white/5 border-transparent hover:border-border/50"}`,children:[S.jsx("input",{type:"checkbox",checked:r.has(E.fieldName),onChange:()=>d(E.fieldName),className:"w-4 h-4 rounded border-border text-accent focus:ring-accent bg-transparent"}),S.jsxs("div",{className:"flex-1 min-w-0",children:[S.jsx("div",{className:"text-sm font-bold text-primary truncate",children:E.fieldLabel||E.fieldName}),S.jsx("div",{className:`text-[10px] font-mono truncate mt-0.5 ${E.isSensitive?"text-amber-600":"text-secondary opacity-70"}`,children:m(E.value,E.isSensitive)})]}),E.confidence<.8&&S.jsx("span",{className:"px-1.5 py-0.5 rounded bg-amber-500/10 text-[9px] text-amber-600 font-black uppercase tracking-tighter",children:"Low match"})]},E.fieldName))})]}),S.jsxs("div",{className:"p-4 border-t border-border shrink-0 flex items-center justify-between bg-surface/50 backdrop-blur-md",children:[S.jsx("button",{onClick:f,className:"text-xs font-bold text-secondary hover:text-primary uppercase tracking-widest px-2",children:r.size===i.length?"Deselect All":"Select All"}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx("button",{onClick:e,className:"px-4 py-2 rounded-xl text-sm font-bold text-secondary hover:bg-white/5 transition-all",children:"Cancel"}),S.jsxs("button",{onClick:()=>t(Array.from(r)),disabled:r.size===0,className:"px-5 py-2 rounded-xl text-sm font-black uppercase tracking-tight bg-accent text-white hover:bg-accent/90 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-accent/20 transition-all",children:["Fill ",r.size," Field",r.size!==1?"s":""]})]})]})]})})},NN=Oe.lazy(()=>bd(()=>import("./HomePage-Mu7fz5zU.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(n=>({default:n.HomePage}))),v9=Oe.lazy(()=>bd(()=>import("./TerminalPage-CUjh1-Ji.js"),[]).then(n=>({default:n.TerminalPage}))),E9=Oe.lazy(()=>bd(()=>import("./FlowPage-8C1TGFlr.js"),__vite__mapDeps([8,1,9,6,5,4])).then(n=>({default:n.FlowPage}))),T9=Oe.lazy(()=>bd(()=>import("./LibraryPage-lDc5YBfY.js"),__vite__mapDeps([10,2,3,6,11,4])).then(n=>({default:n.LibraryPage}))),b9=Oe.lazy(()=>bd(()=>import("./SettingsPage-BgMHpa5p.js"),__vite__mapDeps([12,3,4,9,11,7,5])).then(n=>({default:n.SettingsPage}))),S9=Oe.memo(nM),w9={home:NN,console:v9,workflows:E9,library:T9,settings:b9},x9=["home","console","workflows","library","settings"],A9="2.0.16".trim();function I9(){var n,e,t;if(typeof window>"u")return null;try{const i=window.chrome,r=(t=(e=(n=i==null?void 0:i.runtime)==null?void 0:n.getManifest)==null?void 0:e.call(n))==null?void 0:t.version;if(typeof r=="string"&&r.trim())return r.trim()}catch{}return null}function C9(n){return(n?I9():null)||A9||"unknown"}const UA=n=>{const e=String(n||"").trim().toLowerCase();if(!e)return null;const i={home:"home",builder:"home",console:"console",terminal:"console",workflows:"workflows",flow:"workflows",library:"library",knowledge:"library",research:"library",avatars:"library",settings:"settings",profile:"settings",servers:"settings",fusion:"settings"}[e];return i||(x9.includes(e)?e:null)},R9=()=>{if(typeof window>"u")return"home";try{const n=new URLSearchParams(window.location.search),e=UA(String(n.get("page")||""));if(e)return e;const t=String(window.location.pathname||"").split("/").filter(Boolean).slice(-1)[0]||"",i=UA(t);if(i)return i}catch{}return"home"},N9=()=>S.jsx("div",{className:"flex-1 h-full flex items-center justify-center bg-background",children:S.jsxs("div",{className:"flex flex-col items-center gap-4",children:[S.jsx(qk,{size:40,className:"text-accent animate-spin"}),S.jsx("span",{className:"text-[10px] font-black text-secondary uppercase tracking-[0.3em]",children:"Initializing Interface..."})]})}),k9=()=>S.jsxs("div",{className:"fixed inset-0 z-[9999] halt-overlay flex flex-col items-center justify-center p-8 text-center backdrop-blur-2xl",children:[S.jsx(FA,{size:80,className:"text-white mb-8 animate-breathe"}),S.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter uppercase mb-4",children:"Core Error: System Halted"}),S.jsx("p",{className:"text-white/70 text-lg mb-12 max-w-lg font-medium leading-relaxed",children:"The kernel received a critical stop signal. All active processes and drivers have been terminated to prevent memory corruption."}),S.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center gap-3 px-10 py-4 bg-white text-rose-950 rounded-2xl hover:scale-105 transition-all text-sm font-black tracking-[0.2em] uppercase shadow-2xl",children:[S.jsx(da,{size:18,strokeWidth:3})," Cold Reboot"]})]}),M9=({isExtension:n})=>{const e=n?"Extension":"Web",t=C9(n);return S.jsxs("div",{className:"version-backdrop","aria-hidden":"true",children:[S.jsx("div",{className:"version-backdrop-mark",children:`Bilge ${e} v${t}`}),S.jsx("div",{className:"version-backdrop-chip",title:`v${t}`,children:`v${t}`})]})},D9=({operationMode:n,isExtension:e,onOpenProfile:t,onRefresh:i,avatar:r,mcpProbeStatus:o})=>S.jsxs("header",{className:"h-14 shrink-0 glass-panel sticky top-0 z-50 px-6 flex items-center justify-between gap-4",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"w-8 h-8 bg-accent rounded-xl flex items-center justify-center text-white shadow-lg shadow-accent/20",children:S.jsx(Ea,{size:20,strokeWidth:3})}),S.jsx("span",{className:"text-xl font-black text-primary tracking-tighter uppercase",children:"Bilge"})]}),S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full border bg-surface/50 backdrop-blur-md transition-all
          ${o==="ok"?"border-green-500/20 text-green-600":"border-border/50 text-secondary"}
        `,children:[S.jsx("div",{className:`w-2 h-2 rounded-full ${o==="ok"?"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.6)]":o==="error"?"bg-rose-500":"bg-amber-500 animate-pulse"}`}),S.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:o==="ok"?"Connected":"System Ready"})]}),S.jsx("button",{onClick:i,className:"h-10 w-10 rounded-2xl bg-surface border border-border/50 shadow-xl flex items-center justify-center hover:scale-105 transition-all text-secondary hover:text-primary",title:"Restart & Reload Assets",children:S.jsx(da,{size:18,strokeWidth:2.5})}),S.jsx("button",{onClick:t,className:"h-10 w-10 rounded-2xl bg-surface border border-border/50 shadow-xl flex items-center justify-center hover:scale-105 transition-all overflow-hidden",title:"Settings & Profile",children:r?S.jsx("img",{src:r,alt:"Profile",className:"w-full h-full object-cover"}):S.jsx(zA,{size:20,className:"text-secondary"})})]})]});function P9(){const[n,e]=Oe.useState(()=>R9()),[t,i]=Oe.useState(!1),[r,o]=Oe.useState(!1),[l,c]=Oe.useState(!1),[d,f]=Oe.useState(!1),[m,v]=Oe.useState(!1),[E,b]=Oe.useState(!1),[I,x]=Oe.useState(!1),[A,N]=Oe.useState({status:"idle"}),[U,L]=Oe.useState(null),[$,K]=Oe.useState(()=>!localStorage.getItem("bilge_onboarding_seen")),[j,k]=Oe.useState({isOpen:!1,mappings:[]});Oe.useRef(null);const V=Oe.useRef(!1),{user:D}=Wv(),{settings:z,isExtension:G}=Io();Oe.useEffect(()=>{var ne;if(typeof chrome<"u"&&((ne=chrome.runtime)!=null&&ne.onMessage)){const ue=(F,W,ye)=>{F.type==="SHOW_AUTO_FILL_PREVIEW"&&k({isOpen:!0,mappings:F.payload.mappings})};return chrome.runtime.onMessage.addListener(ue),()=>chrome.runtime.onMessage.removeListener(ue)}},[]);const M=ne=>{var ue;typeof chrome<"u"&&((ue=chrome.runtime)!=null&&ue.sendMessage)&&chrome.runtime.sendMessage({type:"CONFIRM_AUTO_FILL",payload:{selectedFields:ne}}),k({isOpen:!1,mappings:[]})},O=wp((z.mcpBaseUrl||"").trim()||"https://mcp.caravanflow.com"),oe=a0(z.mcpApiToken||"");(()=>{try{return new URL(O).host||O}catch{return O}})(),Oe.useEffect(()=>{const ne=()=>f(!0);return window.addEventListener("bilge-system-halt",ne),()=>window.removeEventListener("bilge-system-halt",ne)},[]);const X=async()=>{if(!E){x(!1),b(!0);try{if(G&&await vi.restartExtension())return;window.location.reload()}finally{window.setTimeout(()=>b(!1),900)}}},Q=async()=>{var ne;N({status:"checking",message:"Probing /mcp/tools..."});try{const ue={Accept:"application/json"};oe&&(ue.Authorization=`Bearer ${oe}`);const F=await fetch(`${O}/mcp/tools`,{headers:ue});if(!F.ok){(F.status===401||F.status===403)&&L({type:"auth",message:"Unauthorized access to MCP"}),N({status:"error",message:`HTTP ${F.status}`});return}const W=await xp(F,"/mcp/tools");if(!W.ok){N({status:"error",message:W.error});return}const ye=Array.isArray((ne=W.data)==null?void 0:ne.tools)?W.data.tools.length:0;N({status:"ok",message:`OK (${ye} tools)`}),L(null)}catch{N({status:"error",message:"CORS/Network error"}),L({type:"connection",message:"Connection error"})}};Oe.useEffect(()=>{if(!G||V.current)return;V.current=!0;const ne=window.setTimeout(()=>{vi.reconnectRelay().then(ue=>{if(!(ue!=null&&ue.ok)||!(ue!=null&&ue.connected)){N(F=>F.status==="ok"?F:{status:"error",message:"Relay failed"});return}Q().catch(()=>{})}).catch(()=>{N(ue=>ue.status==="ok"?ue:{status:"error",message:"Relay error"})})},150);return()=>window.clearTimeout(ne)},[G]),Oe.useEffect(()=>{const ne=window.setTimeout(()=>{Q().catch(()=>{})},300);return()=>window.clearTimeout(ne)},[O,oe]);const se=w9[n]||NN;return d?S.jsx(k9,{}):S.jsxs("div",{"data-runtime":G?"extension":"web",className:"flex flex-col supports-[height:100dvh]:h-[100dvh] h-screen bg-background text-primary font-sans overflow-hidden selection:bg-accent/20 pb-16 sm:pb-0",children:[S.jsx(M9,{isExtension:G}),S.jsx(v4,{}),S.jsx(d9,{}),S.jsx(f9,{isOpen:r,onClose:()=>o(!1)}),S.jsx(T4,{isOpen:t,onClose:()=>i(!1)}),l&&S.jsx(p9,{onClose:()=>c(!1)}),S.jsx(g9,{error:U,onRetry:Q,onClear:()=>L(null)}),S.jsx(y9,{isOpen:$,onClose:()=>{K(!1),localStorage.setItem("bilge_onboarding_seen","true")}}),S.jsx(_9,{isOpen:j.isOpen,mappings:j.mappings,onClose:()=>k({isOpen:!1,mappings:[]}),onConfirm:M}),S.jsx(D9,{operationMode:z.operationMode,isExtension:G,onOpenProfile:()=>e("settings"),onRefresh:X,avatar:D==null?void 0:D.avatar,mcpProbeStatus:A.status}),S.jsx("main",{className:"flex-1 relative overflow-hidden bg-background",children:S.jsx(Oe.Suspense,{fallback:S.jsx(N9,{}),children:S.jsx(se,{})})}),S.jsx(S9,{activePage:n,onPageChange:e})]})}function O9(){const[n,e]=Oe.useState(!1);return S.jsx(c4,{children:S.jsx(_4,{children:S.jsx(m9,{onBootComplete:()=>e(!0),children:n&&S.jsx(P9,{})})})})}const kN=document.getElementById("root");if(!kN)throw new Error("Could not find root element to mount to");window.__BILGE_APP_BOOTSTRAPPED__||(window.__BILGE_APP_BOOTSTRAPPED__=!0,vk.createRoot(kN).render(S.jsx(dk.StrictMode,{children:S.jsx(O9,{})})));export{U9 as $,t9 as A,Ta as B,uy as C,Mk as D,n9 as E,Uk as F,K9 as G,OA as H,Ok as I,xk as J,zb as K,qk as L,Uy as M,$b as N,Fk as O,B_ as P,wh as Q,da as R,id as S,Ly as T,zA as U,eM as V,Ww as W,G_ as X,B9 as Y,ba as Z,F9 as _,Lk as a,$9 as a0,io as a1,j9 as a2,Xi as a3,H9 as a4,G9 as a5,rR as a6,q9 as a7,L5 as a8,L9 as a9,z9 as aa,F_ as ab,Ck as b,st as c,Io as d,Ik as e,BA as f,J9 as g,Hb as h,Nk as i,S as j,Qw as k,i9 as l,vi as m,dk as n,Hk as o,$k as p,Vk as q,Oe as r,Y9 as s,Zk as t,Wv as u,wp as v,a0 as w,IN as x,ca as y,CN as z};
